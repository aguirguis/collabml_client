Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 44.39819088813076 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([], dtype=int64),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 20
Intermediate:  1531.25
29.572265625
Total layers size  29.767486572265625
Fixed, scale_with_bsz  30.436920166015625 30.146484375
Mem usage  1250.0 3.0
Using split index: 20
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 288.19219303131104 seconds
Memory occpied: (1294.0, 3.0)
Streaming imagenet data took 288.9087870121002 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1294.0, 3.0)
Time of next(dataloader) is: 1.28684401512146
Time for copying to cuda: 0.3888092041015625
Memory occpied: (2826.0, 1028.0)
Memory occpied: (2826.0, 1448.0)
Memory occpied: (2826.0, 1916.0)
Time for forward pass: 3.512819528579712
Time for backpropagation: 0.07833075523376465
GPU memory for training: 6.810298919677734                          

One training iteration takes: 5.522813081741333 seconds
Index: 0
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 290.0519633293152 seconds
Memory occpied: (5328.0, 4462.0)
Streaming imagenet data took 290.62668108940125 seconds
Then, training+dataloading take 290.7106935977936 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.4776086807250977
Time for copying to cuda: 0.39661478996276855
Time for forward pass: 0.16074275970458984
Time for backpropagation: 0.01177072525024414
GPU memory for training: 6.8247809410095215                          

Memory occpied: (5328.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
One training iteration takes: 7.235433340072632 seconds
Index: 1
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 291.25893473625183 seconds
Streaming imagenet data took 291.8275763988495 seconds
Then, training+dataloading take 291.91046929359436 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.4719111919403076
Time for copying to cuda: 0.4015998840332031
Time for forward pass: 0.16064977645874023
Time for backpropagation: 0.011636972427368164
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.2617506980895996 seconds
Index: 2
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 290.69492268562317 seconds
Streaming imagenet data took 291.3415014743805 seconds
Then, training+dataloading take 291.39874172210693 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.5269815921783447
Memory occpied: (5344.0, 4478.0)
Time for copying to cuda: 0.45478105545043945
Time for forward pass: 0.16101336479187012
Time for backpropagation: 0.011868953704833984
GPU memory for training: 6.8247809410095215                          

Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
One training iteration takes: 7.3464038372039795 seconds
Index: 3
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 293.34284567832947 seconds
Streaming imagenet data took 293.91050148010254 seconds
Then, training+dataloading take 293.9936852455139 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.5495281219482422
Time for copying to cuda: 0.39221620559692383
Time for forward pass: 0.1611166000366211
Time for backpropagation: 0.011838674545288086
GPU memory for training: 6.8247809410095215                          

Memory occpied: (5344.0, 4478.0)
One training iteration takes: 2.389376163482666 seconds
Index: 4
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 290.3002836704254 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 290.9498550891876 seconds
Then, training+dataloading take 291.0332181453705 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.4280338287353516
Time for copying to cuda: 0.39339208602905273
Time for forward pass: 0.16392159461975098
Time for backpropagation: 0.012421131134033203
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.2040271759033203 seconds
Index: 5
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 79.03811359405518 seconds
Streaming imagenet data took 79.18174123764038 seconds
Then, training+dataloading take 79.20801019668579 seconds

Epoch: 0
Time of next(dataloader) is: 0.7255973815917969
Memory occpied: (5344.0, 4478.0)
Time for copying to cuda: 0.10268878936767578
Time for forward pass: 0.046829938888549805
Time for backpropagation: 0.010855436325073242
GPU memory for training: 1.753340721130371                          

The whole process took 1835.2702679634094 seconds
