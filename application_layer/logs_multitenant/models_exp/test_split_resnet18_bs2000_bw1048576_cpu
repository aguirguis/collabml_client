Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.2932545558349 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  1148.4375
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.190131902694702 seconds
Streaming imagenet data took 8.261658191680908 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4848508834838867
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 1.1558341979980469
Time for backpropagation: 2.2199959754943848
One training iteration takes: 3.9670403003692627 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.785607576370239 seconds
Streaming imagenet data took 7.859037637710571 seconds
Then, training+dataloading take 7.869187831878662 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44376230239868164
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3429780006408691
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.591397523880005
One training iteration takes: 4.506867170333862 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.700538635253906 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.774567365646362 seconds
Then, training+dataloading take 7.787084579467773 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4463033676147461
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3202719688415527
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6173880100250244
One training iteration takes: 4.508779525756836 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.410350799560547 seconds
Streaming imagenet data took 7.484370946884155 seconds
Then, training+dataloading take 7.496877908706665 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5581014156341553
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 1.1593677997589111
Time for backpropagation: 2.2467241287231445
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.086503028869629 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.18880319595337 seconds
Streaming imagenet data took 8.262941837310791 seconds
Then, training+dataloading take 8.272399663925171 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47220921516418457
Time for copying to cuda: 1.2874603271484375e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3410227298736572
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4503536224365234
One training iteration takes: 4.38139796257019 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.450681686401367 seconds
Streaming imagenet data took 7.524630546569824 seconds
Then, training+dataloading take 7.539958715438843 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4451735019683838
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3469104766845703
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5956270694732666
One training iteration takes: 4.48721718788147 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.882388353347778 seconds
Streaming imagenet data took 7.9545814990997314 seconds
Then, training+dataloading take 7.9685797691345215 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4438445568084717
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.426548719406128
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3578457832336426
One training iteration takes: 4.328436374664307 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.6101393699646 seconds
Streaming imagenet data took 7.683346748352051 seconds
Then, training+dataloading take 7.697611570358276 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46070027351379395
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2415227890014648
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4171431064605713
One training iteration takes: 4.223660945892334 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.445844173431396 seconds
Streaming imagenet data took 8.519592761993408 seconds
Then, training+dataloading take 8.533143758773804 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4436788558959961
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3763396739959717
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.678873062133789
One training iteration takes: 4.625781297683716 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.7203898429870605 seconds
Streaming imagenet data took 7.792059659957886 seconds
Then, training+dataloading take 7.806184530258179 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4448106288909912
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4090912342071533
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6597015857696533
One training iteration takes: 4.63893461227417 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.458542346954346 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.5355987548828125 seconds
Then, training+dataloading take 7.550602912902832 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4625682830810547
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3384451866149902
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6371805667877197
One training iteration takes: 4.538323640823364 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.676234722137451 seconds
Streaming imagenet data took 7.835727691650391 seconds
Then, training+dataloading take 7.848453760147095 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.45102477073669434
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3822579383850098
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.477116584777832
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.419000148773193 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.318149089813232 seconds
Streaming imagenet data took 8.389668464660645 seconds
Then, training+dataloading take 8.40465760231018 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4415910243988037
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.364506483078003
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.646343231201172
One training iteration takes: 4.555703163146973 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.541426181793213 seconds
Streaming imagenet data took 7.6137919425964355 seconds
Then, training+dataloading take 7.6286773681640625 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.452392578125
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3715064525604248
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6403727531433105
One training iteration takes: 4.579552888870239 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.535264492034912 seconds
Streaming imagenet data took 7.6067798137664795 seconds
Then, training+dataloading take 7.621083974838257 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4455225467681885
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.371988296508789
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5924129486083984
One training iteration takes: 4.531217813491821 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.840604782104492 seconds
Streaming imagenet data took 7.913397312164307 seconds
Then, training+dataloading take 7.923688888549805 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46625304222106934
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3679828643798828
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.610694646835327
One training iteration takes: 4.565726280212402 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.202547788619995 seconds
Streaming imagenet data took 8.277061462402344 seconds
Then, training+dataloading take 8.286782026290894 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46538376808166504
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3907039165496826
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3781864643096924
One training iteration takes: 4.390957593917847 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.602668762207031 seconds
Streaming imagenet data took 7.675039768218994 seconds
Then, training+dataloading take 7.6898322105407715 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4420907497406006
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.442704439163208
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.432506799697876
One training iteration takes: 4.424213409423828 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.749581336975098 seconds
Streaming imagenet data took 7.82101845741272 seconds
Then, training+dataloading take 7.835637331008911 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4844632148742676
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 1.155120611190796
Time for backpropagation: 2.2249770164489746
One training iteration takes: 3.9884073734283447 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.7615272998809814 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.834905385971069 seconds
Then, training+dataloading take 7.849658966064453 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4441225528717041
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3288750648498535
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6161725521087646
One training iteration takes: 4.525675535202026 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.192295789718628 seconds
Streaming imagenet data took 8.264980792999268 seconds
Then, training+dataloading take 8.279664754867554 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47390007972717285
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2727341651916504
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.597132444381714
One training iteration takes: 4.459060430526733 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.887423992156982 seconds
Streaming imagenet data took 7.959368467330933 seconds
Then, training+dataloading take 7.9734461307525635 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4836108684539795
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.275592565536499
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3920533657073975
One training iteration takes: 4.2530906200408936 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.622616529464722 seconds
Streaming imagenet data took 7.696978330612183 seconds
Then, training+dataloading take 7.707214117050171 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48903512954711914
Time for copying to cuda: 1.049041748046875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.367724895477295
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3798317909240723
One training iteration takes: 4.339263677597046 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.605106830596924 seconds
Streaming imagenet data took 7.679600715637207 seconds
Then, training+dataloading take 7.690073728561401 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4664456844329834
Time for copying to cuda: 9.059906005859375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4369442462921143
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3687171936035156
One training iteration takes: 4.413748025894165 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.53661298751831 seconds
Streaming imagenet data took 8.610746383666992 seconds
Then, training+dataloading take 8.623034000396729 seconds

Epoch: 0
Time of next(dataloader) is: 0.4570026397705078
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3939528465270996
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6603643894195557
The whole process took 209.0786852836609 seconds
