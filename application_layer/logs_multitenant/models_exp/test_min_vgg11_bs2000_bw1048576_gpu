Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.6120217633237 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 25
Intermediate:  31.25
62.60546875
Total layers size  62.687408447265625
Fixed, scale_with_bsz  506.8334045410156 63.1796875
Mem usage  1250.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.389246702194214 seconds
Streaming imagenet data took 11.402324914932251 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37438154220581055
Time for copying to cuda: 0.009417533874511719
Memory occpied: (1794.0, 164.0)
Memory occpied: (1794.0, 568.0)
Memory occpied: (1794.0, 1020.0)
Time for forward pass: 3.4518845081329346
Time for backpropagation: 0.054270267486572266
GPU memory for training: 2.0919079780578613                          

One training iteration takes: 3.9813408851623535 seconds
Index: 0
Memory occpied: (3020.0, 1862.0)
Memory occpied: (3020.0, 1862.0)
Memory occpied: (3020.0, 1862.0)
Memory occpied: (3020.0, 1862.0)
Memory occpied: (3020.0, 1862.0)
Memory occpied: (3020.0, 1862.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.39237642288208 seconds
Streaming imagenet data took 11.40519666671753 seconds
Then, training+dataloading take 11.406304597854614 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47333526611328125
Time for copying to cuda: 0.008557558059692383
Time for forward pass: 0.09726572036743164
Time for backpropagation: 0.0032236576080322266
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.70192551612854 seconds
Index: 1
Memory occpied: (3020.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.13029146194458 seconds
Streaming imagenet data took 9.143723726272583 seconds
Then, training+dataloading take 9.144842386245728 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4467284679412842
Time for copying to cuda: 0.008619546890258789
Time for forward pass: 0.09727787971496582
Time for backpropagation: 0.003610849380493164
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.703697919845581 seconds
Index: 2
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.332975149154663 seconds
Streaming imagenet data took 11.34625768661499 seconds
Then, training+dataloading take 11.347157001495361 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4666624069213867
Time for copying to cuda: 0.008806943893432617
Time for forward pass: 0.09792637825012207
Time for backpropagation: 0.003217935562133789
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.7082669734954834 seconds
Index: 3
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.346358299255371 seconds
Streaming imagenet data took 11.354873180389404 seconds
Then, training+dataloading take 11.35606837272644 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.511268138885498
Time for copying to cuda: 0.008753538131713867
Memory occpied: (3422.0, 1870.0)
Time for forward pass: 0.09737610816955566
Time for backpropagation: 0.0032384395599365234
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.7208616733551025 seconds
Index: 4
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.377484321594238 seconds
Streaming imagenet data took 11.390880346298218 seconds
Then, training+dataloading take 11.391879796981812 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (3422.0, 1870.0)
Time of next(dataloader) is: 0.49544787406921387
Time for copying to cuda: 0.008703231811523438
Time for forward pass: 0.09722471237182617
Time for backpropagation: 0.003299713134765625
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6968212127685547 seconds
Index: 5
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.313532829284668 seconds
Streaming imagenet data took 9.322041749954224 seconds
Then, training+dataloading take 9.323251247406006 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4099588394165039
Time for copying to cuda: 0.008613109588623047
Time for forward pass: 0.09712719917297363
Time for backpropagation: 0.003168821334838867
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6071038246154785 seconds
Index: 6
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.427724599838257 seconds
Streaming imagenet data took 11.440981388092041 seconds
Then, training+dataloading take 11.441971063613892 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4024507999420166
Time for copying to cuda: 0.008658170700073242
Time for forward pass: 0.09753179550170898
Time for backpropagation: 0.0032308101654052734
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6122846603393555 seconds
Index: 7
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.462900638580322 seconds
Streaming imagenet data took 11.471646070480347 seconds
Then, training+dataloading take 11.47289752960205 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45386672019958496
Time for copying to cuda: 0.008862495422363281
Time for forward pass: 0.10784506797790527
Time for backpropagation: 0.003670215606689453
GPU memory for training: 2.2474637031555176                          

Memory occpied: (3422.0, 1870.0)
One training iteration takes: 0.6764702796936035 seconds
Index: 8
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.438854455947876 seconds
Streaming imagenet data took 11.452217102050781 seconds
Then, training+dataloading take 11.453195810317993 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4777810573577881
Time for copying to cuda: 0.008570194244384766
Time for forward pass: 0.09727811813354492
Time for backpropagation: 0.0032448768615722656
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.7242612838745117 seconds
Index: 9
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.155539274215698 seconds
Streaming imagenet data took 9.164078712463379 seconds
Then, training+dataloading take 9.165293455123901 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4362504482269287
Time for copying to cuda: 0.008680582046508789
Time for forward pass: 0.09728026390075684
Time for backpropagation: 0.0031850337982177734
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6805236339569092 seconds
Index: 10
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.296224117279053 seconds
Streaming imagenet data took 11.309443235397339 seconds
Then, training+dataloading take 11.310358047485352 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5132744312286377
Time for copying to cuda: 0.008569478988647461
Memory occpied: (3422.0, 1870.0)
Time for forward pass: 0.0973055362701416
Time for backpropagation: 0.003237009048461914
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.7393715381622314 seconds
Index: 11
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.86101484298706 seconds
Streaming imagenet data took 11.869465827941895 seconds
Then, training+dataloading take 11.87145447731018 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3939552307128906
Time for copying to cuda: 0.008661270141601562
Time for forward pass: 0.0970766544342041
Time for backpropagation: 0.003308534622192383
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6011228561401367 seconds
Index: 12
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.409208059310913 seconds
Streaming imagenet data took 11.423011779785156 seconds
Then, training+dataloading take 11.42404580116272 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44159674644470215
Time for copying to cuda: 0.008661508560180664
Time for forward pass: 0.10167694091796875
Time for backpropagation: 0.004287242889404297
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6993439197540283 seconds
Index: 13
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.501267671585083 seconds
Streaming imagenet data took 9.509726285934448 seconds
Then, training+dataloading take 9.51086974143982 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38814544677734375
Time for copying to cuda: 0.008630037307739258
Time for forward pass: 0.09726667404174805
Time for backpropagation: 0.003660917282104492
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.5994467735290527 seconds
Index: 14
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.349608898162842 seconds
Streaming imagenet data took 11.363282203674316 seconds
Then, training+dataloading take 11.36424207687378 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42253923416137695
Time for copying to cuda: 0.008739471435546875
Time for forward pass: 0.09732341766357422
Time for backpropagation: 0.003390073776245117
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6270062923431396 seconds
Index: 15
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.267581939697266 seconds
Streaming imagenet data took 11.27609395980835 seconds
Then, training+dataloading take 11.277324914932251 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39144468307495117
Time for copying to cuda: 0.008591651916503906
Time for forward pass: 0.09747028350830078
Time for backpropagation: 0.003198385238647461
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6132838726043701 seconds
Index: 16
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.372416496276855 seconds
Streaming imagenet data took 11.385884284973145 seconds
Then, training+dataloading take 11.386783599853516 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42295193672180176
Time for copying to cuda: 0.008592367172241211
Time for forward pass: 0.11157584190368652
Time for backpropagation: 0.0036427974700927734
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6402156352996826 seconds
Index: 17
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.77035927772522 seconds
Streaming imagenet data took 9.77895998954773 seconds
Then, training+dataloading take 9.780927419662476 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40735912322998047
Time for copying to cuda: 0.008601188659667969
Time for forward pass: 0.12063312530517578
Time for backpropagation: 0.0036847591400146484
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6614091396331787 seconds
Index: 18
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.204945802688599 seconds
Streaming imagenet data took 11.218290328979492 seconds
Then, training+dataloading take 11.21917986869812 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40329504013061523
Time for copying to cuda: 0.008588552474975586
Time for forward pass: 0.1118779182434082
Time for backpropagation: 0.003648519515991211
GPU memory for training: 2.2474637031555176                          

Memory occpied: (3422.0, 1870.0)
One training iteration takes: 0.6220865249633789 seconds
Index: 19
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.346464395523071 seconds
Streaming imagenet data took 11.354906558990479 seconds
Then, training+dataloading take 11.356088876724243 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Memory occpied: (3422.0, 1870.0)
Time of next(dataloader) is: 0.5120360851287842
Time for copying to cuda: 0.008513689041137695
Time for forward pass: 0.09809064865112305
Time for backpropagation: 0.0032546520233154297
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.718904972076416 seconds
Index: 20
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.457695245742798 seconds
Streaming imagenet data took 11.51507830619812 seconds
Then, training+dataloading take 11.521979331970215 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Memory occpied: (3422.0, 1870.0)
Time of next(dataloader) is: 0.3922879695892334
Time for copying to cuda: 0.008614301681518555
Time for forward pass: 0.09730076789855957
Time for backpropagation: 0.0032150745391845703
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6223132610321045 seconds
Index: 21
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.425397157669067 seconds
Streaming imagenet data took 9.433990716934204 seconds
Then, training+dataloading take 9.435309171676636 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44161391258239746
Time for copying to cuda: 0.009689092636108398
Time for forward pass: 0.11495518684387207
Time for backpropagation: 0.0037593841552734375
GPU memory for training: 2.2474637031555176                          

Memory occpied: (3422.0, 1870.0)
One training iteration takes: 0.663175106048584 seconds
Index: 22
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.494361639022827 seconds
Streaming imagenet data took 11.50753378868103 seconds
Then, training+dataloading take 11.508522987365723 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4512815475463867
Time for copying to cuda: 0.008594274520874023
Time for forward pass: 0.09727191925048828
Time for backpropagation: 0.0032198429107666016
GPU memory for training: 2.2474637031555176                          

One training iteration takes: 0.6899080276489258 seconds
Index: 23
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Memory occpied: (3422.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.275675773620605 seconds
Streaming imagenet data took 11.288632869720459 seconds
Then, training+dataloading take 11.289622783660889 seconds

Epoch: 0
Time of next(dataloader) is: 0.39511704444885254
Time for copying to cuda: 0.008981466293334961
Time for forward pass: 0.09847164154052734
Time for backpropagation: 0.003793001174926758
GPU memory for training: 2.2474637031555176                          

Memory occpied: (3422.0, 1870.0)
The whole process took 282.74455523490906 seconds
