Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.2690334232069 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 11
Intermediate:  4593.75
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 17.395784616470337 seconds
Streaming imagenet data took 17.680054664611816 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1312.0, 3.0)
Time of next(dataloader) is: 0.8093616962432861
Time for copying to cuda: 0.19603800773620605
Memory occpied: (2078.0, 768.0)
Memory occpied: (2078.0, 1218.0)
Memory occpied: (2078.0, 7182.0)
Memory occpied: (7594.0, 7182.0)
Time for forward pass: 5.344459295272827
Memory occpied: (12654.0, 12276.0)
Memory occpied: (12654.0, 12276.0)
Memory occpied: (12654.0, 7164.0)
Memory occpied: (12654.0, 7164.0)
Time for backpropagation: 4.830949306488037
GPU memory for training: 14.14211130142212                          

One training iteration takes: 11.349432945251465 seconds
Index: 0
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 17.54147720336914 seconds
Streaming imagenet data took 17.833643436431885 seconds
Then, training+dataloading take 17.871379852294922 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9528098106384277
Time for copying to cuda: 0.19737505912780762
Time for forward pass: 0.334733247756958
Time for backpropagation: 0.004936933517456055
GPU memory for training: 8.730688571929932                          

One training iteration takes: 1.6591401100158691 seconds
Index: 1
Memory occpied: (7572.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 17.540242433547974 seconds
Streaming imagenet data took 17.8246750831604 seconds
Then, training+dataloading take 17.862239360809326 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (7588.0, 6682.0)
Time of next(dataloader) is: 0.9102180004119873
Time for copying to cuda: 0.1976315975189209
Time for forward pass: 0.3189833164215088
Time for backpropagation: 0.005234956741333008
GPU memory for training: 8.730311393737793                          

Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
One training iteration takes: 6.5291290283203125 seconds
Index: 2
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 17.752626419067383 seconds
Streaming imagenet data took 18.041077852249146 seconds
Then, training+dataloading take 18.090840101242065 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (7588.0, 6682.0)
Time of next(dataloader) is: 1.0154931545257568
Time for copying to cuda: 0.19546771049499512
Time for forward pass: 0.34440135955810547
Time for backpropagation: 0.00489497184753418
GPU memory for training: 8.730311393737793                          

One training iteration takes: 1.712294578552246 seconds
Index: 3
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 17.30083179473877 seconds
Memory occpied: (7588.0, 6682.0)
Streaming imagenet data took 17.59444260597229 seconds
Then, training+dataloading take 17.63608407974243 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9551033973693848
Memory occpied: (7588.0, 6682.0)
Time for copying to cuda: 0.19765806198120117
Time for forward pass: 0.31310224533081055
Time for backpropagation: 0.004904270172119141
GPU memory for training: 8.730311393737793                          

One training iteration takes: 1.6653354167938232 seconds
Index: 4
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 17.30883502960205 seconds
Streaming imagenet data took 17.72052836418152 seconds
Then, training+dataloading take 17.768876314163208 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (7588.0, 6682.0)
Time of next(dataloader) is: 0.9169449806213379
Time for copying to cuda: 0.251476526260376
Memory occpied: (7588.0, 6682.0)
Time for forward pass: 0.3432750701904297
Time for backpropagation: 0.0051195621490478516
GPU memory for training: 8.730311393737793                          

One training iteration takes: 1.7322559356689453 seconds
Index: 5
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.8173322677612305 seconds
Memory occpied: (7588.0, 6682.0)
Streaming imagenet data took 7.891068696975708 seconds
Then, training+dataloading take 7.920377016067505 seconds

Epoch: 0
Time of next(dataloader) is: 0.5241138935089111
Time for copying to cuda: 0.0513920783996582
Memory occpied: (12926.0, 12020.0)
Time for forward pass: 0.8441779613494873
Memory occpied: (12156.0, 12380.0)
Time for backpropagation: 1.4904048442840576
GPU memory for training: 11.565897464752197                          

The whole process took 124.35143327713013 seconds
