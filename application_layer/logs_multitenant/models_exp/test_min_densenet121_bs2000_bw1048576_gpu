Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.2899179721476 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 20
Intermediate:  191.40625
29.380859375
Total layers size  29.767486572265625
Fixed, scale_with_bsz  30.436920166015625 29.955078125
Mem usage  1250.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.47468638420105 seconds
Streaming imagenet data took 11.546211242675781 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4462263584136963
Time for copying to cuda: 0.08543276786804199
Memory occpied: (1486.0, 15.0)
Memory occpied: (1486.0, 624.0)
Memory occpied: (1486.0, 1072.0)
Memory occpied: (4220.0, 5056.0)
Memory occpied: (7608.0, 4564.0)
Time for forward pass: 4.9559385776519775
Time for backpropagation: 0.09218573570251465
GPU memory for training: 6.092408180236816                          

One training iteration takes: 5.69536828994751 seconds
Index: 0
Memory occpied: (2800.0, 4588.0)
Memory occpied: (2800.0, 4588.0)
Memory occpied: (2800.0, 4588.0)
Memory occpied: (2800.0, 4588.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.863595724105835 seconds
Streaming imagenet data took 10.937092304229736 seconds
Then, training+dataloading take 10.947878122329712 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.529468297958374
Time for copying to cuda: 0.04979538917541504
Memory occpied: (2800.0, 4604.0)
Time for forward pass: 0.28064727783203125
Time for backpropagation: 0.011463403701782227
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9705219268798828 seconds
Index: 1
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.839476823806763 seconds
Streaming imagenet data took 10.911337614059448 seconds
Then, training+dataloading take 10.92411732673645 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5001742839813232
Time for copying to cuda: 0.049829959869384766
Time for forward pass: 0.2863023281097412
Time for backpropagation: 0.011980056762695312
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9758198261260986 seconds
Index: 2
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.01531171798706 seconds
Streaming imagenet data took 10.087029218673706 seconds
Then, training+dataloading take 10.099640846252441 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48828768730163574
Time for copying to cuda: 0.0498507022857666
Time for forward pass: 0.25964856147766113
Time for backpropagation: 0.011744022369384766
GPU memory for training: 1.753188133239746                          

Memory occpied: (2816.0, 4604.0)
One training iteration takes: 0.9259347915649414 seconds
Index: 3
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.353296041488647 seconds
Streaming imagenet data took 11.42559027671814 seconds
Then, training+dataloading take 11.435679197311401 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.541142463684082
Time for copying to cuda: 0.04981088638305664
Time for forward pass: 0.22627806663513184
Time for backpropagation: 0.01097559928894043
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.95658278465271 seconds
Index: 4
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.966708660125732 seconds
Memory occpied: (2816.0, 4604.0)
Streaming imagenet data took 11.0388662815094 seconds
Then, training+dataloading take 11.05446481704712 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4917030334472656
Time for copying to cuda: 0.050390005111694336
Time for forward pass: 0.22821426391601562
Time for backpropagation: 0.011192083358764648
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8777389526367188 seconds
Index: 5
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.920203685760498 seconds
Streaming imagenet data took 11.042536973953247 seconds
Then, training+dataloading take 11.058899164199829 seconds
Memory occpied: (2816.0, 4604.0)
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5275247097015381
Time for copying to cuda: 0.049547433853149414
Time for forward pass: 0.22371292114257812
Time for backpropagation: 0.011203289031982422
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9106361865997314 seconds
Index: 6
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.113865613937378 seconds
Streaming imagenet data took 10.187371253967285 seconds
Then, training+dataloading take 10.20078730583191 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5280187129974365
Time for copying to cuda: 0.04963493347167969
Time for forward pass: 0.23035836219787598
Time for backpropagation: 0.01139068603515625
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9898922443389893 seconds
Index: 7
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.836043119430542 seconds
Streaming imagenet data took 10.955601453781128 seconds
Then, training+dataloading take 10.971975088119507 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (2816.0, 4604.0)
Time of next(dataloader) is: 0.48442935943603516
Time for copying to cuda: 0.04972505569458008
Time for forward pass: 0.228287935256958
Time for backpropagation: 0.011319875717163086
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8946964740753174 seconds
Index: 8
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.75083613395691 seconds
Streaming imagenet data took 11.8229341506958 seconds
Then, training+dataloading take 11.837689876556396 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5399885177612305
Time for copying to cuda: 0.05050802230834961
Time for forward pass: 0.2272036075592041
Time for backpropagation: 0.011451482772827148
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9548039436340332 seconds
Index: 9
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.938863277435303 seconds
Memory occpied: (2816.0, 4604.0)
Streaming imagenet data took 11.011857986450195 seconds
Then, training+dataloading take 11.027190208435059 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4922163486480713
Time for copying to cuda: 0.04992222785949707
Time for forward pass: 0.2291719913482666
Time for backpropagation: 0.06030392646789551
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9276151657104492 seconds
Index: 10
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.095747470855713 seconds
Streaming imagenet data took 10.171559572219849 seconds
Then, training+dataloading take 10.186464786529541 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48972058296203613
Time for copying to cuda: 0.050441741943359375
Time for forward pass: 0.2645385265350342
Time for backpropagation: 0.012188434600830078
GPU memory for training: 1.753188133239746                          

Memory occpied: (2816.0, 4604.0)
One training iteration takes: 0.9462406635284424 seconds
Index: 11
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.982449531555176 seconds
Streaming imagenet data took 11.055193901062012 seconds
Then, training+dataloading take 11.070272445678711 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4848287105560303
Time for copying to cuda: 0.050374746322631836
Time for forward pass: 0.22755002975463867
Time for backpropagation: 0.011774063110351562
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8967061042785645 seconds
Index: 12
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.895490169525146 seconds
Memory occpied: (2816.0, 4604.0)
Streaming imagenet data took 10.967882633209229 seconds
Then, training+dataloading take 10.983308553695679 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4868638515472412
Time for copying to cuda: 0.05019855499267578
Time for forward pass: 0.22781705856323242
Time for backpropagation: 0.011403560638427734
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8746950626373291 seconds
Index: 13
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.555410146713257 seconds
Streaming imagenet data took 11.629225969314575 seconds
Then, training+dataloading take 11.644566774368286 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5265371799468994
Time for copying to cuda: 0.05002188682556152
Memory occpied: (2816.0, 4604.0)
Time for forward pass: 0.2268664836883545
Time for backpropagation: 0.011200189590454102
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9121427536010742 seconds
Index: 14
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 9.945099830627441 seconds
Streaming imagenet data took 10.016578197479248 seconds
Then, training+dataloading take 10.031440734863281 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5409595966339111
Time for copying to cuda: 0.050028085708618164
Time for forward pass: 0.2265636920928955
Time for backpropagation: 0.010944843292236328
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9524035453796387 seconds
Index: 15
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.695398330688477 seconds
Streaming imagenet data took 11.767436027526855 seconds
Then, training+dataloading take 11.78223204612732 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.53255295753479
Time for copying to cuda: 0.04978203773498535
Time for forward pass: 0.2212049961090088
Time for backpropagation: 0.011256694793701172
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.938591480255127 seconds
Index: 16
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.923163414001465 seconds
Memory occpied: (2816.0, 4604.0)
Streaming imagenet data took 10.995299816131592 seconds
Then, training+dataloading take 11.010584354400635 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48281359672546387
Time for copying to cuda: 0.0501561164855957
Time for forward pass: 0.22827911376953125
Time for backpropagation: 0.011558055877685547
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9028728008270264 seconds
Index: 17
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 12.286853075027466 seconds
Memory occpied: (2816.0, 4604.0)
Streaming imagenet data took 12.358307838439941 seconds
Then, training+dataloading take 12.374504327774048 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5235805511474609
Time for copying to cuda: 0.05035567283630371
Time for forward pass: 0.2285919189453125
Time for backpropagation: 0.011327028274536133
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9379067420959473 seconds
Index: 18
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.08142900466919 seconds
Streaming imagenet data took 10.153855800628662 seconds
Then, training+dataloading take 10.170042753219604 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4852864742279053
Time for copying to cuda: 0.05013728141784668
Time for forward pass: 0.22669053077697754
Time for backpropagation: 0.012099027633666992
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8822298049926758 seconds
Index: 19
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.590317249298096 seconds
Streaming imagenet data took 11.663350343704224 seconds
Then, training+dataloading take 11.678314447402954 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Memory occpied: (2816.0, 4604.0)
Time of next(dataloader) is: 0.5337221622467041
Time for copying to cuda: 0.05059385299682617
Time for forward pass: 0.22819805145263672
Time for backpropagation: 0.011207818984985352
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9477322101593018 seconds
Index: 20
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.9162118434906 seconds
Streaming imagenet data took 10.989448547363281 seconds
Then, training+dataloading take 11.00519347190857 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5575628280639648
Time for copying to cuda: 0.05073904991149902
Memory occpied: (2816.0, 4604.0)
Time for forward pass: 0.22952866554260254
Time for backpropagation: 0.0113372802734375
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9814004898071289 seconds
Index: 21
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.785385370254517 seconds
Memory occpied: (2816.0, 4604.0)
Streaming imagenet data took 11.85808539390564 seconds
Then, training+dataloading take 11.873568058013916 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4992797374725342
Time for copying to cuda: 0.05086636543273926
Time for forward pass: 0.22900080680847168
Time for backpropagation: 0.011164188385009766
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8860068321228027 seconds
Index: 22
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.256959676742554 seconds
Streaming imagenet data took 10.331299304962158 seconds
Then, training+dataloading take 10.34667420387268 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5617804527282715
Time for copying to cuda: 0.050749778747558594
Memory occpied: (2816.0, 4604.0)
Time for forward pass: 0.3236722946166992
Time for backpropagation: 0.012142419815063477
GPU memory for training: 1.753188133239746                          

One training iteration takes: 1.0484850406646729 seconds
Index: 23
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Memory occpied: (2816.0, 4604.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 12.310401916503906 seconds
Streaming imagenet data took 12.38352370262146 seconds
Then, training+dataloading take 12.398839950561523 seconds

Epoch: 0
Time of next(dataloader) is: 0.5463628768920898
Time for copying to cuda: 0.050843238830566406
Memory occpied: (2816.0, 4604.0)
Time for forward pass: 0.27040648460388184
Time for backpropagation: 0.011729240417480469
GPU memory for training: 1.753188133239746                          

The whole process took 285.565838098526 seconds
