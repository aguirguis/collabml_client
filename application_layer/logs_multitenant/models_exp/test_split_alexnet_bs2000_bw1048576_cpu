Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.7518226706369 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  70.3125
4.037109375
Total layers size  4.189361572265625
Candidate split  13
Server, client, server+client, vanilla  348.3644104003906 709.2774963378906 1057.6419067382812 9861.62124633789
Model size  233.08120727539062
Fixed, scale_with_bsz  233.08120727539062 4.611328125
Mem usage  1250.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.288771390914917 seconds
Streaming imagenet data took 9.315969467163086 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43638134002685547
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.35686540603637695
Time for backpropagation: 0.17374634742736816
One training iteration takes: 1.080000638961792 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.220313310623169 seconds
Streaming imagenet data took 9.24765682220459 seconds
Then, training+dataloading take 9.25199842453003 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43955469131469727
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.3636505603790283
Time for backpropagation: 0.22598695755004883
One training iteration takes: 1.178434133529663 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.161824226379395 seconds
Streaming imagenet data took 9.190659999847412 seconds
Then, training+dataloading take 9.195723295211792 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42135190963745117
Time for copying to cuda: 1.2636184692382812e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.4520280361175537
Time for backpropagation: 0.24634385108947754
One training iteration takes: 1.2409217357635498 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.054465055465698 seconds
Streaming imagenet data took 9.125530481338501 seconds
Then, training+dataloading take 9.133783102035522 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.39501094818115234
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.3637256622314453
Time for backpropagation: 0.23291802406311035
One training iteration takes: 1.1463894844055176 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.28294324874878 seconds
Streaming imagenet data took 9.31070590019226 seconds
Then, training+dataloading take 9.3150954246521 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39504170417785645
Time for copying to cuda: 1.2159347534179688e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.40937232971191406
Time for backpropagation: 0.2663865089416504
One training iteration takes: 1.218386173248291 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.00934100151062 seconds
Streaming imagenet data took 9.080869436264038 seconds
Then, training+dataloading take 9.088783740997314 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4602012634277344
Time for copying to cuda: 1.1444091796875e-05
Time for forward pass: 0.3786449432373047
Time for backpropagation: 0.260361909866333
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.2183971405029297 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.44709825515747 seconds
Streaming imagenet data took 9.477165222167969 seconds
Then, training+dataloading take 9.48253607749939 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4585397243499756
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.39580488204956055
Time for backpropagation: 0.2572207450866699
One training iteration takes: 1.259096622467041 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.19914984703064 seconds
Streaming imagenet data took 9.226246356964111 seconds
Then, training+dataloading take 9.231252670288086 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4047255516052246
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.579988956451416
Time for backpropagation: 0.28060364723205566
One training iteration takes: 1.4080300331115723 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.725222110748291 seconds
Streaming imagenet data took 9.755585670471191 seconds
Then, training+dataloading take 9.76043152809143 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41678810119628906
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.6086080074310303
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.28195643424987793
One training iteration takes: 1.4611682891845703 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.219657897949219 seconds
Streaming imagenet data took 9.246812105178833 seconds
Then, training+dataloading take 9.251073837280273 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43085551261901855
Time for copying to cuda: 1.1920928955078125e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.4454331398010254
Time for backpropagation: 0.26224207878112793
One training iteration takes: 1.2828879356384277 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.98206639289856 seconds
Streaming imagenet data took 9.009321689605713 seconds
Then, training+dataloading take 9.012176752090454 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.546302318572998
Time for copying to cuda: 1.3589859008789062e-05
Time for forward pass: 0.3933377265930176
Time for backpropagation: 0.2773575782775879
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.3337149620056152 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.01332974433899 seconds
Streaming imagenet data took 9.040478467941284 seconds
Then, training+dataloading take 9.045583009719849 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41455698013305664
Time for copying to cuda: 1.0013580322265625e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6629090309143066
Time for backpropagation: 0.2738211154937744
One training iteration takes: 1.4884836673736572 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.419260025024414 seconds
Streaming imagenet data took 9.446465969085693 seconds
Then, training+dataloading take 9.449307918548584 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4593925476074219
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.39525365829467773
Time for backpropagation: 0.22522449493408203
One training iteration takes: 1.2425198554992676 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.874998092651367 seconds
Streaming imagenet data took 8.902401208877563 seconds
Then, training+dataloading take 8.906596422195435 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44265079498291016
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.6204056739807129
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2570788860321045
One training iteration takes: 1.4716103076934814 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.042278051376343 seconds
Streaming imagenet data took 9.070318460464478 seconds
Then, training+dataloading take 9.074593544006348 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40435099601745605
Time for copying to cuda: 1.1444091796875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5697462558746338
Time for backpropagation: 0.2629086971282959
One training iteration takes: 1.3717041015625 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.828203439712524 seconds
Streaming imagenet data took 8.856050968170166 seconds
Then, training+dataloading take 8.860384941101074 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4515526294708252
Time for copying to cuda: 1.1205673217773438e-05
Time for forward pass: 0.3794069290161133
Time for backpropagation: 0.2601203918457031
One training iteration takes: 1.2745633125305176 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.509225606918335 seconds
Streaming imagenet data took 9.5366952419281 seconds
Then, training+dataloading take 9.541075468063354 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.478226900100708
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.3644592761993408
Time for backpropagation: 0.26029014587402344
One training iteration takes: 1.2508635520935059 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.314515590667725 seconds
Streaming imagenet data took 9.342618703842163 seconds
Then, training+dataloading take 9.347101926803589 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40720272064208984
Time for copying to cuda: 1.1205673217773438e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.47384023666381836
Time for backpropagation: 0.26465582847595215
One training iteration takes: 1.2929651737213135 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.971984386444092 seconds
Streaming imagenet data took 9.044893980026245 seconds
Then, training+dataloading take 9.052903175354004 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45827770233154297
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.38803791999816895
Time for backpropagation: 0.2342662811279297
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.201756477355957 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.51207447052002 seconds
Streaming imagenet data took 9.539350032806396 seconds
Then, training+dataloading take 9.54445195198059 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46958327293395996
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.38771653175354004
Time for backpropagation: 0.2157001495361328
One training iteration takes: 1.2209343910217285 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.273736000061035 seconds
Streaming imagenet data took 9.302635192871094 seconds
Then, training+dataloading take 9.30692434310913 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4229097366333008
Time for copying to cuda: 1.52587890625e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.45037841796875
Time for backpropagation: 0.27509307861328125
One training iteration takes: 1.3070499897003174 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.909365892410278 seconds
Streaming imagenet data took 8.936612844467163 seconds
Then, training+dataloading take 8.940925121307373 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4589879512786865
Time for copying to cuda: 1.1682510375976562e-05
Time for forward pass: 0.36165523529052734
Time for backpropagation: 0.23342418670654297
One training iteration takes: 1.2085278034210205 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.968205690383911 seconds
Streaming imagenet data took 8.995758771896362 seconds
Then, training+dataloading take 9.000143051147461 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4196314811706543
Time for copying to cuda: 1.0251998901367188e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.603158712387085
Time for backpropagation: 0.27817606925964355
One training iteration takes: 1.4300062656402588 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.686680555343628 seconds
Streaming imagenet data took 9.713603019714355 seconds
Then, training+dataloading take 9.71804165840149 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40886616706848145
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.38250184059143066
Time for backpropagation: 0.4779379367828369
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.4014551639556885 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.537927389144897 seconds
Streaming imagenet data took 9.564963579177856 seconds
Then, training+dataloading take 9.569316625595093 seconds

Epoch: 0
Time of next(dataloader) is: 0.4497523307800293
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.36295652389526367
Time for backpropagation: 0.2626664638519287
Memory occpied: (1250.0, 3.0)
The whole process took 240.01054692268372 seconds
