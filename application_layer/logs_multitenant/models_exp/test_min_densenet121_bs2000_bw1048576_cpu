Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.595238885591 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 20
Intermediate:  191.40625
29.380859375
Total layers size  29.767486572265625
Fixed, scale_with_bsz  30.436920166015625 29.955078125
Mem usage  1250.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.968453168869019 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 11.040452718734741 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4584319591522217
Time for copying to cuda: 5.9604644775390625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.233884811401367
Time for backpropagation: 0.2017369270324707
One training iteration takes: 4.99653172492981 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.142969608306885 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 10.216197967529297 seconds
Then, training+dataloading take 10.235984086990356 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44337892532348633
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.192538022994995
Time for backpropagation: 0.2097797393798828
One training iteration takes: 4.961935758590698 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.588759660720825 seconds
Streaming imagenet data took 11.663649559020996 seconds
Then, training+dataloading take 11.673049688339233 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48783326148986816
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.198028326034546
Time for backpropagation: 0.34856343269348145
One training iteration takes: 5.130511045455933 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.58050799369812 seconds
Streaming imagenet data took 11.65322732925415 seconds
Then, training+dataloading take 11.664873600006104 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4811842441558838
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.363579034805298
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.31298136711120605
One training iteration takes: 5.281850337982178 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.075295209884644 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 11.193621397018433 seconds
Then, training+dataloading take 11.206608772277832 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.469951868057251
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.256032943725586
Time for backpropagation: 0.23534274101257324
One training iteration takes: 5.070591926574707 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.028181791305542 seconds
Streaming imagenet data took 10.147850513458252 seconds
Then, training+dataloading take 10.158928155899048 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5318398475646973
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 3.787311553955078
Time for backpropagation: 0.21062469482421875
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.640254974365234 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.573710918426514 seconds
Streaming imagenet data took 11.647969245910645 seconds
Then, training+dataloading take 11.66219425201416 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5133697986602783
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 3.7360005378723145
Time for backpropagation: 0.21106338500976562
One training iteration takes: 4.585118532180786 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.719410181045532 seconds
Streaming imagenet data took 11.838287830352783 seconds
Then, training+dataloading take 11.856098413467407 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5207509994506836
Time for copying to cuda: 9.059906005859375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.296698570251465
Time for backpropagation: 0.22863101959228516
One training iteration takes: 5.164630174636841 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.345209836959839 seconds
Streaming imagenet data took 11.416741847991943 seconds
Then, training+dataloading take 11.430989027023315 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5803775787353516
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.226575136184692
Time for backpropagation: 0.21943211555480957
One training iteration takes: 5.121423006057739 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.118861436843872 seconds
Streaming imagenet data took 10.192830801010132 seconds
Then, training+dataloading take 10.207258224487305 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5117380619049072
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 3.732189416885376
Time for backpropagation: 0.21337151527404785
One training iteration takes: 4.579777717590332 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.709652423858643 seconds
Streaming imagenet data took 11.83103895187378 seconds
Then, training+dataloading take 11.843821048736572 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5422813892364502
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 3.7794041633605957
Time for backpropagation: 0.2112882137298584
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.6409618854522705 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.982291221618652 seconds
Streaming imagenet data took 11.053757667541504 seconds
Then, training+dataloading take 11.067890644073486 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46579623222351074
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.389411687850952
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2200615406036377
One training iteration takes: 5.182356834411621 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.87047290802002 seconds
Streaming imagenet data took 10.987786293029785 seconds
Then, training+dataloading take 11.003358125686646 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5142490863800049
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.324066400527954
Time for backpropagation: 0.20643925666809082
One training iteration takes: 5.15260648727417 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 9.958066701889038 seconds
Streaming imagenet data took 10.029504299163818 seconds
Then, training+dataloading take 10.043953657150269 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5943717956542969
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.2622740268707275
Time for backpropagation: 0.20640873908996582
One training iteration takes: 5.179511070251465 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.220875263214111 seconds
Streaming imagenet data took 11.293347597122192 seconds
Then, training+dataloading take 11.308290004730225 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5246918201446533
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 3.713881492614746
Time for backpropagation: 0.2069087028503418
One training iteration takes: 4.574466228485107 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.924832105636597 seconds
Streaming imagenet data took 10.998018026351929 seconds
Then, training+dataloading take 11.013461112976074 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47173428535461426
Time for copying to cuda: 1.0251998901367188e-05
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.152085542678833
Time for backpropagation: 0.27715563774108887
One training iteration takes: 5.037821054458618 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.946720361709595 seconds
Streaming imagenet data took 11.018701076507568 seconds
Then, training+dataloading take 11.033549308776855 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5114829540252686
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 3.7621536254882812
Time for backpropagation: 0.2229764461517334
One training iteration takes: 4.616251468658447 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.07698917388916 seconds
Streaming imagenet data took 10.150133609771729 seconds
Then, training+dataloading take 10.164494276046753 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.475236177444458
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.379920721054077
Time for backpropagation: 0.2118067741394043
One training iteration takes: 5.161994695663452 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.888014316558838 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 10.962352275848389 seconds
Then, training+dataloading take 10.977844953536987 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47894763946533203
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.249713659286499
Time for backpropagation: 0.20919179916381836
One training iteration takes: 5.0320494174957275 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 12.214234113693237 seconds
Streaming imagenet data took 12.288475275039673 seconds
Then, training+dataloading take 12.303282022476196 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5878610610961914
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 3.7502243518829346
Time for backpropagation: 0.2052779197692871
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.65339732170105 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.821142673492432 seconds
Streaming imagenet data took 10.894021034240723 seconds
Then, training+dataloading take 10.908917427062988 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.475846529006958
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.212626218795776
Time for backpropagation: 0.25719761848449707
One training iteration takes: 5.086239814758301 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 9.983518362045288 seconds
Streaming imagenet data took 10.100804567337036 seconds
Then, training+dataloading take 10.117330312728882 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000

Memory occpied: (1250.0, 3.0)

Epoch: 0
Time of next(dataloader) is: 0.46755194664001465
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.300748586654663
Time for backpropagation: 0.21499061584472656
One training iteration takes: 5.100744724273682 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.994693517684937 seconds
Streaming imagenet data took 11.06716012954712 seconds
Then, training+dataloading take 11.082300662994385 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5219810009002686
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 3.7357397079467773
Time for backpropagation: 0.21095991134643555
One training iteration takes: 4.59031867980957 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.535712957382202 seconds
Streaming imagenet data took 11.610018730163574 seconds
Then, training+dataloading take 11.624300718307495 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.52549147605896
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 3.735929012298584
Time for backpropagation: 0.20924115180969238
One training iteration takes: 4.5992114543914795 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 11.28719973564148 seconds
Streaming imagenet data took 11.362197637557983 seconds
Then, training+dataloading take 11.377165794372559 seconds

Epoch: 0
Time of next(dataloader) is: 0.47003674507141113
Time for copying to cuda: 1.0013580322265625e-05
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.391565799713135
Time for backpropagation: 0.21929025650024414
The whole process took 288.9548568725586 seconds
