Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.329873698544 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  1148.4375
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.136021852493286 seconds
Streaming imagenet data took 8.207560777664185 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47914958000183105
Time for copying to cuda: 0.049902915954589844
Time for forward pass: 3.9029626846313477
Time for backpropagation: 1.5009384155273438
GPU memory for training: 11.528353214263916                          

One training iteration takes: 6.05566668510437 seconds
Index: 0
Memory occpied: (1312.0, 6718.0)
Memory occpied: (6962.0, 6718.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.490654706954956 seconds
Streaming imagenet data took 7.5632829666137695 seconds
Then, training+dataloading take 7.57756495475769 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4833235740661621
Time for copying to cuda: 0.049603939056396484
Time for forward pass: 0.09518098831176758
Time for backpropagation: 0.004670619964599609
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7383167743682861 seconds
Index: 1
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.689762353897095 seconds
Streaming imagenet data took 7.763469696044922 seconds
Then, training+dataloading take 7.7740278244018555 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5232393741607666
Time for copying to cuda: 0.09346866607666016
Memory occpied: (6978.0, 6734.0)
Time for forward pass: 0.09537720680236816
Time for backpropagation: 0.00465083122253418
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8310983180999756 seconds
Index: 2
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.54546594619751 seconds
Streaming imagenet data took 7.619039535522461 seconds
Then, training+dataloading take 7.6309494972229 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5693809986114502
Time for copying to cuda: 0.04998445510864258
Time for forward pass: 0.09519314765930176
Time for backpropagation: 0.004784822463989258
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8500638008117676 seconds
Index: 3
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.237141132354736 seconds
Streaming imagenet data took 8.355422258377075 seconds
Memory occpied: (6978.0, 6734.0)
Then, training+dataloading take 8.368531465530396 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.544480562210083
Time for copying to cuda: 0.04992318153381348
Time for forward pass: 0.09517192840576172
Time for backpropagation: 0.004641056060791016
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8206362724304199 seconds
Index: 4
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.462051153182983 seconds
Memory occpied: (6978.0, 6734.0)
Streaming imagenet data took 7.53511381149292 seconds
Then, training+dataloading take 7.54597020149231 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5370080471038818
Time for copying to cuda: 0.049774169921875
Time for forward pass: 0.09520602226257324
Time for backpropagation: 0.004694700241088867
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7859008312225342 seconds
Index: 5
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.741687536239624 seconds
Streaming imagenet data took 7.814221143722534 seconds
Then, training+dataloading take 7.827162504196167 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4960293769836426
Time for copying to cuda: 0.04977059364318848
Time for forward pass: 0.09673333168029785
Time for backpropagation: 0.0054149627685546875
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7600052356719971 seconds
Index: 6
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.461785793304443 seconds
Streaming imagenet data took 7.5335915088653564 seconds
Then, training+dataloading take 7.544514179229736 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5273342132568359
Time for copying to cuda: 0.05005049705505371
Time for forward pass: 0.09671449661254883
Time for backpropagation: 0.005318880081176758
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6734.0)
One training iteration takes: 0.7787740230560303 seconds
Index: 7
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.321404218673706 seconds
Streaming imagenet data took 8.394591808319092 seconds
Then, training+dataloading take 8.405351400375366 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5191326141357422
Time for copying to cuda: 0.05045175552368164
Time for forward pass: 0.09526753425598145
Time for backpropagation: 0.00471949577331543
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7826535701751709 seconds
Index: 8
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.621478080749512 seconds
Streaming imagenet data took 7.695793151855469 seconds
Then, training+dataloading take 7.70854115486145 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4915339946746826
Time for copying to cuda: 0.09419655799865723
Time for forward pass: 0.0983889102935791
Time for backpropagation: 0.005258083343505859
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6734.0)
One training iteration takes: 0.8024141788482666 seconds
Index: 9
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.646265029907227 seconds
Streaming imagenet data took 7.719955205917358 seconds
Then, training+dataloading take 7.730463743209839 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5519711971282959
Time for copying to cuda: 0.04937291145324707
Time for forward pass: 0.09521794319152832
Time for backpropagation: 0.004773855209350586
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8527100086212158 seconds
Index: 10
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.642302751541138 seconds
Streaming imagenet data took 7.715531349182129 seconds
Then, training+dataloading take 7.725346803665161 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5645666122436523
Time for copying to cuda: 0.04964780807495117
Memory occpied: (6978.0, 6734.0)
Time for forward pass: 0.0953061580657959
Time for backpropagation: 0.004677772521972656
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8330044746398926 seconds
Index: 11
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.299642086029053 seconds
Streaming imagenet data took 8.372845888137817 seconds
Then, training+dataloading take 8.388087272644043 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5309431552886963
Time for copying to cuda: 0.05113506317138672
Time for forward pass: 0.09602737426757812
Time for backpropagation: 0.004705190658569336
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7663800716400146 seconds
Index: 12
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.506579875946045 seconds
Streaming imagenet data took 7.5797107219696045 seconds
Then, training+dataloading take 7.594849586486816 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5151758193969727
Time for copying to cuda: 0.0929255485534668
Time for forward pass: 0.09680533409118652
Time for backpropagation: 0.0054531097412109375
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6734.0)
One training iteration takes: 0.833552360534668 seconds
Index: 13
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.592259645462036 seconds
Streaming imagenet data took 7.663982629776001 seconds
Then, training+dataloading take 7.678366661071777 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5549952983856201
Time for copying to cuda: 0.0494236946105957
Time for forward pass: 0.09523606300354004
Time for backpropagation: 0.004671812057495117
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8011085987091064 seconds
Index: 14
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.708850622177124 seconds
Streaming imagenet data took 7.781871318817139 seconds
Then, training+dataloading take 7.797163009643555 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5680227279663086
Time for copying to cuda: 0.050286293029785156
Memory occpied: (6978.0, 6734.0)
Time for forward pass: 0.09529638290405273
Time for backpropagation: 0.004913330078125
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8400392532348633 seconds
Index: 15
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.266844272613525 seconds
Streaming imagenet data took 8.338516473770142 seconds
Then, training+dataloading take 8.353849172592163 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5135624408721924
Time for copying to cuda: 0.049665212631225586
Time for forward pass: 0.09520435333251953
Time for backpropagation: 0.004700660705566406
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.782416582107544 seconds
Index: 16
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.685322999954224 seconds
Streaming imagenet data took 7.757945775985718 seconds
Then, training+dataloading take 7.772313594818115 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5192759037017822
Time for copying to cuda: 0.0980992317199707
Memory occpied: (6978.0, 6734.0)
Time for forward pass: 0.09559798240661621
Time for backpropagation: 0.004968404769897461
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8317148685455322 seconds
Index: 17
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.763952255249023 seconds
Streaming imagenet data took 7.838966369628906 seconds
Then, training+dataloading take 7.854281425476074 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6734.0)
Time of next(dataloader) is: 0.5867352485656738
Time for copying to cuda: 0.0505521297454834
Time for forward pass: 0.0952610969543457
Time for backpropagation: 0.004904985427856445
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8538985252380371 seconds
Index: 18
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.553221702575684 seconds
Streaming imagenet data took 7.674704313278198 seconds
Then, training+dataloading take 7.6880247592926025 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5362088680267334
Time for copying to cuda: 0.049463748931884766
Time for forward pass: 0.09520077705383301
Time for backpropagation: 0.004721164703369141
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6734.0)
One training iteration takes: 0.8072481155395508 seconds
Index: 19
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.273332595825195 seconds
Memory occpied: (6978.0, 6734.0)
Streaming imagenet data took 8.34570050239563 seconds
Then, training+dataloading take 8.360997200012207 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4874420166015625
Time for copying to cuda: 0.050202369689941406
Time for forward pass: 0.09521985054016113
Time for backpropagation: 0.004963874816894531
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7327306270599365 seconds
Index: 20
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.816572427749634 seconds
Streaming imagenet data took 7.8893537521362305 seconds
Then, training+dataloading take 7.903618097305298 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4839510917663574
Time for copying to cuda: 0.0988311767578125
Memory occpied: (6978.0, 6734.0)
Time for forward pass: 0.0954742431640625
Time for backpropagation: 0.004680633544921875
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7777535915374756 seconds
Index: 21
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.663662910461426 seconds
Streaming imagenet data took 7.737627744674683 seconds
Then, training+dataloading take 7.752579212188721 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5334045886993408
Time for copying to cuda: 0.05001020431518555
Time for forward pass: 0.09511828422546387
Time for backpropagation: 0.004705190658569336
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8301825523376465 seconds
Index: 22
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.7159953117370605 seconds
Streaming imagenet data took 7.789712190628052 seconds
Then, training+dataloading take 7.80502724647522 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5319333076477051
Time for copying to cuda: 0.04998636245727539
Time for forward pass: 0.09618711471557617
Time for backpropagation: 0.004651784896850586
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8363635540008545 seconds
Index: 23
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.601698398590088 seconds
Streaming imagenet data took 8.676825761795044 seconds
Then, training+dataloading take 8.691782236099243 seconds

Epoch: 0
Time of next(dataloader) is: 0.48824214935302734
Time for copying to cuda: 0.0494229793548584
Time for forward pass: 0.09520840644836426
Time for backpropagation: 0.004729270935058594
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6734.0)
The whole process took 205.66967105865479 seconds
