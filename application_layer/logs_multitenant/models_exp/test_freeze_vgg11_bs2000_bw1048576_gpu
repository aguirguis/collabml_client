Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 907.8994289513558 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 25
Intermediate:  31.25
62.63671875
Total layers size  62.687408447265625
Fixed, scale_with_bsz  506.8334045410156 63.2109375
Mem usage  1250.0 3.0
Using split index: 25
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.317612409591675 seconds
Streaming imagenet data took 11.330636739730835 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3366270065307617
Time for copying to cuda: 0.009199142456054688
Memory occpied: (1794.0, 172.0)
Memory occpied: (1794.0, 608.0)
Memory occpied: (1794.0, 1042.0)
Time for forward pass: 3.473446846008301
Time for backpropagation: 0.052802085876464844
GPU memory for training: 2.0762829780578613                          

One training iteration takes: 3.973365545272827 seconds
Index: 0
Memory occpied: (3020.0, 1846.0)
Memory occpied: (3020.0, 1846.0)
Memory occpied: (3020.0, 1846.0)
Memory occpied: (3020.0, 1846.0)
Memory occpied: (3020.0, 1846.0)
Memory occpied: (3020.0, 1846.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.304584264755249 seconds
Streaming imagenet data took 11.317244052886963 seconds
Then, training+dataloading take 11.318403244018555 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4709196090698242
Time for copying to cuda: 0.00874471664428711
Memory occpied: (3020.0, 1854.0)
Time for forward pass: 0.09730124473571777
Time for backpropagation: 0.003815889358520508
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6842083930969238 seconds
Index: 1
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.383304834365845 seconds
Streaming imagenet data took 11.396444320678711 seconds
Then, training+dataloading take 11.39756464958191 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47301578521728516
Time for copying to cuda: 0.008617401123046875
Time for forward pass: 0.09693646430969238
Time for backpropagation: 0.003284931182861328
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.7198460102081299 seconds
Index: 2
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.13843059539795 seconds
Streaming imagenet data took 9.15155029296875 seconds
Then, training+dataloading take 9.152445793151855 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4714622497558594
Time for copying to cuda: 0.008538484573364258
Time for forward pass: 0.09696316719055176
Time for backpropagation: 0.003167390823364258
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.7194311618804932 seconds
Index: 3
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.495750188827515 seconds
Streaming imagenet data took 11.504430294036865 seconds
Then, training+dataloading take 11.505618810653687 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4970736503601074
Time for copying to cuda: 0.008672475814819336
Memory occpied: (3422.0, 1854.0)
Time for forward pass: 0.09717798233032227
Time for backpropagation: 0.003213167190551758
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.7045552730560303 seconds
Index: 4
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.526113510131836 seconds
Streaming imagenet data took 11.540207624435425 seconds
Then, training+dataloading take 11.54195523262024 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (3422.0, 1854.0)
Time of next(dataloader) is: 0.4412236213684082
Time for copying to cuda: 0.008561849594116211
Time for forward pass: 0.09694933891296387
Time for backpropagation: 0.0032701492309570312
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6376433372497559 seconds
Index: 5
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.339860200881958 seconds
Memory occpied: (3422.0, 1854.0)
Streaming imagenet data took 11.348702907562256 seconds
Then, training+dataloading take 11.349907159805298 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39351892471313477
Time for copying to cuda: 0.008671045303344727
Time for forward pass: 0.09698939323425293
Time for backpropagation: 0.0032820701599121094
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.5914738178253174 seconds
Index: 6
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.245390176773071 seconds
Streaming imagenet data took 9.258573293685913 seconds
Then, training+dataloading take 9.25946593284607 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4269270896911621
Time for copying to cuda: 0.008817672729492188
Time for forward pass: 0.10964751243591309
Time for backpropagation: 0.003725767135620117
GPU memory for training: 2.2318387031555176                          

Memory occpied: (3422.0, 1854.0)
One training iteration takes: 0.6474564075469971 seconds
Index: 7
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.231201648712158 seconds
Streaming imagenet data took 11.239691019058228 seconds
Then, training+dataloading take 11.240938901901245 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45599889755249023
Time for copying to cuda: 0.008779287338256836
Time for forward pass: 0.11369180679321289
Time for backpropagation: 0.003780364990234375
GPU memory for training: 2.2318387031555176                          

Memory occpied: (3422.0, 1854.0)
One training iteration takes: 0.6824221611022949 seconds
Index: 8
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.597813129425049 seconds
Streaming imagenet data took 11.61138391494751 seconds
Then, training+dataloading take 11.612325668334961 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45702195167541504
Time for copying to cuda: 0.008635282516479492
Time for forward pass: 0.10222482681274414
Time for backpropagation: 0.003277301788330078
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6913661956787109 seconds
Index: 9
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.179558992385864 seconds
Streaming imagenet data took 11.188261270523071 seconds
Then, training+dataloading take 11.189480543136597 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3938605785369873
Time for copying to cuda: 0.008443832397460938
Time for forward pass: 0.09801268577575684
Time for backpropagation: 0.0038204193115234375
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6010141372680664 seconds
Index: 10
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.362938165664673 seconds
Streaming imagenet data took 9.376157760620117 seconds
Then, training+dataloading take 9.377063512802124 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (3422.0, 1854.0)
Time of next(dataloader) is: 0.393383264541626
Time for copying to cuda: 0.008544683456420898
Time for forward pass: 0.0969400405883789
Time for backpropagation: 0.0032587051391601562
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.5937404632568359 seconds
Index: 11
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.516467809677124 seconds
Streaming imagenet data took 11.52494740486145 seconds
Then, training+dataloading take 11.526143789291382 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4186081886291504
Time for copying to cuda: 0.010295867919921875
Time for forward pass: 0.10866212844848633
Time for backpropagation: 0.003236055374145508
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6481454372406006 seconds
Index: 12
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.326013565063477 seconds
Streaming imagenet data took 11.339242458343506 seconds
Then, training+dataloading take 11.34012246131897 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4279482364654541
Time for copying to cuda: 0.008803606033325195
Time for forward pass: 0.09972143173217773
Time for backpropagation: 0.0037915706634521484
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.657306432723999 seconds
Index: 13
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.271435737609863 seconds
Streaming imagenet data took 11.279918909072876 seconds
Then, training+dataloading take 11.281118154525757 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40351080894470215
Time for copying to cuda: 0.008668184280395508
Time for forward pass: 0.11008024215698242
Time for backpropagation: 0.0037572383880615234
GPU memory for training: 2.2318387031555176                          

Memory occpied: (3422.0, 1854.0)
One training iteration takes: 0.6249933242797852 seconds
Index: 14
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.308473825454712 seconds
Streaming imagenet data took 9.32165002822876 seconds
Then, training+dataloading take 9.323277235031128 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43029093742370605
Time for copying to cuda: 0.008587360382080078
Time for forward pass: 0.09695076942443848
Time for backpropagation: 0.003296375274658203
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6290068626403809 seconds
Index: 15
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.310611724853516 seconds
Streaming imagenet data took 11.31929612159729 seconds
Then, training+dataloading take 11.320496082305908 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43311071395874023
Time for copying to cuda: 0.008655309677124023
Time for forward pass: 0.09677410125732422
Time for backpropagation: 0.0032663345336914062
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.635556697845459 seconds
Index: 16
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.533356666564941 seconds
Streaming imagenet data took 11.546677350997925 seconds
Then, training+dataloading take 11.547621726989746 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44623613357543945
Time for copying to cuda: 0.00872945785522461
Time for forward pass: 0.09702825546264648
Time for backpropagation: 0.0032646656036376953
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.681847333908081 seconds
Index: 17
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.351320743560791 seconds
Streaming imagenet data took 11.360019207000732 seconds
Then, training+dataloading take 11.361202955245972 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4618556499481201
Time for copying to cuda: 0.00857090950012207
Time for forward pass: 0.09692716598510742
Time for backpropagation: 0.0032720565795898438
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.7056732177734375 seconds
Index: 18
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.385684251785278 seconds
Streaming imagenet data took 9.399340152740479 seconds
Then, training+dataloading take 9.400429725646973 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Time of next(dataloader) is: 0.39263463020324707
Time for copying to cuda: 0.008464574813842773
Time for forward pass: 0.09689497947692871
Time for backpropagation: 0.0032482147216796875
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.600316047668457 seconds
Index: 19
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.395010232925415 seconds
Streaming imagenet data took 11.403500318527222 seconds
Then, training+dataloading take 11.404704093933105 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42221856117248535
Time for copying to cuda: 0.008682727813720703
Time for forward pass: 0.09697842597961426
Time for backpropagation: 0.0033609867095947266
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6198046207427979 seconds
Index: 20
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.540004968643188 seconds
Streaming imagenet data took 11.55329179763794 seconds
Then, training+dataloading take 11.55424427986145 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4403204917907715
Time for copying to cuda: 0.05160689353942871
Memory occpied: (3422.0, 1854.0)
Time for forward pass: 0.09713435173034668
Time for backpropagation: 0.0032477378845214844
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6969709396362305 seconds
Index: 21
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.33832311630249 seconds
Streaming imagenet data took 11.346923828125 seconds
Then, training+dataloading take 11.348143339157104 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4367034435272217
Time for copying to cuda: 0.008532285690307617
Time for forward pass: 0.09704899787902832
Time for backpropagation: 0.0036344528198242188
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6923933029174805 seconds
Index: 22
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.327821254730225 seconds
Streaming imagenet data took 9.384607791900635 seconds
Then, training+dataloading take 9.39173436164856 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (3422.0, 1854.0)
Time of next(dataloader) is: 0.42803049087524414
Time for copying to cuda: 0.008585691452026367
Time for forward pass: 0.09691524505615234
Time for backpropagation: 0.003263235092163086
GPU memory for training: 2.2318387031555176                          

One training iteration takes: 0.6557807922363281 seconds
Index: 23
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Memory occpied: (3422.0, 1854.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.585171222686768 seconds
Streaming imagenet data took 11.593971967697144 seconds
Then, training+dataloading take 11.595344543457031 seconds

Epoch: 0
Time of next(dataloader) is: 0.3941659927368164
Time for copying to cuda: 0.008579254150390625
Time for forward pass: 0.0969228744506836
Time for backpropagation: 0.0032367706298828125
GPU memory for training: 2.2318387031555176                          

The whole process took 281.12985849380493 seconds
