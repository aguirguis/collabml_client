Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.7046335574234 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 17
Intermediate:  31.25
4.123046875
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.697265625
Mem usage  1250.0 3.0
Using split index: 16
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.029030561447144 seconds
Streaming imagenet data took 9.041762113571167 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3525853157043457
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.11596369743347168
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.44521450996398926
One training iteration takes: 0.9810223579406738 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.82323145866394 seconds
Streaming imagenet data took 8.836041688919067 seconds
Then, training+dataloading take 8.837202787399292 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39025282859802246
Time for copying to cuda: 1.3828277587890625e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.28765153884887695
Time for backpropagation: 0.2389240264892578
One training iteration takes: 1.0666999816894531 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.944306373596191 seconds
Streaming imagenet data took 9.015836477279663 seconds
Then, training+dataloading take 9.022319793701172 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4297492504119873
Time for copying to cuda: 1.2159347534179688e-05
Time for forward pass: 0.1323225498199463
Time for backpropagation: 0.2256176471710205
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.8995609283447266 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.820634603500366 seconds
Streaming imagenet data took 8.828670740127563 seconds
Then, training+dataloading take 8.830736875534058 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3778836727142334
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.3499791622161865
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.28676438331604004
One training iteration takes: 1.1246638298034668 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.760695219039917 seconds
Streaming imagenet data took 8.774117469787598 seconds
Then, training+dataloading take 8.775116443634033 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40488767623901367
Time for copying to cuda: 1.4543533325195312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.32963991165161133
Time for backpropagation: 0.30073118209838867
One training iteration takes: 1.1456024646759033 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.971978425979614 seconds
Streaming imagenet data took 8.98026180267334 seconds
Then, training+dataloading take 8.982239484786987 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4260830879211426
Time for copying to cuda: 1.3828277587890625e-05
Time for forward pass: 0.1517167091369629
Time for backpropagation: 0.2771413326263428
One training iteration takes: 1.0120446681976318 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.285483837127686 seconds
Streaming imagenet data took 9.299058437347412 seconds
Then, training+dataloading take 9.300067663192749 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5017592906951904
Time for copying to cuda: 1.1682510375976562e-05
Time for forward pass: 0.16618728637695312
Time for backpropagation: 0.25259828567504883
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.0405833721160889 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.221275568008423 seconds
Streaming imagenet data took 9.229392528533936 seconds
Then, training+dataloading take 9.230652332305908 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41518306732177734
Time for copying to cuda: 1.1444091796875e-05
Time for forward pass: 0.1770615577697754
Time for backpropagation: 0.26587605476379395
One training iteration takes: 1.0059261322021484 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.742660522460938 seconds
Streaming imagenet data took 8.75598669052124 seconds
Then, training+dataloading take 8.756964921951294 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3885478973388672
Time for copying to cuda: 1.3589859008789062e-05
Time for forward pass: 0.1663374900817871
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.5376958847045898
One training iteration takes: 1.2269353866577148 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.093953847885132 seconds
Streaming imagenet data took 9.102356195449829 seconds
Then, training+dataloading take 9.104295253753662 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40990233421325684
Time for copying to cuda: 1.0967254638671875e-05
Time for forward pass: 0.1542665958404541
Time for backpropagation: 0.26259613037109375
One training iteration takes: 0.9908905029296875 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.968287229537964 seconds
Streaming imagenet data took 8.98154592514038 seconds
Then, training+dataloading take 8.98250699043274 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39351367950439453
Time for copying to cuda: 1.0967254638671875e-05
Time for forward pass: 0.34566187858581543
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2996797561645508
One training iteration takes: 1.1926958560943604 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.803116798400879 seconds
Streaming imagenet data took 8.811976909637451 seconds
Then, training+dataloading take 8.813508987426758 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3790411949157715
Time for copying to cuda: 1.4066696166992188e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.28157877922058105
Time for backpropagation: 0.23691940307617188
One training iteration takes: 1.021653652191162 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.777374744415283 seconds
Streaming imagenet data took 8.79063868522644 seconds
Then, training+dataloading take 8.791699886322021 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42089056968688965
Time for copying to cuda: 1.1205673217773438e-05
Time for forward pass: 0.16466140747070312
Time for backpropagation: 0.246002197265625
One training iteration takes: 0.9951574802398682 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.983935832977295 seconds
Streaming imagenet data took 8.992015838623047 seconds
Then, training+dataloading take 8.993974447250366 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3655703067779541
Time for copying to cuda: 1.1205673217773438e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.27434730529785156
Time for backpropagation: 0.2657961845397949
One training iteration takes: 1.0877466201782227 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.321665287017822 seconds
Streaming imagenet data took 9.334967613220215 seconds
Then, training+dataloading take 9.336668252944946 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37334346771240234
Time for copying to cuda: 1.1920928955078125e-05
Time for forward pass: 0.1508641242980957
Time for backpropagation: 0.2881793975830078
One training iteration takes: 0.9498772621154785 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.789331674575806 seconds
Streaming imagenet data took 8.7974214553833 seconds
Then, training+dataloading take 8.798648595809937 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3647134304046631
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.14324235916137695
Time for backpropagation: 0.30753421783447266
One training iteration takes: 0.9436430931091309 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.148557662963867 seconds
Streaming imagenet data took 9.16161561012268 seconds
Then, training+dataloading take 9.162547826766968 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43316125869750977
Time for copying to cuda: 1.1444091796875e-05
Time for forward pass: 0.16460585594177246
Time for backpropagation: 0.26338648796081543
One training iteration takes: 1.00433349609375 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.731688737869263 seconds
Streaming imagenet data took 8.739773511886597 seconds
Then, training+dataloading take 8.741040468215942 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.382831335067749
Time for copying to cuda: 1.1205673217773438e-05
Time for forward pass: 0.16503095626831055
Time for backpropagation: 0.2869076728820801
One training iteration takes: 0.958885669708252 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.455413818359375 seconds
Streaming imagenet data took 9.468708992004395 seconds
Then, training+dataloading take 9.47235894203186 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4174184799194336
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.1651008129119873
Time for backpropagation: 0.29487013816833496
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.9860665798187256 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.003815412521362 seconds
Streaming imagenet data took 9.0118088722229 seconds
Then, training+dataloading take 9.013785362243652 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39940357208251953
Time for copying to cuda: 1.4543533325195312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.30795788764953613
Time for backpropagation: 0.29172778129577637
One training iteration takes: 1.1150896549224854 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.723627805709839 seconds
Streaming imagenet data took 8.737359285354614 seconds
Then, training+dataloading take 8.738326787948608 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43302226066589355
Time for copying to cuda: 1.1205673217773438e-05
Time for forward pass: 0.1527843475341797
Time for backpropagation: 0.26424098014831543
One training iteration takes: 1.0126972198486328 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.670963525772095 seconds
Streaming imagenet data took 8.679097890853882 seconds
Then, training+dataloading take 8.680325508117676 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3754761219024658
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.16392207145690918
Time for backpropagation: 0.30106186866760254
One training iteration takes: 0.9679520130157471 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.007308959960938 seconds
Streaming imagenet data took 9.020460844039917 seconds
Then, training+dataloading take 9.021383285522461 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38876914978027344
Time for copying to cuda: 1.2159347534179688e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.23436284065246582
Time for backpropagation: 0.2353665828704834
One training iteration takes: 0.991213321685791 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.178613901138306 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 9.186645746231079 seconds
Then, training+dataloading take 9.188071966171265 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38568615913391113
Time for copying to cuda: 1.1444091796875e-05
Time for forward pass: 0.1656665802001953
Time for backpropagation: 0.2206132411956787
One training iteration takes: 0.9127521514892578 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.353596448898315 seconds
Streaming imagenet data took 9.367134094238281 seconds
Then, training+dataloading take 9.368204355239868 seconds

Epoch: 0
Time of next(dataloader) is: 0.4149906635284424
Time for copying to cuda: 1.1444091796875e-05
Time for forward pass: 0.16603446006774902
Time for backpropagation: 0.2558329105377197
Memory occpied: (1250.0, 3.0)
The whole process took 233.37148308753967 seconds
