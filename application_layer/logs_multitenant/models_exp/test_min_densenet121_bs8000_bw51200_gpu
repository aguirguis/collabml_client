Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 44.4091020235437 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([], dtype=int64),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 20
Intermediate:  765.625
29.380859375
Total layers size  29.767486572265625
Fixed, scale_with_bsz  30.436920166015625 29.955078125
Mem usage  1250.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 147.0125241279602 seconds
Memory occpied: (1294.0, 3.0)
Streaming imagenet data took 147.35443305969238 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8676350116729736
Memory occpied: (2060.0, 3.0)
Time for copying to cuda: 0.23670125007629395
Memory occpied: (2060.0, 862.0)
Memory occpied: (2060.0, 1328.0)
Memory occpied: (7582.0, 7192.0)
Memory occpied: (12908.0, 12808.0)
Memory occpied: (14070.0, 13390.0)
Memory occpied: (14650.0, 13970.0)
Time for forward pass: 8.533536195755005
Time for backpropagation: 0.13166570663452148
GPU memory for training: 18.65279531478882                          

Memory occpied: (14682.0, 6360.0)
One training iteration takes: 9.947163581848145 seconds
Index: 0
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Memory occpied: (14682.0, 6360.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 145.28681468963623 seconds
Streaming imagenet data took 145.63315510749817 seconds
Then, training+dataloading take 145.67355918884277 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0283608436584473
Time for copying to cuda: 0.19992446899414062
Time for forward pass: 0.8172695636749268
Time for backpropagation: 0.012360811233520508
GPU memory for training: 6.8218512535095215                          

Memory occpied: (14682.0, 6360.0)
One training iteration takes: 2.2500569820404053 seconds
Index: 1
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 153.4642734527588 seconds
Streaming imagenet data took 153.75372552871704 seconds
Then, training+dataloading take 153.79889154434204 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (14698.0, 6376.0)
Time of next(dataloader) is: 1.0371942520141602
Time for copying to cuda: 0.19875764846801758
Memory occpied: (14698.0, 6376.0)
Time for forward pass: 0.7825429439544678
Time for backpropagation: 0.011725902557373047
GPU memory for training: 6.8218512535095215                          

Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
One training iteration takes: 7.140935659408569 seconds
Index: 2
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 150.17268300056458 seconds
Streaming imagenet data took 150.46977162361145 seconds
Then, training+dataloading take 150.51327800750732 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0947036743164062
Time for copying to cuda: 0.1981358528137207
Time for forward pass: 0.7816243171691895
Time for backpropagation: 0.011841535568237305
GPU memory for training: 6.8218512535095215                          

Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
One training iteration takes: 7.194918632507324 seconds
Index: 3
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 150.7978744506836 seconds
Streaming imagenet data took 151.14893054962158 seconds
Then, training+dataloading take 151.19521570205688 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (14698.0, 6376.0)
Time of next(dataloader) is: 1.0197422504425049
Time for copying to cuda: 0.19936585426330566
Memory occpied: (14698.0, 6376.0)
Time for forward pass: 0.788804292678833
Time for backpropagation: 0.012149572372436523
GPU memory for training: 6.8218512535095215                          

One training iteration takes: 2.2238259315490723 seconds
Index: 4
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 152.50026679039001 seconds
Memory occpied: (14698.0, 6376.0)
Streaming imagenet data took 152.9203016757965 seconds
Then, training+dataloading take 152.96706318855286 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9324417114257812
Memory occpied: (14698.0, 6376.0)
Time for copying to cuda: 0.2508676052093506
Time for forward pass: 0.8053054809570312
Time for backpropagation: 0.012220144271850586
GPU memory for training: 6.8218512535095215                          

One training iteration takes: 2.180765390396118 seconds
Index: 5
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Memory occpied: (14698.0, 6376.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 43.06108045578003 seconds
Streaming imagenet data took 43.18884992599487 seconds
Then, training+dataloading take 43.2019944190979 seconds

Epoch: 0
Time of next(dataloader) is: 0.6065900325775146
Time for copying to cuda: 0.05164599418640137
Time for forward pass: 1.5066800117492676
Time for backpropagation: 0.0370023250579834
GPU memory for training: 6.105504512786865                          

Memory occpied: (14698.0, 6376.0)
The whole process took 954.2156341075897 seconds
