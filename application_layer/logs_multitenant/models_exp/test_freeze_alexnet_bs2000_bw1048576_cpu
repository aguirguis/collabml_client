Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.6789102630873 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 17
Intermediate:  31.25
4.138671875
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.712890625
Mem usage  1250.0 3.0
Using split index: 17
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.812039375305176 seconds
Streaming imagenet data took 8.824652671813965 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35380077362060547
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.11317205429077148
Time for backpropagation: 0.17368841171264648
One training iteration takes: 0.7292144298553467 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.82250189781189 seconds
Streaming imagenet data took 8.835679531097412 seconds
Then, training+dataloading take 8.837486982345581 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37069010734558105
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.35988879203796387
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.23102235794067383
One training iteration takes: 1.0884220600128174 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.60206913948059 seconds
Streaming imagenet data took 8.615211963653564 seconds
Then, training+dataloading take 8.616193294525146 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3763105869293213
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3969581127166748
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.25667881965637207
One training iteration takes: 1.1586227416992188 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.948834657669067 seconds
Streaming imagenet data took 8.957332849502563 seconds
Then, training+dataloading take 8.9585702419281 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4624953269958496
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.1781015396118164
Time for backpropagation: 0.23215293884277344
One training iteration takes: 1.0455148220062256 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.789933204650879 seconds
Streaming imagenet data took 8.803268432617188 seconds
Then, training+dataloading take 8.804216623306274 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43372082710266113
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.17151594161987305
Time for backpropagation: 0.2984778881072998
One training iteration takes: 1.0772247314453125 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.877711534500122 seconds
Streaming imagenet data took 8.886163234710693 seconds
Then, training+dataloading take 8.888089656829834 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4258999824523926
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.17565584182739258
Time for backpropagation: 0.2765481472015381
One training iteration takes: 1.026092290878296 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.241873502731323 seconds
Streaming imagenet data took 9.255293369293213 seconds
Then, training+dataloading take 9.257035732269287 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4264554977416992
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.16234612464904785
Time for backpropagation: 0.2967092990875244
One training iteration takes: 1.034261703491211 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.058423042297363 seconds
Streaming imagenet data took 9.067039728164673 seconds
Then, training+dataloading take 9.06830382347107 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38150906562805176
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.31339263916015625
Time for backpropagation: 0.2357954978942871
One training iteration takes: 1.103571891784668 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.773826599121094 seconds
Streaming imagenet data took 8.78689980506897 seconds
Then, training+dataloading take 8.78787612915039 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4371325969696045
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.1880483627319336
Time for backpropagation: 0.3036487102508545
One training iteration takes: 1.103999376296997 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.094735622406006 seconds
Streaming imagenet data took 9.103378295898438 seconds
Then, training+dataloading take 9.10539698600769 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3915214538574219
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.37848854064941406
Time for backpropagation: 0.39580559730529785
One training iteration takes: 1.2928569316864014 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.007346868515015 seconds
Streaming imagenet data took 9.020913124084473 seconds
Then, training+dataloading take 9.021918773651123 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45122385025024414
Time for copying to cuda: 9.059906005859375e-06
Time for forward pass: 0.16358137130737305
Time for backpropagation: 0.2868180274963379
One training iteration takes: 1.0492925643920898 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.040112972259521 seconds
Streaming imagenet data took 9.048590183258057 seconds
Then, training+dataloading take 9.049816608428955 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.380718469619751
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.3918156623840332
Time for backpropagation: 0.26528167724609375
One training iteration takes: 1.145596981048584 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.071372985839844 seconds
Streaming imagenet data took 9.08456301689148 seconds
Then, training+dataloading take 9.085484266281128 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5131440162658691
Time for copying to cuda: 8.344650268554688e-06
Time for forward pass: 0.1580967903137207
Time for backpropagation: 0.2765674591064453
One training iteration takes: 1.0557959079742432 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.669832944869995 seconds
Streaming imagenet data took 8.67831015586853 seconds
Then, training+dataloading take 8.679563522338867 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4707643985748291
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.23336029052734375
Time for backpropagation: 0.2409961223602295
One training iteration takes: 1.092729091644287 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.019968748092651 seconds
Streaming imagenet data took 9.033141374588013 seconds
Then, training+dataloading take 9.03410291671753 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3799169063568115
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.14937448501586914
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.47746849060058594
One training iteration takes: 1.1145823001861572 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.004112958908081 seconds
Streaming imagenet data took 9.012596368789673 seconds
Then, training+dataloading take 9.013859272003174 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4412417411804199
Time for copying to cuda: 9.5367431640625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.15320992469787598
Time for backpropagation: 0.2873053550720215
One training iteration takes: 1.008601427078247 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.174812316894531 seconds
Streaming imagenet data took 9.187617778778076 seconds
Then, training+dataloading take 9.188556671142578 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39080810546875
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.1515674591064453
Time for backpropagation: 0.3040344715118408
One training iteration takes: 0.9667296409606934 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.123762369155884 seconds
Streaming imagenet data took 9.132428169250488 seconds
Then, training+dataloading take 9.134385824203491 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.419879674911499
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.43627429008483887
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2972066402435303
One training iteration takes: 1.2688829898834229 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.543040990829468 seconds
Streaming imagenet data took 8.55656385421753 seconds
Then, training+dataloading take 8.557571172714233 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40635108947753906
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.16199445724487305
Time for backpropagation: 0.45766162872314453
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.1469993591308594 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.300413131713867 seconds
Streaming imagenet data took 9.309051036834717 seconds
Then, training+dataloading take 9.310328483581543 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4441041946411133
Time for copying to cuda: 1.049041748046875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.1834120750427246
Time for backpropagation: 0.30191636085510254
One training iteration takes: 1.050046682357788 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.785338878631592 seconds
Streaming imagenet data took 8.798904657363892 seconds
Then, training+dataloading take 8.799880027770996 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45053935050964355
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.16359996795654297
Time for backpropagation: 0.28935670852661133
One training iteration takes: 1.0603036880493164 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.588397026062012 seconds
Streaming imagenet data took 8.601116418838501 seconds
Then, training+dataloading take 8.602096796035767 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3841893672943115
Time for copying to cuda: 8.344650268554688e-06
Time for forward pass: 0.16225814819335938
Time for backpropagation: 0.2877655029296875
One training iteration takes: 0.9800503253936768 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.739485025405884 seconds
Streaming imagenet data took 8.748101234436035 seconds
Then, training+dataloading take 8.749488830566406 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3884141445159912
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.18508577346801758
Time for backpropagation: 0.3407866954803467
One training iteration takes: 1.061269760131836 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.19885802268982 seconds
Streaming imagenet data took 9.21193242073059 seconds
Then, training+dataloading take 9.212899923324585 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4293508529663086
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.16529536247253418
Time for backpropagation: 0.2586076259613037
One training iteration takes: 1.0147244930267334 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.742687940597534 seconds
Streaming imagenet data took 8.751150608062744 seconds
Then, training+dataloading take 8.752400636672974 seconds

Epoch: 0
Time of next(dataloader) is: 0.38404226303100586
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.1626896858215332
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.5822815895080566
The whole process took 231.74671697616577 seconds
