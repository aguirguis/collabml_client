Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.7165867804713 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 11
Intermediate:  1148.4375
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.243229627609253 seconds
Streaming imagenet data took 8.357780933380127 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Time of next(dataloader) is: 0.49948740005493164
Time for copying to cuda: 0.0502467155456543
Memory occpied: (1504.0, 490.0)
Memory occpied: (1504.0, 894.0)
Memory occpied: (1504.0, 1338.0)
Time for forward pass: 4.34211277961731
Memory occpied: (12296.0, 12204.0)
Memory occpied: (6958.0, 6718.0)
Time for backpropagation: 1.5311439037322998
GPU memory for training: 11.528353214263916                          

One training iteration takes: 6.519763231277466 seconds
Index: 0
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.38382625579834 seconds
Streaming imagenet data took 7.505677223205566 seconds
Then, training+dataloading take 7.516209363937378 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5876832008361816
Time for copying to cuda: 0.050151824951171875
Time for forward pass: 0.09524655342102051
Time for backpropagation: 0.0047380924224853516
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6962.0, 6718.0)
One training iteration takes: 0.8589787483215332 seconds
Index: 1
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.709799528121948 seconds
Streaming imagenet data took 7.782441854476929 seconds
Then, training+dataloading take 7.795642375946045 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5890476703643799
Time for copying to cuda: 0.05031299591064453
Time for forward pass: 0.09519410133361816
Time for backpropagation: 0.004655361175537109
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.890007495880127 seconds
Index: 2
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.470407485961914 seconds
Streaming imagenet data took 7.5427045822143555 seconds
Then, training+dataloading take 7.556237697601318 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5157852172851562
Time for copying to cuda: 0.05129075050354004
Time for forward pass: 0.14031028747558594
Time for backpropagation: 0.005691051483154297
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8553850650787354 seconds
Index: 3
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.262267827987671 seconds
Streaming imagenet data took 8.387173652648926 seconds
Then, training+dataloading take 8.402870178222656 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Time of next(dataloader) is: 0.5041260719299316
Time for copying to cuda: 0.04987072944641113
Time for forward pass: 0.09856748580932617
Time for backpropagation: 0.004996299743652344
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.795140266418457 seconds
Index: 4
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.654715299606323 seconds
Streaming imagenet data took 7.726609230041504 seconds
Then, training+dataloading take 7.744889736175537 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5160715579986572
Time for copying to cuda: 0.04980587959289551
Time for forward pass: 0.09511733055114746
Time for backpropagation: 0.0045583248138427734
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7709829807281494 seconds
Index: 5
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.60736083984375 seconds
Streaming imagenet data took 7.679392337799072 seconds
Then, training+dataloading take 7.689922332763672 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5369710922241211
Time for copying to cuda: 0.09571051597595215
Time for forward pass: 0.1028590202331543
Time for backpropagation: 0.005380153656005859
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8407034873962402 seconds
Index: 6
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.700660467147827 seconds
Streaming imagenet data took 7.772016286849976 seconds
Then, training+dataloading take 7.784233808517456 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5449891090393066
Time for copying to cuda: 0.04984736442565918
Time for forward pass: 0.09539437294006348
Time for backpropagation: 0.006655216217041016
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8402462005615234 seconds
Index: 7
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.594722986221313 seconds
Streaming imagenet data took 8.66749906539917 seconds
Then, training+dataloading take 8.68177342414856 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.541907787322998
Time for copying to cuda: 0.04965782165527344
Time for forward pass: 0.11874079704284668
Time for backpropagation: 0.005411624908447266
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8411312103271484 seconds
Index: 8
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.770911931991577 seconds
Streaming imagenet data took 7.842303276062012 seconds
Then, training+dataloading take 7.853045225143433 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5979790687561035
Time for copying to cuda: 0.05002164840698242
Time for forward pass: 0.09526610374450684
Time for backpropagation: 0.004654645919799805
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.9042046070098877 seconds
Index: 9
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.758910417556763 seconds
Streaming imagenet data took 7.831843852996826 seconds
Then, training+dataloading take 7.844273090362549 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.532721996307373
Time for copying to cuda: 0.09612512588500977
Memory occpied: (6978.0, 6734.0)
Time for forward pass: 0.09544849395751953
Time for backpropagation: 0.004612922668457031
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8257594108581543 seconds
Index: 10
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.607732772827148 seconds
Streaming imagenet data took 7.683598279953003 seconds
Then, training+dataloading take 7.698962688446045 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6734.0)
Time of next(dataloader) is: 0.5598726272583008
Time for copying to cuda: 0.05065560340881348
Time for forward pass: 0.09519314765930176
Time for backpropagation: 0.004992961883544922
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8276510238647461 seconds
Index: 11
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.291890621185303 seconds
Streaming imagenet data took 8.363101243972778 seconds
Then, training+dataloading take 8.377432584762573 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5033156871795654
Time for copying to cuda: 0.04970717430114746
Time for forward pass: 0.11112213134765625
Time for backpropagation: 0.0054209232330322266
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8133125305175781 seconds
Index: 12
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.846560955047607 seconds
Streaming imagenet data took 7.920388460159302 seconds
Then, training+dataloading take 7.935050010681152 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6734.0)
Time of next(dataloader) is: 0.5601816177368164
Time for copying to cuda: 0.04972219467163086
Time for forward pass: 0.09524941444396973
Time for backpropagation: 0.004781007766723633
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8105361461639404 seconds
Index: 13
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.5521838665008545 seconds
Streaming imagenet data took 7.6243956089019775 seconds
Then, training+dataloading take 7.6349897384643555 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5623800754547119
Time for copying to cuda: 0.04964447021484375
Time for forward pass: 0.0951998233795166
Time for backpropagation: 0.004647493362426758
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8551220893859863 seconds
Index: 14
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.7556915283203125 seconds
Streaming imagenet data took 7.827783107757568 seconds
Then, training+dataloading take 7.840141773223877 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5658612251281738
Time for copying to cuda: 0.0496366024017334
Time for forward pass: 0.09520792961120605
Time for backpropagation: 0.004637479782104492
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8491103649139404 seconds
Index: 15
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.294183254241943 seconds
Streaming imagenet data took 8.41402816772461 seconds
Then, training+dataloading take 8.430087327957153 seconds
Memory occpied: (6978.0, 6734.0)
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5127511024475098
Time for copying to cuda: 0.04951667785644531
Time for forward pass: 0.09502792358398438
Time for backpropagation: 0.004597663879394531
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.756894588470459 seconds
Index: 16
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.84270167350769 seconds
Streaming imagenet data took 7.915158271789551 seconds
Then, training+dataloading take 7.9252800941467285 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5500330924987793
Time for copying to cuda: 0.049565792083740234
Time for forward pass: 0.10113930702209473
Time for backpropagation: 0.005564451217651367
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6734.0)
One training iteration takes: 0.820958137512207 seconds
Index: 17
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.505418539047241 seconds
Streaming imagenet data took 7.57696270942688 seconds
Then, training+dataloading take 7.589252710342407 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5323033332824707
Time for copying to cuda: 0.09424924850463867
Memory occpied: (6978.0, 6734.0)
Time for forward pass: 0.09550070762634277
Time for backpropagation: 0.0048711299896240234
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.846552848815918 seconds
Index: 18
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.557048559188843 seconds
Streaming imagenet data took 7.630643129348755 seconds
Then, training+dataloading take 7.646188735961914 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6734.0)
Time of next(dataloader) is: 0.5664470195770264
Time for copying to cuda: 0.04979252815246582
Time for forward pass: 0.0952615737915039
Time for backpropagation: 0.004918813705444336
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8177127838134766 seconds
Index: 19
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.171720027923584 seconds
Streaming imagenet data took 8.246241331100464 seconds
Then, training+dataloading take 8.261191129684448 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5265235900878906
Time for copying to cuda: 0.0500032901763916
Time for forward pass: 0.09542655944824219
Time for backpropagation: 0.004983186721801758
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7733893394470215 seconds
Index: 20
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.606283664703369 seconds
Streaming imagenet data took 7.678042888641357 seconds
Then, training+dataloading take 7.692810535430908 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5557270050048828
Time for copying to cuda: 0.04977607727050781
Time for forward pass: 0.0961618423461914
Time for backpropagation: 0.005425453186035156
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6734.0)
One training iteration takes: 0.8040878772735596 seconds
Index: 21
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.840106248855591 seconds
Streaming imagenet data took 7.9113054275512695 seconds
Then, training+dataloading take 7.921297073364258 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6009392738342285
Time for copying to cuda: 0.04985213279724121
Time for forward pass: 0.09520173072814941
Time for backpropagation: 0.004594326019287109
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8785355091094971 seconds
Index: 22
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.689953804016113 seconds
Streaming imagenet data took 7.761944532394409 seconds
Then, training+dataloading take 7.774252653121948 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5021250247955322
Time for copying to cuda: 0.050066471099853516
Time for forward pass: 0.12716412544250488
Memory occpied: (6978.0, 6734.0)
Time for backpropagation: 0.0049304962158203125
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7991688251495361 seconds
Index: 23
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Memory occpied: (6978.0, 6734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.565736770629883 seconds
Streaming imagenet data took 8.642170906066895 seconds
Then, training+dataloading take 8.658101797103882 seconds

Epoch: 0
Time of next(dataloader) is: 0.49164915084838867
Time for copying to cuda: 0.09456396102905273
Time for forward pass: 0.0969095230102539
Time for backpropagation: 0.005501747131347656
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6734.0)
The whole process took 206.41513800621033 seconds
