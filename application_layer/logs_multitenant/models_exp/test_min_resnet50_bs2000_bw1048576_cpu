Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.4932580756724 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 21
Intermediate:  15.625
110.736328125
Total layers size  110.74014282226562
Fixed, scale_with_bsz  97.49234008789062 111.310546875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.101593732833862 seconds
Streaming imagenet data took 10.108992576599121 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37082743644714355
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.017513275146484375
Time for backpropagation: 0.06258630752563477
One training iteration takes: 0.5368881225585938 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.507423162460327 seconds
Streaming imagenet data took 7.514688491821289 seconds
Then, training+dataloading take 7.515596628189087 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33463120460510254
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.0400540828704834
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.318406343460083
One training iteration takes: 0.8143913745880127 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.224653959274292 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 10.23193073272705 seconds
Then, training+dataloading take 10.232750177383423 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33362841606140137
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.036182403564453125
Time for backpropagation: 0.05407118797302246
One training iteration takes: 0.49547243118286133 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.186504602432251 seconds
Streaming imagenet data took 10.194015979766846 seconds
Then, training+dataloading take 10.19490361213684 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.336911678314209
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.03119516372680664
Time for backpropagation: 0.13454580307006836
One training iteration takes: 0.6281561851501465 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.108101844787598 seconds
Streaming imagenet data took 10.15356159210205 seconds
Then, training+dataloading take 10.159355640411377 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4146096706390381
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.026786327362060547
Time for backpropagation: 0.07084250450134277
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.5989809036254883 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.526570796966553 seconds
Streaming imagenet data took 7.531574010848999 seconds
Then, training+dataloading take 7.532500982284546 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.43997979164123535
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.03607320785522461
Time for backpropagation: 0.05684828758239746
One training iteration takes: 0.6039330959320068 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.227790355682373 seconds
Streaming imagenet data took 10.232836484909058 seconds
Then, training+dataloading take 10.233711242675781 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34325480461120605
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.030322551727294922
Time for backpropagation: 0.07882523536682129
One training iteration takes: 0.5443539619445801 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.3274507522583 seconds
Streaming imagenet data took 10.332383632659912 seconds
Then, training+dataloading take 10.333284616470337 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4603757858276367
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.030178546905517578
Time for backpropagation: 0.07553744316101074
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.6549243927001953 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.040857553482056 seconds
Streaming imagenet data took 10.045870304107666 seconds
Then, training+dataloading take 10.04668664932251 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37592387199401855
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.026807308197021484
Time for backpropagation: 0.07683801651000977
One training iteration takes: 0.5890202522277832 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.818536281585693 seconds
Streaming imagenet data took 7.827378273010254 seconds
Then, training+dataloading take 7.830565929412842 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3343322277069092
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.02966022491455078
Time for backpropagation: 0.0692739486694336
One training iteration takes: 0.5267198085784912 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.102850198745728 seconds
Streaming imagenet data took 10.107944965362549 seconds
Then, training+dataloading take 10.108864068984985 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34641575813293457
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.026734590530395508
Time for backpropagation: 0.07584428787231445
One training iteration takes: 0.5200064182281494 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.45436143875122 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 10.459528923034668 seconds
Then, training+dataloading take 10.461106300354004 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.364246129989624
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.026925086975097656
Time for backpropagation: 0.071136474609375
One training iteration takes: 0.5345473289489746 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.298710823059082 seconds
Streaming imagenet data took 10.303663730621338 seconds
Then, training+dataloading take 10.304526567459106 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3664848804473877
Time for copying to cuda: 8.821487426757812e-06
Time for forward pass: 0.030208349227905273
Time for backpropagation: 0.1403210163116455
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.6467962265014648 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.728440999984741 seconds
Streaming imagenet data took 7.737104892730713 seconds
Then, training+dataloading take 7.7380852699279785 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.34190797805786133
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.026779651641845703
Time for backpropagation: 0.07581496238708496
One training iteration takes: 0.5195927619934082 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.373584747314453 seconds
Streaming imagenet data took 10.378743171691895 seconds
Then, training+dataloading take 10.379642963409424 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3705120086669922
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.03599190711975098
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.1335742473602295
One training iteration takes: 0.6125319004058838 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.281628608703613 seconds
Streaming imagenet data took 10.286797523498535 seconds
Then, training+dataloading take 10.287671327590942 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3373754024505615
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.03596758842468262
Time for backpropagation: 0.07116317749023438
One training iteration takes: 0.5176310539245605 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.222715616226196 seconds
Streaming imagenet data took 10.227530241012573 seconds
Then, training+dataloading take 10.228370904922485 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3366873264312744
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.0946197509765625
Time for backpropagation: 0.10632109642028809
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.6247031688690186 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.838275909423828 seconds
Streaming imagenet data took 7.847600936889648 seconds
Then, training+dataloading take 7.851309299468994 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.34714412689208984
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.026757001876831055
Time for backpropagation: 0.07316184043884277
One training iteration takes: 0.5245010852813721 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.209904670715332 seconds
Streaming imagenet data took 10.21511459350586 seconds
Then, training+dataloading take 10.216082096099854 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3374614715576172
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.029604196548461914
Time for backpropagation: 0.06989169120788574
One training iteration takes: 0.50974440574646 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.3850679397583 seconds
Streaming imagenet data took 10.390028238296509 seconds
Then, training+dataloading take 10.391545534133911 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.338181734085083
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.0267183780670166
Time for backpropagation: 0.06327962875366211
One training iteration takes: 0.4989049434661865 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.297283172607422 seconds
Streaming imagenet data took 10.302186012268066 seconds
Then, training+dataloading take 10.303040266036987 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37456607818603516
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.028728485107421875
Time for backpropagation: 0.07260727882385254
One training iteration takes: 0.5905883312225342 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.890870809555054 seconds
Streaming imagenet data took 7.8956708908081055 seconds
Then, training+dataloading take 7.8972015380859375 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33954858779907227
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.026851177215576172
Time for backpropagation: 0.07631921768188477
One training iteration takes: 0.514301061630249 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.904172658920288 seconds
Streaming imagenet data took 10.90919303894043 seconds
Then, training+dataloading take 10.91002368927002 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3763730525970459
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.026925325393676758
Time for backpropagation: 0.07745027542114258
One training iteration takes: 0.5683004856109619 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.54616117477417 seconds
Streaming imagenet data took 10.551111221313477 seconds
Then, training+dataloading take 10.551923990249634 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3812999725341797
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.026983022689819336
Time for backpropagation: 0.07451081275939941
One training iteration takes: 0.6190171241760254 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.455501794815063 seconds
Streaming imagenet data took 10.460601568222046 seconds
Then, training+dataloading take 10.461495399475098 seconds

Epoch: 0
Time of next(dataloader) is: 0.34114885330200195
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.025206327438354492
Time for backpropagation: 0.0772547721862793
The whole process took 249.48569774627686 seconds
