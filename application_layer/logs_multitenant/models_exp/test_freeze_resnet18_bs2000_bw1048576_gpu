Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.5108055981135 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 11
Intermediate:  1148.4375
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.529397964477539 seconds
Streaming imagenet data took 7.601862668991089 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43451857566833496
Time for copying to cuda: 0.04996371269226074
Memory occpied: (1504.0, 288.0)
Memory occpied: (1504.0, 696.0)
Memory occpied: (1504.0, 1146.0)
Memory occpied: (6984.0, 6858.0)
Time for forward pass: 4.286781311035156
Memory occpied: (12296.0, 12170.0)
Time for backpropagation: 1.432283878326416
GPU memory for training: 11.528353214263916                          

One training iteration takes: 6.309253215789795 seconds
Index: 0
Memory occpied: (6962.0, 6834.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.530437707901001 seconds
Streaming imagenet data took 7.603364944458008 seconds
Then, training+dataloading take 7.612958908081055 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5187406539916992
Time for copying to cuda: 0.09364128112792969
Memory occpied: (6962.0, 6850.0)
Time for forward pass: 0.09549641609191895
Time for backpropagation: 0.00469970703125
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8100805282592773 seconds
Index: 1
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.350837469100952 seconds
Streaming imagenet data took 7.424744367599487 seconds
Then, training+dataloading take 7.436772346496582 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4884498119354248
Time for copying to cuda: 0.04950284957885742
Time for forward pass: 0.09671425819396973
Time for backpropagation: 0.0056688785552978516
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.7450976371765137 seconds
Index: 2
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.168585538864136 seconds
Streaming imagenet data took 8.241096258163452 seconds
Then, training+dataloading take 8.25626516342163 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.493419885635376
Time for copying to cuda: 0.04975533485412598
Time for forward pass: 0.09517049789428711
Time for backpropagation: 0.004630565643310547
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7378640174865723 seconds
Index: 3
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.7361741065979 seconds
Streaming imagenet data took 7.807578086853027 seconds
Then, training+dataloading take 7.8174357414245605 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5181155204772949
Time for copying to cuda: 0.05025815963745117
Time for forward pass: 0.09673786163330078
Time for backpropagation: 0.005551338195800781
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.7965128421783447 seconds
Index: 4
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.551434278488159 seconds
Streaming imagenet data took 7.624524354934692 seconds
Then, training+dataloading take 7.635253429412842 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5647454261779785
Memory occpied: (6978.0, 6850.0)
Time for copying to cuda: 0.04941534996032715
Time for forward pass: 0.09518647193908691
Time for backpropagation: 0.0045626163482666016
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8343832492828369 seconds
Index: 5
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.804508686065674 seconds
Streaming imagenet data took 7.925631999969482 seconds
Then, training+dataloading take 7.936659097671509 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.5605826377868652
Time for copying to cuda: 0.04941844940185547
Time for forward pass: 0.09536361694335938
Time for backpropagation: 0.004629611968994141
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8156445026397705 seconds
Index: 6
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.270071983337402 seconds
Streaming imagenet data took 8.342003345489502 seconds
Then, training+dataloading take 8.351947784423828 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5794353485107422
Memory occpied: (6978.0, 6850.0)
Time for copying to cuda: 0.04993438720703125
Time for forward pass: 0.09530258178710938
Time for backpropagation: 0.0047304630279541016
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8342776298522949 seconds
Index: 7
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.979289293289185 seconds
Streaming imagenet data took 8.10054898262024 seconds
Then, training+dataloading take 8.116564273834229 seconds
Memory occpied: (6978.0, 6850.0)
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5030310153961182
Time for copying to cuda: 0.04999494552612305
Time for forward pass: 0.09537076950073242
Time for backpropagation: 0.00464177131652832
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7642643451690674 seconds
Index: 8
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.671661615371704 seconds
Streaming imagenet data took 7.743842124938965 seconds
Then, training+dataloading take 7.758689880371094 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5163025856018066
Time for copying to cuda: 0.050125837326049805
Time for forward pass: 0.1342017650604248
Time for backpropagation: 0.0055694580078125
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.845839262008667 seconds
Index: 9
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.60823917388916 seconds
Streaming imagenet data took 7.681024074554443 seconds
Then, training+dataloading take 7.696252822875977 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4982304573059082
Time for copying to cuda: 0.09178686141967773
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09554386138916016
Time for backpropagation: 0.004700422286987305
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7856290340423584 seconds
Index: 10
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.264987707138062 seconds
Streaming imagenet data took 8.336779117584229 seconds
Then, training+dataloading take 8.352118015289307 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5229265689849854
Time for copying to cuda: 0.04998183250427246
Time for forward pass: 0.0953376293182373
Time for backpropagation: 0.004665374755859375
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8189125061035156 seconds
Index: 11
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.480924606323242 seconds
Streaming imagenet data took 7.552695989608765 seconds
Then, training+dataloading take 7.56795859336853 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49103331565856934
Time for copying to cuda: 0.04976153373718262
Time for forward pass: 0.1380329132080078
Time for backpropagation: 0.005285978317260742
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8304569721221924 seconds
Index: 12
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.717401027679443 seconds
Streaming imagenet data took 7.789692401885986 seconds
Then, training+dataloading take 7.804312705993652 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5780000686645508
Time for copying to cuda: 0.04998350143432617
Time for forward pass: 0.09521293640136719
Time for backpropagation: 0.0046727657318115234
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8552958965301514 seconds
Index: 13
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.047247409820557 seconds
Streaming imagenet data took 8.166653633117676 seconds
Then, training+dataloading take 8.178743124008179 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5505533218383789
Time for copying to cuda: 0.049368858337402344
Time for forward pass: 0.0952904224395752
Time for backpropagation: 0.004659414291381836
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.809995174407959 seconds
Index: 14
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.352436304092407 seconds
Streaming imagenet data took 8.424080610275269 seconds
Then, training+dataloading take 8.4392728805542 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48209238052368164
Time for copying to cuda: 0.04959678649902344
Time for forward pass: 0.09524130821228027
Time for backpropagation: 0.00460362434387207
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7371790409088135 seconds
Index: 15
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.88632345199585 seconds
Streaming imagenet data took 7.959380865097046 seconds
Then, training+dataloading take 7.973653078079224 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5773253440856934
Time for copying to cuda: 0.04982423782348633
Time for forward pass: 0.09534001350402832
Time for backpropagation: 0.00463557243347168
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8556802272796631 seconds
Index: 16
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.65181565284729 seconds
Streaming imagenet data took 7.723867177963257 seconds
Then, training+dataloading take 7.738714694976807 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49880003929138184
Time for copying to cuda: 0.09312868118286133
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09555387496948242
Time for backpropagation: 0.004822969436645508
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8215343952178955 seconds
Index: 17
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.87693452835083 seconds
Streaming imagenet data took 7.996975898742676 seconds
Then, training+dataloading take 8.012827396392822 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.5453557968139648
Time for copying to cuda: 0.04985499382019043
Time for forward pass: 0.0952310562133789
Time for backpropagation: 0.004719734191894531
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7897341251373291 seconds
Index: 18
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.447068452835083 seconds
Streaming imagenet data took 8.520713090896606 seconds
Then, training+dataloading take 8.535548210144043 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5316188335418701
Time for copying to cuda: 0.05014324188232422
Time for forward pass: 0.09525418281555176
Time for backpropagation: 0.004656076431274414
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8323330879211426 seconds
Index: 19
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.629246950149536 seconds
Streaming imagenet data took 7.700741767883301 seconds
Then, training+dataloading take 7.710753679275513 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5318615436553955
Time for copying to cuda: 0.04980063438415527
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09532904624938965
Time for backpropagation: 0.004620075225830078
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.803905725479126 seconds
Index: 20
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.603023052215576 seconds
Streaming imagenet data took 7.6750688552856445 seconds
Then, training+dataloading take 7.6849939823150635 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5494537353515625
Time for copying to cuda: 0.049669504165649414
Time for forward pass: 0.09513330459594727
Time for backpropagation: 0.004687786102294922
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8465454578399658 seconds
Index: 21
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.636804103851318 seconds
Streaming imagenet data took 7.708083391189575 seconds
Then, training+dataloading take 7.718735694885254 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5162906646728516
Time for copying to cuda: 0.09427380561828613
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09891414642333984
Time for backpropagation: 0.004644155502319336
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8109970092773438 seconds
Index: 22
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.432122707366943 seconds
Streaming imagenet data took 8.505852222442627 seconds
Then, training+dataloading take 8.520753145217896 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.478482723236084
Time for copying to cuda: 0.04955267906188965
Time for forward pass: 0.1146996021270752
Time for backpropagation: 0.005386829376220703
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7691903114318848 seconds
Index: 23
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.625320672988892 seconds
Streaming imagenet data took 7.69673752784729 seconds
Then, training+dataloading take 7.711252212524414 seconds

Epoch: 0
Time of next(dataloader) is: 0.5591738224029541
Time for copying to cuda: 0.049811601638793945
Time for forward pass: 0.0953514575958252
Time for backpropagation: 0.004668712615966797
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
The whole process took 206.176105260849 seconds
