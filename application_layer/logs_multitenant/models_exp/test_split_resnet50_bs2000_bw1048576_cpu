Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.5313676839155 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  15.625
110.736328125
Total layers size  110.74014282226562
Candidate split  21
Server, client, server+client, vanilla  2880.2560119628906 128.37612915039062 3008.6321411132812 222733.8448791504
Model size  97.49234008789062
Fixed, scale_with_bsz  97.49234008789062 111.310546875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.124783277511597 seconds
Streaming imagenet data took 10.132620573043823 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3572967052459717
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.016073226928710938
Time for backpropagation: 0.0636451244354248
One training iteration takes: 0.49950623512268066 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.280409574508667 seconds
Streaming imagenet data took 10.32651686668396 seconds
Then, training+dataloading take 10.332476615905762 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3253955841064453
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.02687811851501465
Time for backpropagation: 0.22750210762023926
One training iteration takes: 0.6709394454956055 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.641283750534058 seconds
Streaming imagenet data took 7.648499011993408 seconds
Then, training+dataloading take 7.649463176727295 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.332592248916626
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.0341794490814209
Time for backpropagation: 0.05778074264526367
One training iteration takes: 0.5180575847625732 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.09568476676941 seconds
Streaming imagenet data took 10.100465774536133 seconds
Then, training+dataloading take 10.101271867752075 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37560367584228516
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.0356137752532959
Time for backpropagation: 0.05651259422302246
One training iteration takes: 0.5743675231933594 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.26246976852417 seconds
Streaming imagenet data took 10.26765775680542 seconds
Then, training+dataloading take 10.269137859344482 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3492445945739746
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.030528545379638672
Time for backpropagation: 0.0775918960571289
One training iteration takes: 0.5294876098632812 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.240947723388672 seconds
Streaming imagenet data took 10.245961904525757 seconds
Then, training+dataloading take 10.246833801269531 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3317887783050537
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.036627769470214844
Time for backpropagation: 0.05495953559875488
One training iteration takes: 0.5331063270568848 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.7633421421051025 seconds
Streaming imagenet data took 7.768235683441162 seconds
Then, training+dataloading take 7.769694805145264 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37061595916748047
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.030431509017944336
Time for backpropagation: 0.07253479957580566
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.5809776782989502 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.207127571105957 seconds
Streaming imagenet data took 10.212260007858276 seconds
Then, training+dataloading take 10.213942527770996 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3647124767303467
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.02983713150024414
Time for backpropagation: 0.05444908142089844
One training iteration takes: 0.5214905738830566 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.239471912384033 seconds
Streaming imagenet data took 10.244467735290527 seconds
Then, training+dataloading take 10.245311498641968 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39047861099243164
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.03653979301452637
Time for backpropagation: 0.12910175323486328
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.6401643753051758 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.173433542251587 seconds
Streaming imagenet data took 10.181128978729248 seconds
Then, training+dataloading take 10.18428373336792 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3410341739654541
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 0.03429770469665527
Time for backpropagation: 0.05654740333557129
One training iteration takes: 0.5199460983276367 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.5685875415802 seconds
Streaming imagenet data took 7.57360053062439 seconds
Then, training+dataloading take 7.574526071548462 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34022974967956543
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.029972076416015625
Time for backpropagation: 0.05448150634765625
One training iteration takes: 0.49659204483032227 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.065831899642944 seconds
Streaming imagenet data took 10.070770502090454 seconds
Then, training+dataloading take 10.071646451950073 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3579275608062744
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 0.030026674270629883
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.12879681587219238
One training iteration takes: 0.5950725078582764 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.174623966217041 seconds
Streaming imagenet data took 10.179369688034058 seconds
Then, training+dataloading take 10.180862426757812 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3318953514099121
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.029748916625976562
Time for backpropagation: 0.0537109375
One training iteration takes: 0.5037264823913574 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.050814867019653 seconds
Streaming imagenet data took 10.055848836898804 seconds
Then, training+dataloading take 10.056691884994507 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3419153690338135
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.02722454071044922
Time for backpropagation: 0.07144594192504883
One training iteration takes: 0.5365087985992432 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.684603929519653 seconds
Streaming imagenet data took 7.689517021179199 seconds
Then, training+dataloading take 7.690424919128418 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38265466690063477
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.026964187622070312
Time for backpropagation: 0.0717155933380127
One training iteration takes: 0.6052775382995605 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.293614625930786 seconds
Streaming imagenet data took 10.298543691635132 seconds
Then, training+dataloading take 10.300019264221191 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3315706253051758
Time for copying to cuda: 5.9604644775390625e-06
Time for forward pass: 0.0274660587310791
Time for backpropagation: 0.07239675521850586
One training iteration takes: 0.5213825702667236 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.186024188995361 seconds
Streaming imagenet data took 10.19084906578064 seconds
Then, training+dataloading take 10.19167709350586 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33859729766845703
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.027768850326538086
Time for backpropagation: 0.053414106369018555
One training iteration takes: 0.5064573287963867 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.077531814575195 seconds
Streaming imagenet data took 10.08248233795166 seconds
Then, training+dataloading take 10.083330392837524 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3764200210571289
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.03593277931213379
Time for backpropagation: 0.07652997970581055
One training iteration takes: 0.5978777408599854 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.882898330688477 seconds
Streaming imagenet data took 7.887612581253052 seconds
Then, training+dataloading take 7.889108419418335 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.336367130279541
Time for copying to cuda: 6.4373016357421875e-06
Time for forward pass: 0.03425431251525879
Time for backpropagation: 0.07887482643127441
One training iteration takes: 0.5369579792022705 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.125496864318848 seconds
Streaming imagenet data took 10.130444049835205 seconds
Then, training+dataloading take 10.131260633468628 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33650755882263184
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.030265331268310547
Time for backpropagation: 0.07499194145202637
One training iteration takes: 0.538931131362915 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.328376054763794 seconds
Streaming imagenet data took 10.333392143249512 seconds
Then, training+dataloading take 10.334903240203857 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33591127395629883
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.026595592498779297
Time for backpropagation: 0.07866621017456055
One training iteration takes: 0.518695592880249 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.098289251327515 seconds
Streaming imagenet data took 10.103328227996826 seconds
Then, training+dataloading take 10.10416579246521 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34045958518981934
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.02676868438720703
Time for backpropagation: 0.06740927696228027
One training iteration takes: 0.5599889755249023 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.669994354248047 seconds
Streaming imagenet data took 7.674914598464966 seconds
Then, training+dataloading take 7.675712585449219 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37779736518859863
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.026469945907592773
Time for backpropagation: 0.050882577896118164
One training iteration takes: 0.5656790733337402 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.423855066299438 seconds
Streaming imagenet data took 10.428967952728271 seconds
Then, training+dataloading take 10.429839134216309 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.340595006942749
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.02687358856201172
Time for backpropagation: 0.057001590728759766
One training iteration takes: 0.5108242034912109 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.160346746444702 seconds
Streaming imagenet data took 10.165427684783936 seconds
Then, training+dataloading take 10.166296482086182 seconds

Epoch: 0
Time of next(dataloader) is: 0.37418603897094727
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 0.03095102310180664
Time for backpropagation: 0.16070055961608887
Memory occpied: (1250.0, 3.0)
The whole process took 247.89342522621155 seconds
