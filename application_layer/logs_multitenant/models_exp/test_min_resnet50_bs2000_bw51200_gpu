Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 44.475412244402044 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([], dtype=int64),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 21
Intermediate:  15.625
110.736328125
Total layers size  110.74014282226562
Fixed, scale_with_bsz  97.49234008789062 111.310546875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.581167697906494 seconds
Streaming imagenet data took 12.58875036239624 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3613426685333252
Time for copying to cuda: 0.005165815353393555
Memory occpied: (1382.0, 140.0)
Memory occpied: (1382.0, 582.0)
Memory occpied: (1382.0, 1042.0)
Time for forward pass: 3.352064609527588
Time for backpropagation: 0.06944417953491211
GPU memory for training: 0.4394540786743164                          

One training iteration takes: 3.8589541912078857 seconds
Index: 0
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.348491668701172 seconds
Streaming imagenet data took 12.355596780776978 seconds
Then, training+dataloading take 12.356569051742554 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41266655921936035
Time for copying to cuda: 0.004525184631347656
Time for forward pass: 0.022341012954711914
Time for backpropagation: 0.007874488830566406
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5599765777587891 seconds
Index: 1
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.612182378768921 seconds
Streaming imagenet data took 12.619244813919067 seconds
Then, training+dataloading take 12.62007474899292 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46459007263183594
Time for copying to cuda: 0.004445552825927734
Time for forward pass: 0.020522117614746094
Time for backpropagation: 0.00641632080078125
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.6258220672607422 seconds
Index: 2
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.014364957809448 seconds
Streaming imagenet data took 10.0193030834198 seconds
Then, training+dataloading take 10.020184516906738 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41886329650878906
Time for copying to cuda: 0.004429817199707031
Time for forward pass: 0.06380820274353027
Time for backpropagation: 0.006940126419067383
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
One training iteration takes: 0.5840792655944824 seconds
Index: 3
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.585214376449585 seconds
Streaming imagenet data took 12.590015888214111 seconds
Then, training+dataloading take 12.590843915939331 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49767374992370605
Time for copying to cuda: 0.004561424255371094
Time for forward pass: 0.020868778228759766
Time for backpropagation: 0.006784677505493164
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
One training iteration takes: 0.6284325122833252 seconds
Index: 4
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.694427013397217 seconds
Streaming imagenet data took 12.701826333999634 seconds
Then, training+dataloading take 12.702760934829712 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.4742143154144287
Time for copying to cuda: 0.004481792449951172
Time for forward pass: 0.02054905891418457
Time for backpropagation: 0.006571531295776367
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.6125442981719971 seconds
Index: 5
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.971184015274048 seconds
Streaming imagenet data took 12.976012706756592 seconds
Then, training+dataloading take 12.977599620819092 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3794097900390625
Time for copying to cuda: 0.004504203796386719
Time for forward pass: 0.020901918411254883
Time for backpropagation: 0.0066950321197509766
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5030255317687988 seconds
Index: 6
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.167594909667969 seconds
Streaming imagenet data took 10.172545433044434 seconds
Then, training+dataloading take 10.174137830734253 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.439788818359375
Time for copying to cuda: 0.004502058029174805
Time for forward pass: 0.02074909210205078
Time for backpropagation: 0.006777286529541016
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5731873512268066 seconds
Index: 7
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.403153657913208 seconds
Streaming imagenet data took 12.408324003219604 seconds
Then, training+dataloading take 12.40997862815857 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4299483299255371
Time for copying to cuda: 0.004492998123168945
Time for forward pass: 0.0635521411895752
Time for backpropagation: 0.0068819522857666016
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5792446136474609 seconds
Index: 8
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.745953559875488 seconds
Streaming imagenet data took 12.75488567352295 seconds
Then, training+dataloading take 12.75878643989563 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43627214431762695
Time for copying to cuda: 0.004488468170166016
Time for forward pass: 0.020594358444213867
Time for backpropagation: 0.0066297054290771484
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
One training iteration takes: 0.5757520198822021 seconds
Index: 9
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.63301420211792 seconds
Streaming imagenet data took 12.637872457504272 seconds
Then, training+dataloading take 12.638839721679688 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45775532722473145
Time for copying to cuda: 0.004594564437866211
Time for forward pass: 0.02082085609436035
Time for backpropagation: 0.006714582443237305
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.6110999584197998 seconds
Index: 10
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.183616399765015 seconds
Streaming imagenet data took 10.188715696334839 seconds
Then, training+dataloading take 10.189669609069824 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4569716453552246
Time for copying to cuda: 0.004448652267456055
Time for forward pass: 0.020569562911987305
Time for backpropagation: 0.006791591644287109
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.6025538444519043 seconds
Index: 11
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.711807012557983 seconds
Streaming imagenet data took 12.716721057891846 seconds
Then, training+dataloading take 12.71759295463562 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45264387130737305
Time for copying to cuda: 0.004495143890380859
Time for forward pass: 0.025048255920410156
Time for backpropagation: 0.006768703460693359
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.6073920726776123 seconds
Index: 12
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.69036865234375 seconds
Streaming imagenet data took 12.695173501968384 seconds
Then, training+dataloading take 12.696048498153687 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42055273056030273
Time for copying to cuda: 0.004480600357055664
Time for forward pass: 0.02044057846069336
Time for backpropagation: 0.006409645080566406
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5685296058654785 seconds
Index: 13
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.519606113433838 seconds
Streaming imagenet data took 12.524532794952393 seconds
Then, training+dataloading take 12.525399208068848 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4683370590209961
Time for copying to cuda: 0.004500627517700195
Time for forward pass: 0.02120494842529297
Time for backpropagation: 0.006871461868286133
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
One training iteration takes: 0.5757520198822021 seconds
Index: 14
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.135705709457397 seconds
Streaming imagenet data took 10.140632390975952 seconds
Then, training+dataloading take 10.141546249389648 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4266197681427002
Time for copying to cuda: 0.004431247711181641
Time for forward pass: 0.020493745803833008
Time for backpropagation: 0.006575107574462891
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5561470985412598 seconds
Index: 15
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.918721914291382 seconds
Streaming imagenet data took 12.927535057067871 seconds
Then, training+dataloading take 12.931124448776245 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.38146376609802246
Time for copying to cuda: 0.004407644271850586
Time for forward pass: 0.020588397979736328
Time for backpropagation: 0.006461620330810547
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.487398624420166 seconds
Index: 16
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.733705043792725 seconds
Streaming imagenet data took 12.738704442977905 seconds
Then, training+dataloading take 12.740392923355103 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3747990131378174
Time for copying to cuda: 0.004407644271850586
Time for forward pass: 0.02039051055908203
Time for backpropagation: 0.006491184234619141
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.48024916648864746 seconds
Index: 17
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.066952466964722 seconds
Streaming imagenet data took 12.071903944015503 seconds
Then, training+dataloading take 12.073469161987305 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3752892017364502
Time for copying to cuda: 0.004538536071777344
Time for forward pass: 0.020751237869262695
Time for backpropagation: 0.006545066833496094
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4987375736236572 seconds
Index: 18
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.288363933563232 seconds
Streaming imagenet data took 10.293220281600952 seconds
Then, training+dataloading take 10.294084310531616 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37853431701660156
Time for copying to cuda: 0.004381418228149414
Time for forward pass: 0.05845046043395996
Time for backpropagation: 0.0068476200103759766
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.55255126953125 seconds
Index: 19
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.619776487350464 seconds
Streaming imagenet data took 12.62471079826355 seconds
Then, training+dataloading take 12.625699758529663 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5066478252410889
Time for copying to cuda: 0.004519939422607422
Time for forward pass: 0.0209197998046875
Time for backpropagation: 0.0066187381744384766
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
One training iteration takes: 0.6270604133605957 seconds
Index: 20
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.655610799789429 seconds
Streaming imagenet data took 12.660606384277344 seconds
Then, training+dataloading take 12.661602020263672 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42330265045166016
Time for copying to cuda: 0.004387617111206055
Time for forward pass: 0.020655393600463867
Time for backpropagation: 0.006528377532958984
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5795888900756836 seconds
Index: 21
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.885593175888062 seconds
Streaming imagenet data took 12.894415616989136 seconds
Then, training+dataloading take 12.89561414718628 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.3800671100616455
Time for copying to cuda: 0.004412651062011719
Time for forward pass: 0.020547151565551758
Time for backpropagation: 0.006494760513305664
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.485790491104126 seconds
Index: 22
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.26325511932373 seconds
Streaming imagenet data took 10.26811408996582 seconds
Then, training+dataloading take 10.269241571426392 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37603259086608887
Time for copying to cuda: 0.004489421844482422
Time for forward pass: 0.020671606063842773
Time for backpropagation: 0.006520748138427734
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.507422924041748 seconds
Index: 23
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.266871213912964 seconds
Streaming imagenet data took 13.271876811981201 seconds
Then, training+dataloading take 13.273592710494995 seconds

Epoch: 0
Time of next(dataloader) is: 0.40859341621398926
Time for copying to cuda: 0.00441288948059082
Time for forward pass: 0.021392345428466797
Time for backpropagation: 0.008216142654418945
GPU memory for training: 0.45486021041870117                          

The whole process took 309.1763565540314 seconds
