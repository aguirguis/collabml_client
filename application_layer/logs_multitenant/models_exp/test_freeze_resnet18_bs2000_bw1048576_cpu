Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.3545151106773 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 11
Intermediate:  1148.4375
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.543783187866211 seconds
Streaming imagenet data took 7.6160173416137695 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4400007724761963
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3895037174224854
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6501359939575195
One training iteration takes: 4.564504623413086 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.495249509811401 seconds
Streaming imagenet data took 7.567274808883667 seconds
Then, training+dataloading take 7.581372261047363 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43950462341308594
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.381223440170288
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.654951572418213
One training iteration takes: 4.60144305229187 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.578598260879517 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.694595098495483 seconds
Then, training+dataloading take 7.70565390586853 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44870591163635254
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3779442310333252
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6876556873321533
One training iteration takes: 4.641853332519531 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.15811014175415 seconds
Streaming imagenet data took 8.23189663887024 seconds
Then, training+dataloading take 8.241978883743286 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45199012756347656
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3564939498901367
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5861594676971436
One training iteration takes: 4.5139899253845215 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.770411491394043 seconds
Streaming imagenet data took 7.843365669250488 seconds
Then, training+dataloading take 7.852721929550171 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4648120403289795
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4782438278198242
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4580039978027344
One training iteration takes: 4.506587266921997 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.747812032699585 seconds
Streaming imagenet data took 7.820210218429565 seconds
Then, training+dataloading take 7.8343186378479 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44392871856689453
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.323077917098999
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.610828399658203
One training iteration takes: 4.4791483879089355 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.733191251754761 seconds
Streaming imagenet data took 7.807395935058594 seconds
Then, training+dataloading take 7.821674823760986 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4432246685028076
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.38822340965271
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4736006259918213
One training iteration takes: 4.415385723114014 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.237145900726318 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 8.353807926177979 seconds
Then, training+dataloading take 8.370149850845337 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45458412170410156
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.321793556213379
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5910184383392334
One training iteration takes: 4.496495246887207 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.59932541847229 seconds
Streaming imagenet data took 7.712977647781372 seconds
Then, training+dataloading take 7.728114366531372 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.47901463508605957
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3757059574127197
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5181026458740234
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.475069999694824 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.767841339111328 seconds
Streaming imagenet data took 7.882642030715942 seconds
Then, training+dataloading take 7.895474433898926 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.49331068992614746
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.359788179397583
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4688146114349365
One training iteration takes: 4.4343249797821045 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.606728553771973 seconds
Streaming imagenet data took 7.679291009902954 seconds
Then, training+dataloading take 7.693120718002319 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4873652458190918
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.378044843673706
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.409738540649414
One training iteration takes: 4.395890235900879 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.214986324310303 seconds
Streaming imagenet data took 8.287786483764648 seconds
Then, training+dataloading take 8.302143812179565 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43534111976623535
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3294920921325684
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6785190105438232
One training iteration takes: 4.576908111572266 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.662176132202148 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.7854719161987305 seconds
Then, training+dataloading take 7.800649166107178 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43680787086486816
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3350729942321777
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.595398426055908
One training iteration takes: 4.475590944290161 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.505175828933716 seconds
Streaming imagenet data took 7.580933332443237 seconds
Then, training+dataloading take 7.598200798034668 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4805173873901367
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 1.1695599555969238
Time for backpropagation: 2.2426180839538574
One training iteration takes: 4.019492864608765 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.775298118591309 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.848962783813477 seconds
Then, training+dataloading take 7.862616539001465 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44173717498779297
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.317387342453003
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5490729808807373
One training iteration takes: 4.421857595443726 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.235249757766724 seconds
Streaming imagenet data took 8.30974531173706 seconds
Then, training+dataloading take 8.323466777801514 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46206116676330566
Time for copying to cuda: 1.0728836059570312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2531960010528564
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5854837894439697
One training iteration takes: 4.436342000961304 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.579636335372925 seconds
Streaming imagenet data took 7.651642560958862 seconds
Then, training+dataloading take 7.666146993637085 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4431602954864502
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.33522367477417
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.537719488143921
One training iteration takes: 4.415599584579468 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.50071120262146 seconds
Streaming imagenet data took 7.573193550109863 seconds
Then, training+dataloading take 7.587045431137085 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44603800773620605
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.395322322845459
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.639758348464966
One training iteration takes: 4.603376150131226 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.964359998703003 seconds
Streaming imagenet data took 8.035742044448853 seconds
Then, training+dataloading take 8.049386024475098 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4385979175567627
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.244647741317749
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5071895122528076
One training iteration takes: 4.312222480773926 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.212990045547485 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 8.326817035675049 seconds
Then, training+dataloading take 8.341658592224121 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4385366439819336
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3617603778839111
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5515716075897217
One training iteration takes: 4.461251735687256 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.584774494171143 seconds
Streaming imagenet data took 7.7016448974609375 seconds
Then, training+dataloading take 7.716717720031738 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5224506855010986
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 1.146477460861206
Time for backpropagation: 2.240532636642456
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.014773845672607 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.906182050704956 seconds
Streaming imagenet data took 7.980940341949463 seconds
Then, training+dataloading take 7.994672060012817 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.445204496383667
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3406774997711182
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.57580304145813
One training iteration takes: 4.466946840286255 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.636096477508545 seconds
Streaming imagenet data took 7.709213495254517 seconds
Then, training+dataloading take 7.724010467529297 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43417835235595703
Time for copying to cuda: 6.198883056640625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3855140209197998
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6300649642944336
One training iteration takes: 4.567873477935791 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.237809658050537 seconds
Streaming imagenet data took 8.310209512710571 seconds
Then, training+dataloading take 8.324037313461304 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47751474380493164
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 1.153235912322998
Time for backpropagation: 2.2442755699157715
One training iteration takes: 4.002997636795044 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.81563401222229 seconds
Streaming imagenet data took 7.887687921524048 seconds
Then, training+dataloading take 7.901412010192871 seconds

Epoch: 0
Time of next(dataloader) is: 0.43364453315734863
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.330202579498291
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.620656728744507
The whole process took 208.63164615631104 seconds
