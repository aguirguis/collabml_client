Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=9, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10446.47416899438 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1369240262.2784314 1369240262.2784314
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 9 20
Intermediate:  0.3828125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 7838.78125 8034.00732421875 14155.1875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 9
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.325101375579834
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.651432752609253
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 401454121
Memory occupied: [1318.0, 3.0] Time: 3.247771739959717
Read 382.856484413147 MBs for this batch
Executing all posts took 3.4602410793304443 seconds
Streaming imagenet data took 3.6039443016052246 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5038096904754639
Time for copying to cuda: 0.09872579574584961
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 1, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 4, 0']
Memory occupied: [1702.0, 354.0] Time: 4.600920915603638
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1702.0, 802.0] Time: 5.977965354919434
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.370359182357788 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Streaming imagenet data took 3.668532609939575 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 1, 0']
Memory occupied: [1702.0, 1306.0] Time: 7.469086647033691
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 89, 71']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 68, 54']
Memory occupied: [6460.0, 6244.0] Time: 8.897037506103516
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 93, 55']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 71, 57']
Memory occupied: [6590.0, 6428.0] Time: 10.321119785308838
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 90, 60']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 70, 52']
Memory occupied: [5366.0, 4054.0] Time: 11.748106479644775
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 57, 42']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 84, 49']
Memory occupied: [3386.0, 4408.0] Time: 13.184210062026978
Time for forward pass: 9.401945352554321
Time for backpropagation: 0.07560276985168457
GPU memory for training: 9.715926170349121                          

One training iteration takes: 10.175005912780762 seconds
Index: 0
Then, training+dataloading take 10.175930500030518 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.5605008602142334
Time for copying to cuda: 0.13582658767700195
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2536.0, 5136.0] Time: 14.631620645523071
Time for forward pass: 0.9140563011169434
Time for backpropagation: 0.011286735534667969
GPU memory for training: 4.842838764190674                          

One training iteration takes: 1.73317551612854 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11532.0, 5136.0] Time: 16.049833059310913
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.7485415935516357 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Streaming imagenet data took 3.982715368270874 seconds
Memory occupied: [11532.0, 5136.0] Time: 17.807645559310913
Then, training+dataloading take 4.00432825088501 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5578889846801758
Time for copying to cuda: 0.09745335578918457
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 100']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 100']
Memory occupied: [11532.0, 5136.0] Time: 19.240592002868652
Time for forward pass: 0.9144151210784912
Time for backpropagation: 0.011420965194702148
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.6953563690185547 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11532.0, 5136.0] Time: 20.68780279159546
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.396326780319214 seconds
Streaming imagenet data took 3.5380806922912598 seconds
Then, training+dataloading take 3.558692693710327 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.6207568645477295
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.13651680946350098
Memory occupied: [11532.0, 5136.0] Time: 22.165070295333862
Time for forward pass: 0.9329040050506592
Time for backpropagation: 0.011206626892089844
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.810934066772461 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 68, 64']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11532.0, 5136.0] Time: 23.61323046684265
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11532.0, 5136.0] Time: 25.08529829978943
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.9639205932617188 seconds
Streaming imagenet data took 4.10886812210083 seconds
Then, training+dataloading take 4.132062911987305 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5591564178466797
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 5, 0']
Time for copying to cuda: 0.17682528495788574
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 1']
Memory occupied: [11532.0, 5136.0] Time: 26.51875400543213
Time for forward pass: 0.9156010150909424
Time for backpropagation: 0.011798620223999023
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.7747972011566162 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11532.0, 5136.0] Time: 27.949873208999634
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.770995616912842 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Streaming imagenet data took 4.005732536315918 seconds
Then, training+dataloading take 4.029690265655518 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11532.0, 5136.0] Time: 29.69660973548889
Time of next(dataloader) is: 0.6063711643218994
Time for copying to cuda: 0.09767389297485352
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 100']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 97']
Memory occupied: [11532.0, 5136.0] Time: 31.1267352104187
Time for forward pass: 0.92057204246521
Time for backpropagation: 0.011450767517089844
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.7523789405822754 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11532.0, 5136.0] Time: 32.55703377723694
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.7554192543029785 seconds
Streaming imagenet data took 3.9018361568450928 seconds
Then, training+dataloading take 3.917271852493286 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6216869354248047
Time for copying to cuda: 0.09756612777709961
Time for forward pass: 0.9773910045623779
Time for backpropagation: 0.010976552963256836
GPU memory for training: 4.842915058135986                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
One training iteration takes: 1.8367280960083008 seconds
Index: 6
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 21, 21']
Memory occupied: [11532.0, 5136.0] Time: 35.584155797958374
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.8652336597442627 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11532.0, 5136.0] Time: 37.43429946899414
Streaming imagenet data took 4.057523965835571 seconds
Then, training+dataloading take 4.081724643707275 seconds

Epoch: 0
Time of next(dataloader) is: 0.5829720497131348
Time for copying to cuda: 0.09791707992553711
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 88, 64']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 100']
Memory occupied: [11532.0, 5136.0] Time: 38.86705732345581
Time for forward pass: 0.9271924495697021
Time for backpropagation: 0.01139378547668457
GPU memory for training: 4.842915058135986                          

The whole process took 46.02087712287903 seconds
