Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=14, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10636.055712907122 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1394089094.4021623 1394089094.4021623
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 14 20
Intermediate:  0.19140625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 6116.125 6311.35107421875 12623.9375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 14
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.32083630561828613
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6435136795043945
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 2.9712846279144287
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.515251636505127 seconds
Streaming imagenet data took 3.5870652198791504 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4210517406463623
Time for copying to cuda: 0.0494081974029541
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1510.0, 222.0] Time: 4.334833860397339
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1510.0, 704.0] Time: 5.708070516586304
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1510.0, 1180.0] Time: 7.113720655441284
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.808328628540039 seconds
Streaming imagenet data took 3.8812971115112305 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 78, 60']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 53, 42']
Memory occupied: [3518.0, 4500.0] Time: 8.531134605407715
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 75, 56']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 63, 46']
Memory occupied: [7566.0, 6338.0] Time: 9.945516347885132
Time for forward pass: 6.85205602645874
Time for backpropagation: 0.11995410919189453
GPU memory for training: 5.916075706481934                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 56, 43']
One training iteration takes: 7.564521789550781 seconds
Index: 0
Then, training+dataloading take 7.565067768096924 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 18, 4']
Time of next(dataloader) is: 0.5431268215179443
Time for copying to cuda: 0.04977583885192871
Time for forward pass: 0.4645566940307617
Time for backpropagation: 0.011166810989379883
GPU memory for training: 2.436784267425537                          

Memory occupied: [3538.0, 1824.0] Time: 12.292999267578125
One training iteration takes: 1.1586823463439941 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 13.706972122192383
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 15.117030620574951
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.846940755844116 seconds
Streaming imagenet data took 4.917792320251465 seconds
Then, training+dataloading take 4.927498817443848 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4879872798919678
Time for copying to cuda: 0.04902005195617676
Time for forward pass: 0.5111112594604492
Time for backpropagation: 0.011556386947631836
GPU memory for training: 2.437255382537842                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
One training iteration takes: 1.1719858646392822 seconds
Index: 2
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 17.544290781021118
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 18.96861743927002
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 20.39021611213684
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.744901895523071 seconds
Streaming imagenet data took 4.817093849182129 seconds
Then, training+dataloading take 4.825976610183716 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4491100311279297
Time for copying to cuda: 0.08884167671203613
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 49, 38']
Memory occupied: [3554.0, 11284.0] Time: 21.822235822677612
Time for forward pass: 0.5138933658599854
Time for backpropagation: 0.011255741119384766
GPU memory for training: 2.437255382537842                          

One training iteration takes: 1.1647334098815918 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 23.252660751342773
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 24.6792950630188
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.603682994842529 seconds
Streaming imagenet data took 4.674597501754761 seconds
Then, training+dataloading take 4.683349132537842 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5016419887542725
Time for copying to cuda: 0.04920053482055664
Time for forward pass: 0.5133702754974365
Time for backpropagation: 0.011713743209838867
GPU memory for training: 2.437255382537842                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
One training iteration takes: 1.2103252410888672 seconds
Index: 4
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 33, 36']
Memory occupied: [3554.0, 11284.0] Time: 27.098634481430054
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 28.532315254211426
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 200751121
Memory occupied: [3554.0, 11284.0] Time: 30.06668186187744
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.5743727684021 seconds
Streaming imagenet data took 4.647818088531494 seconds
Then, training+dataloading take 4.662993669509888 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44919872283935547
Time for copying to cuda: 0.04865241050720215
Time for forward pass: 0.5186893939971924
Time for backpropagation: 0.012143850326538086
GPU memory for training: 2.437255382537842                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 86, 77']
One training iteration takes: 1.1182801723480225 seconds
Index: 5
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 28, 29']
Memory occupied: [3554.0, 11284.0] Time: 31.652434825897217
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 33.08299803733826
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 34.514652729034424
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.552799940109253 seconds
Streaming imagenet data took 4.623523950576782 seconds
Then, training+dataloading take 4.634011745452881 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4513874053955078
Time for copying to cuda: 0.04896879196166992
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 35, 19']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 89, 67']
Memory occupied: [3554.0, 11284.0] Time: 35.94600224494934
Time for forward pass: 0.5672569274902344
Time for backpropagation: 0.011094331741333008
GPU memory for training: 2.437255382537842                          

One training iteration takes: 1.1725900173187256 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 37.37471055984497
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 38.80742645263672
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.6217358112335205 seconds
Streaming imagenet data took 4.693925857543945 seconds
Then, training+dataloading take 4.709864616394043 seconds

Epoch: 0
Time of next(dataloader) is: 0.48851585388183594
Time for copying to cuda: 0.04861807823181152
Time for forward pass: 0.510108232498169
Time for backpropagation: 0.010963201522827148
GPU memory for training: 2.437255382537842                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3554.0, 11284.0] Time: 41.06899404525757
The whole process took 48.22927284240723 seconds
