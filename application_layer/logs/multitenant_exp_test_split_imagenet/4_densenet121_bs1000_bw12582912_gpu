Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=4, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10130.106475079581 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1327773315.9016309 1327773315.9016309
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 4 20
Intermediate:  0.765625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 11284.09375 11479.31982421875 17217.6875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 4
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.3246273994445801
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6500260829925537
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.560399055480957 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 3.893819808959961
Streaming imagenet data took 3.965867042541504 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7221763134002686
Time for copying to cuda: 0.22498703002929688
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 30, 2']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2084.0, 508.0] Time: 5.255157470703125
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 5, 0']
Memory occupied: [2084.0, 1094.0] Time: 6.923284530639648
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.626187324523926 seconds
Streaming imagenet data took 3.9130213260650635 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 1, 0']
Memory occupied: [2084.0, 1574.0] Time: 8.381401777267456
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 88, 81']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 72, 66']
Memory occupied: [9958.0, 10490.0] Time: 9.813575744628906
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 90, 83']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 91, 66']
Memory occupied: [13576.0, 15024.0] Time: 11.23631739616394
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 99, 75']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 80, 65']
Memory occupied: [9824.0, 6982.0] Time: 12.662872552871704
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 98, 65']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 83, 52']
Memory occupied: [3424.0, 2846.0] Time: 14.08300495147705
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 98, 69']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 69, 49']
Memory occupied: [6652.0, 5278.0] Time: 15.509172201156616
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 96, 63']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 55, 43']
Memory occupied: [5404.0, 4336.0] Time: 16.932594060897827
Time for forward pass: 12.274365186691284
Time for backpropagation: 0.07077407836914062
GPU memory for training: 18.321105003356934                          

One training iteration takes: 13.43547248840332 seconds
Index: 0
Then, training+dataloading take 13.437195777893066 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.7787442207336426
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2830.0, 3482.0] Time: 18.361961364746094
Time for copying to cuda: 0.23397064208984375
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 100']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 96']
Memory occupied: [5886.0, 12882.0] Time: 19.79084825515747
Time for forward pass: 1.550555944442749
Time for backpropagation: 0.021075010299682617
GPU memory for training: 9.796470165252686                          

One training iteration takes: 2.7678558826446533 seconds
Index: 1
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.869020462036133 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5910.0, 12882.0] Time: 21.73014211654663
Streaming imagenet data took 4.314356565475464 seconds
Then, training+dataloading take 4.358748197555542 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7948071956634521
Time for copying to cuda: 0.2344958782196045
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 20, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 1']
Memory occupied: [9166.0, 12882.0] Time: 23.16740870475769
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 95']
Time for forward pass: 1.5129704475402832
Time for backpropagation: 0.014062643051147461
GPU memory for training: 9.797263622283936                          

One training iteration takes: 2.698263168334961 seconds
Index: 2
Length of received data: 802862121
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 36, 35']
Read 765.668984413147 MBs for this batch
Executing all posts took 3.7001421451568604 seconds
Memory occupied: [9166.0, 12882.0] Time: 25.662644863128662
Streaming imagenet data took 4.048768997192383 seconds
Then, training+dataloading take 4.083325624465942 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8171813488006592
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 7, 0']
Time for copying to cuda: 0.276853084564209
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [9166.0, 12882.0] Time: 27.12295365333557
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 97']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 95']
Time for forward pass: 1.5468666553497314
Time for backpropagation: 0.013486862182617188
GPU memory for training: 9.796531200408936                          

Memory occupied: [9166.0, 12882.0] Time: 28.879014015197754
One training iteration takes: 3.0844411849975586 seconds
Index: 3
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.8263299465179443 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Streaming imagenet data took 4.221369028091431 seconds
Then, training+dataloading take 4.239999294281006 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.9551403522491455
Time for copying to cuda: 0.19523882865905762
Time for forward pass: 1.4891331195831299
Time for backpropagation: 0.015067338943481445
GPU memory for training: 9.796531200408936                          

Memory occupied: [9166.0, 12882.0] Time: 32.871517181396484
One training iteration takes: 2.8392889499664307 seconds
Index: 4
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.5225818157196045 seconds
Streaming imagenet data took 3.8685109615325928 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Then, training+dataloading take 3.9162421226501465 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8890781402587891
Time for copying to cuda: 0.1934506893157959
Time for forward pass: 1.4874484539031982
Time for backpropagation: 0.014446735382080078
GPU memory for training: 9.796531200408936                          

GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
One training iteration takes: 2.737604856491089 seconds
Index: 5
Memory occupied: [9166.0, 12882.0] Time: 36.88033151626587
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.719001531600952 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Streaming imagenet data took 4.113094806671143 seconds
Then, training+dataloading take 4.160538673400879 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.8945956230163574
Time for copying to cuda: 0.1928246021270752
Time for forward pass: 1.5251808166503906
Time for backpropagation: 0.011898517608642578
GPU memory for training: 9.796531200408936                          

Memory occupied: [9166.0, 12882.0] Time: 40.90070080757141
One training iteration takes: 3.2309963703155518 seconds
Index: 6
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.6902949810028076 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Streaming imagenet data took 4.19170069694519 seconds
Then, training+dataloading take 4.213444232940674 seconds

Epoch: 0
Memory occupied: [9166.0, 12882.0] Time: 42.55744290351868
Time of next(dataloader) is: 0.8092243671417236
Time for copying to cuda: 0.19597530364990234
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 50, 10']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 98']
Memory occupied: [9166.0, 12882.0] Time: 44.013160943984985
Time for forward pass: 1.483133316040039
Time for backpropagation: 0.011411428451538086
GPU memory for training: 9.796531200408936                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 5, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [9166.0, 12882.0] Time: 45.548346281051636
The whole process took 52.69031882286072 seconds
