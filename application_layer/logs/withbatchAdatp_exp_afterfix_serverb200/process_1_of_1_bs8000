Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='myalexnet', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 4425.775062304181 Mbps
[774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
133802.66666666666
233.08120727539062 4.164713541666667
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
Start 0, end 8000, post_step 1000

Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 21.2327299118042 seconds
Streaming imagenet data took 21.339802026748657 seconds
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1350.0, 3.0)
Time of next(dataloader) is: 0.6890428066253662
Time for copying to cuda: 0.07534980773925781
Memory occpied: (1632.0, 412.0)
Memory occpied: (1632.0, 794.0)
Time for forward pass: 3.51568603515625
Time for backpropagation: 0.006776332855224609
GPU memory for training: 1.6641554832458496                          

One training iteration takes: 4.422767400741577 seconds
Index: 0
Memory occpied: (1980.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 20.200130939483643 seconds
Streaming imagenet data took 20.307889699935913 seconds
Then, training+dataloading take 20.324803829193115 seconds
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7121806144714355
Time for copying to cuda: 0.07462358474731445
Memory occpied: (2332.0, 1820.0)
Time for forward pass: 0.23140740394592285
Time for backpropagation: 0.0025246143341064453
GPU memory for training: 1.8206424713134766                          

Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
One training iteration takes: 6.090541839599609 seconds
Index: 1
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 21.81398367881775 seconds
Streaming imagenet data took 21.9230375289917 seconds
Then, training+dataloading take 21.941352367401123 seconds
Start 24000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.749809980392456
Time for copying to cuda: 0.07586264610290527
Memory occpied: (2494.0, 1828.0)
Time for forward pass: 0.23969268798828125
Time for backpropagation: 0.0027413368225097656
GPU memory for training: 1.8206424713134766                          

One training iteration takes: 1.2028095722198486 seconds
Index: 2
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 21.026721000671387 seconds
Streaming imagenet data took 21.138612508773804 seconds
Then, training+dataloading take 21.15609622001648 seconds
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7762796878814697
Time for copying to cuda: 0.07570743560791016
Time for forward pass: 0.23394465446472168
Time for backpropagation: 0.0025777816772460938
GPU memory for training: 1.8206424713134766                          

One training iteration takes: 1.2569215297698975 seconds
Index: 3
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 20.942232370376587 seconds
Streaming imagenet data took 21.05413293838501 seconds
Then, training+dataloading take 21.07177209854126 seconds
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7194993495941162
Time for copying to cuda: 0.07562565803527832
Time for forward pass: 0.24690485000610352
Time for backpropagation: 0.003065347671508789
GPU memory for training: 1.8206424713134766                          

Memory occpied: (2494.0, 1828.0)
One training iteration takes: 1.1875102519989014 seconds
Index: 4
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 21.48041605949402 seconds
Streaming imagenet data took 21.59192442893982 seconds
Then, training+dataloading take 21.61555027961731 seconds
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7526736259460449
Time for copying to cuda: 0.07496953010559082
Time for forward pass: 0.23113441467285156
Time for backpropagation: 0.002557039260864258
GPU memory for training: 1.8206424713134766                          

One training iteration takes: 1.228097677230835 seconds
Index: 5
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.288686513900757 seconds
Streaming imagenet data took 12.31700086593628 seconds
Then, training+dataloading take 12.326831102371216 seconds

Epoch: 0
Time of next(dataloader) is: 0.5765559673309326
Time for copying to cuda: 0.019448041915893555
Memory occpied: (2494.0, 1828.0)
Time for forward pass: 0.08257174491882324
Time for backpropagation: 0.0023758411407470703
GPU memory for training: 1.2567806243896484                          

The whole process took 147.35290551185608 seconds
