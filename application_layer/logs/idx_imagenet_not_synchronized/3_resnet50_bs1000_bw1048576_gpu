Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=3, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5595246947059 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119086714.0207845 119086714.0207845
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 3 21
Intermediate:  3.0625
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 9292.857421875 9497.77294921875 12929.576171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Using split index: 3
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 36.363688707351685 seconds
Memory occpied: (1410.0, 3.0)
Streaming imagenet data took 37.62982797622681 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.1118288040161133
Time for copying to cuda: 0.771233320236206
Time for forward pass: 9.793127536773682
Time for backpropagation: 0.06823372840881348
GPU memory for training: 17.227513790130615                          

Memory occpied: (1410.0, 3.0)
One training iteration takes: 13.128479957580566 seconds
Index: 0
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 36.71655058860779 seconds
Memory occpied: (12490.0, 6368.0)
Streaming imagenet data took 38.00572752952576 seconds
Then, training+dataloading take 38.14496731758118 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.259817123413086
Time for copying to cuda: 0.7680821418762207
Time for forward pass: 1.5288496017456055
Time for backpropagation: 0.006613969802856445
GPU memory for training: 14.418626308441162                          

Memory occpied: (12490.0, 6368.0)
One training iteration takes: 4.973552465438843 seconds
Index: 1
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 37.038052797317505 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 38.32954549789429 seconds
Then, training+dataloading take 38.51834440231323 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.213636636734009
Time for copying to cuda: 0.7669250965118408
Time for forward pass: 1.5283887386322021
Time for backpropagation: 0.00658416748046875
GPU memory for training: 14.417954921722412                          

Memory occpied: (12498.0, 9440.0)
One training iteration takes: 4.94215202331543 seconds
Index: 2
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 36.80918550491333 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 38.10208868980408 seconds
Then, training+dataloading take 38.27807378768921 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.1746151447296143
Time for copying to cuda: 0.7686400413513184
Time for forward pass: 1.5346689224243164
Time for backpropagation: 0.006514072418212891
GPU memory for training: 14.417954921722412                          

Memory occpied: (12498.0, 9440.0)
One training iteration takes: 4.896955728530884 seconds
Index: 3
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 72.86224436759949 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 74.14052319526672 seconds
Then, training+dataloading take 74.29131412506104 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.248520612716675
Time for copying to cuda: 0.774362325668335
Time for forward pass: 1.536419153213501
Time for backpropagation: 0.006606340408325195
GPU memory for training: 14.417954921722412                          

Memory occpied: (12498.0, 9440.0)
One training iteration takes: 4.960684776306152 seconds
Index: 4
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 36.91844320297241 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 38.21441292762756 seconds
Then, training+dataloading take 38.36402082443237 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Time of next(dataloader) is: 2.289302110671997
Memory occpied: (12498.0, 9440.0)
Time for copying to cuda: 0.866940975189209
Memory occpied: (12498.0, 9440.0)
Time for forward pass: 1.5326411724090576
Time for backpropagation: 0.00701594352722168
GPU memory for training: 14.417954921722412                          

One training iteration takes: 5.118031740188599 seconds
Index: 5
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 36.83739137649536 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 38.13879632949829 seconds
Then, training+dataloading take 38.202693700790405 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Time of next(dataloader) is: 2.1522412300109863
Memory occpied: (12498.0, 9440.0)
Time for copying to cuda: 0.8719043731689453
Memory occpied: (12498.0, 9440.0)
Time for forward pass: 1.5547237396240234
Time for backpropagation: 0.006745576858520508
GPU memory for training: 14.417954921722412                          

One training iteration takes: 4.992551326751709 seconds
Index: 6
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 36.85602927207947 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 38.14295053482056 seconds
Then, training+dataloading take 38.300026416778564 seconds

Epoch: 0
Time of next(dataloader) is: 2.2684288024902344
Time for copying to cuda: 0.7802791595458984
Time for forward pass: 1.5322644710540771
Time for backpropagation: 0.006726503372192383
GPU memory for training: 14.417954921722412                          

Memory occpied: (12498.0, 9440.0)
The whole process took 353.9468836784363 seconds
