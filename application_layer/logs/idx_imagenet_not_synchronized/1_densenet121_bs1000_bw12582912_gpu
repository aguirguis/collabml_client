Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=1, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10089.324471994687 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1322427937.1932876 1322427937.1932876
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 1 20
Intermediate:  3.0625
3.63671875
Total layers size  29.767486572265625
Server, client, server+client, vanilla  155.41357421875 13580.96875 13736.38232421875 14729.40625
Fixed, scale_with_bsz  0 7.78466796875
Mem usage  1318.0 3.0
Using split index: 1
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.583984136581421 seconds
Memory occpied: (1318.0, 3.0)
Streaming imagenet data took 14.834850311279297 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.153303384780884
Time for copying to cuda: 0.7705638408660889
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.032923221588135 seconds
Streaming imagenet data took 14.15653371810913 seconds
Time for forward pass: 13.989283323287964
Time for backpropagation: 0.07022523880004883
GPU memory for training: 20.046401023864746                          

Memory occpied: (1318.0, 3.0)
One training iteration takes: 17.355928421020508 seconds
Index: 0
Then, training+dataloading take 17.3624107837677 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (4996.0, 4674.0)
Memory occpied: (4996.0, 4674.0)
Time of next(dataloader) is: 2.1415328979492188
Time for copying to cuda: 0.7721748352050781
Memory occpied: (14964.0, 11194.0)
Memory occpied: (8818.0, 11202.0)
Time for forward pass: 1.6960813999176025
Time for backpropagation: 0.019630908966064453
GPU memory for training: 13.909873485565186                          

One training iteration takes: 5.0433197021484375 seconds
Index: 1
Memory occpied: (8842.0, 11202.0)
Memory occpied: (8842.0, 11202.0)
Memory occpied: (8842.0, 11202.0)
Memory occpied: (8842.0, 11202.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.683670043945312 seconds
Memory occpied: (8842.0, 11202.0)
Streaming imagenet data took 14.883464813232422 seconds
Then, training+dataloading take 15.013469219207764 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2411856651306152
Time for copying to cuda: 0.7752039432525635
Time for forward pass: 1.6243491172790527
Time for backpropagation: 0.011820316314697266
GPU memory for training: 13.90972089767456                          

One training iteration takes: 5.136650562286377 seconds
Index: 2
Memory occpied: (8842.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.202585935592651 seconds
Memory occpied: (12290.0, 11202.0)
Streaming imagenet data took 14.429760694503784 seconds
Then, training+dataloading take 14.65774393081665 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.232088088989258
Time for copying to cuda: 0.777599573135376
Time for forward pass: 1.6311490535736084
Time for backpropagation: 0.011571407318115234
GPU memory for training: 13.909934520721436                          

Memory occpied: (12290.0, 11202.0)
One training iteration takes: 5.053954839706421 seconds
Index: 3
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.650741338729858 seconds
Memory occpied: (12290.0, 11202.0)
Streaming imagenet data took 14.969367980957031 seconds
Then, training+dataloading take 15.13370966911316 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.19628643989563
Time for copying to cuda: 0.7713453769683838
Time for forward pass: 1.6130571365356445
Time for backpropagation: 0.011402368545532227
GPU memory for training: 13.909934520721436                          

Memory occpied: (12290.0, 11202.0)
One training iteration takes: 5.047540903091431 seconds
Index: 4
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.185678482055664 seconds
Memory occpied: (12290.0, 11202.0)
Streaming imagenet data took 14.385003089904785 seconds
Then, training+dataloading take 14.524342060089111 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Time of next(dataloader) is: 2.248513698577881
Memory occpied: (12290.0, 11202.0)
Time for copying to cuda: 0.8954010009765625
Memory occpied: (12290.0, 11202.0)
Time for forward pass: 1.6177496910095215
Time for backpropagation: 0.011684417724609375
GPU memory for training: 13.909934520721436                          

One training iteration takes: 5.182722330093384 seconds
Index: 5
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.079519271850586 seconds
Memory occpied: (12290.0, 11202.0)
Streaming imagenet data took 14.405863523483276 seconds
Then, training+dataloading take 14.546078205108643 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Time of next(dataloader) is: 2.317836046218872
Memory occpied: (12290.0, 11202.0)
Time for copying to cuda: 0.884662389755249
Memory occpied: (12290.0, 11202.0)
Time for forward pass: 1.6334943771362305
Time for backpropagation: 0.011572599411010742
GPU memory for training: 13.909934520721436                          

One training iteration takes: 5.2546374797821045 seconds
Index: 6
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Memory occpied: (12290.0, 11202.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.591641902923584 seconds
Memory occpied: (12290.0, 11202.0)
Streaming imagenet data took 14.823122262954712 seconds
Then, training+dataloading take 14.967704057693481 seconds

Epoch: 0
Time of next(dataloader) is: 2.3334426879882812
Time for copying to cuda: 0.7781400680541992
Time for forward pass: 1.632483959197998
Time for backpropagation: 0.011659860610961914
GPU memory for training: 13.909934520721436                          

Memory occpied: (12290.0, 11202.0)
The whole process took 133.2300944328308 seconds
