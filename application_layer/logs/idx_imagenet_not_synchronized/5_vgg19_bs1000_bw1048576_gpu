Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2788735908492 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119049928.51929979 119049928.51929979
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 36
Intermediate:  3.0625
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 16438.86474609375 17388.47509765625 38450.58349609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 5
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 38.190818071365356 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 39.451565742492676 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2262282371520996
Time for copying to cuda: 0.7737810611724854
Time for forward pass: 23.587001085281372
Time for backpropagation: 0.05124998092651367
GPU memory for training: 23.57125186920166                          

Memory occpied: (1894.0, 3.0)
One training iteration takes: 27.077053785324097 seconds
Index: 0
Memory occpied: (7990.0, 14550.0)
Memory occpied: (7990.0, 14550.0)
Memory occpied: (7990.0, 14550.0)
Memory occpied: (7990.0, 14550.0)
Memory occpied: (7990.0, 14550.0)
Memory occpied: (7990.0, 14550.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 37.566736459732056 seconds
Memory occpied: (7990.0, 14550.0)
Streaming imagenet data took 38.77353119850159 seconds
Then, training+dataloading take 38.91276454925537 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (7990.0, 14550.0)
Memory occpied: (7990.0, 14550.0)
Time of next(dataloader) is: 2.250507354736328
Memory occpied: (7990.0, 14550.0)
Time for copying to cuda: 0.8727381229400635
Memory occpied: (14118.0, 14550.0)
Memory occpied: (11208.0, 14558.0)
Time for forward pass: 2.2926595211029053
Time for backpropagation: 0.006335258483886719
GPU memory for training: 20.98159885406494                          

One training iteration takes: 5.826655149459839 seconds
Index: 1
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 39.03372812271118 seconds
Memory occpied: (11210.0, 14558.0)
Streaming imagenet data took 40.3302001953125 seconds
Then, training+dataloading take 40.521259784698486 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.219456434249878
Time for copying to cuda: 0.7754371166229248
Time for forward pass: 2.2511682510375977
Time for backpropagation: 0.004088163375854492
GPU memory for training: 20.98159885406494                          

One training iteration takes: 5.7218616008758545 seconds
Index: 2
Memory occpied: (11210.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 38.682698249816895 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 39.98802661895752 seconds
Then, training+dataloading take 40.16658043861389 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.179896831512451
Time for copying to cuda: 0.7787759304046631
Time for forward pass: 2.249284267425537
Time for backpropagation: 0.004443168640136719
GPU memory for training: 20.98159885406494                          

One training iteration takes: 5.663769483566284 seconds
Index: 3
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 38.740558385849 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 40.03871488571167 seconds
Then, training+dataloading take 40.192336082458496 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.232937812805176
Time for copying to cuda: 0.7767610549926758
Time for forward pass: 2.2770440578460693
Time for backpropagation: 0.00408625602722168
GPU memory for training: 20.98159885406494                          

Memory occpied: (14274.0, 14558.0)
One training iteration takes: 5.7617857456207275 seconds
Index: 4
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 38.96176528930664 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 40.28500008583069 seconds
Then, training+dataloading take 40.491881370544434 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2335927486419678
Time for copying to cuda: 0.7771632671356201
Time for forward pass: 2.263068675994873
Time for backpropagation: 0.004127025604248047
GPU memory for training: 20.98159885406494                          

Memory occpied: (14274.0, 14558.0)
One training iteration takes: 5.761835813522339 seconds
Index: 5
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 41.827550649642944 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 43.12913680076599 seconds
Then, training+dataloading take 43.33057355880737 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3111495971679688
Time for copying to cuda: 0.7774038314819336
Time for forward pass: 2.2543976306915283
Time for backpropagation: 0.004070758819580078
GPU memory for training: 20.98159885406494                          

Memory occpied: (14274.0, 14558.0)
One training iteration takes: 5.768795967102051 seconds
Index: 6
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 38.891998529434204 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 40.21490168571472 seconds
Then, training+dataloading take 40.373059034347534 seconds

Epoch: 0
Time of next(dataloader) is: 2.2764148712158203
Time for copying to cuda: 0.7733566761016846
Time for forward pass: 2.2450084686279297
Time for backpropagation: 0.004103183746337891
GPU memory for training: 20.98159885406494                          

Memory occpied: (14274.0, 14558.0)
The whole process took 337.9274022579193 seconds
