Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6496970046878 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119098533.08579844 119098533.08579844
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 21
Intermediate:  3.0625
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 7761.607421875 7966.52294921875 11398.326171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Using split index: 7
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.24684429168701 seconds
Memory occpied: (1410.0, 3.0)
Streaming imagenet data took 38.51735186576843 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.1259028911590576
Time for copying to cuda: 0.7737665176391602
Time for forward pass: 8.43573546409607
Time for backpropagation: 0.06190204620361328
GPU memory for training: 16.299291133880615                          

Memory occpied: (1410.0, 3.0)
One training iteration takes: 11.774139881134033 seconds
Index: 0
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Memory occpied: (9668.0, 8104.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.45095610618591 seconds
Memory occpied: (9668.0, 8104.0)
Streaming imagenet data took 38.73259973526001 seconds
Then, training+dataloading take 38.87577533721924 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2632267475128174
Time for copying to cuda: 0.7744467258453369
Time for forward pass: 1.1428313255310059
Time for backpropagation: 0.0065958499908447266
GPU memory for training: 9.183461666107178                          

Memory occpied: (9668.0, 8104.0)
One training iteration takes: 4.602504014968872 seconds
Index: 1
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.6820867061615 seconds
Memory occpied: (9676.0, 8112.0)
Streaming imagenet data took 38.99142098426819 seconds
Then, training+dataloading take 39.18038845062256 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.253727436065674
Time for copying to cuda: 0.7705779075622559
Time for forward pass: 1.1440565586090088
Time for backpropagation: 0.0065958499908447266
GPU memory for training: 9.183461666107178                          

Memory occpied: (9676.0, 8112.0)
One training iteration takes: 4.574316501617432 seconds
Index: 2
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.56687641143799 seconds
Memory occpied: (9676.0, 8112.0)
Streaming imagenet data took 38.86347699165344 seconds
Then, training+dataloading take 39.039836168289185 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.1857049465179443
Time for copying to cuda: 0.7718157768249512
Time for forward pass: 1.1491060256958008
Time for backpropagation: 0.006498098373413086
GPU memory for training: 9.183461666107178                          

Memory occpied: (9676.0, 8112.0)
One training iteration takes: 4.51947283744812 seconds
Index: 3
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.58695077896118 seconds
Memory occpied: (9676.0, 8112.0)
Streaming imagenet data took 38.882275104522705 seconds
Then, training+dataloading take 38.94109320640564 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2107253074645996
Time for copying to cuda: 0.7712125778198242
Time for forward pass: 1.1429779529571533
Time for backpropagation: 0.00677943229675293
GPU memory for training: 9.183461666107178                          

Memory occpied: (9676.0, 8112.0)
One training iteration takes: 4.527865648269653 seconds
Index: 4
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.68263554573059 seconds
Memory occpied: (9676.0, 8112.0)
Streaming imagenet data took 38.964813470840454 seconds
Then, training+dataloading take 39.11478018760681 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Time of next(dataloader) is: 2.2443292140960693
Memory occpied: (9676.0, 8112.0)
Time for copying to cuda: 0.8730480670928955
Memory occpied: (9676.0, 8112.0)
Time for forward pass: 1.170041561126709
Time for backpropagation: 0.007063627243041992
GPU memory for training: 9.183461666107178                          

One training iteration takes: 4.705981016159058 seconds
Index: 5
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.691802740097046 seconds
Memory occpied: (9676.0, 8112.0)
Streaming imagenet data took 39.010547161102295 seconds
Then, training+dataloading take 39.16545128822327 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2552225589752197
Time for copying to cuda: 0.7786250114440918
Time for forward pass: 1.1373326778411865
Time for backpropagation: 0.007074117660522461
GPU memory for training: 9.183461666107178                          

Memory occpied: (9676.0, 8112.0)
One training iteration takes: 4.597361326217651 seconds
Index: 6
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Memory occpied: (9676.0, 8112.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.59261965751648 seconds
Memory occpied: (9676.0, 8112.0)
Streaming imagenet data took 38.90557909011841 seconds
Then, training+dataloading take 39.0555157661438 seconds

Epoch: 0
Time of next(dataloader) is: 2.237164258956909
Time for copying to cuda: 0.780698299407959
Time for forward pass: 1.164482593536377
Time for backpropagation: 0.006515979766845703
GPU memory for training: 9.183461666107178                          

Memory occpied: (9676.0, 8112.0)
The whole process took 323.7105212211609 seconds
