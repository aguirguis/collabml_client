Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.341507493353 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119058138.07016876 119058138.07016876
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 20
Intermediate:  3.0625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 12049.71875 12244.94482421875 15686.4375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 7
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.34244775772095 seconds
Memory occpied: (1318.0, 3.0)
Streaming imagenet data took 38.60169982910156 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.1282742023468018
Time for copying to cuda: 0.7719242572784424
Time for forward pass: 8.547595262527466
Time for backpropagation: 0.07740426063537598
GPU memory for training: 16.164183616638184                          

Memory occpied: (1318.0, 3.0)
One training iteration takes: 11.895359516143799 seconds
Index: 0
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Memory occpied: (4862.0, 5718.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.5590341091156 seconds
Memory occpied: (4862.0, 5718.0)
Streaming imagenet data took 38.8352632522583 seconds
Then, training+dataloading take 38.975871562957764 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2530603408813477
Time for copying to cuda: 0.772130012512207
Time for forward pass: 1.0740940570831299
Time for backpropagation: 0.011033296585083008
GPU memory for training: 9.142300128936768                          

Memory occpied: (4862.0, 5718.0)
One training iteration takes: 4.521557331085205 seconds
Index: 1
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.801029682159424 seconds
Memory occpied: (11732.0, 5734.0)
Streaming imagenet data took 39.09796762466431 seconds
Then, training+dataloading take 39.28742837905884 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Time of next(dataloader) is: 2.216724157333374
Memory occpied: (11732.0, 5734.0)
Time for copying to cuda: 0.8671059608459473
Memory occpied: (11732.0, 5734.0)
Time for forward pass: 1.074955940246582
Time for backpropagation: 0.011400461196899414
GPU memory for training: 9.142513751983643                          

One training iteration takes: 4.570234060287476 seconds
Index: 2
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.64322781562805 seconds
Memory occpied: (11732.0, 5734.0)
Streaming imagenet data took 38.93569993972778 seconds
Then, training+dataloading take 38.99948740005493 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.195157766342163
Time for copying to cuda: 0.7792651653289795
Time for forward pass: 1.05167555809021
Time for backpropagation: 0.011090755462646484
GPU memory for training: 9.142513751983643                          

Memory occpied: (11732.0, 5734.0)
One training iteration takes: 4.455726385116577 seconds
Index: 3
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 38.070125579833984 seconds
Memory occpied: (11732.0, 5734.0)
Streaming imagenet data took 39.266584396362305 seconds
Then, training+dataloading take 39.40996241569519 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Time of next(dataloader) is: 2.208101272583008
Memory occpied: (11732.0, 5734.0)
Time for copying to cuda: 0.871640682220459
Memory occpied: (11732.0, 5734.0)
Time for forward pass: 1.0628762245178223
Time for backpropagation: 0.011220455169677734
GPU memory for training: 9.142513751983643                          

One training iteration takes: 4.5611889362335205 seconds
Index: 4
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.8765606880188 seconds
Memory occpied: (11732.0, 5734.0)
Streaming imagenet data took 39.19590091705322 seconds
Then, training+dataloading take 39.32823157310486 seconds
Memory occpied: (11732.0, 5734.0)
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (11732.0, 5734.0)
Time of next(dataloader) is: 2.153170347213745
Memory occpied: (11732.0, 5734.0)
Time for copying to cuda: 0.8635327816009521
Memory occpied: (11732.0, 5734.0)
Time for forward pass: 1.0764195919036865
Time for backpropagation: 0.011360883712768555
GPU memory for training: 9.142513751983643                          

One training iteration takes: 4.510537147521973 seconds
Index: 5
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.609702348709106 seconds
Memory occpied: (11732.0, 5734.0)
Streaming imagenet data took 38.81440806388855 seconds
Then, training+dataloading take 38.95734262466431 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Time of next(dataloader) is: 2.196354627609253
Memory occpied: (11732.0, 5734.0)
Time for copying to cuda: 0.866934061050415
Time for forward pass: 1.0625879764556885
Time for backpropagation: 0.012034177780151367
GPU memory for training: 9.142513751983643                          

Memory occpied: (11732.0, 5734.0)
One training iteration takes: 4.597758054733276 seconds
Index: 6
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Memory occpied: (11732.0, 5734.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.81526255607605 seconds
Memory occpied: (11732.0, 5734.0)
Streaming imagenet data took 39.11210083961487 seconds
Then, training+dataloading take 39.254571199417114 seconds

Epoch: 0
Time of next(dataloader) is: 2.238558530807495
Time for copying to cuda: 0.7774233818054199
Time for forward pass: 1.0509896278381348
Time for backpropagation: 0.011135101318359375
GPU memory for training: 9.142513751983643                          

Memory occpied: (11732.0, 5734.0)
The whole process took 324.2792594432831 seconds
