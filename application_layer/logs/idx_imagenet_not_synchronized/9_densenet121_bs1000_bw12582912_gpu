Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=9, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10047.427087264563 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1316936363.1819408 1316936363.1819408
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 9 20
Intermediate:  0.3828125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 7838.78125 8034.00732421875 14155.1875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 9
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.311927556991577 seconds
Streaming imagenet data took 3.452958345413208 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5389318466186523
Time for copying to cuda: 0.09838485717773438
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.2815725803375244 seconds
Streaming imagenet data took 3.4257514476776123 seconds
Time for forward pass: 8.249181032180786
Time for backpropagation: 0.07099270820617676
GPU memory for training: 9.715926170349121                          

One training iteration takes: 9.066884517669678 seconds
Index: 0
Then, training+dataloading take 9.067159652709961 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (1318.0, 2892.0)
Time of next(dataloader) is: 0.5549056529998779
Time for copying to cuda: 0.09767436981201172
Memory occpied: (5072.0, 7702.0)
Time for forward pass: 0.8855149745941162
Time for backpropagation: 0.011160612106323242
GPU memory for training: 4.842941761016846                          

One training iteration takes: 1.6692430973052979 seconds
Index: 1
Memory occpied: (5072.0, 7702.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.296386480331421 seconds
Streaming imagenet data took 3.4385721683502197 seconds
Then, training+dataloading take 3.4593265056610107 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6233024597167969
Time for copying to cuda: 0.09841752052307129
Time for forward pass: 0.9300296306610107
Time for backpropagation: 0.01135110855102539
GPU memory for training: 4.842941761016846                          

One training iteration takes: 1.8022055625915527 seconds
Index: 2
Memory occpied: (5072.0, 7702.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.2993509769439697 seconds
Streaming imagenet data took 3.4878299236297607 seconds
Memory occpied: (5072.0, 7702.0)
Then, training+dataloading take 3.5089268684387207 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5523738861083984
Time for copying to cuda: 0.09815168380737305
Memory occpied: (5072.0, 7702.0)
Time for forward pass: 0.9312558174133301
Time for backpropagation: 0.01125788688659668
GPU memory for training: 4.842941761016846                          

One training iteration takes: 1.724872350692749 seconds
Index: 3
Memory occpied: (5072.0, 7702.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.1847403049468994 seconds
Streaming imagenet data took 3.3265748023986816 seconds
Then, training+dataloading take 3.3473033905029297 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5910193920135498
Time for copying to cuda: 0.09686040878295898
Time for forward pass: 0.9307987689971924
Time for backpropagation: 0.011195898056030273
GPU memory for training: 4.842941761016846                          

One training iteration takes: 1.7545690536499023 seconds
Index: 4
Memory occpied: (5072.0, 7702.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.2757818698883057 seconds
Memory occpied: (5072.0, 7702.0)
Streaming imagenet data took 3.462334632873535 seconds
Then, training+dataloading take 3.4843742847442627 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5517385005950928
Time for copying to cuda: 0.09738802909851074
Memory occpied: (5072.0, 7702.0)
Time for forward pass: 0.9333047866821289
Time for backpropagation: 0.01126408576965332
GPU memory for training: 4.842941761016846                          

One training iteration takes: 1.705662488937378 seconds
Index: 5
Memory occpied: (5072.0, 7702.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.265552043914795 seconds
Streaming imagenet data took 3.4541823863983154 seconds
Then, training+dataloading take 3.476635456085205 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (5072.0, 7702.0)
Time of next(dataloader) is: 0.6017160415649414
Time for copying to cuda: 0.09706234931945801
Memory occpied: (5072.0, 7702.0)
Time for forward pass: 0.9690084457397461
Time for backpropagation: 0.01116037368774414
GPU memory for training: 4.842941761016846                          

One training iteration takes: 1.7972538471221924 seconds
Index: 6
Memory occpied: (5072.0, 7702.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 3.305231809616089 seconds
Streaming imagenet data took 3.446237802505493 seconds
Then, training+dataloading take 3.4678544998168945 seconds

Epoch: 0
Time of next(dataloader) is: 0.6022863388061523
Time for copying to cuda: 0.09786224365234375
Time for forward pass: 0.9200847148895264
Time for backpropagation: 0.011235952377319336
GPU memory for training: 4.842941761016846                          

Memory occpied: (5072.0, 7702.0)
The whole process took 42.25366258621216 seconds
