Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10456.973904360124 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1370616483.5922902 1370616483.5922902
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 25
Intermediate:  3.0625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 9796.08837890625 10704.48486328125 31807.80712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 7
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.169944286346436 seconds
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 16.462562561035156 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.114922523498535
Time for copying to cuda: 0.778376579284668
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.823535919189453 seconds
Time for forward pass: 12.896981716156006
Time for backpropagation: 0.054024457931518555
GPU memory for training: 22.27123260498047                          

Memory occpied: (1840.0, 3.0)
One training iteration takes: 16.239662885665894 seconds
Index: 0
Streaming imagenet data took 16.289288997650146 seconds
Then, training+dataloading take 16.42648959159851 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (6396.0, 8062.0)
Memory occpied: (6396.0, 8062.0)
Time of next(dataloader) is: 2.132718801498413
Time for copying to cuda: 0.7790791988372803
Memory occpied: (12990.0, 8062.0)
Time for forward pass: 0.9156718254089355
Time for backpropagation: 0.003590822219848633
GPU memory for training: 14.903350830078125                          

One training iteration takes: 4.257037162780762 seconds
Index: 1
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.138369798660278 seconds
Memory occpied: (11148.0, 8070.0)
Streaming imagenet data took 16.42030096054077 seconds
Then, training+dataloading take 16.489619731903076 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Time of next(dataloader) is: 2.1369967460632324
Memory occpied: (11148.0, 8070.0)
Time for copying to cuda: 0.856003999710083
Time for forward pass: 0.8682041168212891
Time for backpropagation: 0.003263235092163086
GPU memory for training: 14.903350830078125                          

One training iteration takes: 4.280384063720703 seconds
Index: 2
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.923642873764038 seconds
Memory occpied: (11148.0, 8070.0)
Streaming imagenet data took 16.205535888671875 seconds
Then, training+dataloading take 16.25802445411682 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.220817804336548
Time for copying to cuda: 0.7677788734436035
Time for forward pass: 0.8730564117431641
Time for backpropagation: 0.0032651424407958984
GPU memory for training: 14.903350830078125                          

Memory occpied: (11148.0, 8070.0)
One training iteration takes: 4.262063264846802 seconds
Index: 3
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.540583372116089 seconds
Memory occpied: (11148.0, 8070.0)
Streaming imagenet data took 16.73938488960266 seconds
Then, training+dataloading take 16.874748945236206 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Time of next(dataloader) is: 2.2633469104766846
Memory occpied: (11148.0, 8070.0)
Time for copying to cuda: 0.8731575012207031
Time for forward pass: 0.8389737606048584
Time for backpropagation: 0.003663301467895508
GPU memory for training: 14.903350830078125                          

One training iteration takes: 4.4104344844818115 seconds
Index: 4
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.606879234313965 seconds
Memory occpied: (11148.0, 8070.0)
Streaming imagenet data took 15.921106815338135 seconds
Then, training+dataloading take 16.042690753936768 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Time of next(dataloader) is: 2.200767755508423
Memory occpied: (11148.0, 8070.0)
Time for copying to cuda: 0.8711040019989014
Time for forward pass: 0.8523778915405273
Time for backpropagation: 0.0036687850952148438
GPU memory for training: 14.903350830078125                          

Memory occpied: (11148.0, 8070.0)
One training iteration takes: 4.339939117431641 seconds
Index: 5
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.919432640075684 seconds
Memory occpied: (11148.0, 8070.0)
Streaming imagenet data took 16.227208375930786 seconds
Then, training+dataloading take 16.361887216567993 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.202420473098755
Time for copying to cuda: 0.7715044021606445
Time for forward pass: 0.8307280540466309
Time for backpropagation: 0.003262758255004883
GPU memory for training: 14.903350830078125                          

Memory occpied: (11148.0, 8070.0)
One training iteration takes: 4.263719081878662 seconds
Index: 6
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Memory occpied: (11148.0, 8070.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.048261165618896 seconds
Memory occpied: (11148.0, 8070.0)
Streaming imagenet data took 16.337420225143433 seconds
Then, training+dataloading take 16.4382643699646 seconds

Epoch: 0
Time of next(dataloader) is: 2.227341890335083
Time for copying to cuda: 0.7759783267974854
Time for forward pass: 0.852942943572998
Time for backpropagation: 0.0030879974365234375
GPU memory for training: 14.903350830078125                          

Memory occpied: (11148.0, 8070.0)
The whole process took 144.33045887947083 seconds
