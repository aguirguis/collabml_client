Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9992.09562677166 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1309683957.992215 1309683957.992215
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 36
Intermediate:  3.0625
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 16438.86474609375 17388.47509765625 38450.58349609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 5
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 15.12562108039856 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 16.30860733985901 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.096046209335327
Time for copying to cuda: 0.7724072933197021
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 14.806045532226562 seconds
Streaming imagenet data took 15.940787076950073 seconds
Time for forward pass: 23.79102349281311
Time for backpropagation: 0.050515174865722656
GPU memory for training: 23.57125186920166                          

Memory occpied: (1894.0, 3.0)
One training iteration takes: 27.095661401748657 seconds
Index: 0
Then, training+dataloading take 27.102203607559204 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (7990.0, 14550.0)
Memory occpied: (7990.0, 14550.0)
Time of next(dataloader) is: 2.1238865852355957
Time for copying to cuda: 0.7704286575317383
Memory occpied: (14118.0, 14558.0)
Memory occpied: (11200.0, 14558.0)
Time for forward pass: 2.322984457015991
Time for backpropagation: 0.005601644515991211
GPU memory for training: 20.98159885406494                          

One training iteration takes: 5.630520820617676 seconds
Index: 1
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 15.620887756347656 seconds
Memory occpied: (11210.0, 14558.0)
Streaming imagenet data took 16.92337203025818 seconds
Then, training+dataloading take 17.09302520751953 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (11210.0, 14558.0)
Memory occpied: (11210.0, 14558.0)
Time of next(dataloader) is: 2.2420663833618164
Memory occpied: (11210.0, 14558.0)
Time for copying to cuda: 0.8645937442779541
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Time for forward pass: 2.3069205284118652
Time for backpropagation: 0.004217624664306641
GPU memory for training: 20.98159885406494                          

One training iteration takes: 5.816744089126587 seconds
Index: 2
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 15.14029598236084 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 16.339343070983887 seconds
Then, training+dataloading take 16.48290181159973 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.208024501800537
Time for copying to cuda: 0.7726879119873047
Time for forward pass: 2.325345754623413
Time for backpropagation: 0.004540443420410156
GPU memory for training: 20.98159885406494                          

Memory occpied: (14274.0, 14558.0)
One training iteration takes: 5.7657387256622314 seconds
Index: 3
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 15.079898595809937 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 16.37010645866394 seconds
Then, training+dataloading take 16.550801277160645 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2778429985046387
Time for copying to cuda: 0.7670528888702393
Time for forward pass: 2.303116798400879
Time for backpropagation: 0.004264354705810547
GPU memory for training: 20.98159885406494                          

Memory occpied: (14274.0, 14558.0)
One training iteration takes: 5.760948657989502 seconds
Index: 4
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 15.333485841751099 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 16.525259256362915 seconds
Then, training+dataloading take 16.66182255744934 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.215749979019165
Time for copying to cuda: 0.7717220783233643
Time for forward pass: 2.32024884223938
Time for backpropagation: 0.003983736038208008
GPU memory for training: 20.98159885406494                          

One training iteration takes: 5.758254289627075 seconds
Index: 5
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 15.665991067886353 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 16.86542820930481 seconds
Then, training+dataloading take 16.997977256774902 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.271066188812256
Time for copying to cuda: 0.778632640838623
Time for forward pass: 2.315166473388672
Time for backpropagation: 0.004122734069824219
GPU memory for training: 20.98159885406494                          

Memory occpied: (14274.0, 14558.0)
One training iteration takes: 5.772337436676025 seconds
Index: 6
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Memory occpied: (14274.0, 14558.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 15.49202013015747 seconds
Memory occpied: (14274.0, 14558.0)
Streaming imagenet data took 16.721941232681274 seconds
Then, training+dataloading take 16.859679460525513 seconds

Epoch: 0
Time of next(dataloader) is: 2.259718179702759
Time for copying to cuda: 0.7763586044311523
Time for forward pass: 2.2875583171844482
Time for backpropagation: 0.0040204524993896484
GPU memory for training: 20.98159885406494                          

Memory occpied: (14274.0, 14558.0)
The whole process took 158.59097576141357 seconds
