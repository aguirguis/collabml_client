Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=17, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10110.103014125138 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03 3.07200e+03 3.07200e+03
 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1325151422.26741 1325151422.26741
All candidates indexes:  (array([15, 16, 17, 18]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 17 17
Intermediate:  0.0029296875
17.314453125
Total layers size  104.47354125976562
Server, client, server+client, vanilla  616.4482421875 346.64794921875 963.09619140625 18232.39013671875
Fixed, scale_with_bsz  0 17.888671875
Mem usage  1654.0 3.0
Using split index: 17
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Length of received data: 3106526
Read 2.962614059448242 MBs for this batch
Executing all posts took 12.570752143859863 seconds
Streaming imagenet data took 12.572728633880615 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3277451992034912
Time for copying to cuda: 0.0011334419250488281
Time for forward pass: 2.931244373321533
Time for backpropagation: 0.07405853271484375
GPU memory for training: 1.3331236839294434                          

One training iteration takes: 3.4228694438934326 seconds
Index: 0
Memory occpied: (1654.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Length of received data: 3106526
Read 2.962614059448242 MBs for this batch
Executing all posts took 12.486112594604492 seconds
Streaming imagenet data took 12.4877450466156 seconds
Then, training+dataloading take 12.488209247589111 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31624507904052734
Time for copying to cuda: 0.0011036396026611328
Time for forward pass: 0.03395986557006836
Time for backpropagation: 0.00896143913269043
GPU memory for training: 1.349365234375                          

One training iteration takes: 0.4450199604034424 seconds
Index: 1
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Length of received data: 3106526
Read 2.962614059448242 MBs for this batch
Executing all posts took 12.566948175430298 seconds
Memory occpied: (2422.0, 1680.0)
Streaming imagenet data took 12.568979501724243 seconds
Then, training+dataloading take 12.569411039352417 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33524107933044434
Time for copying to cuda: 0.0011141300201416016
Time for forward pass: 0.033925533294677734
Time for backpropagation: 0.007876873016357422
GPU memory for training: 1.349365234375                          

One training iteration takes: 0.4609794616699219 seconds
Index: 2
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Length of received data: 3106526
Read 2.962614059448242 MBs for this batch
Executing all posts took 12.659857034683228 seconds
Streaming imagenet data took 12.661407947540283 seconds
Then, training+dataloading take 12.661869287490845 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3137838840484619
Time for copying to cuda: 0.0011210441589355469
Time for forward pass: 0.05166006088256836
Time for backpropagation: 0.008457422256469727
GPU memory for training: 1.349365234375                          

One training iteration takes: 0.4714350700378418 seconds
Index: 3
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Length of received data: 3106526
Read 2.962614059448242 MBs for this batch
Executing all posts took 12.765361785888672 seconds
Streaming imagenet data took 12.766920566558838 seconds
Then, training+dataloading take 12.76736855506897 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3229193687438965
Time for copying to cuda: 0.0011360645294189453
Time for forward pass: 0.03397941589355469
Time for backpropagation: 0.0080413818359375
GPU memory for training: 1.349365234375                          

One training iteration takes: 0.44899845123291016 seconds
Index: 4
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Length of received data: 3106526
Read 2.962614059448242 MBs for this batch
Executing all posts took 12.827095985412598 seconds
Streaming imagenet data took 12.82986330986023 seconds
Then, training+dataloading take 12.830527544021606 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3645753860473633
Time for copying to cuda: 0.0010941028594970703
Time for forward pass: 0.03394341468811035
Time for backpropagation: 0.007807493209838867
GPU memory for training: 1.349365234375                          

Memory occpied: (2422.0, 1680.0)
One training iteration takes: 0.48049402236938477 seconds
Index: 5
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Length of received data: 3106526
Read 2.962614059448242 MBs for this batch
Executing all posts took 12.872429370880127 seconds
Streaming imagenet data took 12.87405514717102 seconds
Then, training+dataloading take 12.874587297439575 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32018566131591797
Time for copying to cuda: 0.0010869503021240234
Time for forward pass: 0.03383159637451172
Time for backpropagation: 0.007854938507080078
GPU memory for training: 1.349365234375                          

One training iteration takes: 0.4412689208984375 seconds
Index: 6
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Length of received data: 3106526
Read 2.962614059448242 MBs for this batch
Executing all posts took 12.921491146087646 seconds
Streaming imagenet data took 12.923049211502075 seconds
Then, training+dataloading take 12.923501968383789 seconds

Epoch: 0
Time of next(dataloader) is: 0.3153507709503174
Time for copying to cuda: 0.0011093616485595703
Time for forward pass: 0.033865928649902344
Time for backpropagation: 0.007812976837158203
GPU memory for training: 1.349365234375                          

The whole process took 109.72137498855591 seconds
