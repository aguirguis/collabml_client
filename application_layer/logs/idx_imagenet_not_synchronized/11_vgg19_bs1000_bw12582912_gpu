Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=11, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9998.919039064609 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1310578316.2882764 1310578316.2882764
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 11 36
Intermediate:  3.0625
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 10313.86474609375 11263.47509765625 32325.58349609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 11
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 16.9548921585083 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 18.159382581710815 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Time of next(dataloader) is: 2.138288736343384
Memory occpied: (4958.0, 3.0)
Time for copying to cuda: 0.8490889072418213
Memory occpied: (4958.0, 1948.0)
Memory occpied: (4958.0, 2412.0)
Memory occpied: (13966.0, 11950.0)
Memory occpied: (13966.0, 11950.0)
Memory occpied: (13966.0, 11950.0)
Memory occpied: (13512.0, 11950.0)
Memory occpied: (13512.0, 11950.0)
Memory occpied: (13512.0, 11950.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 16.878741025924683 seconds
Memory occpied: (13512.0, 11950.0)
Streaming imagenet data took 18.16749930381775 seconds
Memory occpied: (6454.0, 11958.0)
Time for forward pass: 15.491410970687866
Time for backpropagation: 0.05014491081237793
GPU memory for training: 22.35250186920166                          

One training iteration takes: 18.93575382232666 seconds
Index: 0
Then, training+dataloading take 18.94328737258911 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (6458.0, 11958.0)
Memory occpied: (6458.0, 11958.0)
Time of next(dataloader) is: 2.1436548233032227
Time for copying to cuda: 0.7747204303741455
Memory occpied: (12786.0, 11966.0)
Memory occpied: (13872.0, 11966.0)
Time for forward pass: 1.6901707649230957
Time for backpropagation: 0.005265474319458008
GPU memory for training: 17.14627170562744                          

One training iteration takes: 5.032552719116211 seconds
Index: 1
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 17.55496597290039 seconds
Memory occpied: (13874.0, 11966.0)
Streaming imagenet data took 18.85854196548462 seconds
Then, training+dataloading take 19.028596878051758 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2754886150360107
Time for copying to cuda: 0.7749161720275879
Time for forward pass: 1.656705379486084
Time for backpropagation: 0.004118442535400391
GPU memory for training: 17.14529514312744                          

Memory occpied: (13874.0, 11966.0)
One training iteration takes: 5.123372793197632 seconds
Index: 2
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 16.796410083770752 seconds
Memory occpied: (13874.0, 11966.0)
Streaming imagenet data took 18.07866072654724 seconds
Then, training+dataloading take 18.216740608215332 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.286407709121704
Time for copying to cuda: 0.7685933113098145
Time for forward pass: 1.6825001239776611
Time for backpropagation: 0.0040433406829833984
GPU memory for training: 17.14529514312744                          

Memory occpied: (13874.0, 11966.0)
One training iteration takes: 5.159977912902832 seconds
Index: 3
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 16.67019248008728 seconds
Memory occpied: (13874.0, 11966.0)
Streaming imagenet data took 17.950840950012207 seconds
Then, training+dataloading take 18.084240198135376 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2619049549102783
Time for copying to cuda: 0.7707159519195557
Time for forward pass: 1.692974328994751
Time for backpropagation: 0.0040607452392578125
GPU memory for training: 17.14529514312744                          

One training iteration takes: 5.206238031387329 seconds
Index: 4
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 16.697400093078613 seconds
Memory occpied: (13874.0, 11966.0)
Streaming imagenet data took 17.89957284927368 seconds
Then, training+dataloading take 18.034265279769897 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2397735118865967
Time for copying to cuda: 0.773383378982544
Time for forward pass: 1.693018913269043
Time for backpropagation: 0.0040738582611083984
GPU memory for training: 17.14529514312744                          

Memory occpied: (13874.0, 11966.0)
One training iteration takes: 5.174864768981934 seconds
Index: 5
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 16.74089813232422 seconds
Memory occpied: (13874.0, 11966.0)
Streaming imagenet data took 18.056355476379395 seconds
Then, training+dataloading take 18.242157220840454 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.241830825805664
Time for copying to cuda: 0.777498722076416
Time for forward pass: 1.6684446334838867
Time for backpropagation: 0.004099845886230469
GPU memory for training: 17.14529514312744                          

Memory occpied: (13874.0, 11966.0)
One training iteration takes: 5.163819789886475 seconds
Index: 6
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Memory occpied: (13874.0, 11966.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 16.812050342559814 seconds
Memory occpied: (13874.0, 11966.0)
Streaming imagenet data took 18.047979831695557 seconds
Then, training+dataloading take 18.179924964904785 seconds

Epoch: 0
Time of next(dataloader) is: 2.3022801876068115
Time for copying to cuda: 0.769282341003418
Time for forward pass: 1.6681509017944336
Time for backpropagation: 0.0040285587310791016
GPU memory for training: 17.14529514312744                          

Memory occpied: (13874.0, 11966.0)
The whole process took 160.8401300907135 seconds
