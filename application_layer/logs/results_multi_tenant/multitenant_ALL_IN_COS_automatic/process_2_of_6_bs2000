Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (2189.0, 3.0)
Memory occpied: (2567.0, 3.0)
Memory occpied: (2985.0, 3.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (2985.0, 3.0)
Streaming imagenet data took 4.429935932159424 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (2985.0, 3.0)
Time of next(dataloader) is: 1.012836217880249
Time for copying to cuda: 0.29668331146240234
Memory occpied: (4135.0, 838.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (5285.0, 2527.0)
Streaming imagenet data took 4.237734079360962 seconds
Memory occpied: (10381.0, 8425.0)
Memory occpied: (10227.0, 13121.0)
Memory occpied: (11873.0, 14005.0)
Time for forward pass: 7.167516469955444
Time for backpropagation: 0.1532764434814453
GPU memory for training: 12.220680236816406                          

One training iteration takes: 8.83357286453247 seconds
Index: 0
Then, training+dataloading take 8.836196422576904 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.2150838375091553
Time for copying to cuda: 0.30342578887939453
Time for forward pass: 0.014330625534057617
Time for backpropagation: 0.002897977828979492
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.7415802478790283 seconds
Index: 1
Memory occpied: (9495.0, 14021.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (9889.0, 14029.0)
Streaming imagenet data took 4.249462366104126 seconds
Then, training+dataloading take 4.338400602340698 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.1852631568908691
Time for copying to cuda: 0.29640984535217285
Time for forward pass: 0.006395816802978516
Time for backpropagation: 0.0029909610748291016
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.7641558647155762 seconds
Index: 2
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.1091673374176025 seconds
Then, training+dataloading take 4.214223146438599 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.1598179340362549
Time for copying to cuda: 0.3123328685760498
Time for forward pass: 0.00760960578918457
Time for backpropagation: 0.0028166770935058594
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.7444908618927002 seconds
Index: 3
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.231730937957764 seconds
Then, training+dataloading take 4.32446813583374 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.2168371677398682
Time for copying to cuda: 0.3064873218536377
Time for forward pass: 0.0064394474029541016
Time for backpropagation: 0.0029425621032714844
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8130362033843994 seconds
Index: 4
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.257860422134399 seconds
Then, training+dataloading take 4.356329441070557 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.1770009994506836
Time for copying to cuda: 0.30164027214050293
Time for forward pass: 0.006325721740722656
Time for backpropagation: 0.002841472625732422
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.7697148323059082 seconds
Index: 5
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.306984186172485 seconds
Then, training+dataloading take 4.36814546585083 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.2853593826293945
Time for copying to cuda: 0.30002617835998535
Time for forward pass: 0.0066072940826416016
Time for backpropagation: 0.002763509750366211
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8884201049804688 seconds
Index: 6
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.145563125610352 seconds
Then, training+dataloading take 4.205279350280762 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.2678241729736328
Time for copying to cuda: 0.32189416885375977
Time for forward pass: 0.0064373016357421875
Time for backpropagation: 0.0027332305908203125
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.9130938053131104 seconds
Index: 7
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.319211721420288 seconds
Then, training+dataloading take 4.425417184829712 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.2154583930969238
Time for copying to cuda: 0.3020198345184326
Time for forward pass: 0.006310939788818359
Time for backpropagation: 0.0028197765350341797
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.7885782718658447 seconds
Index: 8
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.279493093490601 seconds
Then, training+dataloading take 4.344784498214722 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.288541316986084
Time for copying to cuda: 0.317699670791626
Time for forward pass: 0.006443500518798828
Time for backpropagation: 0.0029261112213134766
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.915187120437622 seconds
Index: 9
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.2611308097839355 seconds
Then, training+dataloading take 4.322932958602905 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.2919282913208008
Time for copying to cuda: 0.3032066822052002
Time for forward pass: 0.00635075569152832
Time for backpropagation: 0.003381967544555664
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.9066777229309082 seconds
Index: 10
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.3389458656311035 seconds
Then, training+dataloading take 4.40098237991333 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Read 183.76415348052979 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 1.259519100189209 seconds
Time of next(dataloader) is: 1.2843337059020996
Time for copying to cuda: 0.31013989448547363
Time for forward pass: 0.005744457244873047
Time for backpropagation: 0.0027379989624023438
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8957703113555908 seconds
Index: 11
Then, training+dataloading take 1.8985073566436768 seconds

Epoch: 0
Time of next(dataloader) is: 0.605248212814331
Time for copying to cuda: 0.052459001541137695
Time for forward pass: 0.4773571491241455
Time for backpropagation: 0.0028100013732910156
GPU memory for training: 2.6385855674743652                          

Memory occpied: (12973.0, 9107.0)
The whole process took 66.68728971481323seconds