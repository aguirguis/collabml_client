Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (2073.0, 3.0)
Memory occpied: (2509.0, 3.0)
Memory occpied: (2985.0, 3.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (2985.0, 3.0)
Streaming imagenet data took 4.257419109344482 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (2985.0, 3.0)
Time of next(dataloader) is: 1.094820261001587
Time for copying to cuda: 0.29847168922424316
Memory occpied: (4135.0, 902.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (5285.0, 2401.0)
Streaming imagenet data took 4.527635097503662 seconds
Memory occpied: (10381.0, 8221.0)
Memory occpied: (10227.0, 12911.0)
Time for forward pass: 6.805598020553589
Memory occpied: (10227.0, 8735.0)
Time for backpropagation: 0.09181094169616699
GPU memory for training: 12.220680236816406                          

One training iteration takes: 8.533054828643799 seconds
Index: 0
Then, training+dataloading take 8.535822868347168 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (10987.0, 15013.0)
Time of next(dataloader) is: 1.2421832084655762
Time for copying to cuda: 0.2998363971710205
Time for forward pass: 0.013576269149780273
Time for backpropagation: 0.002687215805053711
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.8472816944122314 seconds
Index: 1
Memory occpied: (14071.0, 14281.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (9889.0, 14289.0)
Streaming imagenet data took 4.428875684738159 seconds
Then, training+dataloading take 4.510164260864258 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.351773977279663
Time for copying to cuda: 0.2979435920715332
Time for forward pass: 0.006162405014038086
Time for backpropagation: 0.0028076171875
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.997413158416748 seconds
Index: 2
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.401249170303345 seconds
Then, training+dataloading take 4.478734493255615 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.4569509029388428
Time for copying to cuda: 0.3403477668762207
Time for forward pass: 0.008433818817138672
Time for backpropagation: 0.003014802932739258
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 2.168851852416992 seconds
Index: 3
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.505335807800293 seconds
Then, training+dataloading take 4.616860628128052 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.369452953338623
Time for copying to cuda: 0.3031306266784668
Time for forward pass: 0.0060253143310546875
Time for backpropagation: 0.00262451171875
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.9762146472930908 seconds
Index: 4
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.497527360916138 seconds
Then, training+dataloading take 4.562883138656616 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.357151746749878
Time for copying to cuda: 0.2974050045013428
Time for forward pass: 0.006159067153930664
Time for backpropagation: 0.002833127975463867
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.9858059883117676 seconds
Index: 5
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.2745201587677 seconds
Then, training+dataloading take 4.335221290588379 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.4330940246582031
Time for copying to cuda: 0.33490943908691406
Time for forward pass: 0.0061419010162353516
Time for backpropagation: 0.002820253372192383
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 2.1168415546417236 seconds
Index: 6
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.414975166320801 seconds
Then, training+dataloading take 4.478439092636108 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.3465313911437988
Time for copying to cuda: 0.30537962913513184
Time for forward pass: 0.0061643123626708984
Time for backpropagation: 0.0028138160705566406
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 2.0005106925964355 seconds
Index: 7
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.378545045852661 seconds
Then, training+dataloading take 4.439468860626221 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.4210524559020996
Time for copying to cuda: 0.3211092948913574
Time for forward pass: 0.006255626678466797
Time for backpropagation: 0.0028429031372070312
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 2.086747646331787 seconds
Index: 8
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.4795966148376465 seconds
Then, training+dataloading take 4.552743911743164 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.5093839168548584
Time for copying to cuda: 0.30350303649902344
Time for forward pass: 0.006044626235961914
Time for backpropagation: 0.002745389938354492
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 2.1769001483917236 seconds
Index: 9
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.29532790184021 seconds
Then, training+dataloading take 4.356343030929565 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.447798728942871
Time for copying to cuda: 0.3069584369659424
Time for forward pass: 0.0062520503997802734
Time for backpropagation: 0.002697467803955078
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 2.105656862258911 seconds
Index: 10
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.510263681411743 seconds
Then, training+dataloading take 4.573254108428955 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Read 183.76415348052979 MBs for this batch
Streaming imagenet data took 1.3343093395233154 seconds
Time of next(dataloader) is: 1.4173686504364014
Time for copying to cuda: 0.30318689346313477
Time for forward pass: 0.005766868591308594
Time for backpropagation: 0.002857208251953125
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 2.0493435859680176 seconds
Index: 11
Then, training+dataloading take 2.0518970489501953 seconds

Epoch: 0
Time of next(dataloader) is: 0.6910603046417236
Time for copying to cuda: 0.052805423736572266
Time for forward pass: 0.48224973678588867
Time for backpropagation: 0.0035741329193115234
GPU memory for training: 2.6385855674743652                          

Memory occpied: (12973.0, 9367.0)
The whole process took 273.70302391052246seconds