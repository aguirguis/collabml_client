Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (2515.0, 3.0)
Memory occpied: (2985.0, 3.0)
Memory occpied: (2985.0, 3.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (2985.0, 3.0)
Streaming imagenet data took 4.134098768234253 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (2985.0, 3.0)
Time of next(dataloader) is: 1.0176563262939453
Time for copying to cuda: 0.31711316108703613
Memory occpied: (5285.0, 900.0)
Memory occpied: (5285.0, 2309.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (5285.0, 3131.0)
Streaming imagenet data took 4.704442501068115 seconds
Memory occpied: (14677.0, 13219.0)
Memory occpied: (10227.0, 10555.0)
Memory occpied: (10235.0, 12761.0)
Memory occpied: (6045.0, 12761.0)
Time for forward pass: 8.439638137817383
Time for backpropagation: 0.15469837188720703
GPU memory for training: 12.220680236816406                          

One training iteration takes: 10.140642642974854 seconds
Index: 0
Then, training+dataloading take 10.143228769302368 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (6045.0, 12777.0)
Time of next(dataloader) is: 1.1617457866668701
Time for copying to cuda: 0.2979164123535156
Time for forward pass: 0.015478134155273438
Time for backpropagation: 0.003614664077758789
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.7481424808502197 seconds
Index: 1
Memory occpied: (9129.0, 7020.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (6488.0, 7020.0)
Streaming imagenet data took 4.227959156036377 seconds
Then, training+dataloading take 4.308285474777222 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (7065.0, 7020.0)
Time of next(dataloader) is: 1.2039411067962646
Time for copying to cuda: 0.2930450439453125
Time for forward pass: 0.006083488464355469
Time for backpropagation: 0.0027208328247070312
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.784423828125 seconds
Index: 2
Memory occpied: (7459.0, 7020.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (7979.0, 7020.0)
Streaming imagenet data took 4.408963680267334 seconds
Then, training+dataloading take 4.467482089996338 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (7979.0, 7020.0)
Time of next(dataloader) is: 1.2251131534576416
Time for copying to cuda: 0.2998664379119873
Time for forward pass: 0.008210420608520508
Time for backpropagation: 0.0035800933837890625
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8265256881713867 seconds
Index: 3
Memory occpied: (7979.0, 7020.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (7979.0, 7020.0)
Streaming imagenet data took 4.018072128295898 seconds
Then, training+dataloading take 4.114711284637451 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (9129.0, 7917.0)
Time of next(dataloader) is: 1.205634593963623
Time for copying to cuda: 0.3050870895385742
Time for forward pass: 0.006777524948120117
Time for backpropagation: 0.0035881996154785156
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.7950592041015625 seconds
Index: 4
Memory occpied: (9129.0, 8245.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (9129.0, 9831.0)
Streaming imagenet data took 4.346983909606934 seconds
Then, training+dataloading take 4.392998933792114 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (14071.0, 14281.0)
Time of next(dataloader) is: 1.2146499156951904
Time for copying to cuda: 0.2955055236816406
Time for forward pass: 0.00586700439453125
Time for backpropagation: 0.002607107162475586
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.7980976104736328 seconds
Index: 5
Memory occpied: (14071.0, 14281.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (9889.0, 14289.0)
Streaming imagenet data took 4.2479088306427 seconds
Then, training+dataloading take 4.308175802230835 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.3333141803741455
Time for copying to cuda: 0.30324292182922363
Time for forward pass: 0.006597757339477539
Time for backpropagation: 0.002707958221435547
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.9303135871887207 seconds
Index: 6
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.445978879928589 seconds
Then, training+dataloading take 4.558568239212036 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.2150087356567383
Time for copying to cuda: 0.3075244426727295
Time for forward pass: 0.0062410831451416016
Time for backpropagation: 0.003473997116088867
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.7930243015289307 seconds
Index: 7
Memory occpied: (12973.0, 14297.0)
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.680377960205078 seconds
Then, training+dataloading take 4.78547215461731 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.368241310119629
Time for copying to cuda: 0.305828332901001
Time for forward pass: 0.0060918331146240234
Time for backpropagation: 0.0026597976684570312
GPU memory for training: 6.32977294921875                          

Memory occpied: (12973.0, 14297.0)
One training iteration takes: 1.9635233879089355 seconds
Index: 8
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.38219141960144 seconds
Then, training+dataloading take 4.413419723510742 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.3581411838531494
Time for copying to cuda: 0.3059353828430176
Time for forward pass: 0.00622248649597168
Time for backpropagation: 0.0028073787689208984
GPU memory for training: 6.32977294921875                          

Memory occpied: (12973.0, 14297.0)
One training iteration takes: 2.0015132427215576 seconds
Index: 9
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.077008485794067 seconds
Then, training+dataloading take 4.1360838413238525 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.358565092086792
Time for copying to cuda: 0.30724191665649414
Time for forward pass: 0.00613713264465332
Time for backpropagation: 0.0027523040771484375
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8890008926391602 seconds
Index: 10
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.180143117904663 seconds
Then, training+dataloading take 4.24132227897644 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Read 183.76415348052979 MBs for this batch
Streaming imagenet data took 1.2557868957519531 seconds
Time of next(dataloader) is: 1.322037696838379
Time for copying to cuda: 0.3153958320617676
Time for forward pass: 0.0058553218841552734
Time for backpropagation: 0.00284576416015625
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.938807725906372 seconds
Index: 11
Then, training+dataloading take 1.9415786266326904 seconds

Epoch: 0
Time of next(dataloader) is: 0.6919143199920654
Time for copying to cuda: 0.05215334892272949
Time for forward pass: 0.4885728359222412
Time for backpropagation: 0.0027184486389160156
GPU memory for training: 2.6385855674743652                          

Memory occpied: (12973.0, 9367.0)
The whole process took 69.36766171455383seconds