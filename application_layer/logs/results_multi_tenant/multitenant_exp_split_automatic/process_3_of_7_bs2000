Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 896.0864782360309 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 117451846.87535304 117451846.87535304
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.086970567703247 seconds
Streaming imagenet data took 2.1143736839294434 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3015451431274414
Time for copying to cuda: 0.018608808517456055
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.624467372894287 seconds
Streaming imagenet data took 2.6525840759277344 seconds
Time for forward pass: 3.0783302783966064
Time for backpropagation: 0.048552751541137695
GPU memory for training: 1.102445125579834                          

Memory occpied: (1514.0, 3.0)
One training iteration takes: 3.5025386810302734 seconds
Index: 0
Then, training+dataloading take 3.5027589797973633 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.25478029251098633
Time for copying to cuda: 0.017941951751708984
Time for forward pass: 0.06875395774841309
Time for backpropagation: 0.0034399032592773438
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4105823040008545 seconds
Index: 1
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.080707788467407 seconds
Streaming imagenet data took 4.107528448104858 seconds
Then, training+dataloading take 4.110851287841797 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.27043962478637695
Time for copying to cuda: 0.01777958869934082
Time for forward pass: 0.07635283470153809
Time for backpropagation: 0.0030694007873535156
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4327409267425537 seconds
Index: 2
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2539.0, 1632.0)
Memory occpied: (2901.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 6.513103485107422 seconds
Streaming imagenet data took 6.540631055831909 seconds
Then, training+dataloading take 6.5447165966033936 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2801976203918457
Time for copying to cuda: 0.018177270889282227
Time for forward pass: 0.08223128318786621
Time for backpropagation: 0.002779722213745117
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4587271213531494 seconds
Index: 3
Memory occpied: (3287.0, 1632.0)
Memory occpied: (3817.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 5.123001575469971 seconds
Streaming imagenet data took 5.150610446929932 seconds
Then, training+dataloading take 5.154031753540039 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32668495178222656
Time for copying to cuda: 0.018041610717773438
Time for forward pass: 0.07526063919067383
Time for backpropagation: 0.002505064010620117
GPU memory for training: 1.2580008506774902                          

Memory occpied: (3837.0, 1632.0)
One training iteration takes: 0.4892289638519287 seconds
Index: 4
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3909.0, 2063.0)
Memory occpied: (3909.0, 2467.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 5.139523506164551 seconds
Streaming imagenet data took 5.16669774055481 seconds
Then, training+dataloading take 5.169662714004517 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.281404972076416
Time for copying to cuda: 0.01842665672302246
Time for forward pass: 0.08517026901245117
Time for backpropagation: 0.0027844905853271484
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.45882153511047363 seconds
Index: 5
Memory occpied: (3909.0, 2879.0)
Memory occpied: (4423.0, 3253.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.609763860702515 seconds
Streaming imagenet data took 4.637346506118774 seconds
Then, training+dataloading take 4.6414570808410645 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.27435779571533203
Time for copying to cuda: 0.01804637908935547
Time for forward pass: 0.07533669471740723
Time for backpropagation: 0.002626657485961914
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4360640048980713 seconds
Index: 6
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.779744625091553 seconds
Streaming imagenet data took 4.807483434677124 seconds
Then, training+dataloading take 4.8104941844940186 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2810325622558594
Time for copying to cuda: 0.02023768424987793
Time for forward pass: 0.0755777359008789
Time for backpropagation: 0.0027184486389160156
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.45911693572998047 seconds
Index: 7
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 11.780193567276001 seconds
Streaming imagenet data took 11.811751365661621 seconds
Then, training+dataloading take 11.818626880645752 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2766718864440918
Time for copying to cuda: 0.018236875534057617
Time for forward pass: 0.09813785552978516
Time for backpropagation: 0.003184795379638672
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.46814870834350586 seconds
Index: 8
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.333808422088623 seconds
Streaming imagenet data took 12.361926078796387 seconds
Then, training+dataloading take 12.366002082824707 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.27487754821777344
Time for copying to cuda: 0.01830577850341797
Time for forward pass: 0.07521200180053711
Time for backpropagation: 0.0025665760040283203
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.44390249252319336 seconds
Index: 9
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 13.896847009658813 seconds
Streaming imagenet data took 13.92430305480957 seconds
Then, training+dataloading take 13.928195238113403 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.276125431060791
Time for copying to cuda: 0.018254756927490234
Time for forward pass: 0.07536768913269043
Time for backpropagation: 0.002613067626953125
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4409298896789551 seconds
Index: 10
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.7984390258789062 seconds
Streaming imagenet data took 2.8257086277008057 seconds
Then, training+dataloading take 2.8282017707824707 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30174851417541504
Time for copying to cuda: 0.017917394638061523
Time for forward pass: 0.06688594818115234
Time for backpropagation: 0.0025644302368164062
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4732367992401123 seconds
Index: 11
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 11.263076782226562 MBs for this batch
Executing all posts took 4.506741046905518 seconds
Streaming imagenet data took 4.5116002559661865 seconds
Then, training+dataloading take 4.512248754501343 seconds

Epoch: 0
Time of next(dataloader) is: 0.23395776748657227
Time for copying to cuda: 0.0031235218048095703
Time for forward pass: 0.032396554946899414
Time for backpropagation: 0.0025463104248046875
GPU memory for training: 1.0984325408935547                          

The whole process took 88.39557218551636 seconds
