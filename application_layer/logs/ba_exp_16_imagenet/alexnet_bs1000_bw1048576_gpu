Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3082268578445 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119053775.9107114 119053775.9107114
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 440.30517578125 706.58251953125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  266.27734375 440.30517578125 706.58251953125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6707484722137451 seconds
Streaming imagenet data took 1.6848602294921875 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30420565605163574
Time for copying to cuda: 0.01005697250366211
Memory occpied: (1550.0, 230.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4916939735412598 seconds
Streaming imagenet data took 1.5058684349060059 seconds
Memory occpied: (1550.0, 670.0)
Memory occpied: (1550.0, 1142.0)
Time for forward pass: 3.204693555831909
Time for backpropagation: 0.04923677444458008
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.630385160446167 seconds
Index: 0
Then, training+dataloading take 3.630638360977173 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3195321559906006
Time for copying to cuda: 0.009452342987060547
Time for forward pass: 0.049663543701171875
Time for backpropagation: 0.0032858848571777344
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.46134090423583984 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5679032802581787 seconds
Streaming imagenet data took 1.5820786952972412 seconds
Then, training+dataloading take 1.5843520164489746 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.375152587890625
Time for copying to cuda: 0.00948476791381836
Time for forward pass: 0.04936480522155762
Time for backpropagation: 0.0026977062225341797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5343286991119385 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.460188627243042 seconds
Streaming imagenet data took 1.4739189147949219 seconds
Then, training+dataloading take 1.4762325286865234 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3742196559906006
Time for copying to cuda: 0.009421825408935547
Time for forward pass: 0.04937148094177246
Time for backpropagation: 0.0026090145111083984
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.536200761795044 seconds
Index: 3
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.479947805404663 seconds
Streaming imagenet data took 1.4940896034240723 seconds
Then, training+dataloading take 1.4963607788085938 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37334775924682617
Time for copying to cuda: 0.009332418441772461
Time for forward pass: 0.04921555519104004
Time for backpropagation: 0.002716064453125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5564432144165039 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.454009771347046 seconds
Streaming imagenet data took 1.4678962230682373 seconds
Then, training+dataloading take 1.4702129364013672 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.433840274810791
Time for copying to cuda: 0.009389400482177734
Time for forward pass: 0.04936408996582031
Time for backpropagation: 0.0025556087493896484
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5780618190765381 seconds
Index: 5
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4480974674224854 seconds
Streaming imagenet data took 1.461921215057373 seconds
Then, training+dataloading take 1.4641942977905273 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3787214756011963
Time for copying to cuda: 0.009372472763061523
Time for forward pass: 0.04923820495605469
Time for backpropagation: 0.0025625228881835938
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5401675701141357 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4672267436981201 seconds
Streaming imagenet data took 1.480928659439087 seconds
Then, training+dataloading take 1.483184814453125 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37470269203186035
Time for copying to cuda: 0.009252071380615234
Time for forward pass: 0.0492100715637207
Time for backpropagation: 0.0027298927307128906
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5364706516265869 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.470367431640625 seconds
Streaming imagenet data took 1.484117031097412 seconds
Then, training+dataloading take 1.4863829612731934 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3751392364501953
Time for copying to cuda: 0.00930643081665039
Time for forward pass: 0.049245357513427734
Time for backpropagation: 0.0025539398193359375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.533350944519043 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4528026580810547 seconds
Streaming imagenet data took 1.466503620147705 seconds
Then, training+dataloading take 1.468841791152954 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39403271675109863
Time for copying to cuda: 0.009445428848266602
Time for forward pass: 0.04919886589050293
Time for backpropagation: 0.0025713443756103516
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5654566287994385 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4500164985656738 seconds
Streaming imagenet data took 1.463984727859497 seconds
Then, training+dataloading take 1.466270923614502 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37141895294189453
Time for copying to cuda: 0.009395360946655273
Time for forward pass: 0.04926586151123047
Time for backpropagation: 0.002590179443359375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5542943477630615 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4730536937713623 seconds
Streaming imagenet data took 1.4873318672180176 seconds
Then, training+dataloading take 1.4880690574645996 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40325093269348145
Time for copying to cuda: 0.009357452392578125
Time for forward pass: 0.04954791069030762
Memory occpied: (2290.0, 1578.0)
Time for backpropagation: 0.002860546112060547
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5509436130523682 seconds
Index: 11
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4584543704986572 seconds
Streaming imagenet data took 1.5108485221862793 seconds
Then, training+dataloading take 1.5151782035827637 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.37108564376831055
Time for copying to cuda: 0.009475231170654297
Time for forward pass: 0.04941415786743164
Time for backpropagation: 0.0027587413787841797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5144507884979248 seconds
Index: 12
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5217843055725098 seconds
Memory occpied: (2290.0, 1578.0)
Streaming imagenet data took 1.5361266136169434 seconds
Then, training+dataloading take 1.538666009902954 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35824155807495117
Time for copying to cuda: 0.009429931640625
Time for forward pass: 0.049330949783325195
Time for backpropagation: 0.0026671886444091797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5155308246612549 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4419879913330078 seconds
Streaming imagenet data took 1.4559862613677979 seconds
Then, training+dataloading take 1.456810474395752 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3587827682495117
Time for copying to cuda: 0.009412765502929688
Time for forward pass: 0.049318790435791016
Time for backpropagation: 0.002701997756958008
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.506274938583374 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.512519359588623 seconds
Streaming imagenet data took 1.5266671180725098 seconds
Then, training+dataloading take 1.5291082859039307 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3663311004638672
Time for copying to cuda: 0.009256601333618164
Time for forward pass: 0.07192540168762207
Time for backpropagation: 0.0031633377075195312
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.559868335723877 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4914805889129639 seconds
Streaming imagenet data took 1.5053348541259766 seconds
Then, training+dataloading take 1.5077075958251953 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37363600730895996
Time for copying to cuda: 0.009328603744506836
Time for forward pass: 0.04934191703796387
Time for backpropagation: 0.002773761749267578
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5364291667938232 seconds
Index: 16
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4846858978271484 seconds
Streaming imagenet data took 1.4988179206848145 seconds
Then, training+dataloading take 1.50124192237854 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3827211856842041
Time for copying to cuda: 0.009350776672363281
Time for forward pass: 0.049260854721069336
Time for backpropagation: 0.0026357173919677734
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5583534240722656 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4618902206420898 seconds
Streaming imagenet data took 1.4757931232452393 seconds
Then, training+dataloading take 1.478191614151001 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3784506320953369
Time for copying to cuda: 0.009330034255981445
Time for forward pass: 0.04916644096374512
Time for backpropagation: 0.00272369384765625
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5592021942138672 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5215559005737305 seconds
Streaming imagenet data took 1.5354013442993164 seconds
Then, training+dataloading take 1.5378525257110596 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37843990325927734
Time for copying to cuda: 0.009403705596923828
Time for forward pass: 0.04936861991882324
Time for backpropagation: 0.002684354782104492
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5383608341217041 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4247093200683594 seconds
Streaming imagenet data took 1.4386370182037354 seconds
Then, training+dataloading take 1.4393894672393799 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3768274784088135
Time for copying to cuda: 0.0094451904296875
Time for forward pass: 0.04924154281616211
Time for backpropagation: 0.0026252269744873047
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5366950035095215 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4556162357330322 seconds
Streaming imagenet data took 1.4695615768432617 seconds
Then, training+dataloading take 1.4718906879425049 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3773159980773926
Time for copying to cuda: 0.009498834609985352
Time for forward pass: 0.049243927001953125
Time for backpropagation: 0.0026051998138427734
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.537550687789917 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4451868534088135 seconds
Streaming imagenet data took 1.459177017211914 seconds
Then, training+dataloading take 1.4616038799285889 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3770415782928467
Time for copying to cuda: 0.009353160858154297
Time for forward pass: 0.04937863349914551
Time for backpropagation: 0.0026254653930664062
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.555809497833252 seconds
Index: 22
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.46159029006958 seconds
Streaming imagenet data took 1.4753086566925049 seconds
Then, training+dataloading take 1.4777352809906006 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38185739517211914
Time for copying to cuda: 0.00947260856628418
Time for forward pass: 0.04931235313415527
Time for backpropagation: 0.002595663070678711
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.544816255569458 seconds
Index: 23
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.437403678894043 seconds
Streaming imagenet data took 1.4516026973724365 seconds
Then, training+dataloading take 1.4523627758026123 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37729430198669434
Time for copying to cuda: 0.009505987167358398
Time for forward pass: 0.04939866065979004
Time for backpropagation: 0.0027132034301757812
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5611965656280518 seconds
Index: 24
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4753198623657227 seconds
Streaming imagenet data took 1.489743709564209 seconds
Then, training+dataloading take 1.4921538829803467 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37711334228515625
Time for copying to cuda: 0.009451150894165039
Time for forward pass: 0.04937887191772461
Time for backpropagation: 0.0026662349700927734
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5591006278991699 seconds
Index: 25
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4343135356903076 seconds
Streaming imagenet data took 1.448211431503296 seconds
Then, training+dataloading take 1.449037790298462 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37650156021118164
Time for copying to cuda: 0.009472370147705078
Time for forward pass: 0.04952549934387207
Time for backpropagation: 0.0026979446411132812
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5389955043792725 seconds
Index: 26
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.491344690322876 seconds
Streaming imagenet data took 1.5053496360778809 seconds
Then, training+dataloading take 1.5076873302459717 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3798801898956299
Time for copying to cuda: 0.009392023086547852
Time for forward pass: 0.04932045936584473
Time for backpropagation: 0.0028994083404541016
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5682237148284912 seconds
Index: 27
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.489475965499878 seconds
Streaming imagenet data took 1.5032060146331787 seconds
Then, training+dataloading take 1.5056464672088623 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3799161911010742
Time for copying to cuda: 0.009458303451538086
Time for forward pass: 0.049416303634643555
Time for backpropagation: 0.0026292800903320312
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5452160835266113 seconds
Index: 28
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.447160005569458 seconds
Streaming imagenet data took 1.4611213207244873 seconds
Then, training+dataloading take 1.463515281677246 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38919973373413086
Time for copying to cuda: 0.009399652481079102
Time for forward pass: 0.0493011474609375
Time for backpropagation: 0.002696990966796875
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5757396221160889 seconds
Index: 29
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.449077844619751 seconds
Streaming imagenet data took 1.4630539417266846 seconds
Then, training+dataloading take 1.465453863143921 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37349414825439453
Time for copying to cuda: 0.009494304656982422
Time for forward pass: 0.049279212951660156
Time for backpropagation: 0.0026700496673583984
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.536393404006958 seconds
Index: 30
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4656240940093994 seconds
Streaming imagenet data took 1.4798147678375244 seconds
Then, training+dataloading take 1.480576992034912 seconds

Epoch: 0
Time of next(dataloader) is: 0.43005871772766113
Time for copying to cuda: 0.00940561294555664
Time for forward pass: 0.0495150089263916
Time for backpropagation: 0.0025963783264160156
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
The whole process took 57.88052558898926 seconds
