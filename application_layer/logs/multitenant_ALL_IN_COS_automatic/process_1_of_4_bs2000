Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (2985.0, 3.0)
Memory occpied: (2985.0, 3.0)
Memory occpied: (2985.0, 3.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (2985.0, 3.0)
Streaming imagenet data took 4.450730323791504 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (4135.0, 904.0)
Time of next(dataloader) is: 1.042463779449463
Time for copying to cuda: 0.3121058940887451
Memory occpied: (5285.0, 2181.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (5285.0, 8497.0)
Streaming imagenet data took 4.39096736907959 seconds
Memory occpied: (10227.0, 13213.0)
Memory occpied: (13315.0, 14005.0)
Memory occpied: (8393.0, 14013.0)
Memory occpied: (9863.0, 14013.0)
Time for forward pass: 8.123798131942749
Time for backpropagation: 0.10468125343322754
GPU memory for training: 10.34604024887085                          

One training iteration takes: 9.841536521911621 seconds
Index: 0
Then, training+dataloading take 9.844443321228027 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.3092925548553467
Time for copying to cuda: 0.3051891326904297
Time for forward pass: 0.015310525894165039
Time for backpropagation: 0.002730131149291992
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8565289974212646 seconds
Index: 1
Memory occpied: (9889.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.233212232589722 seconds
Then, training+dataloading take 4.34204363822937 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.2401552200317383
Time for copying to cuda: 0.3047513961791992
Time for forward pass: 0.006284952163696289
Time for backpropagation: 0.002685546875
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.824760913848877 seconds
Index: 2
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.037869930267334 seconds
Then, training+dataloading take 4.098997354507446 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.340414047241211
Time for copying to cuda: 0.2988126277923584
Time for forward pass: 0.007691144943237305
Time for backpropagation: 0.002735614776611328
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.9395301342010498 seconds
Index: 3
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.278528213500977 seconds
Then, training+dataloading take 4.342968225479126 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.2874622344970703
Time for copying to cuda: 0.30327343940734863
Time for forward pass: 0.006489753723144531
Time for backpropagation: 0.0029294490814208984
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8751063346862793 seconds
Index: 4
Memory occpied: (12973.0, 14037.0)
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.535455942153931 seconds
Then, training+dataloading take 4.599362134933472 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.2891523838043213
Time for copying to cuda: 0.30450987815856934
Time for forward pass: 0.006047248840332031
Time for backpropagation: 0.002844095230102539
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.894618034362793 seconds
Index: 5
Memory occpied: (12973.0, 14037.0)
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.450910806655884 seconds
Then, training+dataloading take 4.523542165756226 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.3672266006469727
Time for copying to cuda: 0.30852818489074707
Time for forward pass: 0.00665283203125
Time for backpropagation: 0.0026216506958007812
GPU memory for training: 6.32977294921875                          

Memory occpied: (12973.0, 14037.0)
One training iteration takes: 1.9836091995239258 seconds
Index: 6
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.251359939575195 seconds
Then, training+dataloading take 4.3156492710113525 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.1962499618530273
Time for copying to cuda: 0.2996349334716797
Time for forward pass: 0.0062122344970703125
Time for backpropagation: 0.0026247501373291016
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8195738792419434 seconds
Index: 7
Memory occpied: (12973.0, 14037.0)
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.416072130203247 seconds
Then, training+dataloading take 4.4733006954193115 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.3635356426239014
Time for copying to cuda: 0.3054349422454834
Time for forward pass: 0.006313323974609375
Time for backpropagation: 0.0032167434692382812
GPU memory for training: 6.32977294921875                          

Memory occpied: (12973.0, 14037.0)
One training iteration takes: 1.943819522857666 seconds
Index: 8
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.179786682128906 seconds
Then, training+dataloading take 4.237356185913086 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.20947265625
Time for copying to cuda: 0.3023059368133545
Time for forward pass: 0.006184101104736328
Time for backpropagation: 0.0027294158935546875
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8130927085876465 seconds
Index: 9
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.349071025848389 seconds
Then, training+dataloading take 4.404623031616211 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14037.0)
Time of next(dataloader) is: 1.2690553665161133
Time for copying to cuda: 0.307297945022583
Time for forward pass: 0.006335258483886719
Time for backpropagation: 0.0027081966400146484
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8947820663452148 seconds
Index: 10
Memory occpied: (12973.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14037.0)
Streaming imagenet data took 4.20993447303772 seconds
Then, training+dataloading take 4.279005765914917 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Memory occpied: (9487.0, 10681.0)
Read 183.76415348052979 MBs for this batch
Streaming imagenet data took 1.185260534286499 seconds
Time of next(dataloader) is: 1.262047290802002
Time for copying to cuda: 0.30638837814331055
Time for forward pass: 0.005784273147583008
Time for backpropagation: 0.002688169479370117
GPU memory for training: 6.32977294921875                          

One training iteration takes: 1.8859803676605225 seconds
Index: 11
Then, training+dataloading take 1.8888304233551025 seconds

Epoch: 0
Time of next(dataloader) is: 0.6240851879119873
Memory occpied: (6488.0, 7020.0)
Time for copying to cuda: 0.051661014556884766
Time for forward pass: 0.4953019618988037
Time for backpropagation: 0.002847909927368164
GPU memory for training: 2.6385855674743652                          

The whole process took 69.07559299468994 seconds