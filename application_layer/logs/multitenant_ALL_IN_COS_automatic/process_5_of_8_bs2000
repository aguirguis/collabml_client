Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (2221.0, 3.0)
Memory occpied: (2641.0, 3.0)
Memory occpied: (2985.0, 3.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (2985.0, 3.0)
Streaming imagenet data took 4.308726072311401 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (2985.0, 3.0)
Time of next(dataloader) is: 1.1063895225524902
Time for copying to cuda: 0.3026905059814453
Memory occpied: (4135.0, 884.0)
Memory occpied: (5285.0, 2075.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.377483367919922 seconds
Memory occpied: (5285.0, 2895.0)
Memory occpied: (14677.0, 13015.0)
Memory occpied: (10227.0, 14005.0)
Memory occpied: (12575.0, 14005.0)
Time for forward pass: 7.7636048793792725
Time for backpropagation: 0.18288707733154297
GPU memory for training: 12.220680236816406                          

One training iteration takes: 9.561453819274902 seconds
Index: 0
Then, training+dataloading take 9.564168453216553 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (12561.0, 14013.0)
Time of next(dataloader) is: 1.3031566143035889
Time for copying to cuda: 0.2971365451812744
Time for forward pass: 0.013231515884399414
Time for backpropagation: 0.0027747154235839844
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.9149110317230225 seconds
Index: 1
Memory occpied: (9889.0, 14029.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.341707229614258 seconds
Then, training+dataloading take 4.419183731079102 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.2787060737609863
Time for copying to cuda: 0.2965884208679199
Time for forward pass: 0.006468296051025391
Time for backpropagation: 0.0027103424072265625
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.9024298191070557 seconds
Index: 2
Memory occpied: (12883.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.351600646972656 seconds
Then, training+dataloading take 4.43544602394104 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.2456095218658447
Time for copying to cuda: 0.30516910552978516
Time for forward pass: 0.007775306701660156
Time for backpropagation: 0.0027196407318115234
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.858276605606079 seconds
Index: 3
Memory occpied: (12883.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.317090272903442 seconds
Then, training+dataloading take 4.369165420532227 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.3207194805145264
Time for copying to cuda: 0.30991077423095703
Time for forward pass: 0.006502628326416016
Time for backpropagation: 0.002749204635620117
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.9474797248840332 seconds
Index: 4
Memory occpied: (12883.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.178805351257324 seconds
Then, training+dataloading take 4.230832099914551 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.3165948390960693
Time for copying to cuda: 0.3099939823150635
Time for forward pass: 0.0063800811767578125
Time for backpropagation: 0.0027112960815429688
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.9663889408111572 seconds
Index: 5
Memory occpied: (12883.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.472017765045166 seconds
Then, training+dataloading take 4.527395725250244 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.3015594482421875
Time for copying to cuda: 0.3113820552825928
Time for forward pass: 0.006206989288330078
Time for backpropagation: 0.0027000904083251953
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.9619941711425781 seconds
Index: 6
Memory occpied: (12883.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.354216814041138 seconds
Then, training+dataloading take 4.409728765487671 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.329899549484253
Time for copying to cuda: 0.30671024322509766
Time for forward pass: 0.006354808807373047
Time for backpropagation: 0.0030722618103027344
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.9712460041046143 seconds
Index: 7
Memory occpied: (12883.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.403254985809326 seconds
Then, training+dataloading take 4.4585864543914795 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.294325590133667
Time for copying to cuda: 0.31106996536254883
Time for forward pass: 0.0062944889068603516
Time for backpropagation: 0.002717733383178711
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.990396499633789 seconds
Index: 8
Memory occpied: (12883.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.389374017715454 seconds
Then, training+dataloading take 4.446671724319458 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.402425765991211
Time for copying to cuda: 0.30846405029296875
Time for forward pass: 0.006227254867553711
Time for backpropagation: 0.003581523895263672
GPU memory for training: 6.712249755859375                          

One training iteration takes: 2.084608793258667 seconds
Index: 9
Memory occpied: (12883.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.395271062850952 seconds
Then, training+dataloading take 4.445469856262207 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.3343517780303955
Time for copying to cuda: 0.3065354824066162
Time for forward pass: 0.006535768508911133
Time for backpropagation: 0.0028312206268310547
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.998490333557129 seconds
Index: 10
Memory occpied: (12883.0, 14037.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12883.0, 14037.0)
Streaming imagenet data took 4.430752992630005 seconds
Then, training+dataloading take 4.52702784538269 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Read 183.76415348052979 MBs for this batch
Streaming imagenet data took 1.1724653244018555 seconds
Memory occpied: (12883.0, 14037.0)
Time of next(dataloader) is: 1.2389349937438965
Time for copying to cuda: 0.308565616607666
Time for forward pass: 0.012258052825927734
Time for backpropagation: 0.0027022361755371094
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.8755812644958496 seconds
Index: 11
Then, training+dataloading take 1.878417730331421 seconds

Epoch: 0
Time of next(dataloader) is: 0.6634316444396973
Time for copying to cuda: 0.050698041915893555
Memory occpied: (12883.0, 14037.0)
Time for forward pass: 0.4857652187347412
Time for backpropagation: 0.002810239791870117
GPU memory for training: 2.6385855674743652                          

The whole process took 205.58826732635498 seconds