Namespace(batch_size=4000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, manual_split=False, model='myvgg19', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.2855256674147 Mbps
[1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
133802.66666666666
548.0470275878906 119.18229166666667
Using split index: 36
Freezing the lower layers of the model (myvgg19) till index 36
Start 0, end 4000, post_step 1000

Memory occpied: (6348.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7026.0, 3.0)
Memory occpied: (7122.0, 515.0)
Memory occpied: (7122.0, 1335.0)
Memory occpied: (7122.0, 2215.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8004.0, 2893.0)
Memory occpied: (8388.0, 3304.0)
Memory occpied: (8388.0, 3678.0)
Memory occpied: (11470.0, 14054.0)
Memory occpied: (11436.0, 14054.0)
Memory occpied: (14280.0, 14030.0)
Memory occpied: (11444.0, 14030.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Memory occpied: (11446.0, 4230.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 114.04081964492798 seconds
Memory occpied: (11446.0, 4230.0)
Streaming imagenet data took 114.70757675170898 seconds
Start 4000, end 8000, post_step 1000


Epoch: 0
Control connection MSS 1448
Memory occpied: (11446.0, 4230.0)
Time of next(dataloader) is: 1.2402679920196533
Time for copying to cuda: 0.3926205635070801
Memory occpied: (12980.0, 4365.0)
Memory occpied: (12980.0, 4783.0)
Memory occpied: (12980.0, 5177.0)
Time for forward pass: 3.476222276687622
Time for backpropagation: 0.0073130130767822266
GPU memory for training: 5.1193528175354                          

One training iteration takes: 5.347771167755127 seconds
Index: 0
Memory occpied: (14602.0, 7251.0)
Memory occpied: (14602.0, 7251.0)
Memory occpied: (14602.0, 7251.0)
Memory occpied: (14602.0, 7251.0)
Memory occpied: (14828.0, 7522.0)
Memory occpied: (14828.0, 7938.0)
Memory occpied: (14828.0, 8318.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14836.0, 8440.0)
Memory occpied: (14864.0, 8448.0)
Memory occpied: (14864.0, 8448.0)
Memory occpied: (14864.0, 8448.0)
Memory occpied: (14864.0, 8448.0)
Memory occpied: (14864.0, 8448.0)
Memory occpied: (14864.0, 8448.0)
Memory occpied: (14864.0, 8448.0)
Memory occpied: (14872.0, 11006.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Memory occpied: (14880.0, 11014.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 142.75026559829712 seconds
Memory occpied: (14880.0, 11014.0)
Streaming imagenet data took 143.37794756889343 seconds
Then, training+dataloading take 143.436354637146 seconds
Start 8000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (14880.0, 11014.0)
Time of next(dataloader) is: 1.3018701076507568
Time for copying to cuda: 0.38837504386901855
Memory occpied: (14854.0, 11022.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/root/swift_playground/application_layer/models/myvgg.py", line 39, in forward
    x = m(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/pooling.py", line 162, in forward
    return F.max_pool2d(input, self.kernel_size, self.stride,
  File "/usr/local/lib/python3.8/dist-packages/torch/_jit_internal.py", line 422, in fn
    return if_false(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/functional.py", line 719, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
RuntimeError: CUDA out of memory. Tried to allocate 384.00 MiB (GPU 0; 14.76 GiB total capacity; 3.14 GiB already allocated; 255.75 MiB free; 3.60 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

The whole process took 268.07291650772095 seconds
Read 1531.4297523498535 MBs for this batch
Executing all posts took 83.38200449943542 seconds
Streaming imagenet data took 83.94775676727295 seconds
