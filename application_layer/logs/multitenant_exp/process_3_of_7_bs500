Namespace(batch_size=500, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, manual_split=False, model='myresnet50', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.2855256674147 Mbps
[3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
133802.66666666666
97.49234008789062 110.86393229166667
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
Start 0, end 500, post_step 500

Memory occpied: (5823.0, 3.0)
Memory occpied: (6783.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8233.0, 112.0)
Memory occpied: (8233.0, 568.0)
Read 3.9250173568725586 MBs for this batch
Executing all posts took 17.864543437957764 seconds
Streaming imagenet data took 17.865811586380005 seconds
Start 500, end 1000, post_step 500


Epoch: 0
Control connection MSS 1448
Time of next(dataloader) is: 0.3373866081237793
Time for copying to cuda: 0.0015518665313720703
Memory occpied: (8281.0, 1522.0)
Memory occpied: (8827.0, 4011.0)
Memory occpied: (8827.0, 5215.0)
Time for forward pass: 3.675128698348999
Time for backpropagation: 0.025424480438232422
GPU memory for training: 0.42156171798706055                          

One training iteration takes: 4.13155198097229 seconds
Index: 0
Memory occpied: (11763.0, 9875.0)
Memory occpied: (10101.0, 8615.0)
Memory occpied: (10483.0, 8615.0)
Memory occpied: (10483.0, 8615.0)
Memory occpied: (8576.0, 6252.0)
