Namespace(batch_size=4000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, manual_split=False, model='myresnet50', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.2855256674147 Mbps
[3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
133802.66666666666
97.49234008789062 110.86393229166667
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
Start 0, end 4000, post_step 1000

Memory occpied: (3502.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3734.0, 3.0)
Memory occpied: (3798.0, 148.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 22.21884775161743 seconds
Streaming imagenet data took 22.233193159103394 seconds
Start 4000, end 8000, post_step 1000


Epoch: 0
Control connection MSS 1448
Time of next(dataloader) is: 0.41614508628845215
Time for copying to cuda: 0.009256124496459961
Memory occpied: (3830.0, 673.0)
Memory occpied: (3830.0, 1455.0)
Memory occpied: (4448.0, 2531.0)
Time for forward pass: 3.2455179691314697
Time for backpropagation: 0.021005630493164062
GPU memory for training: 0.4694523811340332                          

One training iteration takes: 3.772155523300171 seconds
Index: 0
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4712.0, 2893.0)
Memory occpied: (4874.0, 2901.0)
Memory occpied: (4874.0, 2901.0)
Memory occpied: (5258.0, 3004.0)
Memory occpied: (5258.0, 3460.0)
Memory occpied: (5258.0, 3862.0)
Memory occpied: (15092.0, 14062.0)
Memory occpied: (15066.0, 14070.0)
Memory occpied: (15066.0, 14038.0)
Memory occpied: (15066.0, 4238.0)
Memory occpied: (15070.0, 4238.0)
Memory occpied: (15070.0, 4238.0)
Memory occpied: (15070.0, 4238.0)
Memory occpied: (15070.0, 4238.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 36.180264711380005 seconds
Streaming imagenet data took 36.19438457489014 seconds
Then, training+dataloading take 36.19658422470093 seconds
Start 8000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47396349906921387
Time for copying to cuda: 0.009130239486694336
Time for forward pass: 0.02598714828491211
Time for backpropagation: 0.007555484771728516
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.6367042064666748 seconds
Index: 1
Memory occpied: (15070.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 4246.0)
Memory occpied: (15098.0, 6804.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 32.73393964767456 seconds
Streaming imagenet data took 32.74830341339111 seconds
Then, training+dataloading take 32.75061774253845 seconds
Start 12000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43537044525146484
Time for copying to cuda: 0.008578062057495117
Time for forward pass: 0.017003536224365234
Time for backpropagation: 0.006592273712158203
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.5611832141876221 seconds
Index: 2
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (15098.0, 6812.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 35.645795822143555 seconds
Streaming imagenet data took 35.659672260284424 seconds
Then, training+dataloading take 35.663222551345825 seconds
Start 16000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4320254325866699
Time for copying to cuda: 0.00904083251953125
Time for forward pass: 0.017673254013061523
Time for backpropagation: 0.00647282600402832
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.5421152114868164 seconds
Index: 3
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 22.781654357910156 seconds
Streaming imagenet data took 22.797189235687256 seconds
Then, training+dataloading take 22.799121856689453 seconds
Start 20000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5677666664123535
Time for copying to cuda: 0.009285926818847656
Time for forward pass: 0.018033504486083984
Time for backpropagation: 0.00677180290222168
GPU memory for training: 0.485931396484375                          

Memory occpied: (3737.0, 2909.0)
One training iteration takes: 0.6967206001281738 seconds
Index: 4
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 28.930264234542847 seconds
Streaming imagenet data took 28.940443754196167 seconds
Then, training+dataloading take 28.94253635406494 seconds
Start 24000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (3737.0, 2909.0)
Time of next(dataloader) is: 0.4359753131866455
Time for copying to cuda: 0.009201288223266602
Time for forward pass: 0.017795085906982422
Time for backpropagation: 0.006548404693603516
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.561326265335083 seconds
Index: 5
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 23.610958576202393 seconds
Memory occpied: (3737.0, 2909.0)
Streaming imagenet data took 23.62541103363037 seconds
Then, training+dataloading take 23.626951694488525 seconds
Start 28000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4578413963317871
Time for copying to cuda: 0.009017229080200195
Time for forward pass: 0.01703953742980957
Time for backpropagation: 0.006661415100097656
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.5864288806915283 seconds
Index: 6
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 22.35533595085144 seconds
Streaming imagenet data took 22.365107774734497 seconds
Then, training+dataloading take 22.366825103759766 seconds
Start 32000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45129919052124023
Time for copying to cuda: 0.009168863296508789
Time for forward pass: 0.05228590965270996
Time for backpropagation: 0.006373882293701172
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.629763126373291 seconds
Index: 7
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 22.452702045440674 seconds
Streaming imagenet data took 22.462168216705322 seconds
Then, training+dataloading take 22.463838577270508 seconds
Start 36000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42052197456359863
Time for copying to cuda: 0.00908970832824707
Time for forward pass: 0.057650089263916016
Time for backpropagation: 0.007108211517333984
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.576819896697998 seconds
Index: 8
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (3737.0, 2909.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 18.75235891342163 seconds
Streaming imagenet data took 18.761852264404297 seconds
Then, training+dataloading take 18.76320481300354 seconds
Start 40000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4426124095916748
Time for copying to cuda: 0.009059906005859375
Time for forward pass: 0.017787933349609375
Time for backpropagation: 0.006506919860839844
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.5903992652893066 seconds
Index: 9
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 17.18712878227234 seconds
Streaming imagenet data took 17.196038722991943 seconds
Then, training+dataloading take 17.197430849075317 seconds
Start 44000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40691328048706055
Time for copying to cuda: 0.009049654006958008
Time for forward pass: 0.017879962921142578
Time for backpropagation: 0.006554126739501953
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.5565764904022217 seconds
Index: 10
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 18.104885578155518 seconds
Streaming imagenet data took 18.114336729049683 seconds
Then, training+dataloading take 18.11644721031189 seconds
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41905856132507324
Time for copying to cuda: 0.00898432731628418
Time for forward pass: 0.017745018005371094
Time for backpropagation: 0.006548404693603516
GPU memory for training: 0.485931396484375                          

One training iteration takes: 0.5281641483306885 seconds
Index: 11
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Memory occpied: (1546.0, 1286.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.727471590042114 seconds
Streaming imagenet data took 12.733884334564209 seconds
Then, training+dataloading take 12.73520827293396 seconds

Epoch: 0
Time of next(dataloader) is: 0.37753772735595703
Time for copying to cuda: 0.004640340805053711
Time for forward pass: 0.016101837158203125
Time for backpropagation: 0.0064351558685302734
GPU memory for training: 0.45395565032958984                          

The whole process took 319.4373559951782 seconds
