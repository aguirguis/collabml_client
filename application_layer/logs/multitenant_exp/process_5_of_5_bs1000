Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, manual_split=False, model='myvgg19', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.2855256674147 Mbps
[1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
133802.66666666666
548.0470275878906 119.18229166666667
Using split index: 36
Freezing the lower layers of the model (myvgg19) till index 36
Start 0, end 1000, post_step 1000

Memory occpied: (6336.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7024.0, 3.0)
Memory occpied: (7156.0, 418.0)
Memory occpied: (7156.0, 1478.0)
Memory occpied: (7312.0, 2908.0)
Memory occpied: (10992.0, 6854.0)
Memory occpied: (14444.0, 7172.0)
Memory occpied: (11232.0, 7104.0)
Memory occpied: (11232.0, 7104.0)
Memory occpied: (11232.0, 7104.0)
Memory occpied: (11232.0, 7104.0)
Memory occpied: (11232.0, 7104.0)
Memory occpied: (11232.0, 7104.0)
Memory occpied: (11232.0, 7104.0)
Memory occpied: (11232.0, 7104.0)
Memory occpied: (11474.0, 7128.0)
Memory occpied: (11502.0, 7136.0)
Memory occpied: (11502.0, 7136.0)
Memory occpied: (11502.0, 7136.0)
Memory occpied: (11598.0, 7525.0)
Memory occpied: (11598.0, 7891.0)
Memory occpied: (11618.0, 8885.0)
Memory occpied: (12830.0, 8885.0)
Memory occpied: (12830.0, 8885.0)
Read 382.8574380874634 MBs for this batch
Executing all posts took 41.60425853729248 seconds
Streaming imagenet data took 41.74540901184082 seconds
Start 1000, end 2000, post_step 1000


Epoch: 0
Control connection MSS 1448
Memory occpied: (12830.0, 8885.0)
Time of next(dataloader) is: 0.5367488861083984
Time for copying to cuda: 0.09983420372009277
Memory occpied: (13214.0, 9304.0)
Memory occpied: (13214.0, 9686.0)
Time for forward pass: 3.2977004051208496
Time for backpropagation: 0.009023666381835938
GPU memory for training: 3.005186080932617                          

One training iteration takes: 4.045466899871826 seconds
Index: 0
Memory occpied: (14844.0, 10900.0)
Memory occpied: (14844.0, 10900.0)
Memory occpied: (14844.0, 10900.0)
Memory occpied: (14844.0, 10900.0)
Memory occpied: (14844.0, 10900.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Memory occpied: (14880.0, 10908.0)
Read 382.8574380874634 MBs for this batch
Executing all posts took 30.821670055389404 seconds
Memory occpied: (14880.0, 10908.0)
Streaming imagenet data took 31.011131286621094 seconds
Then, training+dataloading take 31.035558700561523 seconds
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5297636985778809
Time for copying to cuda: 0.09893059730529785
Time for forward pass: 0.16139507293701172
Exception: CUDA out of memory. Tried to allocate 392.00 MiB (GPU 0; 14.76 GiB total capacity; 2.45 GiB already allocated; 245.75 MiB free; 2.49 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Memory occpied: (14864.0, 10916.0)
The whole process took 81.77586650848389 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 28.13485836982727 seconds
Streaming imagenet data took 28.279432773590088 seconds
