Namespace(batch_size=500, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, manual_split=False, model='myresnet18', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.2855256674147 Mbps
[3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
133802.66666666666
44.591949462890625 26.733072916666668
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
Start 0, end 500, post_step 500

Memory occpied: (5155.0, 3.0)
Memory occpied: (6599.0, 3.0)
Memory occpied: (7657.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8171.0, 3.0)
Memory occpied: (8233.0, 438.0)
Read 47.87408924102783 MBs for this batch
Executing all posts took 18.418410778045654 seconds
Streaming imagenet data took 18.43749976158142 seconds
Start 500, end 1000, post_step 500


Epoch: 0
Control connection MSS 1448
Time of next(dataloader) is: 0.36958909034729004
Time for copying to cuda: 0.014346837997436523
Memory occpied: (8281.0, 1090.0)
Memory occpied: (10479.0, 4755.0)
Memory occpied: (8827.0, 4823.0)
Time for forward pass: 3.7162508964538574
Memory occpied: (11283.0, 10319.0)
Time for backpropagation: 0.5731940269470215
GPU memory for training: 4.525081157684326                          

One training iteration takes: 4.743701696395874 seconds
Index: 0
Memory occpied: (9647.0, 9461.0)
