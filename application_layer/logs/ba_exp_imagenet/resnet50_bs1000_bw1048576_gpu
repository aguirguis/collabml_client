Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.8997789706541 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119000239.82924157 119000239.82924157
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  312.10302734375 113.169921875 425.27294921875 6804.576171875
Candidate split  21
Server, client, server+client, vanilla  312.10302734375 113.169921875 425.27294921875 6804.576171875
Model size  97.72802734375
Fixed, scale_with_bsz  97.72802734375 6.69921875
Mem usage  1410.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.287491798400879 seconds
Streaming imagenet data took 4.2915263175964355 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3047056198120117
Time for copying to cuda: 0.0023665428161621094
Memory occpied: (1410.0, 178.0)
Memory occpied: (1410.0, 618.0)
Memory occpied: (1410.0, 1082.0)
Time for forward pass: 3.1602509021759033
Time for backpropagation: 0.06423807144165039
GPU memory for training: 0.4265751838684082                          

One training iteration takes: 3.587329387664795 seconds
Index: 0
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.85506272315979 seconds
Streaming imagenet data took 3.859412670135498 seconds
Then, training+dataloading take 3.8599252700805664 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3889133930206299
Time for copying to cuda: 0.002389669418334961
Time for forward pass: 0.01437830924987793
Time for backpropagation: 0.0073244571685791016
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.5354974269866943 seconds
Index: 1
Memory occpied: (1632.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.23603081703186 seconds
Memory occpied: (1660.0, 1416.0)
Streaming imagenet data took 4.240130424499512 seconds
Then, training+dataloading take 4.240674257278442 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36060523986816406
Time for copying to cuda: 0.0023648738861083984
Time for forward pass: 0.013607501983642578
Time for backpropagation: 0.00630640983581543
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4609057903289795 seconds
Index: 2
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.223837852478027 seconds
Streaming imagenet data took 4.227880477905273 seconds
Then, training+dataloading take 4.228477716445923 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3357672691345215
Time for copying to cuda: 0.0024704933166503906
Time for forward pass: 0.013527393341064453
Time for backpropagation: 0.006278276443481445
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4503905773162842 seconds
Index: 3
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.256785154342651 seconds
Memory occpied: (1660.0, 1416.0)
Streaming imagenet data took 4.260082960128784 seconds
Then, training+dataloading take 4.260669708251953 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33514928817749023
Time for copying to cuda: 0.002338886260986328
Time for forward pass: 0.013529300689697266
Time for backpropagation: 0.006316423416137695
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4253501892089844 seconds
Index: 4
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.2341601848602295 seconds
Streaming imagenet data took 4.238186836242676 seconds
Then, training+dataloading take 4.238725185394287 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34148287773132324
Time for copying to cuda: 0.0023496150970458984
Time for forward pass: 0.013420343399047852
Time for backpropagation: 0.0062334537506103516
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.44873857498168945 seconds
Index: 5
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.830202579498291 seconds
Streaming imagenet data took 3.833340644836426 seconds
Then, training+dataloading take 3.833911418914795 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.396040678024292
Time for copying to cuda: 0.0024187564849853516
Time for forward pass: 0.013762474060058594
Time for backpropagation: 0.0061414241790771484
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.5347106456756592 seconds
Index: 6
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.237091779708862 seconds
Memory occpied: (1660.0, 1416.0)
Streaming imagenet data took 4.241147041320801 seconds
Then, training+dataloading take 4.241689205169678 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3404722213745117
Time for copying to cuda: 0.0023381710052490234
Time for forward pass: 0.013457775115966797
Time for backpropagation: 0.006255626678466797
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.45056605339050293 seconds
Index: 7
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.206404209136963 seconds
Streaming imagenet data took 4.2094879150390625 seconds
Then, training+dataloading take 4.210027694702148 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33585453033447266
Time for copying to cuda: 0.0023431777954101562
Time for forward pass: 0.013493537902832031
Time for backpropagation: 0.006268739700317383
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.46172213554382324 seconds
Index: 8
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.252240180969238 seconds
Streaming imagenet data took 4.256296396255493 seconds
Then, training+dataloading take 4.25685715675354 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Memory occpied: (1660.0, 1416.0)
Time of next(dataloader) is: 0.34084510803222656
Time for copying to cuda: 0.002321958541870117
Time for forward pass: 0.013509511947631836
Time for backpropagation: 0.0063478946685791016
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4306831359863281 seconds
Index: 9
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.835340738296509 seconds
Streaming imagenet data took 3.8383729457855225 seconds
Then, training+dataloading take 3.838909864425659 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3393244743347168
Time for copying to cuda: 0.0023996829986572266
Time for forward pass: 0.013641119003295898
Time for backpropagation: 0.00632023811340332
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4292185306549072 seconds
Index: 10
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.805091381072998 seconds
Streaming imagenet data took 3.80910587310791 seconds
Then, training+dataloading take 3.809674024581909 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33382344245910645
Time for copying to cuda: 0.0023751258850097656
Time for forward pass: 0.013480901718139648
Time for backpropagation: 0.0062901973724365234
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4247889518737793 seconds
Index: 11
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.186716794967651 seconds
Streaming imagenet data took 4.189809799194336 seconds
Then, training+dataloading take 4.19035792350769 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40888357162475586
Time for copying to cuda: 0.002347707748413086
Time for forward pass: 0.013538360595703125
Time for backpropagation: 0.006281614303588867
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.5491020679473877 seconds
Index: 12
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.228161096572876 seconds
Streaming imagenet data took 4.234789609909058 seconds
Then, training+dataloading take 4.235491514205933 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Time of next(dataloader) is: 0.34367990493774414
Time for copying to cuda: 0.002341032028198242
Time for forward pass: 0.013484716415405273
Time for backpropagation: 0.006448030471801758
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4574911594390869 seconds
Index: 13
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.839329957962036 seconds
Streaming imagenet data took 3.842388868331909 seconds
Then, training+dataloading take 3.84297776222229 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36052560806274414
Time for copying to cuda: 0.0023505687713623047
Time for forward pass: 0.01375126838684082
Time for backpropagation: 0.006289005279541016
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4660980701446533 seconds
Index: 14
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.232652425765991 seconds
Streaming imagenet data took 4.236620187759399 seconds
Then, training+dataloading take 4.237179756164551 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42734336853027344
Time for copying to cuda: 0.002432107925415039
Time for forward pass: 0.013731718063354492
Time for backpropagation: 0.006589174270629883
GPU memory for training: 0.4421114921569824                          

Memory occpied: (1660.0, 1416.0)
One training iteration takes: 0.541724443435669 seconds
Index: 15
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.23047399520874 seconds
Streaming imagenet data took 4.233580589294434 seconds
Then, training+dataloading take 4.234158992767334 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33735084533691406
Time for copying to cuda: 0.0023217201232910156
Time for forward pass: 0.013525962829589844
Time for backpropagation: 0.006280183792114258
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4271068572998047 seconds
Index: 16
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.196570634841919 seconds
Streaming imagenet data took 4.20049786567688 seconds
Then, training+dataloading take 4.201066017150879 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39822912216186523
Time for copying to cuda: 0.0024263858795166016
Time for forward pass: 0.013842105865478516
Time for backpropagation: 0.006650447845458984
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.5265111923217773 seconds
Index: 17
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.822028398513794 seconds
Streaming imagenet data took 3.825120687484741 seconds
Then, training+dataloading take 3.8256449699401855 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38289880752563477
Time for copying to cuda: 0.0023555755615234375
Time for forward pass: 0.013635635375976562
Time for backpropagation: 0.006329536437988281
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.512129545211792 seconds
Index: 18
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.23264217376709 seconds
Streaming imagenet data took 4.236527919769287 seconds
Then, training+dataloading take 4.237051486968994 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36632227897644043
Time for copying to cuda: 0.0023796558380126953
Time for forward pass: 0.013517379760742188
Time for backpropagation: 0.0064525604248046875
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.45575737953186035 seconds
Index: 19
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.212328195571899 seconds
Streaming imagenet data took 4.21540641784668 seconds
Then, training+dataloading take 4.215943813323975 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35952329635620117
Time for copying to cuda: 0.002394437789916992
Time for forward pass: 0.013582229614257812
Time for backpropagation: 0.006529808044433594
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.48395442962646484 seconds
Index: 20
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.250753402709961 seconds
Memory occpied: (1660.0, 1416.0)
Streaming imagenet data took 4.254729270935059 seconds
Then, training+dataloading take 4.255297899246216 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35936641693115234
Time for copying to cuda: 0.0023696422576904297
Time for forward pass: 0.013468265533447266
Time for backpropagation: 0.0063135623931884766
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4606614112854004 seconds
Index: 21
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.188664197921753 seconds
Streaming imagenet data took 4.191716432571411 seconds
Then, training+dataloading take 4.192257404327393 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35404109954833984
Time for copying to cuda: 0.0023636817932128906
Time for forward pass: 0.013499021530151367
Time for backpropagation: 0.006362199783325195
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.47574472427368164 seconds
Index: 22
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.27063512802124 seconds
Streaming imagenet data took 4.274702310562134 seconds
Then, training+dataloading take 4.275277376174927 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Memory occpied: (1660.0, 1416.0)
Time of next(dataloader) is: 0.33551788330078125
Time for copying to cuda: 0.002399444580078125
Time for forward pass: 0.013499736785888672
Time for backpropagation: 0.00628209114074707
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.424206018447876 seconds
Index: 23
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.213083028793335 seconds
Streaming imagenet data took 4.216141223907471 seconds
Then, training+dataloading take 4.216698408126831 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4077942371368408
Time for copying to cuda: 0.0023272037506103516
Time for forward pass: 0.11595416069030762
Time for backpropagation: 0.006861448287963867
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.6332149505615234 seconds
Index: 24
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.8351869583129883 seconds
Streaming imagenet data took 3.839108467102051 seconds
Then, training+dataloading take 3.8396904468536377 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38788366317749023
Time for copying to cuda: 0.0024352073669433594
Time for forward pass: 0.013918876647949219
Time for backpropagation: 0.0066699981689453125
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.5152280330657959 seconds
Index: 25
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.237340211868286 seconds
Memory occpied: (1660.0, 1416.0)
Streaming imagenet data took 4.240450143814087 seconds
Then, training+dataloading take 4.240999937057495 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35396528244018555
Time for copying to cuda: 0.0023839473724365234
Time for forward pass: 0.013602972030639648
Time for backpropagation: 0.0062754154205322266
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4541666507720947 seconds
Index: 26
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.2219884395599365 seconds
Streaming imagenet data took 4.226040840148926 seconds
Then, training+dataloading take 4.226629257202148 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33553075790405273
Time for copying to cuda: 0.0023450851440429688
Time for forward pass: 0.013491392135620117
Time for backpropagation: 0.006284952163696289
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.45299696922302246 seconds
Index: 27
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.2739081382751465 seconds
Memory occpied: (1660.0, 1416.0)
Streaming imagenet data took 4.277235507965088 seconds
Then, training+dataloading take 4.2778191566467285 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35039186477661133
Time for copying to cuda: 0.002361297607421875
Time for forward pass: 0.013660430908203125
Time for backpropagation: 0.0063686370849609375
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.441699743270874 seconds
Index: 28
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.840115785598755 seconds
Streaming imagenet data took 3.844027042388916 seconds
Then, training+dataloading take 3.8445897102355957 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3549015522003174
Time for copying to cuda: 0.0023603439331054688
Time for forward pass: 0.013551950454711914
Time for backpropagation: 0.006382465362548828
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.4445765018463135 seconds
Index: 29
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.255795955657959 seconds
Streaming imagenet data took 4.258830785751343 seconds
Then, training+dataloading take 4.259408712387085 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4563612937927246
Time for copying to cuda: 0.0024476051330566406
Memory occpied: (1660.0, 1416.0)
Time for forward pass: 0.013682365417480469
Time for backpropagation: 0.006323814392089844
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.5582401752471924 seconds
Index: 30
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.268580436706543 seconds
Streaming imagenet data took 4.272548675537109 seconds
Then, training+dataloading take 4.273118495941162 seconds

Epoch: 0
Time of next(dataloader) is: 0.35506129264831543
Time for copying to cuda: 0.0023365020751953125
Time for forward pass: 0.013509750366210938
Time for backpropagation: 0.0062825679779052734
GPU memory for training: 0.4421114921569824                          

The whole process took 139.69224786758423 seconds
