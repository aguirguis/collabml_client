Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.4431860071351 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118940393.27632721 118940393.27632721
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.015625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  1309.583984375 803.7177734375 2113.3017578125 50920.9052734375
Candidate split  23
Server, client, server+client, vanilla  1309.583984375 803.7177734375 2113.3017578125 50920.9052734375
Model size  507.208984375
Fixed, scale_with_bsz  507.208984375 25.07421875
Mem usage  1840.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.681000471115112 seconds
Streaming imagenet data took 5.6939592361450195 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31769490242004395
Time for copying to cuda: 0.00889277458190918
Time for forward pass: 2.9308104515075684
Time for backpropagation: 0.050255775451660156
GPU memory for training: 2.0919079780578613                          

One training iteration takes: 3.402475118637085 seconds
Index: 0
Memory occpied: (1840.0, 1862.0)
Memory occpied: (3058.0, 1862.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.572525262832642 seconds
Streaming imagenet data took 5.5851781368255615 seconds
Then, training+dataloading take 5.586305141448975 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3716745376586914
Time for copying to cuda: 0.008459806442260742
Time for forward pass: 0.06460404396057129
Time for backpropagation: 0.0033121109008789062
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5471489429473877 seconds
Index: 1
Memory occpied: (3058.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.598549842834473 seconds
Streaming imagenet data took 5.611711263656616 seconds
Then, training+dataloading take 5.612797498703003 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3210277557373047
Time for copying to cuda: 0.008437395095825195
Time for forward pass: 0.06420540809631348
Time for backpropagation: 0.0030939579010009766
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.48006272315979004 seconds
Index: 2
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.69350266456604 seconds
Streaming imagenet data took 5.706963062286377 seconds
Then, training+dataloading take 5.710724592208862 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (3460.0, 1870.0)
Time of next(dataloader) is: 0.3262343406677246
Time for copying to cuda: 0.008350849151611328
Time for forward pass: 0.06429243087768555
Time for backpropagation: 0.0030863285064697266
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.4880979061126709 seconds
Index: 3
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.619795322418213 seconds
Streaming imagenet data took 5.628296613693237 seconds
Then, training+dataloading take 5.629513740539551 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3614006042480469
Time for copying to cuda: 0.008495807647705078
Time for forward pass: 0.0641777515411377
Time for backpropagation: 0.003014087677001953
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.556511640548706 seconds
Index: 4
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.655876398086548 seconds
Streaming imagenet data took 5.66917872428894 seconds
Then, training+dataloading take 5.670120000839233 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3258190155029297
Time for copying to cuda: 0.008343935012817383
Time for forward pass: 0.06418657302856445
Time for backpropagation: 0.0030760765075683594
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.4861433506011963 seconds
Index: 5
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.706693410873413 seconds
Memory occpied: (3460.0, 1870.0)
Streaming imagenet data took 5.7153308391571045 seconds
Then, training+dataloading take 5.716460227966309 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3286781311035156
Time for copying to cuda: 0.00857234001159668
Time for forward pass: 0.0642404556274414
Time for backpropagation: 0.003094911575317383
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.48180294036865234 seconds
Index: 6
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.666912794113159 seconds
Streaming imagenet data took 5.68038272857666 seconds
Then, training+dataloading take 5.681324243545532 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36810922622680664
Time for copying to cuda: 0.008469343185424805
Time for forward pass: 0.06431245803833008
Time for backpropagation: 0.0031294822692871094
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5582363605499268 seconds
Index: 7
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.6858720779418945 seconds
Streaming imagenet data took 5.694470167160034 seconds
Then, training+dataloading take 5.6956565380096436 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32710862159729004
Time for copying to cuda: 0.008549690246582031
Time for forward pass: 0.06420302391052246
Time for backpropagation: 0.003100872039794922
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.48653364181518555 seconds
Index: 8
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.730315208435059 seconds
Streaming imagenet data took 5.743751764297485 seconds
Then, training+dataloading take 5.745448589324951 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32690954208374023
Time for copying to cuda: 0.008524179458618164
Time for forward pass: 0.06433606147766113
Time for backpropagation: 0.0031278133392333984
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.48163580894470215 seconds
Index: 9
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.714529275894165 seconds
Streaming imagenet data took 5.761039972305298 seconds
Then, training+dataloading take 5.767697334289551 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (3460.0, 1870.0)
Time of next(dataloader) is: 0.36997032165527344
Time for copying to cuda: 0.008450746536254883
Time for forward pass: 0.06444525718688965
Time for backpropagation: 0.0031785964965820312
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5293412208557129 seconds
Index: 10
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.676287889480591 seconds
Streaming imagenet data took 5.689421653747559 seconds
Then, training+dataloading take 5.690599203109741 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32616233825683594
Time for copying to cuda: 0.008419036865234375
Time for forward pass: 0.08844709396362305
Time for backpropagation: 0.003679037094116211
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5255982875823975 seconds
Index: 11
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.820318937301636 seconds
Streaming imagenet data took 5.8291027545928955 seconds
Then, training+dataloading take 5.830383062362671 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32184934616088867
Time for copying to cuda: 0.008379459381103516
Time for forward pass: 0.06420230865478516
Time for backpropagation: 0.003030061721801758
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.4828307628631592 seconds
Index: 12
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.727117300033569 seconds
Streaming imagenet data took 5.740339040756226 seconds
Then, training+dataloading take 5.741290330886841 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.331376314163208
Time for copying to cuda: 0.008360862731933594
Time for forward pass: 0.06414031982421875
Time for backpropagation: 0.0030794143676757812
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.4877476692199707 seconds
Index: 13
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.767104625701904 seconds
Streaming imagenet data took 5.775563716888428 seconds
Then, training+dataloading take 5.77745246887207 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3277149200439453
Time for copying to cuda: 0.008524656295776367
Time for forward pass: 0.06444454193115234
Time for backpropagation: 0.003182649612426758
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.48165178298950195 seconds
Index: 14
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.750047922134399 seconds
Streaming imagenet data took 5.799895524978638 seconds
Then, training+dataloading take 5.806372880935669 seconds

Epoch: 0
Time of next(dataloader) is: 0.35903167724609375
Time for copying to cuda: 0.008481979370117188
Time for forward pass: 0.06418538093566895
Time for backpropagation: 0.0031583309173583984
GPU memory for training: 2.247260570526123                          

Memory occpied: (3460.0, 1870.0)
The whole process took 100.69607281684875 seconds
