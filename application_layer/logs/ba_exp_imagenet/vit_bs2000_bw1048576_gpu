Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.6527622349731 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03 3.07200e+03 3.07200e+03
 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118967862.8516624 118967862.8516624
All candidates indexes:  (array([15, 16, 17, 18]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.0029296875
17.314453125
Total layers size  104.47354125976562
Server, client, server+client, vanilla  902.6669921875 374.78515625 1277.4521484375 36146.26953125
Candidate split  16
Server, client, server+client, vanilla  902.6669921875 374.78515625 1277.4521484375 36146.26953125
Model size  330.2294921875
Fixed, scale_with_bsz  330.2294921875 17.888671875
Mem usage  1654.0 3.0
Using split index: 16
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.770159482955933 seconds
Streaming imagenet data took 12.773869276046753 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31984496116638184
Time for copying to cuda: 0.0018038749694824219
Time for forward pass: 2.9080655574798584
Time for backpropagation: 0.07586121559143066
GPU memory for training: 1.3407373428344727                          

Memory occpied: (1654.0, 3.0)
One training iteration takes: 3.3594844341278076 seconds
Index: 0
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.778377532958984 seconds
Streaming imagenet data took 12.782686471939087 seconds
Then, training+dataloading take 12.785645723342896 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (2414.0, 1672.0)
Time of next(dataloader) is: 0.34850263595581055
Time for copying to cuda: 0.0018842220306396484
Time for forward pass: 0.03426527976989746
Time for backpropagation: 0.008814096450805664
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4821157455444336 seconds
Index: 1
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.875021696090698 seconds
Streaming imagenet data took 12.878770351409912 seconds
Then, training+dataloading take 12.879552125930786 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31177806854248047
Time for copying to cuda: 0.0018825531005859375
Time for forward pass: 0.06543159484863281
Time for backpropagation: 0.008561372756958008
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4980931282043457 seconds
Index: 2
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.972814798355103 seconds
Streaming imagenet data took 12.975919008255005 seconds
Then, training+dataloading take 12.977181911468506 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31315040588378906
Time for copying to cuda: 0.00185394287109375
Time for forward pass: 0.034235239028930664
Time for backpropagation: 0.008004426956176758
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4427947998046875 seconds
Index: 3
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.000299215316772 seconds
Streaming imagenet data took 13.002993106842041 seconds
Then, training+dataloading take 13.004341840744019 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3112947940826416
Time for copying to cuda: 0.0018420219421386719
Time for forward pass: 0.03431129455566406
Time for backpropagation: 0.007994890213012695
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4393651485443115 seconds
Index: 4
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.061694145202637 seconds
Streaming imagenet data took 13.064786195755005 seconds
Then, training+dataloading take 13.066141605377197 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31186389923095703
Time for copying to cuda: 0.0018663406372070312
Time for forward pass: 0.03419756889343262
Time for backpropagation: 0.008026361465454102
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.44099879264831543 seconds
Index: 5
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.027199745178223 seconds
Streaming imagenet data took 13.029887199401855 seconds
Then, training+dataloading take 13.031264305114746 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3156003952026367
Time for copying to cuda: 0.0018355846405029297
Time for forward pass: 0.03419804573059082
Time for backpropagation: 0.007856607437133789
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4395115375518799 seconds
Index: 6
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.992078304290771 seconds
Streaming imagenet data took 12.998459339141846 seconds
Then, training+dataloading take 12.999488353729248 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (2442.0, 1680.0)
Time of next(dataloader) is: 0.31178879737854004
Time for copying to cuda: 0.0018649101257324219
Time for forward pass: 0.03422713279724121
Time for backpropagation: 0.007905244827270508
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.43450069427490234 seconds
Index: 7
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.844498872756958 seconds
Streaming imagenet data took 12.847175359725952 seconds
Then, training+dataloading take 12.84818410873413 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3569824695587158
Time for copying to cuda: 0.0019276142120361328
Time for forward pass: 0.0345158576965332
Time for backpropagation: 0.008182287216186523
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.5025520324707031 seconds
Index: 8
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.807446956634521 seconds
Streaming imagenet data took 12.810925245285034 seconds
Then, training+dataloading take 12.812319040298462 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30646491050720215
Time for copying to cuda: 0.0018656253814697266
Time for forward pass: 0.03430962562561035
Time for backpropagation: 0.008068561553955078
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.43515777587890625 seconds
Index: 9
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.794939994812012 seconds
Streaming imagenet data took 12.800281763076782 seconds
Then, training+dataloading take 12.803164720535278 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (2442.0, 1680.0)
Time of next(dataloader) is: 0.3328886032104492
Time for copying to cuda: 0.0018854141235351562
Time for forward pass: 0.034351348876953125
Time for backpropagation: 0.008235454559326172
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4545447826385498 seconds
Index: 10
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.752801895141602 seconds
Streaming imagenet data took 12.755571365356445 seconds
Then, training+dataloading take 12.75662112236023 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3906893730163574
Time for copying to cuda: 0.001954793930053711
Time for forward pass: 0.03460359573364258
Time for backpropagation: 0.008142471313476562
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.5505845546722412 seconds
Index: 11
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.744736194610596 seconds
Streaming imagenet data took 12.747745752334595 seconds
Then, training+dataloading take 12.749151229858398 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3153657913208008
Time for copying to cuda: 0.0018780231475830078
Time for forward pass: 0.034265756607055664
Time for backpropagation: 0.008114337921142578
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.44335150718688965 seconds
Index: 12
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.743955612182617 seconds
Streaming imagenet data took 12.74655795097351 seconds
Then, training+dataloading take 12.747336149215698 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39702320098876953
Time for copying to cuda: 0.0018720626831054688
Time for forward pass: 0.034244537353515625
Time for backpropagation: 0.007927179336547852
GPU memory for training: 1.3560242652893066                          

Memory occpied: (2442.0, 1680.0)
One training iteration takes: 0.5270402431488037 seconds
Index: 13
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.741879940032959 seconds
Streaming imagenet data took 12.744879722595215 seconds
Then, training+dataloading take 12.746203899383545 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31402063369750977
Time for copying to cuda: 0.0018510818481445312
Time for forward pass: 0.0341794490814209
Time for backpropagation: 0.008075714111328125
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4475109577178955 seconds
Index: 14
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.838979721069336 seconds
Streaming imagenet data took 12.844682931900024 seconds
Then, training+dataloading take 12.845797538757324 seconds

Epoch: 0
Memory occpied: (2442.0, 1680.0)
Time of next(dataloader) is: 0.3216211795806885
Time for copying to cuda: 0.001870870590209961
Time for forward pass: 0.03418326377868652
Time for backpropagation: 0.008060216903686523
GPU memory for training: 1.3560242652893066                          

The whole process took 214.18416237831116 seconds
