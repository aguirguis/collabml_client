Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3416547164386 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119058157.36699304 119058157.36699304
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  259.0654296875 343.33544921875 602.40087890625 6946.85107421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.767573833465576 seconds
Streaming imagenet data took 2.8034560680389404 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34746289253234863
Time for copying to cuda: 0.02522754669189453
Memory occpied: (1432.0, 308.0)
Memory occpied: (1432.0, 768.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.735414505004883 seconds
Streaming imagenet data took 2.7718334197998047 seconds
Memory occpied: (1432.0, 1170.0)
Time for forward pass: 3.756314754486084
Memory occpied: (7922.0, 7828.0)
Time for backpropagation: 0.7741098403930664
GPU memory for training: 6.8614277839660645                          

One training iteration takes: 4.988065719604492 seconds
Index: 0
Then, training+dataloading take 4.988417863845825 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39703369140625
Time for copying to cuda: 0.02490711212158203
Time for forward pass: 0.032236337661743164
Time for backpropagation: 0.004456520080566406
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.537693977355957 seconds
Index: 1
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.7093143463134766 seconds
Streaming imagenet data took 2.745769739151001 seconds
Then, training+dataloading take 2.7517590522766113 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47561073303222656
Time for copying to cuda: 0.025032520294189453
Memory occpied: (4728.0, 4630.0)
Time for forward pass: 0.04643654823303223
Time for backpropagation: 0.004502058029174805
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6443979740142822 seconds
Index: 2
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6898398399353027 seconds
Streaming imagenet data took 2.7259626388549805 seconds
Then, training+dataloading take 2.7319178581237793 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4452202320098877
Time for copying to cuda: 0.0247957706451416
Time for forward pass: 0.0461578369140625
Time for backpropagation: 0.004459857940673828
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6367237567901611 seconds
Index: 3
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6713707447052 seconds
Streaming imagenet data took 2.7083420753479004 seconds
Then, training+dataloading take 2.7143845558166504 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4896702766418457
Time for copying to cuda: 0.024915456771850586
Time for forward pass: 0.04623842239379883
Time for backpropagation: 0.004450559616088867
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6921000480651855 seconds
Index: 4
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.73171329498291 seconds
Streaming imagenet data took 2.7681450843811035 seconds
Then, training+dataloading take 2.7731735706329346 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4891316890716553
Memory occpied: (4728.0, 4630.0)
Time for copying to cuda: 0.024740934371948242
Time for forward pass: 0.04617047309875488
Time for backpropagation: 0.004385232925415039
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6538336277008057 seconds
Index: 5
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.685436964035034 seconds
Streaming imagenet data took 2.7808711528778076 seconds
Then, training+dataloading take 2.786304473876953 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4515557289123535
Time for copying to cuda: 0.024857044219970703
Time for forward pass: 0.046423912048339844
Time for backpropagation: 0.004556179046630859
GPU memory for training: 1.2606515884399414                          

Memory occpied: (4728.0, 4630.0)
One training iteration takes: 0.606752872467041 seconds
Index: 6
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.64078950881958 seconds
Streaming imagenet data took 2.676656723022461 seconds
Then, training+dataloading take 2.681922435760498 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48163318634033203
Time for copying to cuda: 0.0248110294342041
Time for forward pass: 0.04616999626159668
Time for backpropagation: 0.0043964385986328125
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6848785877227783 seconds
Index: 7
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.713380813598633 seconds
Streaming imagenet data took 2.750596523284912 seconds
Then, training+dataloading take 2.7557246685028076 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45380544662475586
Time for copying to cuda: 0.025086402893066406
Memory occpied: (4728.0, 4630.0)
Time for forward pass: 0.04641842842102051
Time for backpropagation: 0.00449824333190918
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.621497392654419 seconds
Index: 8
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6530351638793945 seconds
Streaming imagenet data took 2.6894023418426514 seconds
Then, training+dataloading take 2.694502115249634 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45360469818115234
Time for copying to cuda: 0.024819612503051758
Time for forward pass: 0.0461733341217041
Time for backpropagation: 0.004651784896850586
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6593015193939209 seconds
Index: 9
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.704115152359009 seconds
Streaming imagenet data took 2.7412919998168945 seconds
Then, training+dataloading take 2.7464776039123535 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46602606773376465
Time for copying to cuda: 0.024914264678955078
Time for forward pass: 0.04632925987243652
Time for backpropagation: 0.004580497741699219
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6742348670959473 seconds
Index: 10
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.7226061820983887 seconds
Streaming imagenet data took 2.7595999240875244 seconds
Then, training+dataloading take 2.764699935913086 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4534933567047119
Time for copying to cuda: 0.028240680694580078
Memory occpied: (4728.0, 4630.0)
Time for forward pass: 0.04683709144592285
Time for backpropagation: 0.004627704620361328
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6138229370117188 seconds
Index: 11
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.645124673843384 seconds
Streaming imagenet data took 2.681678533554077 seconds
Then, training+dataloading take 2.6869068145751953 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4642152786254883
Time for copying to cuda: 0.025361299514770508
Time for forward pass: 0.0462033748626709
Time for backpropagation: 0.004506587982177734
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6539602279663086 seconds
Index: 12
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.729989767074585 seconds
Streaming imagenet data took 2.7670960426330566 seconds
Then, training+dataloading take 2.772260904312134 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47720956802368164
Time for copying to cuda: 0.024830341339111328
Time for forward pass: 0.04613828659057617
Time for backpropagation: 0.004387617111206055
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6774816513061523 seconds
Index: 13
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.7523868083953857 seconds
Streaming imagenet data took 2.788727283477783 seconds
Then, training+dataloading take 2.793915271759033 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.457808256149292
Time for copying to cuda: 0.024618864059448242
Time for forward pass: 0.0461881160736084
Time for backpropagation: 0.004441022872924805
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6608672142028809 seconds
Index: 14
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6783924102783203 seconds
Streaming imagenet data took 2.714317560195923 seconds
Then, training+dataloading take 2.719444513320923 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4707214832305908
Time for copying to cuda: 0.024791240692138672
Time for forward pass: 0.04623150825500488
Time for backpropagation: 0.004498004913330078
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.660059928894043 seconds
Index: 15
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.69952392578125 seconds
Streaming imagenet data took 2.7356464862823486 seconds
Then, training+dataloading take 2.740797996520996 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4514193534851074
Time for copying to cuda: 0.024805307388305664
Time for forward pass: 0.04634213447570801
Time for backpropagation: 0.004523754119873047
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6440017223358154 seconds
Index: 16
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6966753005981445 seconds
Streaming imagenet data took 2.7331957817077637 seconds
Then, training+dataloading take 2.7383170127868652 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4673120975494385
Time for copying to cuda: 0.024936437606811523
Memory occpied: (4728.0, 4630.0)
Time for forward pass: 0.046546220779418945
Time for backpropagation: 0.0046539306640625
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6250348091125488 seconds
Index: 17
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6392886638641357 seconds
Streaming imagenet data took 2.6753451824188232 seconds
Then, training+dataloading take 2.680626153945923 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5162792205810547
Time for copying to cuda: 0.025077342987060547
Time for forward pass: 0.046233415603637695
Time for backpropagation: 0.004475593566894531
GPU memory for training: 1.2606515884399414                          

Memory occpied: (4728.0, 4630.0)
One training iteration takes: 0.6759788990020752 seconds
Index: 18
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.672494888305664 seconds
Streaming imagenet data took 2.709099292755127 seconds
Then, training+dataloading take 2.714259624481201 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4852919578552246
Time for copying to cuda: 0.025110483169555664
Time for forward pass: 0.04626607894897461
Time for backpropagation: 0.004445075988769531
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6735010147094727 seconds
Index: 19
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.680793046951294 seconds
Streaming imagenet data took 2.7181973457336426 seconds
Then, training+dataloading take 2.7234582901000977 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4815995693206787
Time for copying to cuda: 0.025228023529052734
Memory occpied: (4728.0, 4630.0)
Time for forward pass: 0.046434879302978516
Time for backpropagation: 0.004526376724243164
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6462259292602539 seconds
Index: 20
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.631424903869629 seconds
Streaming imagenet data took 2.6688179969787598 seconds
Then, training+dataloading take 2.674067258834839 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5029833316802979
Time for copying to cuda: 0.025206327438354492
Time for forward pass: 0.04631519317626953
Time for backpropagation: 0.004652738571166992
GPU memory for training: 1.2606515884399414                          

Memory occpied: (4728.0, 4630.0)
One training iteration takes: 0.6617610454559326 seconds
Index: 21
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6614832878112793 seconds
Streaming imagenet data took 2.698225975036621 seconds
Then, training+dataloading take 2.703450918197632 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48601555824279785
Time for copying to cuda: 0.025152206420898438
Time for forward pass: 0.04632210731506348
Time for backpropagation: 0.0046389102935791016
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6768167018890381 seconds
Index: 22
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6864566802978516 seconds
Streaming imagenet data took 2.7235286235809326 seconds
Then, training+dataloading take 2.7287256717681885 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4828665256500244
Time for copying to cuda: 0.02472209930419922
Time for forward pass: 0.046349525451660156
Time for backpropagation: 0.004544258117675781
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.7059485912322998 seconds
Index: 23
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.7200798988342285 seconds
Streaming imagenet data took 2.7560877799987793 seconds
Then, training+dataloading take 2.761262893676758 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4579734802246094
Time for copying to cuda: 0.02508234977722168
Time for forward pass: 0.04639148712158203
Time for backpropagation: 0.004598379135131836
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6489708423614502 seconds
Index: 24
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.693547487258911 seconds
Streaming imagenet data took 2.7301814556121826 seconds
Then, training+dataloading take 2.73543381690979 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45249295234680176
Time for copying to cuda: 0.025028467178344727
Time for forward pass: 0.04626965522766113
Time for backpropagation: 0.004563808441162109
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.642998456954956 seconds
Index: 25
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6630516052246094 seconds
Streaming imagenet data took 2.7005107402801514 seconds
Then, training+dataloading take 2.705772876739502 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45557308197021484
Time for copying to cuda: 0.0248563289642334
Time for forward pass: 0.046440839767456055
Time for backpropagation: 0.004595518112182617
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6678237915039062 seconds
Index: 26
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.7386627197265625 seconds
Streaming imagenet data took 2.774972677230835 seconds
Then, training+dataloading take 2.780202627182007 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4554588794708252
Time for copying to cuda: 0.025063276290893555
Memory occpied: (4728.0, 4630.0)
Time for forward pass: 0.04646015167236328
Time for backpropagation: 0.004586696624755859
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6387889385223389 seconds
Index: 27
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.671466588973999 seconds
Streaming imagenet data took 2.707449436187744 seconds
Then, training+dataloading take 2.712698459625244 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.474259614944458
Time for copying to cuda: 0.024982213973999023
Time for forward pass: 0.046185970306396484
Time for backpropagation: 0.004480600357055664
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6611437797546387 seconds
Index: 28
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.7275662422180176 seconds
Streaming imagenet data took 2.7640016078948975 seconds
Then, training+dataloading take 2.7691991329193115 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4556605815887451
Time for copying to cuda: 0.025065898895263672
Memory occpied: (4728.0, 4630.0)
Time for forward pass: 0.046477317810058594
Time for backpropagation: 0.004685878753662109
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6149048805236816 seconds
Index: 29
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6754825115203857 seconds
Streaming imagenet data took 2.711663007736206 seconds
Then, training+dataloading take 2.7169687747955322 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (4728.0, 4630.0)
Time of next(dataloader) is: 0.501194953918457
Time for copying to cuda: 0.024932861328125
Time for forward pass: 0.046166419982910156
Time for backpropagation: 0.004477024078369141
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6588418483734131 seconds
Index: 30
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.639565944671631 seconds
Streaming imagenet data took 2.7207672595977783 seconds
Then, training+dataloading take 2.7262003421783447 seconds

Epoch: 0
Time of next(dataloader) is: 0.46485042572021484
Time for copying to cuda: 0.02499079704284668
Time for forward pass: 0.04630088806152344
Time for backpropagation: 0.00457310676574707
GPU memory for training: 1.2606515884399414                          

Memory occpied: (4728.0, 4630.0)
The whole process took 97.59996724128723 seconds
