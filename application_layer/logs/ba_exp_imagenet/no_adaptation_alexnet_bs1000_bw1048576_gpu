Cached  True
Transformed  True
All in COS  False
No adaptation  True
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=True, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3247198482813 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119055937.67995393 119055937.67995393
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.77201509475708 seconds
Streaming imagenet data took 1.7858881950378418 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3376960754394531
Time for copying to cuda: 0.010403871536254883
Memory occpied: (1550.0, 214.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7754831314086914 seconds
Streaming imagenet data took 1.8306841850280762 seconds
Memory occpied: (1550.0, 688.0)
Memory occpied: (1550.0, 1118.0)
Time for forward pass: 3.2391445636749268
Time for backpropagation: 0.04918360710144043
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.698578119277954 seconds
Index: 0
Then, training+dataloading take 3.698772430419922 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3550748825073242
Time for copying to cuda: 0.009603023529052734
Time for forward pass: 0.04985451698303223
Time for backpropagation: 0.0033538341522216797
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.5300488471984863 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.772162675857544 seconds
Streaming imagenet data took 1.7883524894714355 seconds
Then, training+dataloading take 1.7902476787567139 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4380178451538086
Time for copying to cuda: 0.009494781494140625
Time for forward pass: 0.04935574531555176
Time for backpropagation: 0.0027077198028564453
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5948135852813721 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7544152736663818 seconds
Streaming imagenet data took 1.7681396007537842 seconds
Then, training+dataloading take 1.7707951068878174 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39038586616516113
Time for copying to cuda: 0.009405136108398438
Time for forward pass: 0.04926562309265137
Time for backpropagation: 0.002772808074951172
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5330896377563477 seconds
Index: 3
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.737762689590454 seconds
Streaming imagenet data took 1.7516343593597412 seconds
Then, training+dataloading take 1.7541065216064453 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4267082214355469
Time for copying to cuda: 0.009507894515991211
Time for forward pass: 0.04934072494506836
Time for backpropagation: 0.002834796905517578
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6225886344909668 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7919142246246338 seconds
Streaming imagenet data took 1.8059332370758057 seconds
Then, training+dataloading take 1.8076250553131104 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41605234146118164
Time for copying to cuda: 0.009490013122558594
Time for forward pass: 0.04951810836791992
Time for backpropagation: 0.0026967525482177734
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5675902366638184 seconds
Index: 5
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8194103240966797 seconds
Streaming imagenet data took 1.8333871364593506 seconds
Then, training+dataloading take 1.8359477519989014 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37876272201538086
Time for copying to cuda: 0.009378194808959961
Time for forward pass: 0.04947018623352051
Time for backpropagation: 0.0026831626892089844
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5306081771850586 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.725862979888916 seconds
Streaming imagenet data took 1.7395648956298828 seconds
Then, training+dataloading take 1.7421290874481201 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3637204170227051
Time for copying to cuda: 0.009305000305175781
Time for forward pass: 0.0786585807800293
Time for backpropagation: 0.003143787384033203
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5641257762908936 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7384836673736572 seconds
Streaming imagenet data took 1.7946741580963135 seconds
Then, training+dataloading take 1.7991361618041992 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3807840347290039
Time for copying to cuda: 0.009445667266845703
Time for forward pass: 0.04925274848937988
Time for backpropagation: 0.0025696754455566406
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.536923885345459 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6953492164611816 seconds
Streaming imagenet data took 1.7091295719146729 seconds
Then, training+dataloading take 1.7118844985961914 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3619420528411865
Time for copying to cuda: 0.009495019912719727
Time for forward pass: 0.04922914505004883
Time for backpropagation: 0.0026161670684814453
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.522028923034668 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7542142868041992 seconds
Streaming imagenet data took 1.7680554389953613 seconds
Then, training+dataloading take 1.7706189155578613 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41417860984802246
Time for copying to cuda: 0.009441137313842773
Time for forward pass: 0.049302101135253906
Time for backpropagation: 0.0026443004608154297
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5859556198120117 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7534258365631104 seconds
Streaming imagenet data took 1.80873703956604 seconds
Then, training+dataloading take 1.8130552768707275 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3700902462005615
Time for copying to cuda: 0.00961160659790039
Time for forward pass: 0.04945039749145508
Time for backpropagation: 0.0027341842651367188
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5230848789215088 seconds
Index: 11
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7096130847930908 seconds
Streaming imagenet data took 1.7236456871032715 seconds
Then, training+dataloading take 1.7264125347137451 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3851654529571533
Time for copying to cuda: 0.009501218795776367
Time for forward pass: 0.049301862716674805
Time for backpropagation: 0.002531766891479492
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5342154502868652 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6870458126068115 seconds
Streaming imagenet data took 1.7008931636810303 seconds
Then, training+dataloading take 1.7034928798675537 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43642115592956543
Time for copying to cuda: 0.009397268295288086
Time for forward pass: 0.0493776798248291
Time for backpropagation: 0.0027112960815429688
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6309006214141846 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8056952953338623 seconds
Streaming imagenet data took 1.8615376949310303 seconds
Then, training+dataloading take 1.8659241199493408 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.37154531478881836
Time for copying to cuda: 0.009475469589233398
Time for forward pass: 0.04933643341064453
Time for backpropagation: 0.0026454925537109375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5240612030029297 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.70796537399292 seconds
Streaming imagenet data took 1.7218413352966309 seconds
Then, training+dataloading take 1.724604845046997 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40348291397094727
Time for copying to cuda: 0.00965571403503418
Time for forward pass: 0.04937863349914551
Time for backpropagation: 0.0027663707733154297
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5600543022155762 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7171456813812256 seconds
Streaming imagenet data took 1.7311651706695557 seconds
Then, training+dataloading take 1.7337725162506104 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48457956314086914
Time for copying to cuda: 0.00957036018371582
Time for forward pass: 0.0495760440826416
Time for backpropagation: 0.0027320384979248047
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6420233249664307 seconds
Index: 16
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7976484298706055 seconds
Streaming imagenet data took 1.811814308166504 seconds
Then, training+dataloading take 1.813422679901123 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3930017948150635
Time for copying to cuda: 0.009623289108276367
Time for forward pass: 0.04929685592651367
Time for backpropagation: 0.002659320831298828
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5448157787322998 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7119407653808594 seconds
Streaming imagenet data took 1.7260870933532715 seconds
Then, training+dataloading take 1.7287170886993408 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3703799247741699
Time for copying to cuda: 0.009606599807739258
Time for forward pass: 0.049272775650024414
Time for backpropagation: 0.0025947093963623047
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5193755626678467 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7051348686218262 seconds
Streaming imagenet data took 1.7190275192260742 seconds
Then, training+dataloading take 1.7216153144836426 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4156460762023926
Time for copying to cuda: 0.009521484375
Time for forward pass: 0.04926896095275879
Time for backpropagation: 0.0026171207427978516
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5901727676391602 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7550983428955078 seconds
Streaming imagenet data took 1.7693572044372559 seconds
Then, training+dataloading take 1.7711186408996582 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45510244369506836
Time for copying to cuda: 0.009562492370605469
Time for forward pass: 0.04935622215270996
Time for backpropagation: 0.0028166770935058594
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6085202693939209 seconds
Index: 20
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8067262172698975 seconds
Memory occpied: (2290.0, 1578.0)
Streaming imagenet data took 1.8207728862762451 seconds
Then, training+dataloading take 1.823319673538208 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36304759979248047
Time for copying to cuda: 0.009368658065795898
Time for forward pass: 0.049292564392089844
Time for backpropagation: 0.0025339126586914062
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5101487636566162 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.76747727394104 seconds
Streaming imagenet data took 1.7814357280731201 seconds
Then, training+dataloading take 1.7840423583984375 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36339759826660156
Time for copying to cuda: 0.00945734977722168
Time for forward pass: 0.04930686950683594
Time for backpropagation: 0.002536773681640625
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5202784538269043 seconds
Index: 22
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7536485195159912 seconds
Streaming imagenet data took 1.7675182819366455 seconds
Then, training+dataloading take 1.7700390815734863 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4361879825592041
Time for copying to cuda: 0.009422540664672852
Time for forward pass: 0.04929351806640625
Time for backpropagation: 0.002672910690307617
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5877044200897217 seconds
Index: 23
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.885124683380127 seconds
Streaming imagenet data took 1.8988869190216064 seconds
Then, training+dataloading take 1.9014520645141602 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.364302396774292
Time for copying to cuda: 0.009375572204589844
Time for forward pass: 0.04927563667297363
Time for backpropagation: 0.0026481151580810547
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.520421028137207 seconds
Index: 24
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7275621891021729 seconds
Streaming imagenet data took 1.7413489818572998 seconds
Then, training+dataloading take 1.7439420223236084 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36536383628845215
Time for copying to cuda: 0.00958395004272461
Time for forward pass: 0.08211994171142578
Time for backpropagation: 0.0030622482299804688
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5674502849578857 seconds
Index: 25
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.734208106994629 seconds
Streaming imagenet data took 1.7482590675354004 seconds
Then, training+dataloading take 1.7506139278411865 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4247579574584961
Time for copying to cuda: 0.009578704833984375
Time for forward pass: 0.049274444580078125
Time for backpropagation: 0.002837657928466797
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5753135681152344 seconds
Index: 26
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7790799140930176 seconds
Memory occpied: (2290.0, 1578.0)
Streaming imagenet data took 1.7929584980010986 seconds
Then, training+dataloading take 1.7953376770019531 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36539173126220703
Time for copying to cuda: 0.009464502334594727
Time for forward pass: 0.049224853515625
Time for backpropagation: 0.002608776092529297
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5146303176879883 seconds
Index: 27
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7276296615600586 seconds
Streaming imagenet data took 1.7414968013763428 seconds
Then, training+dataloading take 1.7440528869628906 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3649446964263916
Time for copying to cuda: 0.009488344192504883
Time for forward pass: 0.04936337471008301
Time for backpropagation: 0.0026254653930664062
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5294408798217773 seconds
Index: 28
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7794687747955322 seconds
Streaming imagenet data took 1.795612096786499 seconds
Then, training+dataloading take 1.798015832901001 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4127652645111084
Time for copying to cuda: 0.00952911376953125
Time for forward pass: 0.04931640625
Time for backpropagation: 0.002666950225830078
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5717833042144775 seconds
Index: 29
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7727549076080322 seconds
Streaming imagenet data took 1.7867910861968994 seconds
Then, training+dataloading take 1.7894773483276367 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3690211772918701
Time for copying to cuda: 0.009590625762939453
Time for forward pass: 0.0494236946105957
Time for backpropagation: 0.002694368362426758
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5279357433319092 seconds
Index: 30
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7384448051452637 seconds
Streaming imagenet data took 1.752683401107788 seconds
Then, training+dataloading take 1.755262851715088 seconds

Epoch: 0
Time of next(dataloader) is: 0.410048246383667
Time for copying to cuda: 0.009442329406738281
Time for forward pass: 0.049252986907958984
Time for backpropagation: 0.0026581287384033203
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
The whole process took 66.86746144294739 seconds
