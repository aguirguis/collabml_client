Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=5000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.5981054830696 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118960698.8818769 118960698.8818769
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  259.0654296875 1537.91552734375 1796.98095703125 34555.49365234375
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 5000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Read 478.7403154373169 MBs for this batch
Executing all posts took 7.399628400802612 seconds
Streaming imagenet data took 7.578636407852173 seconds
The mode is:  split
Start 5000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5919601917266846
Time for copying to cuda: 0.15601611137390137
Memory occpied: (1816.0, 36.0)
Memory occpied: (1816.0, 794.0)
Memory occpied: (1816.0, 1220.0)
Memory occpied: (13812.0, 13522.0)
Memory occpied: (13812.0, 13522.0)
Time for forward pass: 5.209541082382202
Memory occpied: (13782.0, 13530.0)
Memory occpied: (13782.0, 13496.0)
Read 478.7403154373169 MBs for this batch
Executing all posts took 8.48104476928711 seconds
Streaming imagenet data took 8.660220384597778 seconds
Time for backpropagation: 2.9647397994995117
GPU memory for training: 24.137078285217285                          

One training iteration takes: 9.057095766067505 seconds
Index: 0
Then, training+dataloading take 9.058315753936768 seconds
The mode is:  split
Start 10000, end 15000, post_step 1000


Epoch: 0
Memory occpied: (13788.0, 1524.0)
Time of next(dataloader) is: 0.6798319816589355
Time for copying to cuda: 0.12235569953918457
Time for forward pass: 0.15011334419250488
Time for backpropagation: 0.005220890045166016
GPU memory for training: 5.530350685119629                          

One training iteration takes: 1.1092333793640137 seconds
Index: 1
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Read 478.7403154373169 MBs for this batch
Executing all posts took 8.535804033279419 seconds
Streaming imagenet data took 8.716295003890991 seconds
Then, training+dataloading take 8.738978862762451 seconds
The mode is:  split
Start 15000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (13804.0, 4734.0)
Time of next(dataloader) is: 0.7519412040710449
Time for copying to cuda: 0.12201952934265137
Time for forward pass: 0.20384597778320312
Time for backpropagation: 0.0045163631439208984
GPU memory for training: 5.530350685119629                          

One training iteration takes: 1.2121171951293945 seconds
Index: 2
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Read 478.7403154373169 MBs for this batch
Executing all posts took 8.532154083251953 seconds
Streaming imagenet data took 8.712522268295288 seconds
Then, training+dataloading take 8.73504638671875 seconds
The mode is:  split
Start 20000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7103941440582275
Time for copying to cuda: 0.12262868881225586
Time for forward pass: 0.20511674880981445
Time for backpropagation: 0.004618406295776367
GPU memory for training: 5.530350685119629                          

One training iteration takes: 1.1711311340332031 seconds
Index: 3
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Read 478.7403154373169 MBs for this batch
Executing all posts took 8.554224014282227 seconds
Memory occpied: (13804.0, 4734.0)
Streaming imagenet data took 8.785321235656738 seconds
Then, training+dataloading take 8.808825731277466 seconds
The mode is:  split
Start 25000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6828610897064209
Time for copying to cuda: 0.12144947052001953
Time for forward pass: 0.2060563564300537
Time for backpropagation: 0.005303859710693359
GPU memory for training: 5.530350685119629                          

One training iteration takes: 1.1475975513458252 seconds
Index: 4
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Read 478.7403154373169 MBs for this batch
Executing all posts took 8.667200565338135 seconds
Memory occpied: (13804.0, 4734.0)
Streaming imagenet data took 8.847553491592407 seconds
Then, training+dataloading take 8.871235370635986 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6743557453155518
Time for copying to cuda: 0.12109708786010742
Time for forward pass: 0.2057664394378662
Time for backpropagation: 0.0046787261962890625
GPU memory for training: 5.530350685119629                          

One training iteration takes: 1.1599068641662598 seconds
Index: 5
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Memory occpied: (13804.0, 4734.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.5484185218811035 seconds
Streaming imagenet data took 4.620753526687622 seconds
Then, training+dataloading take 4.630884408950806 seconds

Epoch: 0
Time of next(dataloader) is: 0.5333294868469238
Time for copying to cuda: 0.04960799217224121
Time for forward pass: 0.8698310852050781
Time for backpropagation: 1.379741907119751
GPU memory for training: 11.565897464752197                          

Memory occpied: (13804.0, 6898.0)
The whole process took 66.63748788833618 seconds
