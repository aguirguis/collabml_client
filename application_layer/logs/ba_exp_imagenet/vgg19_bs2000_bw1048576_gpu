Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 906.9985145117344 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118882109.29408205 118882109.29408205
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  1350.7978515625 4001.181640625 5351.9794921875 53383.994140625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.45866060256958 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 18.823917150497437 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7323992252349854
Time for copying to cuda: 0.22711396217346191
Memory occpied: (2660.0, 36.0)
Memory occpied: (2660.0, 916.0)
Memory occpied: (2660.0, 1368.0)
Memory occpied: (8408.0, 7926.0)
Memory occpied: (8408.0, 7926.0)
Time for forward pass: 5.756422996520996
Time for backpropagation: 0.0638895034790039
GPU memory for training: 13.368073463439941                          

One training iteration takes: 6.913372278213501 seconds
Index: 0
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.488245964050293 seconds
Streaming imagenet data took 18.773813486099243 seconds
Then, training+dataloading take 18.80923366546631 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8261916637420654
Time for copying to cuda: 0.19521594047546387
Time for forward pass: 0.5914409160614014
Time for backpropagation: 0.004487514495849609
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7735235691070557 seconds
Index: 1
Memory occpied: (4206.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.63478708267212 seconds
Streaming imagenet data took 19.017345190048218 seconds
Memory occpied: (6326.0, 7942.0)
Then, training+dataloading take 19.067460536956787 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7638125419616699
Time for copying to cuda: 0.19469833374023438
Memory occpied: (6326.0, 7942.0)
Time for forward pass: 0.5421464443206787
Time for backpropagation: 0.004244565963745117
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.6646602153778076 seconds
Index: 2
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.595059871673584 seconds
Streaming imagenet data took 18.880327463150024 seconds
Then, training+dataloading take 18.931130170822144 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8003652095794678
Time for copying to cuda: 0.19606614112854004
Time for forward pass: 0.5870201587677002
Time for backpropagation: 0.0041692256927490234
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7165062427520752 seconds
Index: 3
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.5664701461792 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 18.94868540763855 seconds
Then, training+dataloading take 19.00069832801819 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7572226524353027
Memory occpied: (6326.0, 7942.0)
Time for copying to cuda: 0.26637768745422363
Time for forward pass: 0.57472825050354
Time for backpropagation: 0.004174470901489258
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7638328075408936 seconds
Index: 4
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.654282808303833 seconds
Streaming imagenet data took 18.986392498016357 seconds
Then, training+dataloading take 19.036776065826416 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (6326.0, 7942.0)
Time of next(dataloader) is: 0.7912511825561523
Time for copying to cuda: 0.19566059112548828
Memory occpied: (6326.0, 7942.0)
Time for forward pass: 0.5543022155761719
Time for backpropagation: 0.004313230514526367
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7256040573120117 seconds
Index: 5
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.533822536468506 seconds
Streaming imagenet data took 18.81700325012207 seconds
Then, training+dataloading take 18.868524312973022 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (6326.0, 7942.0)
Time of next(dataloader) is: 0.7667663097381592
Time for copying to cuda: 0.19682931900024414
Time for forward pass: 0.5695135593414307
Time for backpropagation: 0.004181861877441406
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7418086528778076 seconds
Index: 6
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.538248300552368 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 18.92545509338379 seconds
Then, training+dataloading take 18.97713565826416 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7508857250213623
Memory occpied: (6326.0, 7942.0)
Time for copying to cuda: 0.2660636901855469
Time for forward pass: 0.5931322574615479
Time for backpropagation: 0.004251956939697266
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7932231426239014 seconds
Index: 7
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.824605226516724 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 19.204329252243042 seconds
Then, training+dataloading take 19.255807638168335 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7553777694702148
Time for copying to cuda: 0.2659454345703125
Memory occpied: (6326.0, 7942.0)
Time for forward pass: 0.5971179008483887
Time for backpropagation: 0.004234790802001953
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7811825275421143 seconds
Index: 8
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.626112699508667 seconds
Streaming imagenet data took 18.909950733184814 seconds
Then, training+dataloading take 18.960678815841675 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (6326.0, 7942.0)
Time of next(dataloader) is: 0.8347370624542236
Time for copying to cuda: 0.1960010528564453
Memory occpied: (6326.0, 7942.0)
Time for forward pass: 0.557375431060791
Time for backpropagation: 0.004332780838012695
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7672474384307861 seconds
Index: 9
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.59080696105957 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 18.87635564804077 seconds
Then, training+dataloading take 18.92765760421753 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7585110664367676
Memory occpied: (6326.0, 7942.0)
Time for copying to cuda: 0.23250317573547363
Time for forward pass: 0.5493030548095703
Time for backpropagation: 0.004161834716796875
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.709115743637085 seconds
Index: 10
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.728898525238037 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 19.118707418441772 seconds
Then, training+dataloading take 19.170812368392944 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7550458908081055
Memory occpied: (6326.0, 7942.0)
Time for copying to cuda: 0.2663872241973877
Time for forward pass: 0.5760068893432617
Time for backpropagation: 0.0041849613189697266
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7714118957519531 seconds
Index: 11
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.653762102127075 seconds
Streaming imagenet data took 18.9870502948761 seconds
Then, training+dataloading take 19.011453866958618 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8072671890258789
Time for copying to cuda: 0.1948709487915039
Time for forward pass: 0.5750751495361328
Time for backpropagation: 0.004220008850097656
GPU memory for training: 7.951027870178223                          

Memory occpied: (6326.0, 7942.0)
One training iteration takes: 1.762911319732666 seconds
Index: 12
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.555136919021606 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 18.93569016456604 seconds
Then, training+dataloading take 18.98798370361328 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7675769329071045
Memory occpied: (6326.0, 7942.0)
Time for copying to cuda: 0.2684144973754883
Time for forward pass: 0.5494444370269775
Time for backpropagation: 0.004166841506958008
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7609500885009766 seconds
Index: 13
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.574084281921387 seconds
Streaming imagenet data took 18.86488389968872 seconds
Then, training+dataloading take 18.915830612182617 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.803908109664917
Time for copying to cuda: 0.1976325511932373
Time for forward pass: 0.547661304473877
Time for backpropagation: 0.004157543182373047
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.6876208782196045 seconds
Index: 14
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.608564138412476 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 18.99855923652649 seconds
Then, training+dataloading take 19.050337076187134 seconds

Epoch: 0
Time of next(dataloader) is: 0.7631590366363525
Memory occpied: (6326.0, 7942.0)
Time for copying to cuda: 0.26614952087402344
Time for forward pass: 0.5485920906066895
Time for backpropagation: 0.004202127456665039
GPU memory for training: 7.951027870178223                          

The whole process took 313.9371645450592 seconds
