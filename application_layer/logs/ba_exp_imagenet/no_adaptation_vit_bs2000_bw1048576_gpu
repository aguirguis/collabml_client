Cached  True
Transformed  True
All in COS  False
No adaptation  True
Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=True, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.3111430517783 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03 3.07200e+03 3.07200e+03
 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118923086.14208269 118923086.14208269
All candidates indexes:  (array([15, 16, 17, 18]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.0029296875
17.314453125
Total layers size  104.47354125976562
Server, client, server+client, vanilla  902.6669921875 374.78515625 1277.4521484375 36146.26953125
Candidate split  16
Server, client, server+client, vanilla  902.6669921875 374.78515625 1277.4521484375 36146.26953125
Model size  330.2294921875
Fixed, scale_with_bsz  330.2294921875 17.888671875
Mem usage  1654.0 3.0
Using split index: 16
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Memory occpied: (1654.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.905762910842896 seconds
Streaming imagenet data took 12.908996105194092 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2864055633544922
Time for copying to cuda: 0.0018453598022460938
Memory occpied: (1654.0, 402.0)
Memory occpied: (1654.0, 834.0)
Time for forward pass: 3.1672654151916504
Memory occpied: (1694.0, 1652.0)
Time for backpropagation: 0.0813438892364502
GPU memory for training: 1.3407373428344727                          

One training iteration takes: 3.5874183177948 seconds
Index: 0
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Memory occpied: (2414.0, 1672.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.906211137771606 seconds
Streaming imagenet data took 12.910959005355835 seconds
Then, training+dataloading take 12.914191961288452 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (2414.0, 1672.0)
Time of next(dataloader) is: 0.3506627082824707
Time for copying to cuda: 0.0018646717071533203
Time for forward pass: 0.03429150581359863
Time for backpropagation: 0.00897073745727539
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.45861029624938965 seconds
Index: 1
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.998814105987549 seconds
Streaming imagenet data took 13.002202987670898 seconds
Then, training+dataloading take 13.003018856048584 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3510310649871826
Time for copying to cuda: 0.001886129379272461
Time for forward pass: 0.03467369079589844
Time for backpropagation: 0.045052528381347656
GPU memory for training: 1.3560242652893066                          

Memory occpied: (2442.0, 1680.0)
One training iteration takes: 0.5140504837036133 seconds
Index: 2
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.98334002494812 seconds
Streaming imagenet data took 12.98681092262268 seconds
Then, training+dataloading take 12.988316774368286 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3135395050048828
Time for copying to cuda: 0.0019130706787109375
Time for forward pass: 0.03422832489013672
Time for backpropagation: 0.00809168815612793
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4419224262237549 seconds
Index: 3
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.023560047149658 seconds
Streaming imagenet data took 13.02628207206726 seconds
Then, training+dataloading take 13.027652740478516 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3107788562774658
Time for copying to cuda: 0.0018572807312011719
Time for forward pass: 0.03423738479614258
Time for backpropagation: 0.0080108642578125
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4350271224975586 seconds
Index: 4
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.061350107192993 seconds
Streaming imagenet data took 13.06371259689331 seconds
Then, training+dataloading take 13.065098762512207 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3121201992034912
Time for copying to cuda: 0.0018768310546875
Time for forward pass: 0.03417229652404785
Time for backpropagation: 0.008077383041381836
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4375467300415039 seconds
Index: 5
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.113280296325684 seconds
Streaming imagenet data took 13.11594271659851 seconds
Then, training+dataloading take 13.117290019989014 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3099980354309082
Time for copying to cuda: 0.0018892288208007812
Time for forward pass: 0.03437209129333496
Time for backpropagation: 0.008285760879516602
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.430372953414917 seconds
Index: 6
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.006935596466064 seconds
Streaming imagenet data took 13.00928544998169 seconds
Then, training+dataloading take 13.010061264038086 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3096592426300049
Time for copying to cuda: 0.001857757568359375
Time for forward pass: 0.03426337242126465
Time for backpropagation: 0.008086442947387695
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4360661506652832 seconds
Index: 7
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.848489761352539 seconds
Streaming imagenet data took 12.852946519851685 seconds
Then, training+dataloading take 12.855846881866455 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Time of next(dataloader) is: 0.30782604217529297
Time for copying to cuda: 0.0018687248229980469
Time for forward pass: 0.034235239028930664
Time for backpropagation: 0.008089542388916016
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4204282760620117 seconds
Index: 8
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.912259578704834 seconds
Streaming imagenet data took 12.914952516555786 seconds
Then, training+dataloading take 12.916041612625122 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35074424743652344
Time for copying to cuda: 0.0018887519836425781
Time for forward pass: 0.0343017578125
Time for backpropagation: 0.007981300354003906
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.5097222328186035 seconds
Index: 9
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.920500993728638 seconds
Streaming imagenet data took 12.92284631729126 seconds
Then, training+dataloading take 12.92423152923584 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3148629665374756
Time for copying to cuda: 0.0018703937530517578
Time for forward pass: 0.03426241874694824
Time for backpropagation: 0.007980108261108398
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.4513065814971924 seconds
Index: 10
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.821174621582031 seconds
Streaming imagenet data took 12.823853492736816 seconds
Then, training+dataloading take 12.825239181518555 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31579089164733887
Time for copying to cuda: 0.0019066333770751953
Time for forward pass: 0.03425145149230957
Time for backpropagation: 0.008014917373657227
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.44850921630859375 seconds
Index: 11
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.689765214920044 seconds
Streaming imagenet data took 12.692082166671753 seconds
Then, training+dataloading take 12.692919492721558 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3764655590057373
Time for copying to cuda: 0.0019347667694091797
Time for forward pass: 0.03469252586364746
Time for backpropagation: 0.008367776870727539
GPU memory for training: 1.3560242652893066                          

Memory occpied: (2442.0, 1680.0)
One training iteration takes: 0.5030028820037842 seconds
Index: 12
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.883143663406372 seconds
Streaming imagenet data took 12.885868549346924 seconds
Then, training+dataloading take 12.88723111152649 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.315326452255249
Time for copying to cuda: 0.0018982887268066406
Time for forward pass: 0.0342557430267334
Time for backpropagation: 0.008177042007446289
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.43253540992736816 seconds
Index: 13
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.802904605865479 seconds
Streaming imagenet data took 12.80530333518982 seconds
Then, training+dataloading take 12.806705951690674 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31188368797302246
Time for copying to cuda: 0.0018532276153564453
Time for forward pass: 0.03430485725402832
Time for backpropagation: 0.008098840713500977
GPU memory for training: 1.3560242652893066                          

One training iteration takes: 0.44302892684936523 seconds
Index: 14
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Memory occpied: (2442.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.896493196487427 seconds
Streaming imagenet data took 12.90138578414917 seconds
Then, training+dataloading take 12.904207468032837 seconds

Epoch: 0
Memory occpied: (2442.0, 1680.0)
Time of next(dataloader) is: 0.31059789657592773
Time for copying to cuda: 0.0018417835235595703
Time for forward pass: 0.034339189529418945
Time for backpropagation: 0.008051395416259766
GPU memory for training: 1.3560242652893066                          

The whole process took 215.17985486984253 seconds
