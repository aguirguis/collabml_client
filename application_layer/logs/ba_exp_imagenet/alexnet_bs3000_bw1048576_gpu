Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=3000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.274797395095 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119049394.24416989 119049394.24416989
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 854.00146484375 1153.09912109375 6902.34130859375
Candidate split  13
Server, client, server+client, vanilla  299.09765625 854.00146484375 1153.09912109375 6902.34130859375
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 3000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.547758102416992 seconds
Streaming imagenet data took 2.5882225036621094 seconds
The mode is:  split
Start 3000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3788003921508789
Time for copying to cuda: 0.027740001678466797
Memory occpied: (1620.0, 376.0)
Memory occpied: (1620.0, 826.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.4238574504852295 seconds
Streaming imagenet data took 2.465282440185547 seconds
Memory occpied: (1620.0, 1250.0)
Time for forward pass: 3.3287482261657715
Time for backpropagation: 0.05024313926696777
GPU memory for training: 1.195061206817627                          

One training iteration takes: 3.881258249282837 seconds
Index: 0
Then, training+dataloading take 3.8816471099853516 seconds
The mode is:  split
Start 6000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.389559268951416
Time for copying to cuda: 0.028165578842163086
Time for forward pass: 0.08720660209655762
Time for backpropagation: 0.0036382675170898438
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.5931637287139893 seconds
Index: 1
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.1379787921905518 seconds
Streaming imagenet data took 3.219970464706421 seconds
Then, training+dataloading take 3.230332612991333 seconds
The mode is:  split
Start 9000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (2440.0, 1680.0)
Time of next(dataloader) is: 0.41924047470092773
Time for copying to cuda: 0.027390480041503906
Time for forward pass: 0.1019594669342041
Time for backpropagation: 0.002636432647705078
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6349728107452393 seconds
Index: 2
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.3007233142852783 seconds
Streaming imagenet data took 2.38376784324646 seconds
Then, training+dataloading take 2.3940062522888184 seconds
The mode is:  split
Start 12000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4513590335845947
Time for copying to cuda: 0.02686905860900879
Time for forward pass: 0.10188102722167969
Time for backpropagation: 0.0025625228881835938
GPU memory for training: 1.3507170677185059                          

Memory occpied: (2440.0, 1680.0)
One training iteration takes: 0.6770114898681641 seconds
Index: 3
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.4367332458496094 seconds
Streaming imagenet data took 2.477630138397217 seconds
Then, training+dataloading take 2.482449531555176 seconds
The mode is:  split
Start 15000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.422757625579834
Time for copying to cuda: 0.027080774307250977
Time for forward pass: 0.10283064842224121
Time for backpropagation: 0.003205537796020508
GPU memory for training: 1.3507170677185059                          

Memory occpied: (2440.0, 1680.0)
One training iteration takes: 0.65519118309021 seconds
Index: 4
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.816614866256714 seconds
Streaming imagenet data took 2.9118905067443848 seconds
Then, training+dataloading take 2.923313617706299 seconds
The mode is:  split
Start 18000, end 21000, post_step 1000


Epoch: 0
Memory occpied: (2440.0, 1680.0)
Time of next(dataloader) is: 0.4555933475494385
Time for copying to cuda: 0.027354717254638672
Time for forward pass: 0.10208392143249512
Time for backpropagation: 0.0027141571044921875
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6948063373565674 seconds
Index: 5
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.325423240661621 seconds
Streaming imagenet data took 2.3664700984954834 seconds
Then, training+dataloading take 2.369840383529663 seconds
The mode is:  split
Start 21000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4523134231567383
Time for copying to cuda: 0.027245521545410156
Memory occpied: (2440.0, 1680.0)
Time for forward pass: 0.10208463668823242
Time for backpropagation: 0.002694368362426758
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6871182918548584 seconds
Index: 6
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.3567299842834473 seconds
Streaming imagenet data took 2.3975255489349365 seconds
Then, training+dataloading take 2.404865264892578 seconds
The mode is:  split
Start 24000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40937256813049316
Time for copying to cuda: 0.0273284912109375
Time for forward pass: 0.10289645195007324
Time for backpropagation: 0.0031480789184570312
GPU memory for training: 1.3507170677185059                          

Memory occpied: (2440.0, 1680.0)
One training iteration takes: 0.6361157894134521 seconds
Index: 7
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.8909733295440674 seconds
Streaming imagenet data took 2.9737823009490967 seconds
Then, training+dataloading take 2.98417592048645 seconds
The mode is:  split
Start 27000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (2440.0, 1680.0)
Time of next(dataloader) is: 0.41680049896240234
Time for copying to cuda: 0.027533531188964844
Time for forward pass: 0.10202622413635254
Time for backpropagation: 0.002653837203979492
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6743950843811035 seconds
Index: 8
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.453853130340576 seconds
Memory occpied: (2440.0, 1680.0)
Streaming imagenet data took 2.494795322418213 seconds
Then, training+dataloading take 2.5025742053985596 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4066178798675537
Time for copying to cuda: 0.027372121810913086
Time for forward pass: 0.10194587707519531
Time for backpropagation: 0.0026030540466308594
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6291990280151367 seconds
Index: 9
Memory occpied: (2440.0, 1680.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.0878055095672607 seconds
Streaming imagenet data took 2.1150271892547607 seconds
Then, training+dataloading take 2.11967396736145 seconds

Epoch: 0
Time of next(dataloader) is: 0.46741461753845215
Time for copying to cuda: 0.018742084503173828
Time for forward pass: 0.07550978660583496
Time for backpropagation: 0.0026214122772216797
GPU memory for training: 1.255445957183838                          

Memory occpied: (2440.0, 1680.0)
The whole process took 38.05716133117676 seconds
