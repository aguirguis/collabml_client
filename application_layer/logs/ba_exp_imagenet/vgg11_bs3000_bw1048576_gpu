Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=3000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.5606250285607 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118955786.24374351 118955786.24374351
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.015625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  1309.583984375 951.97216796875 2261.55615234375 76127.75341796875
Candidate split  23
Server, client, server+client, vanilla  1309.583984375 951.97216796875 2261.55615234375 76127.75341796875
Model size  507.208984375
Fixed, scale_with_bsz  507.208984375 25.07421875
Mem usage  1840.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 3000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 10.896188735961914 seconds
Streaming imagenet data took 10.914758682250977 seconds
The mode is:  split
Start 3000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31523752212524414
Time for copying to cuda: 0.013134002685546875
Memory occpied: (1888.0, 246.0)
Memory occpied: (1888.0, 716.0)
Memory occpied: (1888.0, 1138.0)
Time for forward pass: 3.2786152362823486
Time for backpropagation: 0.05002713203430176
GPU memory for training: 2.1442408561706543                          

One training iteration takes: 3.7285099029541016 seconds
Index: 0
Memory occpied: (3074.0, 1890.0)
Memory occpied: (3074.0, 1890.0)
Memory occpied: (3074.0, 1890.0)
Memory occpied: (3074.0, 1890.0)
Memory occpied: (3074.0, 1890.0)
Memory occpied: (3074.0, 1890.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 10.817891597747803 seconds
Streaming imagenet data took 10.83677363395691 seconds
Then, training+dataloading take 10.83881402015686 seconds
The mode is:  split
Start 6000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37988901138305664
Time for copying to cuda: 0.012462615966796875
Time for forward pass: 0.0728616714477539
Time for backpropagation: 0.0031366348266601562
GPU memory for training: 2.299837112426758                          

One training iteration takes: 0.5852596759796143 seconds
Index: 1
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 15.515187501907349 seconds
Streaming imagenet data took 15.533904552459717 seconds
Then, training+dataloading take 15.535237550735474 seconds
The mode is:  split
Start 9000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35376667976379395
Time for copying to cuda: 0.01244044303894043
Time for forward pass: 0.07281208038330078
Time for backpropagation: 0.003217935562133789
GPU memory for training: 2.299837112426758                          

One training iteration takes: 0.5246458053588867 seconds
Index: 2
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 10.655990362167358 seconds
Streaming imagenet data took 10.674731016159058 seconds
Then, training+dataloading take 10.676052570343018 seconds
The mode is:  split
Start 12000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3552565574645996
Time for copying to cuda: 0.012531280517578125
Time for forward pass: 0.07296419143676758
Time for backpropagation: 0.003560304641723633
GPU memory for training: 2.299837112426758                          

One training iteration takes: 0.5250744819641113 seconds
Index: 3
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 10.825775861740112 seconds
Streaming imagenet data took 10.844909906387329 seconds
Then, training+dataloading take 10.84626841545105 seconds
The mode is:  split
Start 15000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35511064529418945
Time for copying to cuda: 0.012816190719604492
Time for forward pass: 0.07299041748046875
Time for backpropagation: 0.003336191177368164
GPU memory for training: 2.299837112426758                          

One training iteration takes: 0.5296773910522461 seconds
Index: 4
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 15.580331325531006 seconds
Streaming imagenet data took 15.599021911621094 seconds
Then, training+dataloading take 15.600453853607178 seconds
The mode is:  split
Start 18000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34905219078063965
Time for copying to cuda: 0.012363195419311523
Time for forward pass: 0.07274484634399414
Time for backpropagation: 0.003265380859375
GPU memory for training: 2.299837112426758                          

One training iteration takes: 0.5257680416107178 seconds
Index: 5
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 10.839216232299805 seconds
Streaming imagenet data took 10.857874870300293 seconds
Then, training+dataloading take 10.859285116195679 seconds
The mode is:  split
Start 21000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3475489616394043
Time for copying to cuda: 0.012526512145996094
Time for forward pass: 0.07292747497558594
Time for backpropagation: 0.0033528804779052734
GPU memory for training: 2.299837112426758                          

One training iteration takes: 0.5240497589111328 seconds
Index: 6
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 10.742083549499512 seconds
Streaming imagenet data took 10.760655879974365 seconds
Then, training+dataloading take 10.76205062866211 seconds
The mode is:  split
Start 24000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34731531143188477
Time for copying to cuda: 0.01239919662475586
Time for forward pass: 0.07287049293518066
Time for backpropagation: 0.0032138824462890625
GPU memory for training: 2.299837112426758                          

One training iteration takes: 0.5154323577880859 seconds
Index: 7
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 15.601497888565063 seconds
Streaming imagenet data took 15.620202541351318 seconds
Then, training+dataloading take 15.62231993675232 seconds
The mode is:  split
Start 27000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36858272552490234
Time for copying to cuda: 0.012549400329589844
Time for forward pass: 0.07269048690795898
Time for backpropagation: 0.003171205520629883
GPU memory for training: 2.299837112426758                          

One training iteration takes: 0.535820722579956 seconds
Index: 8
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Read 46.97903251647949 MBs for this batch
Executing all posts took 10.830284357070923 seconds
Streaming imagenet data took 10.84922480583191 seconds
Then, training+dataloading take 10.850659847259521 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35183238983154297
Time for copying to cuda: 0.012600898742675781
Time for forward pass: 0.07305145263671875
Time for backpropagation: 0.0033278465270996094
GPU memory for training: 2.299837112426758                          

One training iteration takes: 0.534064531326294 seconds
Index: 9
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Memory occpied: (3476.0, 1898.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 10.896256923675537 seconds
Streaming imagenet data took 10.908791065216064 seconds
Then, training+dataloading take 10.909929752349854 seconds

Epoch: 0
Time of next(dataloader) is: 0.3352832794189453
Time for copying to cuda: 0.00849151611328125
Time for forward pass: 0.06436538696289062
Time for backpropagation: 0.0031805038452148438
GPU memory for training: 2.2456326484680176                          

The whole process took 141.8251016139984 seconds
