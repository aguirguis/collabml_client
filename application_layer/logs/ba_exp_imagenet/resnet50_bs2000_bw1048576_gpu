Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.2299086391737 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118912438.58515377 118912438.58515377
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  312.10302734375 128.61181640625 440.71484375 13511.42431640625
Candidate split  21
Server, client, server+client, vanilla  312.10302734375 128.61181640625 440.71484375 13511.42431640625
Model size  97.72802734375
Fixed, scale_with_bsz  97.72802734375 6.69921875
Mem usage  1410.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.335155010223389 seconds
Streaming imagenet data took 4.342199802398682 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33723878860473633
Time for copying to cuda: 0.004391193389892578
Memory occpied: (1410.0, 124.0)
Memory occpied: (1410.0, 558.0)
Memory occpied: (1410.0, 1018.0)
Time for forward pass: 3.142395496368408
Time for backpropagation: 0.06340837478637695
GPU memory for training: 0.4387826919555664                          

One training iteration takes: 3.6078293323516846 seconds
Index: 0
Memory occpied: (1638.0, 1408.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.18450140953064 seconds
Streaming imagenet data took 4.192204236984253 seconds
Then, training+dataloading take 4.193837404251099 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32619333267211914
Time for copying to cuda: 0.004434347152709961
Time for forward pass: 0.01498103141784668
Time for backpropagation: 0.007328033447265625
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4343886375427246 seconds
Index: 1
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.192301511764526 seconds
Streaming imagenet data took 4.199548244476318 seconds
Then, training+dataloading take 4.200420618057251 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3857853412628174
Time for copying to cuda: 0.04104018211364746
Time for forward pass: 0.014870882034301758
Time for backpropagation: 0.006630659103393555
GPU memory for training: 0.4546504020690918                          

Memory occpied: (1666.0, 1416.0)
One training iteration takes: 0.5203027725219727 seconds
Index: 2
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.844454526901245 seconds
Streaming imagenet data took 3.8497331142425537 seconds
Then, training+dataloading take 3.850590467453003 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (1666.0, 1416.0)
Time of next(dataloader) is: 0.402768611907959
Time for copying to cuda: 0.0044193267822265625
Time for forward pass: 0.014342546463012695
Time for backpropagation: 0.0062732696533203125
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.5077385902404785 seconds
Index: 3
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.25493049621582 seconds
Streaming imagenet data took 4.259883403778076 seconds
Then, training+dataloading take 4.260770797729492 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33977270126342773
Time for copying to cuda: 0.004453420639038086
Time for forward pass: 0.014294147491455078
Time for backpropagation: 0.006374359130859375
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4459655284881592 seconds
Index: 4
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.348134994506836 seconds
Streaming imagenet data took 4.356876611709595 seconds
Then, training+dataloading take 4.35802149772644 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37493133544921875
Time for copying to cuda: 0.004429340362548828
Time for forward pass: 0.014414548873901367
Time for backpropagation: 0.006377458572387695
GPU memory for training: 0.4546504020690918                          

Memory occpied: (1666.0, 1416.0)
One training iteration takes: 0.46782803535461426 seconds
Index: 5
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.249746561050415 seconds
Streaming imagenet data took 4.25507926940918 seconds
Then, training+dataloading take 4.256126165390015 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32730984687805176
Time for copying to cuda: 0.0043735504150390625
Time for forward pass: 0.01432180404663086
Time for backpropagation: 0.006341695785522461
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4331693649291992 seconds
Index: 6
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.281355381011963 seconds
Streaming imagenet data took 4.286230087280273 seconds
Then, training+dataloading take 4.287071228027344 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3871948719024658
Time for copying to cuda: 0.0043888092041015625
Time for forward pass: 0.014255285263061523
Time for backpropagation: 0.006473541259765625
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.51045823097229 seconds
Index: 7
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.2711522579193115 seconds
Streaming imagenet data took 4.276461601257324 seconds
Then, training+dataloading take 4.277339458465576 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3324158191680908
Time for copying to cuda: 0.004357099533081055
Time for forward pass: 0.014293909072875977
Time for backpropagation: 0.006315469741821289
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.42057180404663086 seconds
Index: 8
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.258762359619141 seconds
Streaming imagenet data took 4.263550043106079 seconds
Then, training+dataloading take 4.264413595199585 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3659934997558594
Time for copying to cuda: 0.004456996917724609
Time for forward pass: 0.014191865921020508
Time for backpropagation: 0.006328582763671875
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.48709630966186523 seconds
Index: 9
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.240946292877197 seconds
Streaming imagenet data took 4.246032953262329 seconds
Then, training+dataloading take 4.246866703033447 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32332611083984375
Time for copying to cuda: 0.004342555999755859
Time for forward pass: 0.014354705810546875
Time for backpropagation: 0.006304740905761719
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4110374450683594 seconds
Index: 10
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.300578355789185 seconds
Streaming imagenet data took 4.305409669876099 seconds
Then, training+dataloading take 4.306355953216553 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3652231693267822
Time for copying to cuda: 0.004451274871826172
Time for forward pass: 0.014339685440063477
Time for backpropagation: 0.006334066390991211
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4943580627441406 seconds
Index: 11
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.219073057174683 seconds
Streaming imagenet data took 4.224490404129028 seconds
Then, training+dataloading take 4.226075887680054 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3271195888519287
Time for copying to cuda: 0.004385471343994141
Time for forward pass: 0.014341592788696289
Time for backpropagation: 0.0063266754150390625
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.42699742317199707 seconds
Index: 12
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.1779561042785645 seconds
Streaming imagenet data took 4.18290114402771 seconds
Then, training+dataloading take 4.18378210067749 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3263547420501709
Time for copying to cuda: 0.04121589660644531
Time for forward pass: 0.01480722427368164
Time for backpropagation: 0.006490230560302734
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.48845958709716797 seconds
Index: 13
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.328304767608643 seconds
Streaming imagenet data took 4.333568334579468 seconds
Then, training+dataloading take 4.334424257278442 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32819390296936035
Time for copying to cuda: 0.004421234130859375
Time for forward pass: 0.014454841613769531
Time for backpropagation: 0.006433248519897461
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4415736198425293 seconds
Index: 14
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.272873878479004 seconds
Streaming imagenet data took 4.277637720108032 seconds
Then, training+dataloading take 4.278494834899902 seconds

Epoch: 0
Time of next(dataloader) is: 0.3846921920776367
Time for copying to cuda: 0.004420042037963867
Time for forward pass: 0.01462244987487793
Time for backpropagation: 0.0066263675689697266
GPU memory for training: 0.4546504020690918                          

Memory occpied: (1666.0, 1416.0)
The whole process took 75.67623281478882 seconds
