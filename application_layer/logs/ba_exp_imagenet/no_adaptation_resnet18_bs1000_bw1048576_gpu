Cached  True
Transformed  True
All in COS  False
No adaptation  True
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=True, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.3531459518513 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118928591.54620105 118928591.54620105
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  259.0654296875 343.33544921875 602.40087890625 6946.85107421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.9355885982513428 seconds
Streaming imagenet data took 2.9718844890594482 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3508727550506592
Time for copying to cuda: 0.02514195442199707
Memory occpied: (1432.0, 228.0)
Memory occpied: (1432.0, 688.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.854619026184082 seconds
Streaming imagenet data took 2.891057014465332 seconds
Memory occpied: (1432.0, 1140.0)
Time for forward pass: 3.7519001960754395
Memory occpied: (7922.0, 7862.0)
Time for backpropagation: 0.8210880756378174
GPU memory for training: 6.8614277839660645                          

One training iteration takes: 5.018057584762573 seconds
Index: 0
Then, training+dataloading take 5.018389940261841 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4221961498260498
Time for copying to cuda: 0.025417566299438477
Time for forward pass: 0.06167292594909668
Time for backpropagation: 0.006455421447753906
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6144781112670898 seconds
Index: 1
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.921379804611206 seconds
Streaming imagenet data took 3.001603841781616 seconds
Then, training+dataloading take 3.0071563720703125 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (2250.0, 4630.0)
Time of next(dataloader) is: 0.4093821048736572
Time for copying to cuda: 0.025149106979370117
Time for forward pass: 0.04618477821350098
Time for backpropagation: 0.004412412643432617
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.5893521308898926 seconds
Index: 2
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8738934993743896 seconds
Streaming imagenet data took 2.9098196029663086 seconds
Then, training+dataloading take 2.9159674644470215 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41274142265319824
Time for copying to cuda: 0.024837970733642578
Time for forward pass: 0.04630637168884277
Time for backpropagation: 0.004545927047729492
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6282291412353516 seconds
Index: 3
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8560616970062256 seconds
Streaming imagenet data took 2.8925483226776123 seconds
Then, training+dataloading take 2.8985743522644043 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47464537620544434
Time for copying to cuda: 0.02489018440246582
Time for forward pass: 0.04627490043640137
Time for backpropagation: 0.004515409469604492
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6634540557861328 seconds
Index: 4
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8304693698883057 seconds
Streaming imagenet data took 2.866806745529175 seconds
Then, training+dataloading take 2.8718209266662598 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4607384204864502
Time for copying to cuda: 0.025228261947631836
Time for forward pass: 0.04623818397521973
Time for backpropagation: 0.0044329166412353516
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6493184566497803 seconds
Index: 5
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.868443012237549 seconds
Streaming imagenet data took 2.905012845993042 seconds
Then, training+dataloading take 2.9100091457366943 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4819002151489258
Time for copying to cuda: 0.02488541603088379
Time for forward pass: 0.04613637924194336
Time for backpropagation: 0.004361391067504883
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6705043315887451 seconds
Index: 6
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8442635536193848 seconds
Streaming imagenet data took 2.8801939487457275 seconds
Then, training+dataloading take 2.8851661682128906 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46766185760498047
Time for copying to cuda: 0.024827003479003906
Time for forward pass: 0.04615020751953125
Time for backpropagation: 0.004342079162597656
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6690561771392822 seconds
Index: 7
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.857083320617676 seconds
Streaming imagenet data took 2.893488645553589 seconds
Then, training+dataloading take 2.898472309112549 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46329498291015625
Time for copying to cuda: 0.024682044982910156
Time for forward pass: 0.04620218276977539
Time for backpropagation: 0.0043735504150390625
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.652318000793457 seconds
Index: 8
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.867873191833496 seconds
Streaming imagenet data took 2.903949737548828 seconds
Then, training+dataloading take 2.9090051651000977 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4596517086029053
Time for copying to cuda: 0.0249326229095459
Time for forward pass: 0.04611086845397949
Time for backpropagation: 0.0046634674072265625
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6577126979827881 seconds
Index: 9
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.823577642440796 seconds
Streaming imagenet data took 2.8594799041748047 seconds
Then, training+dataloading take 2.864544153213501 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5047423839569092
Time for copying to cuda: 0.025187015533447266
Time for forward pass: 0.04620552062988281
Time for backpropagation: 0.0043659210205078125
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6635503768920898 seconds
Index: 10
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.828202247619629 seconds
Streaming imagenet data took 2.864668130874634 seconds
Then, training+dataloading take 2.869736909866333 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5059878826141357
Time for copying to cuda: 0.025051116943359375
Time for forward pass: 0.04625439643859863
Time for backpropagation: 0.004450082778930664
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6651759147644043 seconds
Index: 11
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8640854358673096 seconds
Streaming imagenet data took 2.9568026065826416 seconds
Then, training+dataloading take 2.96294903755188 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4593620300292969
Time for copying to cuda: 0.024842500686645508
Time for forward pass: 0.04642081260681152
Time for backpropagation: 0.004505157470703125
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6479065418243408 seconds
Index: 12
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8212625980377197 seconds
Streaming imagenet data took 2.902723789215088 seconds
Then, training+dataloading take 2.908252716064453 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48847079277038574
Time for copying to cuda: 0.024664640426635742
Time for forward pass: 0.04617810249328613
Time for backpropagation: 0.004412174224853516
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6456902027130127 seconds
Index: 13
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8484184741973877 seconds
Streaming imagenet data took 2.9302988052368164 seconds
Then, training+dataloading take 2.9357540607452393 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4789414405822754
Time for copying to cuda: 0.024672269821166992
Time for forward pass: 0.046141624450683594
Time for backpropagation: 0.004363536834716797
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6419095993041992 seconds
Index: 14
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8409876823425293 seconds
Streaming imagenet data took 2.921299457550049 seconds
Then, training+dataloading take 2.927060604095459 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Memory occpied: (2250.0, 4630.0)
Time of next(dataloader) is: 0.4754514694213867
Time for copying to cuda: 0.024802446365356445
Time for forward pass: 0.046210289001464844
Time for backpropagation: 0.004399538040161133
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6616711616516113 seconds
Index: 15
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.914212226867676 seconds
Streaming imagenet data took 2.950535774230957 seconds
Then, training+dataloading take 2.956106185913086 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4126565456390381
Time for copying to cuda: 0.025178909301757812
Time for forward pass: 0.04639863967895508
Time for backpropagation: 0.0045621395111083984
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.5973968505859375 seconds
Index: 16
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.9262685775756836 seconds
Streaming imagenet data took 2.9627842903137207 seconds
Then, training+dataloading take 2.968114137649536 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4744079113006592
Time for copying to cuda: 0.025046825408935547
Time for forward pass: 0.04647660255432129
Time for backpropagation: 0.004702091217041016
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6684691905975342 seconds
Index: 17
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8228228092193604 seconds
Streaming imagenet data took 2.8593544960021973 seconds
Then, training+dataloading take 2.8646490573883057 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.488391637802124
Time for copying to cuda: 0.02510356903076172
Time for forward pass: 0.04630398750305176
Time for backpropagation: 0.00450897216796875
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6593527793884277 seconds
Index: 18
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.84860897064209 seconds
Streaming imagenet data took 2.8852832317352295 seconds
Then, training+dataloading take 2.890756607055664 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46068501472473145
Time for copying to cuda: 0.02509164810180664
Time for forward pass: 0.0461583137512207
Time for backpropagation: 0.004392147064208984
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6588542461395264 seconds
Index: 19
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8745644092559814 seconds
Streaming imagenet data took 2.911595582962036 seconds
Then, training+dataloading take 2.91705584526062 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (2250.0, 4630.0)
Time of next(dataloader) is: 0.5022053718566895
Time for copying to cuda: 0.025156021118164062
Time for forward pass: 0.04636573791503906
Time for backpropagation: 0.005049705505371094
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.680178165435791 seconds
Index: 20
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.920194625854492 seconds
Streaming imagenet data took 2.9566073417663574 seconds
Then, training+dataloading take 2.9622931480407715 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42082738876342773
Time for copying to cuda: 0.025300979614257812
Time for forward pass: 0.04623675346374512
Time for backpropagation: 0.004754304885864258
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.5773699283599854 seconds
Index: 21
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.9086101055145264 seconds
Streaming imagenet data took 2.945621967315674 seconds
Then, training+dataloading take 2.9522807598114014 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43127965927124023
Time for copying to cuda: 0.02536487579345703
Time for forward pass: 0.08626413345336914
Time for backpropagation: 0.005673408508300781
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6325783729553223 seconds
Index: 22
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.830827474594116 seconds
Streaming imagenet data took 2.9127960205078125 seconds
Then, training+dataloading take 2.918989419937134 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48768043518066406
Time for copying to cuda: 0.025222301483154297
Time for forward pass: 0.04626297950744629
Time for backpropagation: 0.004802227020263672
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6484735012054443 seconds
Index: 23
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.856689214706421 seconds
Streaming imagenet data took 2.937816858291626 seconds
Then, training+dataloading take 2.943493604660034 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46316075325012207
Time for copying to cuda: 0.025159835815429688
Time for forward pass: 0.04618525505065918
Time for backpropagation: 0.005017995834350586
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6435689926147461 seconds
Index: 24
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.7908101081848145 seconds
Streaming imagenet data took 2.8284101486206055 seconds
Then, training+dataloading take 2.835355281829834 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47884559631347656
Time for copying to cuda: 0.025370359420776367
Time for forward pass: 0.046193599700927734
Time for backpropagation: 0.004435062408447266
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6775882244110107 seconds
Index: 25
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8371689319610596 seconds
Streaming imagenet data took 2.8730812072753906 seconds
Then, training+dataloading take 2.8797342777252197 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4701573848724365
Time for copying to cuda: 0.025203943252563477
Time for forward pass: 0.04613971710205078
Time for backpropagation: 0.004389286041259766
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6592206954956055 seconds
Index: 26
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8499176502227783 seconds
Streaming imagenet data took 2.8870272636413574 seconds
Then, training+dataloading take 2.8937227725982666 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5366799831390381
Time for copying to cuda: 0.025211095809936523
Time for forward pass: 0.04613161087036133
Time for backpropagation: 0.0043621063232421875
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6926634311676025 seconds
Index: 27
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.876065254211426 seconds
Streaming imagenet data took 2.957137107849121 seconds
Then, training+dataloading take 2.9625096321105957 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47237348556518555
Time for copying to cuda: 0.024982929229736328
Time for forward pass: 0.0462646484375
Time for backpropagation: 0.0045375823974609375
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
One training iteration takes: 0.6481969356536865 seconds
Index: 28
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8656599521636963 seconds
Streaming imagenet data took 2.947080612182617 seconds
Then, training+dataloading take 2.952383279800415 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Memory occpied: (2250.0, 4630.0)
Time of next(dataloader) is: 0.47117090225219727
Time for copying to cuda: 0.025087594985961914
Time for forward pass: 0.046434640884399414
Time for backpropagation: 0.0047037601470947266
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.6317765712738037 seconds
Index: 29
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.917417526245117 seconds
Streaming imagenet data took 2.9534387588500977 seconds
Then, training+dataloading take 2.9592504501342773 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.418290376663208
Time for copying to cuda: 0.025117874145507812
Time for forward pass: 0.04614901542663574
Time for backpropagation: 0.004406452178955078
GPU memory for training: 1.261444091796875                          

One training iteration takes: 0.5927755832672119 seconds
Index: 30
Memory occpied: (2250.0, 4630.0)
Memory occpied: (2250.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.908888816833496 seconds
Streaming imagenet data took 2.9454240798950195 seconds
Then, training+dataloading take 2.9510347843170166 seconds

Epoch: 0
Time of next(dataloader) is: 0.43503761291503906
Time for copying to cuda: 0.02521514892578125
Time for forward pass: 0.0765073299407959
Time for backpropagation: 0.005351066589355469
GPU memory for training: 1.261444091796875                          

Memory occpied: (2250.0, 4630.0)
The whole process took 103.3841872215271 seconds
