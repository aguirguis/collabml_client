Cached  True
Transformed  True
All in COS  False
No adaptation  True
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=True, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.2420648312027 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118914031.9215554 118914031.9215554
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  259.0654296875 343.33544921875 602.40087890625 6946.85107421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.9678571224212646 seconds
Streaming imagenet data took 3.0045595169067383 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3412203788757324
Time for copying to cuda: 0.02531266212463379
Memory occpied: (1432.0, 222.0)
Memory occpied: (1432.0, 706.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8702359199523926 seconds
Streaming imagenet data took 2.9612278938293457 seconds
Memory occpied: (1432.0, 1106.0)
Time for forward pass: 3.709294319152832
Memory occpied: (7922.0, 7862.0)
Time for backpropagation: 0.7733988761901855
GPU memory for training: 6.8614277839660645                          

One training iteration takes: 4.935418605804443 seconds
Index: 0
Then, training+dataloading take 4.935752630233765 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44724369049072266
Time for copying to cuda: 0.025386571884155273
Time for forward pass: 0.03327798843383789
Time for backpropagation: 0.004430532455444336
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6461164951324463 seconds
Index: 1
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.863679885864258 seconds
Streaming imagenet data took 2.9428791999816895 seconds
Then, training+dataloading take 2.948225975036621 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44276976585388184
Time for copying to cuda: 0.024876117706298828
Time for forward pass: 0.04644942283630371
Time for backpropagation: 0.004526853561401367
GPU memory for training: 1.2606515884399414                          

Memory occpied: (4728.0, 4630.0)
One training iteration takes: 0.5994424819946289 seconds
Index: 2
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.918142557144165 seconds
Streaming imagenet data took 2.9975638389587402 seconds
Then, training+dataloading take 3.0034842491149902 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (4728.0, 4630.0)
Time of next(dataloader) is: 0.4045841693878174
Time for copying to cuda: 0.024930953979492188
Time for forward pass: 0.04628944396972656
Time for backpropagation: 0.004574775695800781
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.5779688358306885 seconds
Index: 3
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.9406094551086426 seconds
Streaming imagenet data took 2.9765236377716064 seconds
Then, training+dataloading take 2.982386827468872 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4024839401245117
Time for copying to cuda: 0.02492213249206543
Time for forward pass: 0.046205759048461914
Time for backpropagation: 0.0043985843658447266
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.5688278675079346 seconds
Index: 4
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8639931678771973 seconds
Streaming imagenet data took 2.9010345935821533 seconds
Then, training+dataloading take 2.905780076980591 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4458897113800049
Time for copying to cuda: 0.02457284927368164
Time for forward pass: 0.04621005058288574
Time for backpropagation: 0.0043904781341552734
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6336886882781982 seconds
Index: 5
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.87382435798645 seconds
Streaming imagenet data took 2.9097893238067627 seconds
Then, training+dataloading take 2.914583921432495 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45019078254699707
Time for copying to cuda: 0.024651288986206055
Time for forward pass: 0.04619264602661133
Time for backpropagation: 0.004374980926513672
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6541481018066406 seconds
Index: 6
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.847166061401367 seconds
Streaming imagenet data took 2.8837180137634277 seconds
Then, training+dataloading take 2.8886189460754395 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48102688789367676
Time for copying to cuda: 0.024796485900878906
Time for forward pass: 0.046250104904174805
Time for backpropagation: 0.00441431999206543
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6702635288238525 seconds
Index: 7
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8701698780059814 seconds
Streaming imagenet data took 2.9071168899536133 seconds
Then, training+dataloading take 2.912975549697876 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4486727714538574
Time for copying to cuda: 0.02484273910522461
Time for forward pass: 0.04641604423522949
Time for backpropagation: 0.004601478576660156
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6586549282073975 seconds
Index: 8
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8732352256774902 seconds
Streaming imagenet data took 2.9096434116363525 seconds
Then, training+dataloading take 2.915553569793701 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.471407413482666
Time for copying to cuda: 0.024653911590576172
Time for forward pass: 0.04623675346374512
Time for backpropagation: 0.0044438838958740234
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6284995079040527 seconds
Index: 9
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8691396713256836 seconds
Streaming imagenet data took 2.9057915210723877 seconds
Then, training+dataloading take 2.9117379188537598 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45624303817749023
Time for copying to cuda: 0.024653911590576172
Time for forward pass: 0.04615664482116699
Time for backpropagation: 0.004332304000854492
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.660353422164917 seconds
Index: 10
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.842716932296753 seconds
Streaming imagenet data took 2.8786232471466064 seconds
Then, training+dataloading take 2.8834497928619385 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44391441345214844
Time for copying to cuda: 0.024748802185058594
Time for forward pass: 0.04621458053588867
Time for backpropagation: 0.004369020462036133
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6311337947845459 seconds
Index: 11
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8786280155181885 seconds
Streaming imagenet data took 2.9149961471557617 seconds
Then, training+dataloading take 2.919813871383667 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4535045623779297
Time for copying to cuda: 0.02482748031616211
Time for forward pass: 0.04620862007141113
Time for backpropagation: 0.00441431999206543
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6406102180480957 seconds
Index: 12
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8267018795013428 seconds
Streaming imagenet data took 2.86258602142334 seconds
Then, training+dataloading take 2.867560625076294 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44672298431396484
Time for copying to cuda: 0.024750947952270508
Time for forward pass: 0.04642820358276367
Time for backpropagation: 0.004620552062988281
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6607050895690918 seconds
Index: 13
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8695921897888184 seconds
Streaming imagenet data took 2.905391216278076 seconds
Then, training+dataloading take 2.910222291946411 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44516611099243164
Time for copying to cuda: 0.024458646774291992
Time for forward pass: 0.04625511169433594
Time for backpropagation: 0.0044765472412109375
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6342642307281494 seconds
Index: 14
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8536970615386963 seconds
Streaming imagenet data took 2.8897199630737305 seconds
Then, training+dataloading take 2.8946194648742676 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4543013572692871
Time for copying to cuda: 0.024973630905151367
Time for forward pass: 0.04633808135986328
Time for backpropagation: 0.004446268081665039
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6425082683563232 seconds
Index: 15
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.853196620941162 seconds
Streaming imagenet data took 2.8902320861816406 seconds
Then, training+dataloading take 2.89513897895813 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4684598445892334
Time for copying to cuda: 0.024749755859375
Time for forward pass: 0.04626321792602539
Time for backpropagation: 0.0043909549713134766
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6547150611877441 seconds
Index: 16
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8761940002441406 seconds
Streaming imagenet data took 2.9125564098358154 seconds
Then, training+dataloading take 2.917515277862549 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47597599029541016
Time for copying to cuda: 0.02467942237854004
Time for forward pass: 0.046228647232055664
Time for backpropagation: 0.004355907440185547
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6991162300109863 seconds
Index: 17
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.853524684906006 seconds
Streaming imagenet data took 2.890558958053589 seconds
Then, training+dataloading take 2.8954684734344482 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45151853561401367
Time for copying to cuda: 0.024600982666015625
Time for forward pass: 0.04645204544067383
Time for backpropagation: 0.004505157470703125
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.639735221862793 seconds
Index: 18
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.861018419265747 seconds
Streaming imagenet data took 2.8970463275909424 seconds
Then, training+dataloading take 2.9019479751586914 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5177762508392334
Time for copying to cuda: 0.024611711502075195
Time for forward pass: 0.046199798583984375
Time for backpropagation: 0.0043621063232421875
GPU memory for training: 1.2606515884399414                          

Memory occpied: (4728.0, 4630.0)
One training iteration takes: 0.6932017803192139 seconds
Index: 19
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8289551734924316 seconds
Streaming imagenet data took 2.864871025085449 seconds
Then, training+dataloading take 2.8698041439056396 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4442627429962158
Time for copying to cuda: 0.024820566177368164
Time for forward pass: 0.04643988609313965
Time for backpropagation: 0.00443720817565918
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6383180618286133 seconds
Index: 20
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.823077917098999 seconds
Streaming imagenet data took 2.859497547149658 seconds
Then, training+dataloading take 2.8644018173217773 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.446763277053833
Time for copying to cuda: 0.024858474731445312
Time for forward pass: 0.046250104904174805
Time for backpropagation: 0.00441288948059082
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6470620632171631 seconds
Index: 21
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8821136951446533 seconds
Streaming imagenet data took 2.918056011199951 seconds
Then, training+dataloading take 2.9230449199676514 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44950246810913086
Time for copying to cuda: 0.024648189544677734
Time for forward pass: 0.04618978500366211
Time for backpropagation: 0.004415273666381836
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.642632246017456 seconds
Index: 22
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8263156414031982 seconds
Streaming imagenet data took 2.8629348278045654 seconds
Then, training+dataloading take 2.867863178253174 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4619767665863037
Time for copying to cuda: 0.024866580963134766
Time for forward pass: 0.04616880416870117
Time for backpropagation: 0.004468441009521484
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6612153053283691 seconds
Index: 23
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.905273914337158 seconds
Streaming imagenet data took 2.9411089420318604 seconds
Then, training+dataloading take 2.9460229873657227 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49282383918762207
Time for copying to cuda: 0.024898529052734375
Time for forward pass: 0.04645085334777832
Time for backpropagation: 0.004557371139526367
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.687788724899292 seconds
Index: 24
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8720695972442627 seconds
Streaming imagenet data took 2.9086356163024902 seconds
Then, training+dataloading take 2.9136130809783936 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47824525833129883
Time for copying to cuda: 0.02481222152709961
Time for forward pass: 0.04617142677307129
Time for backpropagation: 0.00448298454284668
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6727581024169922 seconds
Index: 25
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.864652633666992 seconds
Streaming imagenet data took 2.900538444519043 seconds
Then, training+dataloading take 2.9054577350616455 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47188901901245117
Time for copying to cuda: 0.02476024627685547
Time for forward pass: 0.04619336128234863
Time for backpropagation: 0.0044019222259521484
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6599721908569336 seconds
Index: 26
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8873207569122314 seconds
Streaming imagenet data took 2.9238486289978027 seconds
Then, training+dataloading take 2.928743839263916 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47947096824645996
Time for copying to cuda: 0.024709463119506836
Time for forward pass: 0.046262502670288086
Time for backpropagation: 0.004465818405151367
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6784570217132568 seconds
Index: 27
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.9169535636901855 seconds
Streaming imagenet data took 2.952775239944458 seconds
Then, training+dataloading take 2.957686424255371 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4477853775024414
Time for copying to cuda: 0.02479076385498047
Time for forward pass: 0.04621553421020508
Time for backpropagation: 0.004395246505737305
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6404907703399658 seconds
Index: 28
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8275392055511475 seconds
Streaming imagenet data took 2.8647615909576416 seconds
Then, training+dataloading take 2.8700034618377686 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44863414764404297
Time for copying to cuda: 0.024590015411376953
Time for forward pass: 0.04624509811401367
Time for backpropagation: 0.004712820053100586
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.638209342956543 seconds
Index: 29
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.8548552989959717 seconds
Streaming imagenet data took 2.890897750854492 seconds
Then, training+dataloading take 2.8958308696746826 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44892024993896484
Time for copying to cuda: 0.024672269821166992
Time for forward pass: 0.04617881774902344
Time for backpropagation: 0.0043642520904541016
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.6358442306518555 seconds
Index: 30
Memory occpied: (4728.0, 4630.0)
Memory occpied: (4728.0, 4630.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.861050605773926 seconds
Streaming imagenet data took 2.8981149196624756 seconds
Then, training+dataloading take 2.903050184249878 seconds

Epoch: 0
Time of next(dataloader) is: 0.4893951416015625
Time for copying to cuda: 0.02456951141357422
Time for forward pass: 0.04622054100036621
Time for backpropagation: 0.0044367313385009766
GPU memory for training: 1.2606515884399414                          

Memory occpied: (4728.0, 4630.0)
The whole process took 103.09721803665161 seconds
