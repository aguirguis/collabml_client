Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2225950549121 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119042551.97903743 119042551.97903743
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6476585865020752 seconds
Streaming imagenet data took 1.6615042686462402 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32934999465942383
Time for copying to cuda: 0.01004648208618164
Memory occpied: (1550.0, 250.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6171393394470215 seconds
Streaming imagenet data took 1.6311471462249756 seconds
Memory occpied: (1550.0, 698.0)
Memory occpied: (1550.0, 1170.0)
Time for forward pass: 3.238582134246826
Time for backpropagation: 0.04967498779296875
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.6895487308502197 seconds
Index: 0
Then, training+dataloading take 3.689742088317871 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35863542556762695
Time for copying to cuda: 0.009656190872192383
Time for forward pass: 0.04986000061035156
Time for backpropagation: 0.0034263134002685547
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.5194118022918701 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6123106479644775 seconds
Streaming imagenet data took 1.6261394023895264 seconds
Then, training+dataloading take 1.6283910274505615 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42891979217529297
Time for copying to cuda: 0.009440898895263672
Time for forward pass: 0.04935431480407715
Time for backpropagation: 0.0029363632202148438
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6282823085784912 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6409218311309814 seconds
Streaming imagenet data took 1.6546363830566406 seconds
Then, training+dataloading take 1.6569149494171143 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4554574489593506
Time for copying to cuda: 0.009239912033081055
Time for forward pass: 0.0493617057800293
Time for backpropagation: 0.0026471614837646484
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6075484752655029 seconds
Index: 3
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.609053134918213 seconds
Streaming imagenet data took 1.6652348041534424 seconds
Then, training+dataloading take 1.6695733070373535 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4099149703979492
Time for copying to cuda: 0.009206295013427734
Time for forward pass: 0.04926490783691406
Time for backpropagation: 0.002787351608276367
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5605802536010742 seconds
Index: 4
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6304101943969727 seconds
Streaming imagenet data took 1.6450755596160889 seconds
Then, training+dataloading take 1.646681547164917 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41459059715270996
Time for copying to cuda: 0.009379148483276367
Time for forward pass: 0.04919123649597168
Time for backpropagation: 0.0026006698608398438
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5711750984191895 seconds
Index: 5
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6422638893127441 seconds
Streaming imagenet data took 1.6563737392425537 seconds
Then, training+dataloading take 1.6579585075378418 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4192776679992676
Time for copying to cuda: 0.009386062622070312
Time for forward pass: 0.049469947814941406
Time for backpropagation: 0.002732515335083008
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5726790428161621 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6741960048675537 seconds
Streaming imagenet data took 1.688255786895752 seconds
Then, training+dataloading take 1.690770149230957 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3691854476928711
Time for copying to cuda: 0.009380578994750977
Time for forward pass: 0.04928874969482422
Time for backpropagation: 0.0025358200073242188
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5227530002593994 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6335070133209229 seconds
Streaming imagenet data took 1.6476335525512695 seconds
Then, training+dataloading take 1.6501872539520264 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41423606872558594
Time for copying to cuda: 0.009716033935546875
Time for forward pass: 0.04942655563354492
Time for backpropagation: 0.0027196407318115234
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.557753324508667 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6086657047271729 seconds
Streaming imagenet data took 1.6658425331115723 seconds
Then, training+dataloading take 1.6703503131866455 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45144152641296387
Time for copying to cuda: 0.009321212768554688
Time for forward pass: 0.04926609992980957
Time for backpropagation: 0.0025773048400878906
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6067521572113037 seconds
Index: 9
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6621601581573486 seconds
Streaming imagenet data took 1.6765849590301514 seconds
Then, training+dataloading take 1.678307056427002 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4609549045562744
Time for copying to cuda: 0.009366750717163086
Time for forward pass: 0.04917311668395996
Time for backpropagation: 0.0025391578674316406
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6105434894561768 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7036027908325195 seconds
Streaming imagenet data took 1.7173194885253906 seconds
Then, training+dataloading take 1.7198479175567627 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37528204917907715
Time for copying to cuda: 0.00940084457397461
Time for forward pass: 0.04922914505004883
Time for backpropagation: 0.0025932788848876953
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5436570644378662 seconds
Index: 11
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5943019390106201 seconds
Streaming imagenet data took 1.6084206104278564 seconds
Then, training+dataloading take 1.6109254360198975 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3863341808319092
Time for copying to cuda: 0.009366035461425781
Time for forward pass: 0.06076312065124512
Time for backpropagation: 0.003164052963256836
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5753672122955322 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6235806941986084 seconds
Streaming imagenet data took 1.637197494506836 seconds
Then, training+dataloading take 1.6396722793579102 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41275906562805176
Time for copying to cuda: 0.009395837783813477
Time for forward pass: 0.04946255683898926
Time for backpropagation: 0.0026552677154541016
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6007013320922852 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.607675552368164 seconds
Streaming imagenet data took 1.6215465068817139 seconds
Then, training+dataloading take 1.6240410804748535 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4143829345703125
Time for copying to cuda: 0.009560108184814453
Time for forward pass: 0.04954266548156738
Time for backpropagation: 0.002733945846557617
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5971026420593262 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6199584007263184 seconds
Streaming imagenet data took 1.6340649127960205 seconds
Then, training+dataloading take 1.6365931034088135 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43824172019958496
Time for copying to cuda: 0.009452342987060547
Time for forward pass: 0.049277305603027344
Time for backpropagation: 0.0028052330017089844
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6311049461364746 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6239900588989258 seconds
Streaming imagenet data took 1.6377620697021484 seconds
Then, training+dataloading take 1.6402664184570312 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42102885246276855
Time for copying to cuda: 0.009470462799072266
Time for forward pass: 0.04921388626098633
Time for backpropagation: 0.0026483535766601562
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6094074249267578 seconds
Index: 16
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5887856483459473 seconds
Streaming imagenet data took 1.6026904582977295 seconds
Then, training+dataloading take 1.6051983833312988 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4106922149658203
Time for copying to cuda: 0.009387969970703125
Time for forward pass: 0.04923200607299805
Time for backpropagation: 0.0027468204498291016
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6119735240936279 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6163640022277832 seconds
Streaming imagenet data took 1.6300663948059082 seconds
Then, training+dataloading take 1.6325769424438477 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41116952896118164
Time for copying to cuda: 0.00951242446899414
Time for forward pass: 0.04918932914733887
Time for backpropagation: 0.0026519298553466797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6018233299255371 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.585808515548706 seconds
Streaming imagenet data took 1.5997207164764404 seconds
Then, training+dataloading take 1.6022400856018066 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4116499423980713
Time for copying to cuda: 0.009342193603515625
Time for forward pass: 0.049263954162597656
Time for backpropagation: 0.002551555633544922
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6081235408782959 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6317219734191895 seconds
Streaming imagenet data took 1.6454548835754395 seconds
Then, training+dataloading take 1.64790940284729 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42801713943481445
Time for copying to cuda: 0.009388923645019531
Time for forward pass: 0.04921364784240723
Time for backpropagation: 0.002577543258666992
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6202683448791504 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6009948253631592 seconds
Streaming imagenet data took 1.6148889064788818 seconds
Then, training+dataloading take 1.6173710823059082 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43441247940063477
Time for copying to cuda: 0.0093536376953125
Time for forward pass: 0.04935121536254883
Time for backpropagation: 0.0025472640991210938
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6128439903259277 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6429529190063477 seconds
Streaming imagenet data took 1.656641960144043 seconds
Then, training+dataloading take 1.659071445465088 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4590604305267334
Time for copying to cuda: 0.00944066047668457
Time for forward pass: 0.04934883117675781
Time for backpropagation: 0.0027697086334228516
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5950741767883301 seconds
Index: 22
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6897861957550049 seconds
Streaming imagenet data took 1.7466814517974854 seconds
Then, training+dataloading take 1.751420259475708 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.37410664558410645
Time for copying to cuda: 0.009591341018676758
Time for forward pass: 0.04939770698547363
Time for backpropagation: 0.0027332305908203125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5390243530273438 seconds
Index: 23
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6065092086791992 seconds
Streaming imagenet data took 1.6202595233917236 seconds
Then, training+dataloading take 1.6229147911071777 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3699605464935303
Time for copying to cuda: 0.009373664855957031
Time for forward pass: 0.04918479919433594
Time for backpropagation: 0.002586841583251953
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5267224311828613 seconds
Index: 24
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6209914684295654 seconds
Streaming imagenet data took 1.6349928379058838 seconds
Then, training+dataloading take 1.637641429901123 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3927114009857178
Time for copying to cuda: 0.009625434875488281
Time for forward pass: 0.049497127532958984
Time for backpropagation: 0.002712726593017578
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5473136901855469 seconds
Index: 25
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6673071384429932 seconds
Streaming imagenet data took 1.681356430053711 seconds
Then, training+dataloading take 1.6830196380615234 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4428107738494873
Time for copying to cuda: 0.009496927261352539
Time for forward pass: 0.04952406883239746
Time for backpropagation: 0.0026912689208984375
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5785598754882812 seconds
Index: 26
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6528079509735107 seconds
Streaming imagenet data took 1.6670660972595215 seconds
Then, training+dataloading take 1.668745517730713 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.43445611000061035
Time for copying to cuda: 0.009586811065673828
Time for forward pass: 0.04923677444458008
Time for backpropagation: 0.0027875900268554688
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5846476554870605 seconds
Index: 27
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6679048538208008 seconds
Streaming imagenet data took 1.6820178031921387 seconds
Then, training+dataloading take 1.6845386028289795 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37050700187683105
Time for copying to cuda: 0.009465694427490234
Time for forward pass: 0.04938197135925293
Time for backpropagation: 0.0026645660400390625
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5223743915557861 seconds
Index: 28
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.660632610321045 seconds
Streaming imagenet data took 1.6745102405548096 seconds
Then, training+dataloading take 1.676969051361084 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3951840400695801
Time for copying to cuda: 0.009606361389160156
Time for forward pass: 0.04959273338317871
Time for backpropagation: 0.0027306079864501953
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5482020378112793 seconds
Index: 29
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6788127422332764 seconds
Streaming imagenet data took 1.6930172443389893 seconds
Then, training+dataloading take 1.6946899890899658 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4190514087677002
Time for copying to cuda: 0.009341001510620117
Time for forward pass: 0.04933452606201172
Time for backpropagation: 0.002601146697998047
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5694301128387451 seconds
Index: 30
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.666351556777954 seconds
Streaming imagenet data took 1.6805033683776855 seconds
Then, training+dataloading take 1.6821656227111816 seconds

Epoch: 0
Time of next(dataloader) is: 0.4102044105529785
Time for copying to cuda: 0.009457111358642578
Time for forward pass: 0.04936051368713379
Time for backpropagation: 0.0025289058685302734
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
The whole process took 63.06169939041138 seconds
