Namespace(batch_size=4000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='myvit', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Error of iperf: unable to connect to server: 
Recorded bandwidth: 908.2855256674147 Mbps
All candidates indexes:  (array([15, 16, 17, 18]),)
Communication time:  [5.05760564e-03 5.08340975e-03 5.08340975e-03 1.42732614e-01
 1.42732614e-01 1.42732614e-01 1.42732614e-01 1.42732614e-01
 1.42732614e-01 1.42732614e-01 1.42732614e-01 1.42732614e-01
 1.42732614e-01 1.42732614e-01 1.42732614e-01 2.58041104e-05
 2.58041104e-05 2.58041104e-05 3.35991021e-05]
Computation time:  [0.09705805778503418, 0.09502363204956055, 0.09461688995361328, 0.09453749656677246, 0.08533453941345215, 0.07751822471618652, 0.06966781616210938, 0.06190156936645508, 0.05421257019042969, 0.04654645919799805, 0.038834333419799805, 0.03113842010498047, 0.02348494529724121, 0.015719175338745117, 0.007987022399902344, 0.0002989768981933594, 0.00011730194091796875, 0.00011348724365234375, 0.00011134147644042969]
Indexes that satisfies the communication less than computation:  [15, 16, 17, 18]
330.2294006347656 0.04908050028483073
Using split index: 16
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
4
Start 0, end 4000, post_step 1000

Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 35.18017077445984 seconds
Streaming imagenet data took 35.18663311004639 seconds
The mode is:  split
4
Start 4000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.323502779006958
Time for copying to cuda: 0.003926515579223633
Memory occpied: (1642.0, 192.0)
Memory occpied: (1642.0, 590.0)
Memory occpied: (1642.0, 1070.0)
Time for forward pass: 3.394744873046875
Time for backpropagation: 0.07911109924316406
GPU memory for training: 1.3530588150024414                          

One training iteration takes: 3.8777432441711426 seconds
Index: 0
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Memory occpied: (2394.0, 1672.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 37.112775564193726 seconds
Streaming imagenet data took 37.119221448898315 seconds
Then, training+dataloading take 37.12159466743469 seconds
The mode is:  split
4
Start 8000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43077516555786133
Time for copying to cuda: 0.0035033226013183594
Time for forward pass: 0.056182146072387695
Time for backpropagation: 0.009349822998046875
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.6097776889801025 seconds
Index: 1
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 38.20867896080017 seconds
Streaming imagenet data took 38.21501874923706 seconds
Then, training+dataloading take 38.216325521469116 seconds
The mode is:  split
4
Start 12000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4184906482696533
Time for copying to cuda: 0.003534555435180664
Time for forward pass: 0.09364104270935059
Time for backpropagation: 0.008960485458374023
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.6408116817474365 seconds
Index: 2
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 38.60402274131775 seconds
Streaming imagenet data took 38.61022615432739 seconds
Then, training+dataloading take 38.6114444732666 seconds
The mode is:  split
4
Start 16000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47121119499206543
Time for copying to cuda: 0.00339508056640625
Time for forward pass: 0.0557103157043457
Time for backpropagation: 0.008297204971313477
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.6566331386566162 seconds
Index: 3
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 39.42871379852295 seconds
Streaming imagenet data took 39.43326282501221 seconds
Then, training+dataloading take 39.43565583229065 seconds
The mode is:  split
4
Start 20000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3940565586090088
Time for copying to cuda: 0.0034148693084716797
Time for forward pass: 0.05578899383544922
Time for backpropagation: 0.008231163024902344
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.5538699626922607 seconds
Index: 4
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 38.9049916267395 seconds
Streaming imagenet data took 38.9092161655426 seconds
Then, training+dataloading take 38.91053867340088 seconds
The mode is:  split
4
Start 24000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (2422.0, 1680.0)
Time of next(dataloader) is: 0.4952869415283203
Time for copying to cuda: 0.003454923629760742
Time for forward pass: 0.055856943130493164
Time for backpropagation: 0.008447885513305664
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.659703254699707 seconds
Index: 5
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 39.60651636123657 seconds
Streaming imagenet data took 39.610992193222046 seconds
Then, training+dataloading take 39.61224436759949 seconds
The mode is:  split
4
Start 28000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44274306297302246
Time for copying to cuda: 0.0035169124603271484
Time for forward pass: 0.05606961250305176
Time for backpropagation: 0.008458137512207031
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.6505875587463379 seconds
Index: 6
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 38.35668420791626 seconds
Streaming imagenet data took 38.36092400550842 seconds
Then, training+dataloading take 38.36224937438965 seconds
The mode is:  split
4
Start 32000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3923804759979248
Time for copying to cuda: 0.0034608840942382812
Time for forward pass: 0.09072303771972656
Time for backpropagation: 0.00853586196899414
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.6331381797790527 seconds
Index: 7
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 39.83181309700012 seconds
Streaming imagenet data took 39.83632564544678 seconds
Then, training+dataloading take 39.83762526512146 seconds
The mode is:  split
4
Start 36000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4779942035675049
Time for copying to cuda: 0.003398895263671875
Time for forward pass: 0.05574369430541992
Time for backpropagation: 0.008360624313354492
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.6828927993774414 seconds
Index: 8
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 39.531071186065674 seconds
Streaming imagenet data took 39.53523588180542 seconds
Then, training+dataloading take 39.53765511512756 seconds
The mode is:  split
4
Start 40000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3922233581542969
Time for copying to cuda: 0.0034716129302978516
Time for forward pass: 0.05584907531738281
Time for backpropagation: 0.008404254913330078
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.5903856754302979 seconds
Index: 9
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 39.304500579833984 seconds
Streaming imagenet data took 39.30893874168396 seconds
Then, training+dataloading take 39.31021690368652 seconds
The mode is:  split
4
Start 44000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4309399127960205
Time for copying to cuda: 0.0034351348876953125
Time for forward pass: 0.056078195571899414
Time for backpropagation: 0.008421182632446289
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.5873236656188965 seconds
Index: 10
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 11.850456237792969 MBs for this batch
Executing all posts took 39.55580139160156 seconds
Streaming imagenet data took 39.56362271308899 seconds
Then, training+dataloading take 39.56898641586304 seconds
The mode is:  split
4
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (2422.0, 1680.0)
Time of next(dataloader) is: 0.42595672607421875
Time for copying to cuda: 0.0034058094024658203
Time for forward pass: 0.05558609962463379
Time for backpropagation: 0.008308649063110352
GPU memory for training: 1.3706331253051758                          

One training iteration takes: 0.6009078025817871 seconds
Index: 11
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Memory occpied: (2422.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 24.158731698989868 seconds
Streaming imagenet data took 24.1617488861084 seconds
Then, training+dataloading take 24.16271448135376 seconds

Epoch: 0
Time of next(dataloader) is: 0.44559550285339355
Time for copying to cuda: 0.001963376998901367
Time for forward pass: 0.05555295944213867
Time for backpropagation: 0.008321046829223633
GPU memory for training: 1.3573460578918457                          

Memory occpied: (2422.0, 1680.0)
The whole process took 496.4610104560852 seconds
