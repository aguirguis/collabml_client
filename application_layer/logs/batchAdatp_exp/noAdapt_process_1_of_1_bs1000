Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3598167184404 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119060537.89691941 119060537.89691941
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 440.30517578125 725.0439453125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 440.30517578125 725.0439453125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5549914836883545 seconds
Streaming imagenet data took 1.56868314743042 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31716442108154297
Time for copying to cuda: 0.010027647018432617
Memory occpied: (1550.0, 308.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5434064865112305 seconds
Streaming imagenet data took 1.5576903820037842 seconds
Memory occpied: (1550.0, 712.0)
Memory occpied: (1550.0, 1176.0)
Time for forward pass: 3.3018929958343506
Time for backpropagation: 0.050855159759521484
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.7587153911590576 seconds
Index: 0
Then, training+dataloading take 3.758904218673706 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3552978038787842
Time for copying to cuda: 0.009581804275512695
Time for forward pass: 0.04991555213928223
Time for backpropagation: 0.0035572052001953125
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.5184104442596436 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.444312334060669 seconds
Streaming imagenet data took 1.4584922790527344 seconds
Then, training+dataloading take 1.4607975482940674 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39093565940856934
Time for copying to cuda: 0.009605169296264648
Time for forward pass: 0.049483299255371094
Time for backpropagation: 0.0027294158935546875
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5317270755767822 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.548893690109253 seconds
Streaming imagenet data took 1.5628924369812012 seconds
Then, training+dataloading take 1.565290927886963 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.470233678817749
Time for copying to cuda: 0.00937795639038086
Time for forward pass: 0.04929780960083008
Time for backpropagation: 0.002572298049926758
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6110737323760986 seconds
Index: 3
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4410951137542725 seconds
Streaming imagenet data took 1.5104305744171143 seconds
Then, training+dataloading take 1.5147674083709717 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43958497047424316
Time for copying to cuda: 0.009522676467895508
Time for forward pass: 0.04946494102478027
Time for backpropagation: 0.002678394317626953
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5931644439697266 seconds
Index: 4
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.481184720993042 seconds
Streaming imagenet data took 1.4948930740356445 seconds
Then, training+dataloading take 1.4974589347839355 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.461256742477417
Time for copying to cuda: 0.009446859359741211
Time for forward pass: 0.049308061599731445
Time for backpropagation: 0.002567291259765625
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6146790981292725 seconds
Index: 5
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.454136848449707 seconds
Streaming imagenet data took 1.4680442810058594 seconds
Then, training+dataloading take 1.4703073501586914 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40590643882751465
Time for copying to cuda: 0.009580135345458984
Time for forward pass: 0.0494077205657959
Time for backpropagation: 0.0025925636291503906
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6025245189666748 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.497161865234375 seconds
Streaming imagenet data took 1.5112872123718262 seconds
Then, training+dataloading take 1.5136473178863525 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42244458198547363
Time for copying to cuda: 0.009564876556396484
Time for forward pass: 0.04940009117126465
Time for backpropagation: 0.002643108367919922
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5937538146972656 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4723892211914062 seconds
Streaming imagenet data took 1.4862875938415527 seconds
Then, training+dataloading take 1.4886069297790527 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4562234878540039
Time for copying to cuda: 0.009495019912719727
Time for forward pass: 0.04948687553405762
Time for backpropagation: 0.002666473388671875
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5904011726379395 seconds
Index: 8
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5128867626190186 seconds
Streaming imagenet data took 1.5820977687835693 seconds
Then, training+dataloading take 1.5863487720489502 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4063441753387451
Time for copying to cuda: 0.009463071823120117
Time for forward pass: 0.049353599548339844
Time for backpropagation: 0.002669811248779297
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5551021099090576 seconds
Index: 9
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.504455804824829 seconds
Streaming imagenet data took 1.5186381340026855 seconds
Then, training+dataloading take 1.5211682319641113 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4046938419342041
Time for copying to cuda: 0.009405374526977539
Time for forward pass: 0.04946494102478027
Time for backpropagation: 0.0026400089263916016
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5919671058654785 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.543426275253296 seconds
Streaming imagenet data took 1.557574987411499 seconds
Then, training+dataloading take 1.5599448680877686 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44941043853759766
Time for copying to cuda: 0.009527921676635742
Time for forward pass: 0.04938769340515137
Time for backpropagation: 0.002689361572265625
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6022605895996094 seconds
Index: 11
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4937243461608887 seconds
Streaming imagenet data took 1.507910966873169 seconds
Then, training+dataloading take 1.5102577209472656 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4403526782989502
Time for copying to cuda: 0.0094146728515625
Time for forward pass: 0.04937005043029785
Time for backpropagation: 0.002683401107788086
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6142086982727051 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5455591678619385 seconds
Streaming imagenet data took 1.5596253871917725 seconds
Then, training+dataloading take 1.5619525909423828 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4051055908203125
Time for copying to cuda: 0.00951385498046875
Time for forward pass: 0.049398183822631836
Time for backpropagation: 0.0026366710662841797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5766184329986572 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4582200050354004 seconds
Streaming imagenet data took 1.4722061157226562 seconds
Then, training+dataloading take 1.4745185375213623 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4237515926361084
Time for copying to cuda: 0.009543418884277344
Time for forward pass: 0.0494081974029541
Time for backpropagation: 0.0026977062225341797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5960180759429932 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5482258796691895 seconds
Streaming imagenet data took 1.5620596408843994 seconds
Then, training+dataloading take 1.5644009113311768 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40454816818237305
Time for copying to cuda: 0.009540319442749023
Time for forward pass: 0.04947543144226074
Time for backpropagation: 0.0026357173919677734
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5996794700622559 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4310567378997803 seconds
Streaming imagenet data took 1.4450750350952148 seconds
Then, training+dataloading take 1.447397232055664 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43002891540527344
Time for copying to cuda: 0.009485483169555664
Time for forward pass: 0.04951667785644531
Time for backpropagation: 0.0027353763580322266
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5652172565460205 seconds
Index: 16
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5989210605621338 seconds
Streaming imagenet data took 1.6547527313232422 seconds
Then, training+dataloading take 1.6590378284454346 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.38584446907043457
Time for copying to cuda: 0.009369850158691406
Time for forward pass: 0.049341440200805664
Time for backpropagation: 0.0026099681854248047
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5379910469055176 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5753753185272217 seconds
Streaming imagenet data took 1.5892798900604248 seconds
Then, training+dataloading take 1.5918793678283691 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38542628288269043
Time for copying to cuda: 0.009358882904052734
Time for forward pass: 0.049423933029174805
Time for backpropagation: 0.0026865005493164062
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5286898612976074 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5025897026062012 seconds
Streaming imagenet data took 1.516585111618042 seconds
Then, training+dataloading take 1.5191190242767334 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3646862506866455
Time for copying to cuda: 0.00945281982421875
Time for forward pass: 0.049498796463012695
Time for backpropagation: 0.002646207809448242
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5162935256958008 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4572796821594238 seconds
Streaming imagenet data took 1.471193790435791 seconds
Then, training+dataloading take 1.473719596862793 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4238154888153076
Time for copying to cuda: 0.00946807861328125
Time for forward pass: 0.04929542541503906
Time for backpropagation: 0.0027027130126953125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5938959121704102 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5422279834747314 seconds
Streaming imagenet data took 1.556154489517212 seconds
Then, training+dataloading take 1.5585908889770508 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4125189781188965
Time for copying to cuda: 0.009457111358642578
Time for forward pass: 0.049472808837890625
Time for backpropagation: 0.002752065658569336
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5860636234283447 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4589159488677979 seconds
Streaming imagenet data took 1.4729135036468506 seconds
Then, training+dataloading take 1.4754092693328857 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4357287883758545
Time for copying to cuda: 0.009517669677734375
Time for forward pass: 0.0494694709777832
Time for backpropagation: 0.002672910690307617
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.584282636642456 seconds
Index: 22
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5046436786651611 seconds
Streaming imagenet data took 1.5597844123840332 seconds
Then, training+dataloading take 1.564072608947754 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4201323986053467
Time for copying to cuda: 0.009434223175048828
Time for forward pass: 0.04940652847290039
Time for backpropagation: 0.002661466598510742
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5735049247741699 seconds
Index: 23
Read 11.263076782226562 MBs for this batch
Executing all posts took 0.6057090759277344 seconds
Streaming imagenet data took 0.6108098030090332 seconds
Then, training+dataloading take 0.6114566326141357 seconds

Epoch: 0
Time of next(dataloader) is: 0.34271740913391113
Time for copying to cuda: 0.0032601356506347656
Time for forward pass: 0.03255963325500488
Time for backpropagation: 0.002588033676147461
GPU memory for training: 1.0986590385437012                          

The whole process took 46.92983388900757 seconds
