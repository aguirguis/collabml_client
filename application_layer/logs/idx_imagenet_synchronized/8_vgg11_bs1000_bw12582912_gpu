Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=8, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10120.826690196458 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1326556995.9374301 1326556995.9374301
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 8 25
Intermediate:  3.0625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 9796.08837890625 10704.48486328125 31807.80712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 8
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.302038431167603 seconds
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 16.578144788742065 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Time of next(dataloader) is: 2.0265445709228516
Memory occpied: (4904.0, 3.0)
Time for copying to cuda: 0.8380861282348633
Memory occpied: (4904.0, 1868.0)
Memory occpied: (4904.0, 2336.0)
Memory occpied: (4904.0, 3212.0)
Memory occpied: (13904.0, 11906.0)
Memory occpied: (13904.0, 11906.0)
Memory occpied: (13452.0, 11906.0)
Memory occpied: (13452.0, 11906.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.11620831489563 seconds
Memory occpied: (9600.0, 11914.0)
Time for forward pass: 13.331534147262573
Time for backpropagation: 0.053524017333984375
GPU memory for training: 22.27123260498047                          

One training iteration takes: 16.656466960906982 seconds
Index: 0
Streaming imagenet data took 16.806427001953125 seconds
Then, training+dataloading take 16.931034326553345 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.17458176612854
Time for copying to cuda: 0.7746942043304443
Time for forward pass: 0.8429124355316162
Time for backpropagation: 0.0031800270080566406
GPU memory for training: 15.244415283203125                          

Memory occpied: (9610.0, 4848.0)
One training iteration takes: 4.217814207077026 seconds
Index: 1
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.555473566055298 seconds
Memory occpied: (12364.0, 13132.0)
Streaming imagenet data took 16.77299666404724 seconds
Then, training+dataloading take 16.955623865127563 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2117600440979004
Time for copying to cuda: 0.7704074382781982
Time for forward pass: 0.8397402763366699
Time for backpropagation: 0.0031070709228515625
GPU memory for training: 15.244415283203125                          

Memory occpied: (12364.0, 13132.0)
One training iteration takes: 4.223336219787598 seconds
Index: 2
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.205283403396606 seconds
Memory occpied: (12364.0, 13132.0)
Streaming imagenet data took 16.49773669242859 seconds
Then, training+dataloading take 16.645317792892456 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Time of next(dataloader) is: 2.2210819721221924
Memory occpied: (12364.0, 13132.0)
Time for copying to cuda: 0.8621106147766113
Time for forward pass: 0.8728420734405518
Time for backpropagation: 0.0039048194885253906
GPU memory for training: 15.244415283203125                          

Memory occpied: (12364.0, 13132.0)
One training iteration takes: 4.381058216094971 seconds
Index: 3
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.365007400512695 seconds
Memory occpied: (12364.0, 13132.0)
Streaming imagenet data took 16.653921604156494 seconds
Then, training+dataloading take 16.719943284988403 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.1873552799224854
Time for copying to cuda: 0.7765610218048096
Time for forward pass: 0.8473451137542725
Time for backpropagation: 0.0031478404998779297
GPU memory for training: 15.244415283203125                          

Memory occpied: (12364.0, 13132.0)
One training iteration takes: 4.2344019412994385 seconds
Index: 4
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.075434684753418 seconds
Memory occpied: (12364.0, 13132.0)
Streaming imagenet data took 16.36582374572754 seconds
Then, training+dataloading take 16.518720865249634 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.164780855178833
Time for copying to cuda: 0.776172399520874
Time for forward pass: 0.8502459526062012
Time for backpropagation: 0.0031561851501464844
GPU memory for training: 15.244415283203125                          

Memory occpied: (12364.0, 13132.0)
One training iteration takes: 4.25594425201416 seconds
Index: 5
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.007734775543213 seconds
Memory occpied: (12364.0, 13132.0)
Streaming imagenet data took 16.315152406692505 seconds
Then, training+dataloading take 16.503673315048218 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Time of next(dataloader) is: 2.2546098232269287
Memory occpied: (12364.0, 13132.0)
Time for copying to cuda: 0.8602449893951416
Time for forward pass: 0.8634960651397705
Time for backpropagation: 0.003465414047241211
GPU memory for training: 15.244415283203125                          

One training iteration takes: 4.4114696979522705 seconds
Index: 6
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Memory occpied: (12364.0, 13132.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 15.121715068817139 seconds
Memory occpied: (12364.0, 13132.0)
Streaming imagenet data took 16.31563138961792 seconds
Then, training+dataloading take 16.461846351623535 seconds

Epoch: 0
Time of next(dataloader) is: 2.238433361053467
Time for copying to cuda: 0.7752437591552734
Time for forward pass: 0.8272745609283447
Time for backpropagation: 0.003113985061645508
GPU memory for training: 15.244415283203125                          

Memory occpied: (12364.0, 13132.0)
The whole process took 146.13390946388245 seconds
