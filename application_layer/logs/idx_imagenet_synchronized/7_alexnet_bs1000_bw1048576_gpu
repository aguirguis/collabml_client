Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5209417037046 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119081656.87098797 119081656.87098797
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 17
Intermediate:  0.24755859375
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 1077.51220703125 1343.78955078125 2881.22314453125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Using split index: 7
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Length of received data: 259631121
Read 247.60353183746338 MBs for this batch
Executing all posts took 3.998656988143921 seconds
Streaming imagenet data took 4.090116739273071 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4122140407562256
Time for copying to cuda: 0.0644981861114502
Memory occpied: (1762.0, 272.0)
Memory occpied: (1762.0, 722.0)
Memory occpied: (1762.0, 1138.0)
Length of received data: 259631121
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.015130281448364 seconds
Streaming imagenet data took 4.106916904449463 seconds
Memory occpied: (3662.0, 3444.0)
Time for forward pass: 3.9236462116241455
Time for backpropagation: 0.05147266387939453
GPU memory for training: 4.371849060058594                          

One training iteration takes: 4.533801078796387 seconds
Index: 0
Then, training+dataloading take 4.534548997879028 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4668858051300049
Time for copying to cuda: 0.06417322158813477
Time for forward pass: 0.07708096504211426
Time for backpropagation: 0.0028510093688964844
GPU memory for training: 2.47955322265625                          

One training iteration takes: 0.7193756103515625 seconds
Index: 1
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Length of received data: 259631121
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.010338306427002 seconds
Streaming imagenet data took 4.105206727981567 seconds
Then, training+dataloading take 4.120561361312866 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5006301403045654
Memory occpied: (3182.0, 3460.0)
Time for copying to cuda: 0.0639338493347168
Time for forward pass: 0.11282777786254883
Time for backpropagation: 0.0027773380279541016
GPU memory for training: 2.47955322265625                          

One training iteration takes: 0.7761380672454834 seconds
Index: 2
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Length of received data: 259631121
Read 247.60353183746338 MBs for this batch
Executing all posts took 3.9935531616210938 seconds
Streaming imagenet data took 4.17345929145813 seconds
Then, training+dataloading take 4.182857990264893 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (3182.0, 3460.0)
Time of next(dataloader) is: 0.47501659393310547
Time for copying to cuda: 0.06407284736633301
Time for forward pass: 0.11328315734863281
Time for backpropagation: 0.002952098846435547
GPU memory for training: 2.47955322265625                          

One training iteration takes: 0.7707312107086182 seconds
Index: 3
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Length of received data: 259631121
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.03306245803833 seconds
Streaming imagenet data took 4.125129461288452 seconds
Then, training+dataloading take 4.14008355140686 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4795970916748047
Time for copying to cuda: 0.06424212455749512
Time for forward pass: 0.16264986991882324
Time for backpropagation: 0.003489255905151367
GPU memory for training: 2.47955322265625                          

One training iteration takes: 0.8419904708862305 seconds
Index: 4
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Length of received data: 259631121
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.011180639266968 seconds
Streaming imagenet data took 4.105364799499512 seconds
Then, training+dataloading take 4.120308876037598 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5288171768188477
Time for copying to cuda: 0.06416487693786621
Time for forward pass: 0.11312389373779297
Time for backpropagation: 0.002717256546020508
GPU memory for training: 2.47955322265625                          

One training iteration takes: 0.8254618644714355 seconds
Index: 5
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Length of received data: 259631121
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.033484935760498 seconds
Streaming imagenet data took 4.126089572906494 seconds
Then, training+dataloading take 4.141000032424927 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5279176235198975
Time for copying to cuda: 0.06403064727783203
Time for forward pass: 0.11317992210388184
Time for backpropagation: 0.0026350021362304688
GPU memory for training: 2.47955322265625                          

One training iteration takes: 0.8233349323272705 seconds
Index: 6
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Memory occpied: (3182.0, 3460.0)
Length of received data: 259631121
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.0482048988342285 seconds
Streaming imagenet data took 4.142488241195679 seconds
Then, training+dataloading take 4.15747594833374 seconds

Epoch: 0
Time of next(dataloader) is: 0.5192382335662842
Time for copying to cuda: 0.06410741806030273
Time for forward pass: 0.11328530311584473
Time for backpropagation: 0.0027632713317871094
GPU memory for training: 2.47955322265625                          

Memory occpied: (3182.0, 3460.0)
The whole process took 41.784820795059204 seconds
