Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=2, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10151.43232206247 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1330568537.317372 1330568537.317372
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 2 11
Intermediate:  3.0625
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 9435.13232421875 9587.01025390625 13071.85107421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 2
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.312037944793701 seconds
Memory occpied: (1336.0, 3.0)
Streaming imagenet data took 14.593086242675781 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Time of next(dataloader) is: 2.11293888092041
Memory occpied: (4400.0, 3.0)
Time for copying to cuda: 0.8596172332763672
Memory occpied: (4400.0, 1914.0)
Memory occpied: (4400.0, 2364.0)
Memory occpied: (4400.0, 7456.0)
Memory occpied: (7156.0, 5734.0)
Time for forward pass: 5.761873483657837
Time for backpropagation: 1.2387053966522217
GPU memory for training: 12.800363063812256                          

Memory occpied: (8394.0, 5284.0)
One training iteration takes: 10.407280921936035 seconds
Index: 0
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.226272583007812 seconds
Memory occpied: (5184.0, 5284.0)
Streaming imagenet data took 14.428952932357788 seconds
Then, training+dataloading take 14.555176973342896 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.273801803588867
Time for copying to cuda: 0.7736179828643799
Time for forward pass: 0.5711104869842529
Time for backpropagation: 0.004641294479370117
GPU memory for training: 7.345221996307373                          

One training iteration takes: 4.0747151374816895 seconds
Index: 1
Memory occpied: (5184.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Length of received data: 3211310121
Memory occpied: (6634.0, 5300.0)
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.843615055084229 seconds
Memory occpied: (6634.0, 5300.0)
Streaming imagenet data took 15.15335464477539 seconds
Then, training+dataloading take 15.332875728607178 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2945120334625244
Time for copying to cuda: 0.7699108123779297
Time for forward pass: 0.5584912300109863
Time for backpropagation: 0.004545688629150391
GPU memory for training: 7.345038890838623                          

Memory occpied: (6634.0, 5300.0)
One training iteration takes: 4.037368059158325 seconds
Index: 2
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 14.519106149673462 seconds
Memory occpied: (6634.0, 5300.0)
Streaming imagenet data took 15.715826749801636 seconds
Then, training+dataloading take 15.852073669433594 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2637810707092285
Time for copying to cuda: 0.7684206962585449
Time for forward pass: 0.573899507522583
Time for backpropagation: 0.004580974578857422
GPU memory for training: 7.345038890838623                          

Memory occpied: (6634.0, 5300.0)
One training iteration takes: 4.093794107437134 seconds
Index: 3
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.048657655715942 seconds
Memory occpied: (6634.0, 5300.0)
Streaming imagenet data took 14.261386394500732 seconds
Then, training+dataloading take 14.447965621948242 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Time of next(dataloader) is: 2.2618095874786377
Memory occpied: (6634.0, 5300.0)
Time for copying to cuda: 0.8738932609558105
Time for forward pass: 0.5924332141876221
Time for backpropagation: 0.0045855045318603516
GPU memory for training: 7.345038890838623                          

One training iteration takes: 4.188300609588623 seconds
Index: 4
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.167826175689697 seconds
Memory occpied: (6634.0, 5300.0)
Streaming imagenet data took 14.36444354057312 seconds
Then, training+dataloading take 14.495872974395752 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.262122631072998
Time for copying to cuda: 0.7665045261383057
Time for forward pass: 0.5899944305419922
Time for backpropagation: 0.004601478576660156
GPU memory for training: 7.345038890838623                          

Memory occpied: (6634.0, 5300.0)
One training iteration takes: 4.096110820770264 seconds
Index: 5
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.533691644668579 seconds
Memory occpied: (6634.0, 5300.0)
Streaming imagenet data took 14.742172241210938 seconds
Then, training+dataloading take 14.936845541000366 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2985477447509766
Time for copying to cuda: 0.7700932025909424
Time for forward pass: 0.5825157165527344
Time for backpropagation: 0.004548549652099609
GPU memory for training: 7.345038890838623                          

Memory occpied: (6634.0, 5300.0)
One training iteration takes: 4.06554913520813 seconds
Index: 6
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Memory occpied: (6634.0, 5300.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.23424768447876 seconds
Memory occpied: (6634.0, 5300.0)
Streaming imagenet data took 14.537327766418457 seconds
Then, training+dataloading take 14.589622974395752 seconds

Epoch: 0
Time of next(dataloader) is: 2.2796592712402344
Time for copying to cuda: 0.7689902782440186
Time for forward pass: 0.5642657279968262
Time for backpropagation: 0.004711627960205078
GPU memory for training: 7.345038890838623                          

Memory occpied: (6634.0, 5300.0)
The whole process took 129.69527673721313 seconds
