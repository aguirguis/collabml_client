Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10007.646915287922 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1311722296.4806185 1311722296.4806185
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 11
Intermediate:  0.765625
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 2544.50732421875 2696.38525390625 8478.10107421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 5
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.6630780696868896 seconds
Memory occpied: (1336.0, 3.0)
Streaming imagenet data took 4.030356407165527 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7435274124145508
Time for copying to cuda: 0.26230430603027344
Memory occpied: (2102.0, 13.0)
Memory occpied: (2102.0, 870.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.745481252670288 seconds
Memory occpied: (2102.0, 1464.0)
Streaming imagenet data took 4.1355767250061035 seconds
Memory occpied: (5936.0, 5542.0)
Memory occpied: (2490.0, 2428.0)
Time for forward pass: 5.421228408813477
Time for backpropagation: 0.7535378932952881
GPU memory for training: 8.687753200531006                          

One training iteration takes: 7.339574813842773 seconds
Index: 0
Then, training+dataloading take 7.341437101364136 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8501443862915039
Time for copying to cuda: 0.1934504508972168
Time for forward pass: 0.28849148750305176
Time for backpropagation: 0.0046787261962890625
GPU memory for training: 4.047980785369873                          

One training iteration takes: 1.4797110557556152 seconds
Index: 1
Memory occpied: (2504.0, 4918.0)
Memory occpied: (3956.0, 4918.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.614124059677124 seconds
Streaming imagenet data took 4.002296686172485 seconds
Then, training+dataloading take 4.021563768386841 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (3956.0, 4918.0)
Time of next(dataloader) is: 0.8119823932647705
Time for copying to cuda: 0.1945340633392334
Memory occpied: (3956.0, 4918.0)
Time for forward pass: 0.37725162506103516
Time for backpropagation: 0.004788637161254883
GPU memory for training: 4.047980785369873                          

One training iteration takes: 1.5434765815734863 seconds
Index: 2
Memory occpied: (3956.0, 4918.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.6342265605926514 seconds
Memory occpied: (3956.0, 4918.0)
Streaming imagenet data took 4.0239222049713135 seconds
Then, training+dataloading take 4.063755989074707 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7994785308837891
Memory occpied: (3956.0, 4918.0)
Time for copying to cuda: 0.27909040451049805
Time for forward pass: 0.3658292293548584
Time for backpropagation: 0.004734039306640625
GPU memory for training: 4.047980785369873                          

One training iteration takes: 1.6066515445709229 seconds
Index: 3
Memory occpied: (3956.0, 4918.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.6479082107543945 seconds
Memory occpied: (3956.0, 4918.0)
Streaming imagenet data took 4.039060115814209 seconds
Then, training+dataloading take 4.079033374786377 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7928969860076904
Time for copying to cuda: 0.29461121559143066
Memory occpied: (3956.0, 4918.0)
Time for forward pass: 0.367431640625
Time for backpropagation: 0.004625082015991211
GPU memory for training: 4.047980785369873                          

One training iteration takes: 1.6265947818756104 seconds
Index: 4
Memory occpied: (3956.0, 4918.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.4766271114349365 seconds
Memory occpied: (3956.0, 4918.0)
Streaming imagenet data took 3.8678879737854004 seconds
Then, training+dataloading take 3.9072437286376953 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7975811958312988
Memory occpied: (3956.0, 4918.0)
Time for copying to cuda: 0.27640366554260254
Time for forward pass: 0.38138270378112793
Time for backpropagation: 0.004647493362426758
GPU memory for training: 4.047980785369873                          

One training iteration takes: 1.6287391185760498 seconds
Index: 5
Memory occpied: (3956.0, 4918.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.544379234313965 seconds
Memory occpied: (3956.0, 4918.0)
Streaming imagenet data took 3.9310073852539062 seconds
Then, training+dataloading take 3.974485397338867 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7921171188354492
Time for copying to cuda: 0.2757272720336914
Memory occpied: (3956.0, 4918.0)
Time for forward pass: 0.3852376937866211
Time for backpropagation: 0.004637479782104492
GPU memory for training: 4.047980785369873                          

One training iteration takes: 1.615706443786621 seconds
Index: 6
Memory occpied: (3956.0, 4918.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.5668463706970215 seconds
Memory occpied: (3956.0, 4918.0)
Streaming imagenet data took 3.9649810791015625 seconds
Then, training+dataloading take 4.00993013381958 seconds

Epoch: 0
Time of next(dataloader) is: 0.7907733917236328
Time for copying to cuda: 0.27595973014831543
Memory occpied: (3956.0, 4918.0)
Time for forward pass: 0.37622928619384766
Time for backpropagation: 0.004655599594116211
GPU memory for training: 4.047980785369873                          

The whole process took 43.654456615448 seconds
