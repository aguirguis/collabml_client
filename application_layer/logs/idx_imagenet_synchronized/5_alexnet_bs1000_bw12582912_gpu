Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10261.58716037689 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1345006752.2849197 1345006752.2849197
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 17
Intermediate:  0.533935546875
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 1526.48681640625 1792.76416015625 3043.82080078125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Using split index: 5
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Length of received data: 559918121
Memory occpied: (1514.0, 3.0)
Read 533.979531288147 MBs for this batch
Executing all posts took 2.8033552169799805 seconds
Streaming imagenet data took 3.000591993331909 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5943078994750977
Time for copying to cuda: 0.1364433765411377
Memory occpied: (2048.0, 388.0)
Memory occpied: (2048.0, 836.0)
Length of received data: 559918121
Read 533.979531288147 MBs for this batch
Executing all posts took 2.9349982738494873 seconds
Streaming imagenet data took 3.1332874298095703 seconds
Memory occpied: (2048.0, 1264.0)
Memory occpied: (5574.0, 5192.0)
Time for forward pass: 4.376059293746948
Time for backpropagation: 0.052803754806518555
GPU memory for training: 5.032950401306152                          

One training iteration takes: 5.282663583755493 seconds
Index: 0
Then, training+dataloading take 5.283942699432373 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (2558.0, 3400.0)
Time of next(dataloader) is: 0.6455459594726562
Time for copying to cuda: 0.1357436180114746
Time for forward pass: 0.10394597053527832
Time for backpropagation: 0.0027010440826416016
GPU memory for training: 3.050745964050293                          

One training iteration takes: 1.029242992401123 seconds
Index: 1
Memory occpied: (3788.0, 3408.0)
Length of received data: 559918121
Read 533.979531288147 MBs for this batch
Executing all posts took 2.9349164962768555 seconds
Memory occpied: (3788.0, 3408.0)
Streaming imagenet data took 3.248626708984375 seconds
Then, training+dataloading take 3.27707576751709 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6816449165344238
Time for copying to cuda: 0.13405108451843262
Time for forward pass: 0.18167996406555176
Time for backpropagation: 0.0031926631927490234
GPU memory for training: 3.050745964050293                          

One training iteration takes: 1.1330437660217285 seconds
Index: 2
Memory occpied: (3788.0, 3408.0)
Memory occpied: (3788.0, 3408.0)
Length of received data: 559918121
Read 533.979531288147 MBs for this batch
Executing all posts took 2.932448387145996 seconds
Streaming imagenet data took 3.129055976867676 seconds
Then, training+dataloading take 3.16064715385437 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (3788.0, 3408.0)
Time of next(dataloader) is: 0.6448855400085449
Time for copying to cuda: 0.13584113121032715
Time for forward pass: 0.15228891372680664
Time for backpropagation: 0.0027017593383789062
GPU memory for training: 3.050745964050293                          

One training iteration takes: 1.0725090503692627 seconds
Index: 3
Memory occpied: (3788.0, 3408.0)
Length of received data: 559918121
Read 533.979531288147 MBs for this batch
Executing all posts took 2.9083962440490723 seconds
Memory occpied: (3788.0, 3408.0)
Streaming imagenet data took 3.2048044204711914 seconds
Then, training+dataloading take 3.2259433269500732 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6623468399047852
Time for copying to cuda: 0.13606595993041992
Time for forward pass: 0.19923043251037598
Time for backpropagation: 0.003252267837524414
GPU memory for training: 3.050745964050293                          

One training iteration takes: 1.159045934677124 seconds
Index: 4
Memory occpied: (3788.0, 3408.0)
Length of received data: 559918121
Read 533.979531288147 MBs for this batch
Executing all posts took 2.9691214561462402 seconds
Memory occpied: (3788.0, 3408.0)
Streaming imagenet data took 3.1676294803619385 seconds
Then, training+dataloading take 3.1885101795196533 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6585383415222168
Time for copying to cuda: 0.1764695644378662
Time for forward pass: 0.15353870391845703
Time for backpropagation: 0.0031359195709228516
GPU memory for training: 3.050745964050293                          

Memory occpied: (3788.0, 3408.0)
One training iteration takes: 1.146777629852295 seconds
Index: 5
Memory occpied: (3788.0, 3408.0)
Length of received data: 559918121
Read 533.979531288147 MBs for this batch
Executing all posts took 2.977346420288086 seconds
Streaming imagenet data took 3.1769893169403076 seconds
Then, training+dataloading take 3.194950819015503 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7343106269836426
Time for copying to cuda: 0.13521718978881836
Time for forward pass: 0.15221047401428223
Time for backpropagation: 0.0027222633361816406
GPU memory for training: 3.050745964050293                          

One training iteration takes: 1.155663251876831 seconds
Index: 6
Memory occpied: (3788.0, 3408.0)
Length of received data: 559918121
Read 533.979531288147 MBs for this batch
Executing all posts took 2.700819492340088 seconds
Memory occpied: (3788.0, 3408.0)
Streaming imagenet data took 2.947521924972534 seconds
Then, training+dataloading take 2.980395793914795 seconds

Epoch: 0
Time of next(dataloader) is: 0.6381845474243164
Time for copying to cuda: 0.1371302604675293
Time for forward pass: 0.1530609130859375
Time for backpropagation: 0.003244161605834961
GPU memory for training: 3.050745964050293                          

Memory occpied: (3788.0, 3408.0)
The whole process took 35.873889684677124 seconds
