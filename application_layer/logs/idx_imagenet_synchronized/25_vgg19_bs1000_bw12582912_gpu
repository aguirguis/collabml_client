Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=25, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10032.354904086851 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1314960821.9884717 1314960821.9884717
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 25 36
Intermediate:  1.53125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 5720.11474609375 6669.72509765625 29263.08349609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 25
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 15.442795753479004 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 16.109898805618286 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1894.0, 3.0)
Time of next(dataloader) is: 1.1287107467651367
Time for copying to cuda: 0.38962340354919434
Memory occpied: (3426.0, 950.0)
Memory occpied: (3426.0, 1376.0)
Memory occpied: (3426.0, 1824.0)
Memory occpied: (11494.0, 10244.0)
Memory occpied: (11494.0, 10244.0)
Memory occpied: (11494.0, 10244.0)
Memory occpied: (11048.0, 10252.0)
Time for forward pass: 7.652265548706055
Time for backpropagation: 0.055422067642211914
GPU memory for training: 18.27120304107666                          

One training iteration takes: 9.469088792800903 seconds
Index: 0
Memory occpied: (4944.0, 10252.0)
Memory occpied: (4944.0, 10252.0)
Memory occpied: (4944.0, 10252.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 15.57169485092163 seconds
Memory occpied: (4944.0, 10252.0)
Streaming imagenet data took 16.133037090301514 seconds
Then, training+dataloading take 16.182549476623535 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (4944.0, 10252.0)
Time of next(dataloader) is: 1.2986929416656494
Time for copying to cuda: 0.43642640113830566
Memory occpied: (8932.0, 10260.0)
Time for forward pass: 0.5416421890258789
Time for backpropagation: 0.0044977664947509766
GPU memory for training: 12.353302955627441                          

One training iteration takes: 2.557429790496826 seconds
Index: 1
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 15.446723937988281 seconds
Memory occpied: (8932.0, 10260.0)
Streaming imagenet data took 16.082266569137573 seconds
Then, training+dataloading take 16.156278610229492 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (8932.0, 10260.0)
Time of next(dataloader) is: 1.2400283813476562
Time for copying to cuda: 0.38856959342956543
Memory occpied: (8932.0, 10260.0)
Time for forward pass: 0.5414965152740479
Time for backpropagation: 0.004393339157104492
GPU memory for training: 12.353302955627441                          

One training iteration takes: 2.4262120723724365 seconds
Index: 2
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 15.4627206325531 seconds
Memory occpied: (8932.0, 10260.0)
Streaming imagenet data took 16.087390422821045 seconds
Then, training+dataloading take 16.13425636291504 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (8932.0, 10260.0)
Time of next(dataloader) is: 1.2779598236083984
Time for copying to cuda: 0.38420557975769043
Memory occpied: (8932.0, 10260.0)
Time for forward pass: 0.5682640075683594
Time for backpropagation: 0.004470348358154297
GPU memory for training: 12.353302955627441                          

One training iteration takes: 2.478083372116089 seconds
Index: 3
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 15.318925619125366 seconds
Memory occpied: (8932.0, 10260.0)
Streaming imagenet data took 16.010131359100342 seconds
Then, training+dataloading take 16.057469606399536 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (8932.0, 10260.0)
Time of next(dataloader) is: 1.290358066558838
Time for copying to cuda: 0.3833425045013428
Memory occpied: (8932.0, 10260.0)
Time for forward pass: 0.5709142684936523
Time for backpropagation: 0.004354715347290039
GPU memory for training: 12.353302955627441                          

One training iteration takes: 2.504807472229004 seconds
Index: 4
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 14.951179504394531 seconds
Memory occpied: (8932.0, 10260.0)
Streaming imagenet data took 15.633149862289429 seconds
Then, training+dataloading take 15.718217134475708 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (8932.0, 10260.0)
Time of next(dataloader) is: 1.2144103050231934
Time for copying to cuda: 0.38477373123168945
Memory occpied: (8932.0, 10260.0)
Time for forward pass: 0.5801618099212646
Time for backpropagation: 0.004456758499145508
GPU memory for training: 12.353302955627441                          

One training iteration takes: 2.436790704727173 seconds
Index: 5
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 15.535405397415161 seconds
Memory occpied: (8932.0, 10260.0)
Streaming imagenet data took 16.154425382614136 seconds
Then, training+dataloading take 16.201386213302612 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (8932.0, 10260.0)
Time of next(dataloader) is: 1.274735927581787
Time for copying to cuda: 0.3864760398864746
Memory occpied: (8932.0, 10260.0)
Time for forward pass: 0.5742297172546387
Time for backpropagation: 0.004448652267456055
GPU memory for training: 12.353302955627441                          

One training iteration takes: 2.488152265548706 seconds
Index: 6
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Memory occpied: (8932.0, 10260.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 15.43049955368042 seconds
Memory occpied: (8932.0, 10260.0)
Streaming imagenet data took 16.0683274269104 seconds
Then, training+dataloading take 16.12811589241028 seconds

Epoch: 0
Memory occpied: (8932.0, 10260.0)
Time of next(dataloader) is: 1.2866358757019043
Time for copying to cuda: 0.38588714599609375
Memory occpied: (8932.0, 10260.0)
Time for forward pass: 0.5526645183563232
Time for backpropagation: 0.005132913589477539
GPU memory for training: 12.353302955627441                          

The whole process took 139.68509793281555 seconds
