Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=10, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9716.38985193073 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1273546650.6722646 1273546650.6722646
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 10 20
Intermediate:  1.53125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 8987.21875 9182.44482421875 14155.1875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 10
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.460035800933838 seconds
Memory occpied: (1318.0, 3.0)
Streaming imagenet data took 9.078966856002808 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1318.0, 3.0)
Time of next(dataloader) is: 1.1475934982299805
Time for copying to cuda: 0.39214468002319336
Memory occpied: (2850.0, 962.0)
Memory occpied: (2850.0, 1384.0)
Memory occpied: (2850.0, 1850.0)
Memory occpied: (4004.0, 3746.0)
Memory occpied: (5642.0, 4808.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.509952783584595 seconds
Memory occpied: (5950.0, 5116.0)
Streaming imagenet data took 9.20554780960083 seconds
Memory occpied: (4564.0, 3974.0)
Time for forward pass: 8.541049003601074
Time for backpropagation: 0.0825655460357666
GPU memory for training: 10.825438499450684                          

One training iteration takes: 10.37651014328003 seconds
Index: 0
Then, training+dataloading take 10.379846572875977 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (3368.0, 3998.0)
Time of next(dataloader) is: 1.2852015495300293
Time for copying to cuda: 0.3854491710662842
Memory occpied: (5230.0, 4014.0)
Time for forward pass: 0.6068577766418457
Time for backpropagation: 0.01110386848449707
GPU memory for training: 4.586160182952881                          

One training iteration takes: 2.526512861251831 seconds
Index: 1
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.539230585098267 seconds
Memory occpied: (5230.0, 4014.0)
Streaming imagenet data took 9.167073011398315 seconds
Then, training+dataloading take 9.247865200042725 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (5230.0, 4014.0)
Time of next(dataloader) is: 1.2905139923095703
Time for copying to cuda: 0.38654565811157227
Memory occpied: (5230.0, 4014.0)
Time for forward pass: 0.6059582233428955
Time for backpropagation: 0.011429786682128906
GPU memory for training: 4.586160182952881                          

One training iteration takes: 2.5502655506134033 seconds
Index: 2
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.51336145401001 seconds
Memory occpied: (5230.0, 4014.0)
Streaming imagenet data took 9.197380304336548 seconds
Then, training+dataloading take 9.279390573501587 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (5230.0, 4014.0)
Time of next(dataloader) is: 1.2223021984100342
Time for copying to cuda: 0.38783788681030273
Memory occpied: (5230.0, 4014.0)
Time for forward pass: 0.6095271110534668
Time for backpropagation: 0.0111083984375
GPU memory for training: 4.586160182952881                          

One training iteration takes: 2.4808478355407715 seconds
Index: 3
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.556135892868042 seconds
Memory occpied: (5230.0, 4014.0)
Streaming imagenet data took 9.24676251411438 seconds
Then, training+dataloading take 9.295268058776855 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (5230.0, 4014.0)
Time of next(dataloader) is: 1.2889995574951172
Time for copying to cuda: 0.3882157802581787
Memory occpied: (5230.0, 4014.0)
Time for forward pass: 0.5899410247802734
Time for backpropagation: 0.01117706298828125
GPU memory for training: 4.586160182952881                          

One training iteration takes: 2.5163114070892334 seconds
Index: 4
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.388908624649048 seconds
Memory occpied: (5230.0, 4014.0)
Streaming imagenet data took 9.078023433685303 seconds
Then, training+dataloading take 9.126097679138184 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (5230.0, 4014.0)
Time of next(dataloader) is: 1.2844901084899902
Time for copying to cuda: 0.38810038566589355
Memory occpied: (5230.0, 4014.0)
Time for forward pass: 0.611962080001831
Time for backpropagation: 0.011286020278930664
GPU memory for training: 4.586160182952881                          

One training iteration takes: 2.5297017097473145 seconds
Index: 5
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.383035659790039 seconds
Memory occpied: (5230.0, 4014.0)
Streaming imagenet data took 9.079241514205933 seconds
Then, training+dataloading take 9.153860092163086 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (5230.0, 4014.0)
Time of next(dataloader) is: 1.2676749229431152
Time for copying to cuda: 0.3856043815612793
Memory occpied: (5230.0, 4014.0)
Time for forward pass: 0.5936281681060791
Time for backpropagation: 0.011252403259277344
GPU memory for training: 4.586160182952881                          

One training iteration takes: 2.485809087753296 seconds
Index: 6
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Memory occpied: (5230.0, 4014.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.431533813476562 seconds
Memory occpied: (5230.0, 4014.0)
Streaming imagenet data took 9.05104374885559 seconds
Then, training+dataloading take 9.098019361495972 seconds

Epoch: 0
Memory occpied: (5230.0, 4014.0)
Time of next(dataloader) is: 1.2962820529937744
Time for copying to cuda: 0.38745808601379395
Memory occpied: (5230.0, 4014.0)
Time for forward pass: 0.6143991947174072
Time for backpropagation: 0.011236906051635742
GPU memory for training: 4.586160182952881                          

The whole process took 84.06176519393921 seconds
