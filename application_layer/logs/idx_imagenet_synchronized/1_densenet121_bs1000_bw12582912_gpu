Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=1, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10502.243573619573 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1376550069.6814647 1376550069.6814647
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 1 20
Intermediate:  3.0625
3.63671875
Total layers size  29.767486572265625
Server, client, server+client, vanilla  155.41357421875 13580.96875 13736.38232421875 14729.40625
Fixed, scale_with_bsz  0 7.78466796875
Mem usage  1318.0 3.0
Using split index: 1
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.597723245620728 seconds
Memory occpied: (1318.0, 3.0)
Streaming imagenet data took 14.859574794769287 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.085359573364258
Time for copying to cuda: 0.7761037349700928
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.289561748504639 seconds
Streaming imagenet data took 14.41696286201477 seconds
Time for forward pass: 14.231715679168701
Time for backpropagation: 0.07066655158996582
GPU memory for training: 20.046401023864746                          

Memory occpied: (1318.0, 3.0)
One training iteration takes: 17.5702862739563 seconds
Index: 0
Then, training+dataloading take 17.576925039291382 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (4996.0, 4664.0)
Time of next(dataloader) is: 2.1203110218048096
Memory occpied: (4996.0, 4664.0)
Time for copying to cuda: 0.777761697769165
Memory occpied: (14964.0, 11184.0)
Time for forward pass: 1.6903283596038818
Time for backpropagation: 0.020874977111816406
GPU memory for training: 13.909873485565186                          

Memory occpied: (8818.0, 11192.0)
One training iteration takes: 5.024712324142456 seconds
Index: 1
Memory occpied: (8842.0, 11192.0)
Memory occpied: (8842.0, 11192.0)
Memory occpied: (8842.0, 11192.0)
Memory occpied: (8842.0, 11192.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.659295320510864 seconds
Memory occpied: (8842.0, 11192.0)
Streaming imagenet data took 14.867205619812012 seconds
Then, training+dataloading take 14.99596357345581 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2523741722106934
Time for copying to cuda: 0.7749965190887451
Time for forward pass: 1.6138324737548828
Time for backpropagation: 0.011266469955444336
GPU memory for training: 13.90972089767456                          

One training iteration takes: 5.100619077682495 seconds
Index: 2
Memory occpied: (8842.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.15027379989624 seconds
Memory occpied: (12290.0, 11192.0)
Streaming imagenet data took 14.3526930809021 seconds
Then, training+dataloading take 14.52944803237915 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3012287616729736
Time for copying to cuda: 0.7759101390838623
Time for forward pass: 1.6308917999267578
Time for backpropagation: 0.01148223876953125
GPU memory for training: 13.909934520721436                          

Memory occpied: (12290.0, 11192.0)
One training iteration takes: 5.140349626541138 seconds
Index: 3
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.134379148483276 seconds
Memory occpied: (12290.0, 11192.0)
Streaming imagenet data took 14.433439016342163 seconds
Then, training+dataloading take 14.597428560256958 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.256279945373535
Time for copying to cuda: 0.7688925266265869
Time for forward pass: 1.6147615909576416
Time for backpropagation: 0.01113271713256836
GPU memory for training: 13.909934520721436                          

Memory occpied: (12290.0, 11192.0)
One training iteration takes: 5.071792840957642 seconds
Index: 4
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.260750532150269 seconds
Memory occpied: (12290.0, 11192.0)
Streaming imagenet data took 14.456314086914062 seconds
Then, training+dataloading take 14.591262340545654 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2523581981658936
Time for copying to cuda: 0.776202917098999
Time for forward pass: 1.6363778114318848
Time for backpropagation: 0.01105809211730957
GPU memory for training: 13.909934520721436                          

One training iteration takes: 5.1277759075164795 seconds
Index: 5
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.682677030563354 seconds
Memory occpied: (12290.0, 11192.0)
Streaming imagenet data took 15.020855188369751 seconds
Then, training+dataloading take 15.073392868041992 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2808477878570557
Time for copying to cuda: 0.766655683517456
Time for forward pass: 1.6310527324676514
Time for backpropagation: 0.011055469512939453
GPU memory for training: 13.909934520721436                          

Memory occpied: (12290.0, 11192.0)
One training iteration takes: 5.092751502990723 seconds
Index: 6
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Memory occpied: (12290.0, 11192.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.18731141090393 seconds
Memory occpied: (12290.0, 11192.0)
Streaming imagenet data took 14.383609533309937 seconds
Then, training+dataloading take 14.519038200378418 seconds

Epoch: 0
Time of next(dataloader) is: 2.2528345584869385
Time for copying to cuda: 0.7667326927185059
Time for forward pass: 1.6159155368804932
Time for backpropagation: 0.01104736328125
GPU memory for training: 13.909934520721436                          

Memory occpied: (12290.0, 11192.0)
The whole process took 133.17718529701233 seconds
