Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7436461037292 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119110847.182108 119110847.182108
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 21
Intermediate:  3.0625
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 9292.857421875 9497.77294921875 12929.576171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Using split index: 5
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 36.632829427719116 seconds
Memory occpied: (1410.0, 3.0)
Streaming imagenet data took 37.90176200866699 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Time of next(dataloader) is: 2.0982673168182373
Memory occpied: (4474.0, 3.0)
Time for copying to cuda: 0.834336519241333
Memory occpied: (4474.0, 1936.0)
Memory occpied: (4474.0, 2388.0)
Memory occpied: (9520.0, 7936.0)
Memory occpied: (10644.0, 11678.0)
Memory occpied: (9112.0, 10238.0)
Memory occpied: (9112.0, 7024.0)
Memory occpied: (9112.0, 10238.0)
Memory occpied: (13670.0, 7024.0)
Time for forward pass: 9.746278047561646
Time for backpropagation: 0.0718834400177002
GPU memory for training: 16.479100704193115                          

One training iteration takes: 13.134376049041748 seconds
Index: 0
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.28208804130554 seconds
Memory occpied: (9140.0, 7048.0)
Streaming imagenet data took 38.55781173706055 seconds
Then, training+dataloading take 38.69798016548157 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (9140.0, 7048.0)
Memory occpied: (9140.0, 7048.0)
Time of next(dataloader) is: 2.236372470855713
Memory occpied: (9140.0, 7048.0)
Time for copying to cuda: 0.860645055770874
Memory occpied: (10680.0, 8588.0)
Time for forward pass: 1.3674511909484863
Time for backpropagation: 0.006911516189575195
GPU memory for training: 13.671006679534912                          

One training iteration takes: 4.887188673019409 seconds
Index: 1
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.272444009780884 seconds
Memory occpied: (10680.0, 8588.0)
Streaming imagenet data took 38.577730655670166 seconds
Then, training+dataloading take 38.71540880203247 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2996654510498047
Time for copying to cuda: 0.7735574245452881
Time for forward pass: 1.386207103729248
Time for backpropagation: 0.006605625152587891
GPU memory for training: 13.671006679534912                          

Memory occpied: (10680.0, 8588.0)
One training iteration takes: 4.903917074203491 seconds
Index: 2
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.44246482849121 seconds
Memory occpied: (10680.0, 8588.0)
Streaming imagenet data took 38.77428340911865 seconds
Then, training+dataloading take 38.94626808166504 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3372340202331543
Time for copying to cuda: 0.7733492851257324
Time for forward pass: 1.3908607959747314
Time for backpropagation: 0.006880521774291992
GPU memory for training: 13.671006679534912                          

Memory occpied: (10680.0, 8588.0)
One training iteration takes: 4.916601896286011 seconds
Index: 3
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.4559588432312 seconds
Memory occpied: (10680.0, 8588.0)
Streaming imagenet data took 38.77938270568848 seconds
Then, training+dataloading take 38.953707218170166 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Time of next(dataloader) is: 2.2649941444396973
Memory occpied: (10680.0, 8588.0)
Time for copying to cuda: 0.8645195960998535
Memory occpied: (10680.0, 8588.0)
Time for forward pass: 1.3714463710784912
Time for backpropagation: 0.006676435470581055
GPU memory for training: 13.671006679534912                          

One training iteration takes: 4.911407947540283 seconds
Index: 4
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.38739323616028 seconds
Memory occpied: (10680.0, 8588.0)
Streaming imagenet data took 38.696322441101074 seconds
Then, training+dataloading take 38.8322696685791 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.271242618560791
Time for copying to cuda: 0.7709834575653076
Time for forward pass: 1.370966911315918
Time for backpropagation: 0.006573200225830078
GPU memory for training: 13.671006679534912                          

One training iteration takes: 4.889891862869263 seconds
Index: 5
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.77434325218201 seconds
Memory occpied: (10680.0, 8588.0)
Streaming imagenet data took 39.08829307556152 seconds
Then, training+dataloading take 39.276686906814575 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3033275604248047
Time for copying to cuda: 0.7681138515472412
Time for forward pass: 1.391167402267456
Time for backpropagation: 0.006548404693603516
GPU memory for training: 13.671006679534912                          

Memory occpied: (10680.0, 8588.0)
One training iteration takes: 4.886097192764282 seconds
Index: 6
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Memory occpied: (10680.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 37.399176836013794 seconds
Memory occpied: (10680.0, 8588.0)
Streaming imagenet data took 38.746872901916504 seconds
Then, training+dataloading take 38.89893627166748 seconds

Epoch: 0
Time of next(dataloader) is: 2.3090052604675293
Time for copying to cuda: 0.7730109691619873
Time for forward pass: 1.4022698402404785
Time for backpropagation: 0.0065190792083740234
GPU memory for training: 13.671006679534912                          

Memory occpied: (10680.0, 8588.0)
The whole process took 322.31896138191223 seconds
