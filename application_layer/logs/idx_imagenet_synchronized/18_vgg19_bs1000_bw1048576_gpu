Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=18, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5716219276605 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119088299.62930232 119088299.62930232
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 18 36
Intermediate:  3.0625
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 8016.98974609375 8966.60009765625 30028.70849609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 18
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.31925344467163 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 43.589335680007935 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.110395908355713
Time for copying to cuda: 0.776045560836792
Time for forward pass: 9.616145133972168
Time for backpropagation: 0.05263686180114746
GPU memory for training: 19.48909854888916                          

Memory occpied: (1894.0, 3.0)
One training iteration takes: 12.945417404174805 seconds
Index: 0
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.692843437194824 seconds
Memory occpied: (6476.0, 7572.0)
Streaming imagenet data took 43.97929000854492 seconds
Then, training+dataloading take 44.12138032913208 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.217726230621338
Time for copying to cuda: 0.7733588218688965
Time for forward pass: 1.033719778060913
Time for backpropagation: 0.004403591156005859
GPU memory for training: 16.09134006500244                          

Memory occpied: (6476.0, 7572.0)
One training iteration takes: 4.440316200256348 seconds
Index: 1
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.95702862739563 seconds
Memory occpied: (13128.0, 11144.0)
Streaming imagenet data took 44.259907245635986 seconds
Then, training+dataloading take 44.45091271400452 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.200000524520874
Time for copying to cuda: 0.7736358642578125
Time for forward pass: 1.019014835357666
Time for backpropagation: 0.0040166378021240234
GPU memory for training: 16.09134006500244                          

Memory occpied: (13128.0, 11144.0)
One training iteration takes: 4.391083002090454 seconds
Index: 2
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 43.010615825653076 seconds
Memory occpied: (13128.0, 11144.0)
Streaming imagenet data took 44.301602363586426 seconds
Then, training+dataloading take 44.45152974128723 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2377164363861084
Time for copying to cuda: 0.779365062713623
Time for forward pass: 1.031247854232788
Time for backpropagation: 0.004076480865478516
GPU memory for training: 16.09134006500244                          

Memory occpied: (13128.0, 11144.0)
One training iteration takes: 4.458700656890869 seconds
Index: 3
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.790372371673584 seconds
Memory occpied: (13128.0, 11144.0)
Streaming imagenet data took 44.10200238227844 seconds
Then, training+dataloading take 44.15860366821289 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Time of next(dataloader) is: 2.140016794204712
Memory occpied: (13128.0, 11144.0)
Time for copying to cuda: 0.8704795837402344
Memory occpied: (13128.0, 11144.0)
Time for forward pass: 1.0170249938964844
Time for backpropagation: 0.004172563552856445
GPU memory for training: 16.09134006500244                          

One training iteration takes: 4.450117111206055 seconds
Index: 4
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.782076835632324 seconds
Memory occpied: (13128.0, 11144.0)
Streaming imagenet data took 44.08020567893982 seconds
Then, training+dataloading take 44.14280605316162 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Time of next(dataloader) is: 2.170322895050049
Memory occpied: (13128.0, 11144.0)
Time for copying to cuda: 0.8706741333007812
Memory occpied: (13128.0, 11144.0)
Time for forward pass: 1.00579833984375
Time for backpropagation: 0.004194736480712891
GPU memory for training: 16.09134006500244                          

One training iteration takes: 4.482545375823975 seconds
Index: 5
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.68267774581909 seconds
Memory occpied: (13128.0, 11144.0)
Streaming imagenet data took 43.97006964683533 seconds
Then, training+dataloading take 44.02895212173462 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Time of next(dataloader) is: 2.1817402839660645
Memory occpied: (13128.0, 11144.0)
Time for copying to cuda: 0.8675205707550049
Time for forward pass: 1.03403639793396
Time for backpropagation: 0.0057659149169921875
GPU memory for training: 16.09134006500244                          

Memory occpied: (13128.0, 11144.0)
One training iteration takes: 4.500292539596558 seconds
Index: 6
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.69766974449158 seconds
Memory occpied: (13128.0, 11144.0)
Streaming imagenet data took 43.98152136802673 seconds
Then, training+dataloading take 44.039483308792114 seconds

Epoch: 0
Memory occpied: (13128.0, 11144.0)
Memory occpied: (13128.0, 11144.0)
Time of next(dataloader) is: 2.172431230545044
Memory occpied: (13128.0, 11144.0)
Time for copying to cuda: 0.8603920936584473
Time for forward pass: 1.0394043922424316
Time for backpropagation: 0.004729270935058594
GPU memory for training: 16.09134006500244                          

Memory occpied: (13128.0, 11144.0)
The whole process took 366.2751247882843 seconds
