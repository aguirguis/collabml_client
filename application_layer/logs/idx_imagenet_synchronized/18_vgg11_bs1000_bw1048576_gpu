Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=18, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.0386205828356 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119018438.07703343 119018438.07703343
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 18 25
Intermediate:  0.3828125
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 1757.02587890625 2665.42236328125 26448.43212890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 18
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.430682182312012 seconds
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 9.645715951919556 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4993293285369873
Time for copying to cuda: 0.09950828552246094
Memory occpied: (2224.0, 434.0)
Memory occpied: (2224.0, 860.0)
Memory occpied: (2224.0, 1336.0)
Memory occpied: (5840.0, 5374.0)
Time for forward pass: 4.255553960800171
Time for backpropagation: 0.04671216011047363
GPU memory for training: 8.204551696777344                          

One training iteration takes: 5.004929542541504 seconds
Index: 0
Memory occpied: (5792.0, 3316.0)
Memory occpied: (5792.0, 3316.0)
Memory occpied: (5792.0, 3316.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.439905881881714 seconds
Streaming imagenet data took 9.669716835021973 seconds
Then, training+dataloading take 9.695525169372559 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (5792.0, 3316.0)
Time of next(dataloader) is: 0.5422492027282715
Time for copying to cuda: 0.09897327423095703
Time for forward pass: 0.19925212860107422
Time for backpropagation: 0.0032117366790771484
GPU memory for training: 4.324462890625                          

One training iteration takes: 0.9578771591186523 seconds
Index: 1
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.486294269561768 seconds
Streaming imagenet data took 9.718135118484497 seconds
Then, training+dataloading take 9.743813037872314 seconds
Memory occpied: (5800.0, 3324.0)
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5443744659423828
Time for copying to cuda: 0.09895634651184082
Time for forward pass: 0.1954946517944336
Time for backpropagation: 0.0030410289764404297
GPU memory for training: 4.324462890625                          

One training iteration takes: 0.9642825126647949 seconds
Index: 2
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.477725982666016 seconds
Streaming imagenet data took 9.70963716506958 seconds
Memory occpied: (5800.0, 3324.0)
Then, training+dataloading take 9.735549211502075 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5463094711303711
Time for copying to cuda: 0.09900093078613281
Time for forward pass: 0.19918560981750488
Time for backpropagation: 0.0031015872955322266
GPU memory for training: 4.324462890625                          

One training iteration takes: 0.9872536659240723 seconds
Index: 3
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.377264738082886 seconds
Streaming imagenet data took 9.567516326904297 seconds
Then, training+dataloading take 9.593549966812134 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5789797306060791
Time for copying to cuda: 0.09909749031066895
Time for forward pass: 0.19909954071044922
Time for backpropagation: 0.003088712692260742
GPU memory for training: 4.324462890625                          

Memory occpied: (5800.0, 3324.0)
One training iteration takes: 1.0072760581970215 seconds
Index: 4
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.56301736831665 seconds
Memory occpied: (5800.0, 3324.0)
Streaming imagenet data took 9.708927392959595 seconds
Then, training+dataloading take 9.736342906951904 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5464653968811035
Time for copying to cuda: 0.09940314292907715
Time for forward pass: 0.2209165096282959
Time for backpropagation: 0.0036537647247314453
GPU memory for training: 4.324462890625                          

One training iteration takes: 0.9921987056732178 seconds
Index: 5
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.490138530731201 seconds
Streaming imagenet data took 9.72275710105896 seconds
Memory occpied: (5800.0, 3324.0)
Then, training+dataloading take 9.750939846038818 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5454308986663818
Time for copying to cuda: 0.09941291809082031
Time for forward pass: 0.19931340217590332
Time for backpropagation: 0.003431081771850586
GPU memory for training: 4.324462890625                          

One training iteration takes: 0.9758317470550537 seconds
Index: 6
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Memory occpied: (5800.0, 3324.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.502211570739746 seconds
Streaming imagenet data took 9.733537673950195 seconds
Then, training+dataloading take 9.758626461029053 seconds

Epoch: 0
Memory occpied: (5800.0, 3324.0)
Time of next(dataloader) is: 0.5422091484069824
Time for copying to cuda: 0.09872984886169434
Time for forward pass: 0.19918441772460938
Time for backpropagation: 0.0032312870025634766
GPU memory for training: 4.324462890625                          

The whole process took 86.48246574401855 seconds
