Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=11, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5474271956798 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119085128.37739214 119085128.37739214
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 11 17
Intermediate:  0.1650390625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 829.95361328125 1096.23095703125 2716.18408203125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Using split index: 11
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Length of received data: 173103121
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.1162033081054688 seconds
Streaming imagenet data took 3.1777899265289307 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41544032096862793
Time for copying to cuda: 0.043344974517822266
Memory occpied: (1680.0, 22.0)
Memory occpied: (1680.0, 656.0)
Memory occpied: (1680.0, 1070.0)
Length of received data: 173103121
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.203864097595215 seconds
Streaming imagenet data took 3.2657604217529297 seconds
Time for forward pass: 3.2083895206451416
Time for backpropagation: 0.05017709732055664
GPU memory for training: 1.2120437622070312                          

One training iteration takes: 3.79280161857605 seconds
Index: 0
Then, training+dataloading take 3.793248176574707 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46181297302246094
Time for copying to cuda: 0.04324173927307129
Time for forward pass: 0.05628681182861328
Time for backpropagation: 0.0036001205444335938
GPU memory for training: 1.367194652557373                          

One training iteration takes: 0.6726195812225342 seconds
Index: 1
Memory occpied: (2194.0, 1642.0)
Memory occpied: (2420.0, 1642.0)
Length of received data: 173103121
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.1956822872161865 seconds
Memory occpied: (2420.0, 1642.0)
Streaming imagenet data took 3.257861852645874 seconds
Then, training+dataloading take 3.26918625831604 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4246542453765869
Time for copying to cuda: 0.042438507080078125
Time for forward pass: 0.05620217323303223
Time for backpropagation: 0.002643585205078125
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.6095726490020752 seconds
Index: 2
Memory occpied: (2420.0, 1642.0)
Memory occpied: (2420.0, 1642.0)
Length of received data: 173103121
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.197209596633911 seconds
Streaming imagenet data took 3.258779287338257 seconds
Then, training+dataloading take 3.2684736251831055 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46204137802124023
Time for copying to cuda: 0.04252505302429199
Time for forward pass: 0.0560917854309082
Time for backpropagation: 0.0025315284729003906
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.6735527515411377 seconds
Index: 3
Memory occpied: (2420.0, 1642.0)
Memory occpied: (2420.0, 1642.0)
Length of received data: 173103121
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.2453293800354004 seconds
Memory occpied: (2420.0, 1642.0)
Streaming imagenet data took 3.3073742389678955 seconds
Then, training+dataloading take 3.319126844406128 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41991519927978516
Time for copying to cuda: 0.04280281066894531
Time for forward pass: 0.05605888366699219
Time for backpropagation: 0.002541780471801758
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.6238176822662354 seconds
Index: 4
Memory occpied: (2420.0, 1642.0)
Memory occpied: (2420.0, 1642.0)
Length of received data: 173103121
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.211378812789917 seconds
Streaming imagenet data took 3.2734460830688477 seconds
Then, training+dataloading take 3.281719923019409 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5454416275024414
Time for copying to cuda: 0.04268789291381836
Time for forward pass: 0.05612611770629883
Time for backpropagation: 0.0028412342071533203
GPU memory for training: 1.367560863494873                          

Memory occpied: (2420.0, 1642.0)
One training iteration takes: 0.7456634044647217 seconds
Index: 5
Memory occpied: (2420.0, 1642.0)
Memory occpied: (2420.0, 1642.0)
Length of received data: 173103121
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.286041259765625 seconds
Streaming imagenet data took 3.34736704826355 seconds
Then, training+dataloading take 3.3557465076446533 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4453413486480713
Time for copying to cuda: 0.042645931243896484
Time for forward pass: 0.05619239807128906
Time for backpropagation: 0.0025787353515625
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.6487681865692139 seconds
Index: 6
Memory occpied: (2420.0, 1642.0)
Memory occpied: (2420.0, 1642.0)
Length of received data: 173103121
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.203458786010742 seconds
Streaming imagenet data took 3.3090202808380127 seconds
Then, training+dataloading take 3.3157100677490234 seconds

Epoch: 0
Time of next(dataloader) is: 0.505645751953125
Time for copying to cuda: 0.042679786682128906
Time for forward pass: 0.0561375617980957
Time for backpropagation: 0.0025348663330078125
GPU memory for training: 1.367560863494873                          

Memory occpied: (2420.0, 1642.0)
The whole process took 34.85712718963623 seconds
