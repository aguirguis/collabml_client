Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=2, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.299293977073 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119052605.06016292 119052605.06016292
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 2 17
Intermediate:  0.738525390625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 2141.23291015625 2407.51025390625 3453.97705078125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Using split index: 2
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 8.818953514099121 seconds
Memory occpied: (1514.0, 3.0)
Streaming imagenet data took 9.091464042663574 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7196173667907715
Memory occpied: (2254.0, 3.0)
Time for copying to cuda: 0.2170393466949463
Memory occpied: (2254.0, 812.0)
Memory occpied: (2254.0, 1256.0)
Memory occpied: (5088.0, 4630.0)
Time for forward pass: 4.613468408584595
Time for backpropagation: 0.09782195091247559
GPU memory for training: 6.579479217529297                          

Memory occpied: (2540.0, 4460.0)
One training iteration takes: 5.795577049255371 seconds
Index: 0
Memory occpied: (2764.0, 4460.0)
Memory occpied: (2764.0, 4460.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 8.863379001617432 seconds
Streaming imagenet data took 9.135099411010742 seconds
Then, training+dataloading take 9.178117513656616 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (2764.0, 4460.0)
Time of next(dataloader) is: 0.8358078002929688
Time for copying to cuda: 0.18692231178283691
Time for forward pass: 0.18615293502807617
Time for backpropagation: 0.0028073787689208984
GPU memory for training: 3.8910465240478516                          

One training iteration takes: 1.3715410232543945 seconds
Index: 1
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 8.834570169448853 seconds
Memory occpied: (3810.0, 4468.0)
Streaming imagenet data took 9.203487873077393 seconds
Then, training+dataloading take 9.251318454742432 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7444620132446289
Time for copying to cuda: 0.26154017448425293
Memory occpied: (3810.0, 4468.0)
Time for forward pass: 0.18598127365112305
Time for backpropagation: 0.0026786327362060547
GPU memory for training: 3.8910465240478516                          

One training iteration takes: 1.3605401515960693 seconds
Index: 2
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 8.859813213348389 seconds
Streaming imagenet data took 9.134831428527832 seconds
Then, training+dataloading take 9.165508508682251 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (3810.0, 4468.0)
Time of next(dataloader) is: 0.8199605941772461
Time for copying to cuda: 0.18861079216003418
Time for forward pass: 0.18623781204223633
Time for backpropagation: 0.0027518272399902344
GPU memory for training: 3.8910465240478516                          

One training iteration takes: 1.3693509101867676 seconds
Index: 3
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 8.766819953918457 seconds
Streaming imagenet data took 9.137933731079102 seconds
Then, training+dataloading take 9.159811735153198 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Time of next(dataloader) is: 0.742750883102417
Time for copying to cuda: 0.18866825103759766
Time for forward pass: 0.1880359649658203
Time for backpropagation: 0.003209352493286133
GPU memory for training: 3.8910465240478516                          

One training iteration takes: 1.2676057815551758 seconds
Index: 4
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 8.76613712310791 seconds
Memory occpied: (3810.0, 4468.0)
Streaming imagenet data took 9.143375158309937 seconds
Then, training+dataloading take 9.18765139579773 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7496359348297119
Time for copying to cuda: 0.26327991485595703
Memory occpied: (3810.0, 4468.0)
Time for forward pass: 0.18610811233520508
Time for backpropagation: 0.0026924610137939453
GPU memory for training: 3.8910465240478516                          

One training iteration takes: 1.3696668148040771 seconds
Index: 5
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 8.816668272018433 seconds
Streaming imagenet data took 9.091068983078003 seconds
Then, training+dataloading take 9.134741067886353 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (3810.0, 4468.0)
Time of next(dataloader) is: 0.793034553527832
Time for copying to cuda: 0.18777132034301758
Time for forward pass: 0.1864321231842041
Time for backpropagation: 0.002836942672729492
GPU memory for training: 3.8910465240478516                          

One training iteration takes: 1.3529865741729736 seconds
Index: 6
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Memory occpied: (3810.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 8.769442796707153 seconds
Memory occpied: (3810.0, 4468.0)
Streaming imagenet data took 9.139190196990967 seconds
Then, training+dataloading take 9.170432090759277 seconds

Epoch: 0
Time of next(dataloader) is: 0.7688329219818115
Time for copying to cuda: 0.22800517082214355
Memory occpied: (3810.0, 4468.0)
Time for forward pass: 0.18668889999389648
Time for backpropagation: 0.002808809280395508
GPU memory for training: 3.8910465240478516                          

The whole process took 81.96520614624023 seconds
