Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9995.2592147513 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1310098615.7958825 1310098615.7958825
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 20
Intermediate:  3.0625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 13580.96875 13776.19482421875 17217.6875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 5
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.36266803741455 seconds
Memory occpied: (1318.0, 3.0)
Streaming imagenet data took 15.617554426193237 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Time of next(dataloader) is: 2.104656457901001
Memory occpied: (4382.0, 3.0)
Time for copying to cuda: 0.8360562324523926
Memory occpied: (4382.0, 1954.0)
Memory occpied: (4382.0, 2388.0)
Memory occpied: (11870.0, 10310.0)
Memory occpied: (11024.0, 9468.0)
Memory occpied: (9534.0, 3994.0)
Memory occpied: (6700.0, 6648.0)
Memory occpied: (10572.0, 6850.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.86458420753479 seconds
Memory occpied: (4918.0, 6102.0)
Time for forward pass: 12.214545249938965
Time for backpropagation: 0.08523130416870117
GPU memory for training: 19.156371116638184                          

One training iteration takes: 15.626803874969482 seconds
Index: 0
Memory occpied: (4952.0, 4808.0)
Streaming imagenet data took 16.55994939804077 seconds
Then, training+dataloading take 16.68401789665222 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (4952.0, 4808.0)
Time of next(dataloader) is: 2.1551108360290527
Memory occpied: (4952.0, 4808.0)
Time for copying to cuda: 0.7694590091705322
Memory occpied: (7266.0, 6356.0)
Time for forward pass: 1.0964665412902832
Time for backpropagation: 0.011476755142211914
GPU memory for training: 9.141491413116455                          

One training iteration takes: 4.428241014480591 seconds
Index: 1
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.581680059432983 seconds
Memory occpied: (7266.0, 6356.0)
Streaming imagenet data took 15.868846416473389 seconds
Then, training+dataloading take 16.00253176689148 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.242791175842285
Time for copying to cuda: 0.7688753604888916
Time for forward pass: 1.1060304641723633
Time for backpropagation: 0.01153874397277832
GPU memory for training: 9.141491413116455                          

One training iteration takes: 4.584289312362671 seconds
Index: 2
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.855509996414185 seconds
Memory occpied: (7266.0, 6356.0)
Streaming imagenet data took 16.161470890045166 seconds
Then, training+dataloading take 16.336772203445435 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Time of next(dataloader) is: 2.3276069164276123
Memory occpied: (7266.0, 6356.0)
Time for copying to cuda: 0.8815100193023682
Memory occpied: (7266.0, 6356.0)
Time for forward pass: 1.0995745658874512
Time for backpropagation: 0.011229515075683594
GPU memory for training: 9.141491413116455                          

One training iteration takes: 4.749678134918213 seconds
Index: 3
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.390571355819702 seconds
Memory occpied: (7266.0, 6356.0)
Streaming imagenet data took 15.69470739364624 seconds
Then, training+dataloading take 15.766870737075806 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.1978280544281006
Time for copying to cuda: 0.7788558006286621
Time for forward pass: 1.080981731414795
Time for backpropagation: 0.011343955993652344
GPU memory for training: 9.141491413116455                          

Memory occpied: (7266.0, 6356.0)
One training iteration takes: 4.494591951370239 seconds
Index: 4
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.790477991104126 seconds
Memory occpied: (7266.0, 6356.0)
Streaming imagenet data took 15.998873710632324 seconds
Then, training+dataloading take 16.139013528823853 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3629963397979736
Time for copying to cuda: 0.7764689922332764
Time for forward pass: 1.0824503898620605
Time for backpropagation: 0.011466503143310547
GPU memory for training: 9.141491413116455                          

Memory occpied: (7266.0, 6356.0)
One training iteration takes: 4.633313417434692 seconds
Index: 5
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.366913795471191 seconds
Memory occpied: (7266.0, 6356.0)
Streaming imagenet data took 15.57956051826477 seconds
Then, training+dataloading take 15.718855857849121 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3381388187408447
Time for copying to cuda: 0.7788248062133789
Time for forward pass: 1.0940756797790527
Time for backpropagation: 0.01110219955444336
GPU memory for training: 9.141491413116455                          

Memory occpied: (7266.0, 6356.0)
One training iteration takes: 4.623799800872803 seconds
Index: 6
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Memory occpied: (7266.0, 6356.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.41772198677063 seconds
Memory occpied: (7266.0, 6356.0)
Streaming imagenet data took 15.745544672012329 seconds
Then, training+dataloading take 15.7965726852417 seconds

Epoch: 0
Time of next(dataloader) is: 2.3046131134033203
Time for copying to cuda: 0.775364875793457
Time for forward pass: 1.095085620880127
Time for backpropagation: 0.011378288269042969
GPU memory for training: 9.141491413116455                          

Memory occpied: (7266.0, 6356.0)
The whole process took 139.66223073005676 seconds
