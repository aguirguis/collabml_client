Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=27, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3000542985665 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119052704.7170217 119052704.7170217
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 27 36
Intermediate:  1.53125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 4571.67724609375 5521.28759765625 28114.64599609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 27
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 27.352008819580078 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 28.025959968566895 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1894.0, 3.0)
Time of next(dataloader) is: 1.183729887008667
Time for copying to cuda: 0.3881094455718994
Memory occpied: (3426.0, 938.0)
Memory occpied: (3426.0, 1412.0)
Memory occpied: (3426.0, 1836.0)
Memory occpied: (7434.0, 6376.0)
Time for forward pass: 4.718075275421143
Time for backpropagation: 0.05377054214477539
GPU memory for training: 10.342461585998535                          

One training iteration takes: 6.604189872741699 seconds
Index: 0
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Memory occpied: (4972.0, 6384.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 27.565740823745728 seconds
Memory occpied: (4972.0, 6384.0)
Streaming imagenet data took 28.24834370613098 seconds
Then, training+dataloading take 28.306392669677734 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (4972.0, 6384.0)
Time of next(dataloader) is: 1.3042423725128174
Time for copying to cuda: 0.3900637626647949
Memory occpied: (6530.0, 6392.0)
Time for forward pass: 0.4325134754180908
Time for backpropagation: 0.004212856292724609
GPU memory for training: 7.228028297424316                          

One training iteration takes: 2.387756824493408 seconds
Index: 1
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 27.580512523651123 seconds
Memory occpied: (6530.0, 6392.0)
Streaming imagenet data took 28.269994974136353 seconds
Then, training+dataloading take 28.354461669921875 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (6530.0, 6392.0)
Time of next(dataloader) is: 1.248781442642212
Time for copying to cuda: 0.39078235626220703
Memory occpied: (6530.0, 6392.0)
Time for forward pass: 0.4421405792236328
Time for backpropagation: 0.0042781829833984375
GPU memory for training: 7.228028297424316                          

One training iteration takes: 2.345313549041748 seconds
Index: 2
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 27.61033034324646 seconds
Memory occpied: (6530.0, 6392.0)
Streaming imagenet data took 28.30463743209839 seconds
Then, training+dataloading take 28.40038299560547 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (6530.0, 6392.0)
Time of next(dataloader) is: 1.2222423553466797
Time for copying to cuda: 0.38919973373413086
Time for forward pass: 0.4221627712249756
Time for backpropagation: 0.004299640655517578
GPU memory for training: 7.228028297424316                          

One training iteration takes: 2.2964916229248047 seconds
Index: 3
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 27.62810182571411 seconds
Memory occpied: (6530.0, 6392.0)
Streaming imagenet data took 28.20508646965027 seconds
Then, training+dataloading take 28.263587713241577 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (6530.0, 6392.0)
Time of next(dataloader) is: 1.2827763557434082
Time for copying to cuda: 0.43621230125427246
Memory occpied: (6530.0, 6392.0)
Time for forward pass: 0.3986377716064453
Time for backpropagation: 0.0042340755462646484
GPU memory for training: 7.228028297424316                          

One training iteration takes: 2.3658859729766846 seconds
Index: 4
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 27.526156425476074 seconds
Memory occpied: (6530.0, 6392.0)
Streaming imagenet data took 28.218472957611084 seconds
Then, training+dataloading take 28.317822456359863 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (6530.0, 6392.0)
Time of next(dataloader) is: 1.2019670009613037
Time for copying to cuda: 0.39173078536987305
Memory occpied: (6530.0, 6392.0)
Time for forward pass: 0.440723180770874
Time for backpropagation: 0.0042340755462646484
GPU memory for training: 7.228028297424316                          

One training iteration takes: 2.288670301437378 seconds
Index: 5
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 27.598084926605225 seconds
Memory occpied: (6530.0, 6392.0)
Streaming imagenet data took 28.28560709953308 seconds
Then, training+dataloading take 28.345049381256104 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (6530.0, 6392.0)
Time of next(dataloader) is: 1.276470422744751
Time for copying to cuda: 0.39063000679016113
Memory occpied: (6530.0, 6392.0)
Time for forward pass: 0.4017488956451416
Time for backpropagation: 0.004303693771362305
GPU memory for training: 7.228028297424316                          

One training iteration takes: 2.3413121700286865 seconds
Index: 6
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Memory occpied: (6530.0, 6392.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 27.524815797805786 seconds
Memory occpied: (6530.0, 6392.0)
Streaming imagenet data took 28.213623523712158 seconds
Then, training+dataloading take 28.284972190856934 seconds

Epoch: 0
Memory occpied: (6530.0, 6392.0)
Time of next(dataloader) is: 1.269845962524414
Time for copying to cuda: 0.39102649688720703
Memory occpied: (6530.0, 6392.0)
Time for forward pass: 0.4116477966308594
Time for backpropagation: 0.0042819976806640625
GPU memory for training: 7.228028297424316                          

The whole process took 237.3486349582672 seconds
