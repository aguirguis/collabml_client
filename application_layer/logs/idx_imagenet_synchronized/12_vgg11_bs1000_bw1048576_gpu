Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=12, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3027784686517 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119053061.77944311 119053061.77944311
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 12 25
Intermediate:  1.53125
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 5202.33837890625 6110.73486328125 28745.30712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 12
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 20.825459718704224 seconds
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 21.48910927772522 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1840.0, 3.0)
Time of next(dataloader) is: 1.138390064239502
Time for copying to cuda: 0.3883209228515625
Memory occpied: (3372.0, 942.0)
Memory occpied: (3372.0, 1412.0)
Memory occpied: (3372.0, 1834.0)
Memory occpied: (11432.0, 10200.0)
Memory occpied: (11432.0, 10200.0)
Memory occpied: (10980.0, 10200.0)
Time for forward pass: 7.416397571563721
Time for backpropagation: 0.09240937232971191
GPU memory for training: 18.18993377685547                          

Memory occpied: (4096.0, 10208.0)
One training iteration takes: 9.273444175720215 seconds
Index: 0
Memory occpied: (4490.0, 10208.0)
Memory occpied: (4490.0, 10208.0)
Memory occpied: (4490.0, 10208.0)
Memory occpied: (4490.0, 10208.0)
Memory occpied: (4490.0, 10208.0)
Memory occpied: (4490.0, 10208.0)
Memory occpied: (4490.0, 10208.0)
Memory occpied: (4490.0, 10208.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 20.225456953048706 seconds
Memory occpied: (4490.0, 10208.0)
Streaming imagenet data took 20.907480001449585 seconds
Then, training+dataloading take 20.965851068496704 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (4490.0, 10208.0)
Time of next(dataloader) is: 1.2807984352111816
Time for copying to cuda: 0.38741207122802734
Memory occpied: (8478.0, 10216.0)
Time for forward pass: 0.5003116130828857
Time for backpropagation: 0.003281831741333008
GPU memory for training: 11.163604736328125                          

One training iteration takes: 2.4214370250701904 seconds
Index: 1
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 20.115503311157227 seconds
Memory occpied: (8478.0, 10216.0)
Streaming imagenet data took 20.799306869506836 seconds
Then, training+dataloading take 20.890920400619507 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (8478.0, 10216.0)
Time of next(dataloader) is: 1.214557409286499
Time for copying to cuda: 0.38916778564453125
Memory occpied: (8478.0, 10216.0)
Time for forward pass: 0.49498605728149414
Time for backpropagation: 0.003222227096557617
GPU memory for training: 11.163604736328125                          

One training iteration takes: 2.3446249961853027 seconds
Index: 2
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 20.33880925178528 seconds
Memory occpied: (8478.0, 10216.0)
Streaming imagenet data took 21.041922092437744 seconds
Then, training+dataloading take 21.10074472427368 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (8478.0, 10216.0)
Time of next(dataloader) is: 1.2675116062164307
Time for copying to cuda: 0.38968563079833984
Memory occpied: (8478.0, 10216.0)
Time for forward pass: 0.5013430118560791
Time for backpropagation: 0.0032281875610351562
GPU memory for training: 11.163604736328125                          

One training iteration takes: 2.4138050079345703 seconds
Index: 3
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 21.053728342056274 seconds
Memory occpied: (8478.0, 10216.0)
Streaming imagenet data took 21.74229669570923 seconds
Then, training+dataloading take 21.801483154296875 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (8478.0, 10216.0)
Time of next(dataloader) is: 1.2713522911071777
Time for copying to cuda: 0.3924558162689209
Memory occpied: (8478.0, 10216.0)
Time for forward pass: 0.47297096252441406
Time for backpropagation: 0.0031747817993164062
GPU memory for training: 11.163604736328125                          

One training iteration takes: 2.4082095623016357 seconds
Index: 4
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 20.104437112808228 seconds
Memory occpied: (8478.0, 10216.0)
Streaming imagenet data took 20.80650496482849 seconds
Then, training+dataloading take 20.891202688217163 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (8478.0, 10216.0)
Time of next(dataloader) is: 1.2238528728485107
Time for copying to cuda: 0.39225149154663086
Memory occpied: (8478.0, 10216.0)
Time for forward pass: 0.4757380485534668
Time for backpropagation: 0.003281831741333008
GPU memory for training: 11.163604736328125                          

One training iteration takes: 2.338460683822632 seconds
Index: 5
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 20.974226474761963 seconds
Memory occpied: (8478.0, 10216.0)
Streaming imagenet data took 21.672154426574707 seconds
Then, training+dataloading take 21.767194271087646 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (8478.0, 10216.0)
Time of next(dataloader) is: 1.2059156894683838
Time for copying to cuda: 0.39258241653442383
Memory occpied: (8478.0, 10216.0)
Time for forward pass: 0.49857234954833984
Time for backpropagation: 0.003215312957763672
GPU memory for training: 11.163604736328125                          

One training iteration takes: 2.356477737426758 seconds
Index: 6
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Memory occpied: (8478.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 20.19322967529297 seconds
Memory occpied: (8478.0, 10216.0)
Streaming imagenet data took 20.91641592979431 seconds
Then, training+dataloading take 20.97552800178528 seconds

Epoch: 0
Memory occpied: (8478.0, 10216.0)
Time of next(dataloader) is: 1.2859516143798828
Time for copying to cuda: 0.3922286033630371
Memory occpied: (8478.0, 10216.0)
Time for forward pass: 0.4735434055328369
Time for backpropagation: 0.0032312870025634766
GPU memory for training: 11.163604736328125                          

The whole process took 180.8601779937744 seconds
