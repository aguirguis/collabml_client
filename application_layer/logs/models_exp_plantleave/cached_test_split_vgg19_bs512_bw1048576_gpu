Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=512, cached=True, cpuonly=False, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.4699120811894 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 8.8000000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118943896.31630565 118943896.31630565
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.33992767333984
Server, client, server+client, vanilla  1335.13818359375 1412.84912109375 2747.9873046875 14054.84912109375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1878.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 512, post_step 64

Memory occpied: (1878.0, 3.0)
Memory occpied: (1878.0, 3.0)
Memory occpied: (1878.0, 3.0)
Memory occpied: (1878.0, 3.0)
Memory occpied: (1878.0, 3.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.603983640670776 seconds
Streaming plantleave data took 5.707027196884155 seconds
The mode is:  split
Start 512, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.39673376083374023
Time for copying to cuda: 0.05039811134338379
Time for forward pass: 3.5814197063446045
Time for backpropagation: 0.06218361854553223
GPU memory for training: 5.770658493041992                          

Memory occpied: (1878.0, 3.0)
One training iteration takes: 4.181628942489624 seconds
Index: 0
Memory occpied: (4620.0, 3758.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.404553174972534 seconds
Streaming plantleave data took 5.477972507476807 seconds
Then, training+dataloading take 5.479572057723999 seconds
The mode is:  split
Start 1024, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.40636610984802246
Time for copying to cuda: 0.04997515678405762
Time for forward pass: 0.23217201232910156
Time for backpropagation: 0.004193544387817383
GPU memory for training: 4.309477806091309                          

One training iteration takes: 0.7899379730224609 seconds
Index: 1
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.237145900726318 seconds
Streaming plantleave data took 5.310004472732544 seconds
Then, training+dataloading take 5.311118125915527 seconds
The mode is:  split
Start 1536, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4114699363708496
Time for copying to cuda: 0.0833437442779541
Memory occpied: (4630.0, 3766.0)
Time for forward pass: 0.24334263801574707
Time for backpropagation: 0.0042154788970947266
GPU memory for training: 4.309477806091309                          

Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.361673355102539 seconds
Streaming plantleave data took 5.436192274093628 seconds
One training iteration takes: 5.774108409881592 seconds
Index: 2
Then, training+dataloading take 5.7761688232421875 seconds
The mode is:  split
Start 2048, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3886411190032959
Time for copying to cuda: 0.05091404914855957
Time for forward pass: 0.24476075172424316
Time for backpropagation: 0.004632711410522461
GPU memory for training: 4.309477806091309                          

Memory occpied: (4630.0, 3766.0)
One training iteration takes: 0.780860185623169 seconds
Index: 3
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.563774824142456 seconds
Streaming plantleave data took 5.636494398117065 seconds
Then, training+dataloading take 5.6407365798950195 seconds
The mode is:  split
Start 2560, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4325897693634033
Time for copying to cuda: 0.050215721130371094
Time for forward pass: 0.2435758113861084
Time for backpropagation: 0.0042209625244140625
GPU memory for training: 4.309477806091309                          

One training iteration takes: 0.8402202129364014 seconds
Index: 4
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.503928184509277 seconds
Streaming plantleave data took 5.577622413635254 seconds
Then, training+dataloading take 5.583123683929443 seconds
The mode is:  split
Start 3072, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4684596061706543
Time for copying to cuda: 0.04961109161376953
Time for forward pass: 0.2435166835784912
Time for backpropagation: 0.0041196346282958984
GPU memory for training: 4.309477806091309                          

Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.588402986526489 seconds
Streaming plantleave data took 5.698590993881226 seconds
Memory occpied: (4630.0, 3766.0)
One training iteration takes: 5.796738386154175 seconds
Index: 5
Then, training+dataloading take 5.7968974113464355 seconds
The mode is:  split
Start 3584, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4220082759857178
Time for copying to cuda: 0.051012277603149414
Time for forward pass: 0.23081088066101074
Time for backpropagation: 0.004110097885131836
GPU memory for training: 4.309477806091309                          

One training iteration takes: 0.793236255645752 seconds
Index: 6
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.410055637359619 seconds
Streaming plantleave data took 5.482910633087158 seconds
Then, training+dataloading take 5.492371082305908 seconds
The mode is:  split
Start 4096, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4534461498260498
Time for copying to cuda: 0.050737619400024414
Time for forward pass: 0.24352383613586426
Time for backpropagation: 0.004106283187866211
GPU memory for training: 4.309477806091309                          

One training iteration takes: 0.8687534332275391 seconds
Index: 7
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Memory occpied: (4630.0, 3766.0)
Read 155.44088077545166 MBs for this batch
Executing all posts took 4.650045871734619 seconds
Streaming plantleave data took 4.708523273468018 seconds
Then, training+dataloading take 4.709483623504639 seconds

Epoch: 0
Time of next(dataloader) is: 0.4079475402832031
Time for copying to cuda: 0.04028725624084473
Memory occpied: (6582.0, 3968.0)
Time for forward pass: 0.6201093196868896
Time for backpropagation: 0.005818367004394531
GPU memory for training: 6.123007297515869                          

The whole process took 59.306212186813354 seconds
