Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=512, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7018570595575 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 8.8000000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119105369.80851032 119105369.80851032
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.73641204833984
Server, client, server+client, vanilla  214.375 4.0859375 218.4609375 3430.0859375
Candidate split  21
Server, client, server+client, vanilla  214.375 4.0859375 218.4609375 3430.0859375
Model size  0.0
Intermediate:  0.0078125
6.125
Total layers size  110.73641204833984
Server, client, server+client, vanilla  214.375 4.0859375 218.4609375 3430.0859375
Fixed, scale_with_bsz  0.0 6.69921875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 512, post_step 64

Memory occpied: (1250.0, 3.0)
Read 4.01995849609375 MBs for this batch
Executing all posts took 1.267745018005371 seconds
Streaming plantleave data took 1.2702274322509766 seconds
The mode is:  split
Start 512, end 1024, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.27631545066833496
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.0015175342559814453
Time for backpropagation: 0.005986690521240234
One training iteration takes: 0.339954137802124 seconds
Index: 0
Read 4.01995849609375 MBs for this batch
Executing all posts took 1.1277422904968262 seconds
Streaming plantleave data took 1.1299355030059814 seconds
Then, training+dataloading take 1.1304497718811035 seconds
The mode is:  split
Start 1024, end 1536, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.27123212814331055
Time for copying to cuda: 1.3828277587890625e-05
Time for forward pass: 0.0018134117126464844
Time for backpropagation: 0.0052051544189453125
One training iteration takes: 0.3313474655151367 seconds
Index: 1
Read 4.01995849609375 MBs for this batch
Executing all posts took 1.1571242809295654 seconds
Streaming plantleave data took 1.159435510635376 seconds
Then, training+dataloading take 1.1598069667816162 seconds
The mode is:  split
Start 1536, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2592010498046875
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.0023627281188964844
Time for backpropagation: 0.005757331848144531
One training iteration takes: 0.34805727005004883 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Read 4.01995849609375 MBs for this batch
Executing all posts took 1.112802267074585 seconds
Streaming plantleave data took 1.1145110130310059 seconds
Then, training+dataloading take 1.1148946285247803 seconds
The mode is:  split
Start 2048, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2409365177154541
Time for copying to cuda: 1.2636184692382812e-05
Time for forward pass: 0.0018067359924316406
Time for backpropagation: 0.004553794860839844
One training iteration takes: 0.3135364055633545 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Read 4.01995849609375 MBs for this batch
Executing all posts took 1.1740481853485107 seconds
Streaming plantleave data took 1.1758372783660889 seconds
Then, training+dataloading take 1.1762657165527344 seconds
The mode is:  split
Start 2560, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.23882460594177246
Time for copying to cuda: 1.0967254638671875e-05
Time for forward pass: 0.0017876625061035156
Time for backpropagation: 0.004608154296875
One training iteration takes: 0.3011326789855957 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Read 4.01995849609375 MBs for this batch
Executing all posts took 1.1866869926452637 seconds
Streaming plantleave data took 1.188445806503296 seconds
Then, training+dataloading take 1.188906192779541 seconds
The mode is:  split
Start 3072, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.25622057914733887
Time for copying to cuda: 1.5974044799804688e-05
Time for forward pass: 0.002482891082763672
Time for backpropagation: 0.005304813385009766
One training iteration takes: 0.3449521064758301 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Read 4.01995849609375 MBs for this batch
Executing all posts took 1.1951477527618408 seconds
Streaming plantleave data took 1.1968932151794434 seconds
Then, training+dataloading take 1.1973397731781006 seconds
The mode is:  split
Start 3584, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.25981712341308594
Time for copying to cuda: 2.6941299438476562e-05
Time for forward pass: 0.0023374557495117188
Time for backpropagation: 0.005697488784790039
Memory occpied: (1250.0, 3.0)
Read 4.01995849609375 MBs for this batch
Executing all posts took 1.1554841995239258 seconds
Streaming plantleave data took 1.1578519344329834 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.285440683364868 seconds
Index: 6
Then, training+dataloading take 5.285516023635864 seconds
The mode is:  split
Start 4096, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24080991744995117
Time for copying to cuda: 1.1920928955078125e-05
Time for forward pass: 0.002244710922241211
Time for backpropagation: 0.005043983459472656
One training iteration takes: 0.29503297805786133 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Read 3.1877737045288086 MBs for this batch
Executing all posts took 1.090282678604126 seconds
Streaming plantleave data took 1.092395544052124 seconds
Then, training+dataloading take 1.0927908420562744 seconds

Epoch: 0
Time of next(dataloader) is: 0.22784996032714844
Time for copying to cuda: 1.1205673217773438e-05
Time for forward pass: 0.0018153190612792969
Time for backpropagation: 0.00438380241394043
The whole process took 21.368786096572876 seconds
