Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=512, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5082260344864 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 8.8000000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119079990.2027922 119079990.2027922
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.33992767333984
Server, client, server+client, vanilla  802.375 880.0859375 1682.4609375 13522.0859375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1250.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 512, post_step 64

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.404670476913452 seconds
Streaming plantleave data took 5.47673225402832 seconds
The mode is:  split
Start 512, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.411238431930542
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.772174596786499
Time for backpropagation: 0.520409345626831
One training iteration takes: 3.830542802810669 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.462682008743286 seconds
Memory occpied: (1250.0, 3.0)
Streaming plantleave data took 5.5364203453063965 seconds
Then, training+dataloading take 5.537953615188599 seconds
The mode is:  split
Start 1024, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4604160785675049
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.880112886428833
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.0864758491516113
Memory occpied: (1250.0, 3.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.631060361862183 seconds
Streaming plantleave data took 5.704461097717285 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 9.643811464309692 seconds
Index: 1
Then, training+dataloading take 9.646026134490967 seconds
The mode is:  split
Start 1536, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.47975850105285645
Time for copying to cuda: 9.298324584960938e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.813244342803955
Time for backpropagation: 0.9028065204620361
Memory occpied: (1250.0, 3.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.293807506561279 seconds
Streaming plantleave data took 5.3668742179870605 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 9.423752784729004 seconds
Index: 2
Then, training+dataloading take 9.424609661102295 seconds
The mode is:  split
Start 2048, end 2560, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.48169946670532227
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.907806634902954
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.02598237991333
Memory occpied: (1250.0, 3.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.634245872497559 seconds
Streaming plantleave data took 5.70687460899353 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 9.639717102050781 seconds
Index: 3
Then, training+dataloading take 9.64322018623352 seconds
The mode is:  split
Start 2560, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4796578884124756
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.870837688446045
Time for backpropagation: 1.0020883083343506
One training iteration takes: 4.788092851638794 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.404847621917725 seconds
Streaming plantleave data took 5.4797728061676025 seconds
Then, training+dataloading take 5.484328746795654 seconds
The mode is:  split
Start 3072, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.5649197101593018
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 3.0183866024017334
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.11456298828125
One training iteration takes: 5.051522731781006 seconds
Index: 5
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.500617265701294 seconds
Streaming plantleave data took 5.575194597244263 seconds
Then, training+dataloading take 5.58076024055481 seconds
The mode is:  split
Start 3584, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.5594544410705566
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 2.4709205627441406
Time for backpropagation: 0.8651881217956543
One training iteration takes: 4.226682424545288 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Read 196.02387237548828 MBs for this batch
Executing all posts took 5.242783784866333 seconds
Streaming plantleave data took 5.3649537563323975 seconds
Then, training+dataloading take 5.369476318359375 seconds
The mode is:  split
Start 4096, end 4502, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.564162015914917
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.9685606956481934
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.0025959014892578
One training iteration takes: 4.870759010314941 seconds
Index: 7
Read 155.44088077545166 MBs for this batch
Executing all posts took 4.983346939086914 seconds
Streaming plantleave data took 5.042811870574951 seconds
Then, training+dataloading take 5.044054269790649 seconds

Epoch: 0
Time of next(dataloader) is: 0.4765148162841797
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.1608376502990723
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.9056854248046875
The whole process took 73.19100046157837 seconds
