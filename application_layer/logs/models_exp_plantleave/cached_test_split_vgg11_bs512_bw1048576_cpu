Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=512, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2985336753421 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 8.8000000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119052505.40589444 119052505.40589444
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.095703125
24.5
Total layers size  62.683677673339844
Server, client, server+client, vanilla  802.375 195.0859375 997.4609375 12984.0859375
Candidate split  21
Server, client, server+client, vanilla  802.375 195.0859375 997.4609375 12984.0859375
Model size  0.0
Intermediate:  0.095703125
24.5
Total layers size  62.683677673339844
Server, client, server+client, vanilla  802.375 195.0859375 997.4609375 12984.0859375
Fixed, scale_with_bsz  0.0 25.07421875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 512, post_step 64

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.686790943145752 seconds
Streaming plantleave data took 2.7056281566619873 seconds
The mode is:  split
Start 512, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.31793856620788574
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.1898660659790039
Time for backpropagation: 0.07160687446594238
One training iteration takes: 0.6452739238739014 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.5084617137908936 seconds
Streaming plantleave data took 2.5269529819488525 seconds
Then, training+dataloading take 2.527665853500366 seconds
The mode is:  split
Start 1024, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.29492998123168945
Time for copying to cuda: 9.5367431640625e-06
Time for forward pass: 0.25319504737854004
Time for backpropagation: 0.13756108283996582
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.49796462059021 seconds
Streaming plantleave data took 2.5169806480407715 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.73058295249939 seconds
Index: 1
Then, training+dataloading take 5.73069429397583 seconds
The mode is:  split
Start 1536, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.29592442512512207
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.2246706485748291
Time for backpropagation: 0.10271859169006348
One training iteration takes: 0.7237651348114014 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.540658950805664 seconds
Streaming plantleave data took 2.5592706203460693 seconds
Then, training+dataloading take 2.559985876083374 seconds
The mode is:  split
Start 2048, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.30522847175598145
Time for copying to cuda: 9.059906005859375e-06
Time for forward pass: 0.2126924991607666
Time for backpropagation: 0.2302839756011963
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.851914644241333 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.4499154090881348 seconds
Streaming plantleave data took 2.4687726497650146 seconds
Then, training+dataloading take 2.4695045948028564 seconds
The mode is:  split
Start 2560, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.30373358726501465
Time for copying to cuda: 8.821487426757812e-06
Time for forward pass: 0.2947654724121094
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.18836665153503418
One training iteration takes: 0.8905808925628662 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.5303568840026855 seconds
Streaming plantleave data took 2.5491912364959717 seconds
Then, training+dataloading take 2.549917459487915 seconds
The mode is:  split
Start 3072, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.30614209175109863
Time for copying to cuda: 9.059906005859375e-06
Time for forward pass: 0.38688039779663086
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.11845541000366211
One training iteration takes: 0.9124536514282227 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.526097536087036 seconds
Streaming plantleave data took 2.544893741607666 seconds
Then, training+dataloading take 2.545687437057495 seconds
The mode is:  split
Start 3584, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.30737829208374023
Time for copying to cuda: 1.0728836059570312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.31678175926208496
Time for backpropagation: 0.1111752986907959
One training iteration takes: 0.8357162475585938 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.626264810562134 seconds
Streaming plantleave data took 2.645108938217163 seconds
Then, training+dataloading take 2.6458792686462402 seconds
The mode is:  split
Start 4096, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3388528823852539
Time for copying to cuda: 1.1205673217773438e-05
Time for forward pass: 0.22033309936523438
Time for backpropagation: 0.1269233226776123
One training iteration takes: 0.8024604320526123 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 38.87447452545166 MBs for this batch
Executing all posts took 2.366360664367676 seconds
Streaming plantleave data took 2.381474018096924 seconds
Then, training+dataloading take 2.382214069366455 seconds

Epoch: 0
Time of next(dataloader) is: 0.2947425842285156
Time for copying to cuda: 8.821487426757812e-06
Time for forward pass: 0.18853354454040527
Time for backpropagation: 0.10389304161071777
Memory occpied: (1250.0, 3.0)
The whole process took 35.30958890914917 seconds
