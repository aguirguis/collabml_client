Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=512, cached=True, cpuonly=False, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5746357550557 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 8.8000000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119088694.65768667 119088694.65768667
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.095703125
24.5
Total layers size  62.683677673339844
Server, client, server+client, vanilla  1293.92431640625 686.63525390625 1980.5595703125 13475.63525390625
Candidate split  21
Server, client, server+client, vanilla  1293.92431640625 686.63525390625 1980.5595703125 13475.63525390625
Model size  491.54931640625
Fixed, scale_with_bsz  491.54931640625 25.07421875
Mem usage  1824.0 3.0
Using split index: 21
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 512, post_step 64

Memory occpied: (1824.0, 3.0)
Memory occpied: (1824.0, 3.0)
Memory occpied: (1824.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.7002992630004883 seconds
Streaming plantleave data took 2.7188820838928223 seconds
The mode is:  split
Start 512, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2669200897216797
Time for copying to cuda: 0.01347208023071289
Memory occpied: (1874.0, 294.0)
Memory occpied: (1874.0, 768.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.6822102069854736 seconds
Streaming plantleave data took 2.7010879516601562 seconds
Memory occpied: (1874.0, 1158.0)
Time for forward pass: 3.2533583641052246
Time for backpropagation: 0.05475878715515137
GPU memory for training: 2.024108409881592                          

One training iteration takes: 3.651952028274536 seconds
Index: 0
Then, training+dataloading take 3.652158498764038 seconds
The mode is:  split
Start 1024, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.303389310836792
Time for copying to cuda: 0.013238668441772461
Time for forward pass: 0.0751957893371582
Time for backpropagation: 0.003051280975341797
GPU memory for training: 2.149811267852783                          

One training iteration takes: 0.4721372127532959 seconds
Index: 1
Memory occpied: (3462.0, 1838.0)
Memory occpied: (3462.0, 1838.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.415374994277954 seconds
Streaming plantleave data took 2.434093952178955 seconds
Then, training+dataloading take 2.4347634315490723 seconds
The mode is:  split
Start 1536, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.30679965019226074
Time for copying to cuda: 0.012896060943603516
Time for forward pass: 0.07515883445739746
Time for backpropagation: 0.003068685531616211
GPU memory for training: 2.149811267852783                          

One training iteration takes: 0.47619128227233887 seconds
Index: 2
Memory occpied: (3462.0, 1838.0)
Memory occpied: (3462.0, 1838.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.3829004764556885 seconds
Streaming plantleave data took 2.401597261428833 seconds
Then, training+dataloading take 2.402292013168335 seconds
The mode is:  split
Start 2048, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3144814968109131
Time for copying to cuda: 0.01301431655883789
Time for forward pass: 0.08264398574829102
Time for backpropagation: 0.003885984420776367
GPU memory for training: 2.149811267852783                          

One training iteration takes: 0.5030879974365234 seconds
Index: 3
Memory occpied: (3462.0, 1838.0)
Memory occpied: (3462.0, 1838.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.4525887966156006 seconds
Streaming plantleave data took 2.471306324005127 seconds
Then, training+dataloading take 2.472062110900879 seconds
The mode is:  split
Start 2560, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3123173713684082
Time for copying to cuda: 0.013028621673583984
Time for forward pass: 0.07664632797241211
Time for backpropagation: 0.0035858154296875
GPU memory for training: 2.149811267852783                          

Memory occpied: (3462.0, 1838.0)
One training iteration takes: 0.4905540943145752 seconds
Index: 4
Memory occpied: (3462.0, 1838.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.4296762943267822 seconds
Streaming plantleave data took 2.4485535621643066 seconds
Then, training+dataloading take 2.449305534362793 seconds
The mode is:  split
Start 3072, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3489246368408203
Time for copying to cuda: 0.012967586517333984
Memory occpied: (3462.0, 1838.0)
Time for forward pass: 0.07532477378845215
Time for backpropagation: 0.0030431747436523438
GPU memory for training: 2.149811267852783                          

One training iteration takes: 0.5183272361755371 seconds
Index: 5
Memory occpied: (3462.0, 1838.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.547151565551758 seconds
Streaming plantleave data took 2.5659146308898926 seconds
Then, training+dataloading take 2.566676139831543 seconds
The mode is:  split
Start 3584, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3408944606781006
Time for copying to cuda: 0.013062715530395508
Time for forward pass: 0.07531094551086426
Time for backpropagation: 0.003068208694458008
GPU memory for training: 2.149811267852783                          

One training iteration takes: 0.5207433700561523 seconds
Index: 6
Memory occpied: (3462.0, 1838.0)
Memory occpied: (3462.0, 1838.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 2.366532564163208 seconds
Streaming plantleave data took 2.3856728076934814 seconds
Then, training+dataloading take 2.3863987922668457 seconds
The mode is:  split
Start 4096, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.31017541885375977
Time for copying to cuda: 0.013206243515014648
Time for forward pass: 0.0771634578704834
Time for backpropagation: 0.0036115646362304688
GPU memory for training: 2.149811267852783                          

One training iteration takes: 0.4946107864379883 seconds
Index: 7
Memory occpied: (3462.0, 1838.0)
Memory occpied: (3462.0, 1838.0)
Read 38.87447452545166 MBs for this batch
Executing all posts took 2.2918343544006348 seconds
Streaming plantleave data took 2.3072495460510254 seconds
Then, training+dataloading take 2.3080151081085205 seconds

Epoch: 0
Time of next(dataloader) is: 0.29595422744750977
Time for copying to cuda: 0.01054692268371582
Time for forward pass: 0.0736684799194336
Time for backpropagation: 0.0030426979064941406
GPU memory for training: 2.1282739639282227                          

Memory occpied: (3462.0, 1838.0)
The whole process took 32.5929651260376 seconds
