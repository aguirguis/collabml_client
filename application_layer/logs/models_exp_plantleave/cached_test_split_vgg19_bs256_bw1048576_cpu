Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=256, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.4487233128281 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 8.8000000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119072191.062059 119072191.062059
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.33992767333984
Server, client, server+client, vanilla  802.375 440.04296875 1242.41796875 6761.04296875
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1250.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 256, post_step 64

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.2599241733551025 seconds
Streaming plantleave data took 3.2966232299804688 seconds
The mode is:  split
Start 256, end 512, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.41921520233154297
Time for copying to cuda: 6.4373016357421875e-06
Time for forward pass: 1.2206943035125732
Time for backpropagation: 0.4071471691131592
One training iteration takes: 2.14477276802063 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.1001970767974854 seconds
Streaming plantleave data took 3.1376287937164307 seconds
Then, training+dataloading take 3.1397645473480225 seconds
The mode is:  split
Start 512, end 768, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4264347553253174
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 1.2465107440948486
Time for backpropagation: 0.6596763134002686
One training iteration takes: 2.6310555934906006 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.2651560306549072 seconds
Streaming plantleave data took 3.3011696338653564 seconds
Then, training+dataloading take 3.3018136024475098 seconds
The mode is:  split
Start 768, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3887455463409424
Time for copying to cuda: 1.0013580322265625e-05
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3855373859405518
Time for backpropagation: 0.7213270664215088
One training iteration takes: 2.9005136489868164 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.330089569091797 seconds
Streaming plantleave data took 3.366758346557617 seconds
Then, training+dataloading take 3.367478370666504 seconds
The mode is:  split
Start 1024, end 1280, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3760082721710205
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.442368984222412
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.8026626110076904
One training iteration takes: 2.9289474487304688 seconds
Index: 3
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.335568428039551 seconds
Streaming plantleave data took 3.3723957538604736 seconds
Then, training+dataloading take 3.3730640411376953 seconds
The mode is:  split
Start 1280, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.42851734161376953
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 1.250788688659668
Time for backpropagation: 0.6994154453277588
One training iteration takes: 2.694397211074829 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.2904410362243652 seconds
Streaming plantleave data took 3.3274779319763184 seconds
Then, training+dataloading take 3.329397678375244 seconds
The mode is:  split
Start 1536, end 1792, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.38669443130493164
Time for copying to cuda: 9.298324584960938e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4785852432250977
Time for backpropagation: 0.7547380924224854
One training iteration takes: 3.004599094390869 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.369868755340576 seconds
Streaming plantleave data took 3.4059627056121826 seconds
Then, training+dataloading take 3.40669846534729 seconds
The mode is:  split
Start 1792, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.40334272384643555
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4342563152313232
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.8939411640167236
One training iteration takes: 3.0321807861328125 seconds
Index: 6
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.252805233001709 seconds
Streaming plantleave data took 3.2902538776397705 seconds
Then, training+dataloading take 3.292222261428833 seconds
The mode is:  split
Start 2048, end 2304, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4417846202850342
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 1.2655577659606934
Time for backpropagation: 0.6741642951965332
One training iteration takes: 2.6842033863067627 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.3101556301116943 seconds
Streaming plantleave data took 3.3472282886505127 seconds
Then, training+dataloading take 3.347881555557251 seconds
The mode is:  split
Start 2304, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3972342014312744
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4197652339935303
Time for backpropagation: 0.7325921058654785
One training iteration takes: 2.9418368339538574 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.3552565574645996 seconds
Streaming plantleave data took 3.392059564590454 seconds
Then, training+dataloading take 3.3928003311157227 seconds
The mode is:  split
Start 2560, end 2816, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.40926480293273926
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.436939001083374
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.89013671875
One training iteration takes: 3.0647308826446533 seconds
Index: 9
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.3916544914245605 seconds
Streaming plantleave data took 3.429306745529175 seconds
Then, training+dataloading take 3.4299533367156982 seconds
The mode is:  split
Start 2816, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.44144439697265625
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 1.2647864818572998
Time for backpropagation: 0.7198762893676758
One training iteration takes: 2.738600969314575 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.2044484615325928 seconds
Streaming plantleave data took 3.2405166625976562 seconds
Then, training+dataloading take 3.24119234085083 seconds
The mode is:  split
Start 3072, end 3328, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.39678311347961426
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.510939598083496
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.758514404296875
One training iteration takes: 3.023930549621582 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.4268407821655273 seconds
Streaming plantleave data took 3.4636547565460205 seconds
Then, training+dataloading take 3.4643969535827637 seconds
The mode is:  split
Start 3328, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3966093063354492
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4221510887145996
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.8923170566558838
One training iteration takes: 3.017575979232788 seconds
Index: 12
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.3533413410186768 seconds
Streaming plantleave data took 3.3906643390655518 seconds
Then, training+dataloading take 3.3913488388061523 seconds
The mode is:  split
Start 3584, end 3840, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4471311569213867
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 1.2671716213226318
Time for backpropagation: 0.7161002159118652
One training iteration takes: 2.7410008907318115 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.2624337673187256 seconds
Streaming plantleave data took 3.2991244792938232 seconds
Then, training+dataloading take 3.2997684478759766 seconds
The mode is:  split
Start 3840, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4032714366912842
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.54541015625
Time for backpropagation: 0.747866153717041
One training iteration takes: 3.0458595752716064 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.377807140350342 seconds
Streaming plantleave data took 3.4141910076141357 seconds
Then, training+dataloading take 3.4148924350738525 seconds
The mode is:  split
Start 4096, end 4352, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.40489840507507324
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4778456687927246
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.8663632869720459
One training iteration takes: 3.0663907527923584 seconds
Index: 15
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.3858397006988525 seconds
Streaming plantleave data took 3.422102212905884 seconds
Then, training+dataloading take 3.4240763187408447 seconds
The mode is:  split
Start 4352, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.44985103607177734
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 57.42894458770752 MBs for this batch
Executing all posts took 2.331805467605591 seconds
Time for forward pass: 1.7172245979309082
Streaming plantleave data took 2.358858346939087 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.9392144680023193
One training iteration takes: 3.4282257556915283 seconds
Index: 16
Then, training+dataloading take 3.4285123348236084 seconds

Epoch: 0
Time of next(dataloader) is: 0.38066768646240234
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.9349968433380127
Time for backpropagation: 0.7306208610534668
Memory occpied: (1250.0, 3.0)
The whole process took 71.17199110984802 seconds
