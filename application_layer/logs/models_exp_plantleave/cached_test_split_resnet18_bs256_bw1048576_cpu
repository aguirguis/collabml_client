Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=256, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5906970675603 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 8.800000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119090799.84603927 119090799.84603927
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.181724548339844
Server, client, server+client, vanilla  214.375 74.54296875 288.91796875 1765.04296875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 256, post_step 64

Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.7454369068145752 seconds
Streaming plantleave data took 0.7556278705596924 seconds
The mode is:  split
Start 256, end 512, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.27263498306274414
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.24775242805480957
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.6732683181762695 seconds
Streaming plantleave data took 0.6855494976043701 seconds
Time for backpropagation: 0.41588521003723145
One training iteration takes: 0.9993031024932861 seconds
Index: 0
Then, training+dataloading take 0.9993577003479004 seconds
The mode is:  split
Start 512, end 768, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.26819849014282227
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.24666595458984375
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.5888156890869141 seconds
Streaming plantleave data took 0.6028504371643066 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.46918821334838867
One training iteration takes: 1.071765422821045 seconds
Index: 1
Then, training+dataloading take 1.0718281269073486 seconds
The mode is:  split
Start 768, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2800459861755371
Time for copying to cuda: 8.106231689453125e-06
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.5737700462341309 seconds
Streaming plantleave data took 0.5863187313079834 seconds
Time for forward pass: 0.3034780025482178
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.46558141708374023
One training iteration takes: 1.1305570602416992 seconds
Index: 2
Then, training+dataloading take 1.1306188106536865 seconds
The mode is:  split
Start 1024, end 1280, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.28208303451538086
Time for copying to cuda: 1.7881393432617188e-05
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.5526442527770996 seconds
Streaming plantleave data took 0.5653905868530273 seconds
Time for forward pass: 0.28783726692199707
Time for backpropagation: 0.27115392684936523
One training iteration takes: 0.9211974143981934 seconds
Index: 3
Then, training+dataloading take 0.9212431907653809 seconds
The mode is:  split
Start 1280, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3154911994934082
Time for copying to cuda: 1.5497207641601562e-05
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.5702767372131348 seconds
Streaming plantleave data took 0.5835564136505127 seconds
Time for forward pass: 0.3001694679260254
Time for backpropagation: 0.2975330352783203
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.955735683441162 seconds
Index: 4
Then, training+dataloading take 5.955808877944946 seconds
The mode is:  split
Start 1536, end 1792, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.28218722343444824
Time for copying to cuda: 6.4373016357421875e-06
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.6195859909057617 seconds
Time for forward pass: 0.33001184463500977
Streaming plantleave data took 0.6308794021606445 seconds
Time for backpropagation: 0.390378475189209
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.0905122756958008 seconds
Index: 5
Then, training+dataloading take 1.090569257736206 seconds
The mode is:  split
Start 1792, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.29266905784606934
Time for copying to cuda: 7.62939453125e-06
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.5686023235321045 seconds
Streaming plantleave data took 0.5797257423400879 seconds
Time for forward pass: 0.3125176429748535
Time for backpropagation: 0.48505258560180664
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.1737563610076904 seconds
Index: 6
Then, training+dataloading take 1.1738121509552002 seconds
The mode is:  split
Start 2048, end 2304, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.286801815032959
Time for copying to cuda: 1.52587890625e-05
Time for forward pass: 0.28978633880615234
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.7086195945739746 seconds
Streaming plantleave data took 0.7277534008026123 seconds
Time for backpropagation: 0.4478919506072998
One training iteration takes: 1.1266140937805176 seconds
Index: 7
Then, training+dataloading take 1.1267361640930176 seconds
The mode is:  split
Start 2304, end 2560, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3086888790130615
Time for copying to cuda: 7.62939453125e-06
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.6185481548309326 seconds
Streaming plantleave data took 0.6346781253814697 seconds
Time for forward pass: 0.3232240676879883
Time for backpropagation: 0.31006431579589844
One training iteration takes: 1.0295584201812744 seconds
Index: 8
Then, training+dataloading take 1.0296058654785156 seconds
The mode is:  split
Start 2560, end 2816, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3563361167907715
Time for copying to cuda: 1.049041748046875e-05
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.651543140411377 seconds
Time for forward pass: 0.2935373783111572
Streaming plantleave data took 0.675710916519165 seconds
Time for backpropagation: 0.45871663093566895
One training iteration takes: 1.187319040298462 seconds
Index: 9
Then, training+dataloading take 1.1873664855957031 seconds
The mode is:  split
Start 2816, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.32725977897644043
Time for copying to cuda: 7.3909759521484375e-06
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.6309657096862793 seconds
Time for forward pass: 0.3014359474182129
Streaming plantleave data took 0.656001091003418 seconds
Time for backpropagation: 0.41863179206848145
One training iteration takes: 1.1679742336273193 seconds
Index: 10
Then, training+dataloading take 1.1681711673736572 seconds
The mode is:  split
Start 3072, end 3328, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3000473976135254
Time for copying to cuda: 1.0013580322265625e-05
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.6105384826660156 seconds
Streaming plantleave data took 0.6297595500946045 seconds
Time for forward pass: 0.33728861808776855
Time for backpropagation: 0.27547383308410645
One training iteration takes: 0.9959638118743896 seconds
Index: 11
Then, training+dataloading take 0.9960086345672607 seconds
The mode is:  split
Start 3328, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3368871212005615
Time for copying to cuda: 1.0728836059570312e-05
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.6254026889801025 seconds
Streaming plantleave data took 0.6450738906860352 seconds
Time for forward pass: 0.309298038482666
Time for backpropagation: 0.4283761978149414
One training iteration takes: 1.1795806884765625 seconds
Index: 12
Then, training+dataloading take 1.17962646484375 seconds
The mode is:  split
Start 3584, end 3840, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.31776905059814453
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.2924215793609619
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.6728429794311523 seconds
Streaming plantleave data took 0.6984472274780273 seconds
Time for backpropagation: 0.4445188045501709
One training iteration takes: 1.1961431503295898 seconds
Index: 13
Then, training+dataloading take 1.1961984634399414 seconds
The mode is:  split
Start 3840, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3063373565673828
Time for copying to cuda: 1.1682510375976562e-05
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.6497135162353516 seconds
Time for forward pass: 0.333646297454834
Streaming plantleave data took 0.6732199192047119 seconds
Time for backpropagation: 0.2921881675720215
One training iteration takes: 1.0184662342071533 seconds
Index: 14
Then, training+dataloading take 1.018510341644287 seconds
The mode is:  split
Start 4096, end 4352, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.30440545082092285
Time for copying to cuda: 1.7404556274414062e-05
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.6203763484954834 seconds
Streaming plantleave data took 0.6785321235656738 seconds
Time for forward pass: 0.40154290199279785
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.3779938220977783
One training iteration takes: 1.1729650497436523 seconds
Index: 15
Then, training+dataloading take 1.1730141639709473 seconds
The mode is:  split
Start 4352, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3024463653564453
Time for copying to cuda: 7.62939453125e-06
Read 14.36253833770752 MBs for this batch
Executing all posts took 0.446077823638916 seconds
Streaming plantleave data took 0.4714055061340332 seconds
Time for forward pass: 0.23757100105285645
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.4198014736175537
One training iteration takes: 1.045830249786377 seconds
Index: 16
Then, training+dataloading take 1.0458905696868896 seconds

Epoch: 0
Time of next(dataloader) is: 0.26775455474853516
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.13205552101135254
Time for backpropagation: 0.17658281326293945
The whole process took 30.78935194015503 seconds
