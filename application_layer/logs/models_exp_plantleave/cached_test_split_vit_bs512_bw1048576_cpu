Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=512, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.7619110610327 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03 3.07200e+03 3.07200e+03
 8.80000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118982169.20659168 118982169.20659168
All candidates indexes:  (array([15, 16, 17, 18]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.0029296875
17.314453125
Total layers size  104.46981048583984
Server, client, server+client, vanilla  572.4375 7.5859375 580.0234375 9165.0859375
Candidate split  16
Server, client, server+client, vanilla  572.4375 7.5859375 580.0234375 9165.0859375
Model size  0.0
Intermediate:  0.0029296875
17.314453125
Total layers size  104.46981048583984
Server, client, server+client, vanilla  572.4375 7.5859375 580.0234375 9165.0859375
Fixed, scale_with_bsz  0.0 17.888671875
Mem usage  1250.0 3.0
Using split index: 16
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
Start 0, end 512, post_step 64

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1.5176620483398438 MBs for this batch
Executing all posts took 3.581148386001587 seconds
Streaming plantleave data took 3.582911491394043 seconds
The mode is:  split
Start 512, end 1024, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.29239654541015625
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.0012907981872558594
Time for backpropagation: 0.004193305969238281
One training iteration takes: 0.35753440856933594 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1.5176620483398438 MBs for this batch
Executing all posts took 3.424882411956787 seconds
Streaming plantleave data took 3.4262022972106934 seconds
Then, training+dataloading take 3.426805257797241 seconds
The mode is:  split
Start 1024, end 1536, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.27649736404418945
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.0011692047119140625
Time for backpropagation: 0.003570079803466797
One training iteration takes: 0.3441593647003174 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1.5176620483398438 MBs for this batch
Executing all posts took 3.625187873840332 seconds
Streaming plantleave data took 3.6265668869018555 seconds
Then, training+dataloading take 3.6279826164245605 seconds
The mode is:  split
Start 1536, end 2048, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.24361658096313477
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.0012531280517578125
Time for backpropagation: 0.0037140846252441406
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1.5176620483398438 MBs for this batch
Executing all posts took 3.4828479290008545 seconds
Streaming plantleave data took 3.4843621253967285 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.259689807891846 seconds
Index: 2
Then, training+dataloading take 5.2597596645355225 seconds
The mode is:  split
Start 2048, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24725842475891113
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.0011875629425048828
Time for backpropagation: 0.003865480422973633
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1.5176620483398438 MBs for this batch
Executing all posts took 3.485025405883789 seconds
Streaming plantleave data took 3.486226797103882 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.26333212852478 seconds
Index: 3
Then, training+dataloading take 5.263397216796875 seconds
The mode is:  split
Start 2560, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24664688110351562
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.0012326240539550781
Time for backpropagation: 0.0033402442932128906
One training iteration takes: 0.30983591079711914 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1.5176620483398438 MBs for this batch
Executing all posts took 3.4825563430786133 seconds
Streaming plantleave data took 3.483759880065918 seconds
Then, training+dataloading take 3.484337329864502 seconds
The mode is:  split
Start 3072, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.25133323669433594
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.0010712146759033203
Time for backpropagation: 0.0035843849182128906
One training iteration takes: 0.3175990581512451 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1.5176620483398438 MBs for this batch
Executing all posts took 3.5853347778320312 seconds
Streaming plantleave data took 3.586557626724243 seconds
Then, training+dataloading take 3.5870375633239746 seconds
The mode is:  split
Start 3584, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.25423312187194824
Time for copying to cuda: 6.198883056640625e-06
Time for forward pass: 0.0010280609130859375
Time for backpropagation: 0.003393411636352539
One training iteration takes: 0.315950870513916 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1.5176620483398438 MBs for this batch
Executing all posts took 3.4903323650360107 seconds
Streaming plantleave data took 3.4915623664855957 seconds
Then, training+dataloading take 3.492095947265625 seconds
The mode is:  split
Start 4096, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24436116218566895
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.0011110305786132812
Time for backpropagation: 0.003500699996948242
One training iteration takes: 0.31083154678344727 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1.2035284042358398 MBs for this batch
Executing all posts took 3.117340564727783 seconds
Streaming plantleave data took 3.1188220977783203 seconds
Then, training+dataloading take 3.1193699836730957 seconds

Epoch: 0
Time of next(dataloader) is: 0.27087903022766113
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.0011048316955566406
Time for backpropagation: 0.0037534236907958984
Memory occpied: (1250.0, 3.0)
The whole process took 43.00790357589722 seconds
