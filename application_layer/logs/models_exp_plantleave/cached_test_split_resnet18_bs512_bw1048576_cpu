Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=512, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5374358216948 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 8.800000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119083818.78802118 119083818.78802118
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.181724548339844
Server, client, server+client, vanilla  214.375 149.0859375 363.4609375 3530.0859375
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 512, post_step 64

Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 0.9101221561431885 seconds
Streaming plantleave data took 0.9294095039367676 seconds
The mode is:  split
Start 512, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.32587504386901855
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.39366722106933594
Read 49.02387237548828 MBs for this batch
Executing all posts took 0.9559273719787598 seconds
Streaming plantleave data took 0.9818861484527588 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.9225165843963623
One training iteration takes: 1.7035114765167236 seconds
Index: 0
Then, training+dataloading take 1.7037379741668701 seconds
The mode is:  split
Start 1024, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.27161693572998047
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.3893568515777588
Read 49.02387237548828 MBs for this batch
Executing all posts took 0.8217840194702148 seconds
Streaming plantleave data took 0.8447871208190918 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.8022322654724121
One training iteration takes: 1.542738914489746 seconds
Index: 1
Then, training+dataloading take 1.5430140495300293 seconds
The mode is:  split
Start 1536, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.27384066581726074
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.474271297454834
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.0046074390411377 seconds
Streaming plantleave data took 1.0236787796020508 seconds
Time for backpropagation: 0.6763875484466553
One training iteration takes: 1.5032074451446533 seconds
Index: 2
Then, training+dataloading take 1.5034213066101074 seconds
The mode is:  split
Start 2048, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.27467966079711914
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5317013263702393
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.051577091217041 seconds
Streaming plantleave data took 1.0750362873077393 seconds
Time for backpropagation: 0.5797438621520996
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 6.415672540664673 seconds
Index: 3
Then, training+dataloading take 6.415778398513794 seconds
The mode is:  split
Start 2560, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2770054340362549
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3502206802368164
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.408508062362671 seconds
Streaming plantleave data took 1.4282829761505127 seconds
Time for backpropagation: 0.8214716911315918
One training iteration takes: 1.5325255393981934 seconds
Index: 4
Then, training+dataloading take 1.5327398777008057 seconds
The mode is:  split
Start 3072, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.28823161125183105
Time for copying to cuda: 2.09808349609375e-05
Time for forward pass: 0.3771803379058838
Read 49.02387237548828 MBs for this batch
Executing all posts took 0.9588794708251953 seconds
Streaming plantleave data took 0.983217716217041 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.6946332454681396
One training iteration takes: 1.4385895729064941 seconds
Index: 5
Then, training+dataloading take 1.4387993812561035 seconds
The mode is:  split
Start 3584, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.27832651138305664
Time for copying to cuda: 8.344650268554688e-06
Time for forward pass: 0.4932854175567627
Read 49.02387237548828 MBs for this batch
Executing all posts took 0.8830187320709229 seconds
Streaming plantleave data took 0.90989089012146 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.9501771926879883
One training iteration takes: 1.8003885746002197 seconds
Index: 6
Then, training+dataloading take 1.8006091117858887 seconds
The mode is:  split
Start 4096, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3161945343017578
Time for copying to cuda: 1.2636184692382812e-05
Time for forward pass: 0.46488475799560547
Read 38.87447452545166 MBs for this batch
Executing all posts took 0.800506591796875 seconds
Streaming plantleave data took 0.819767951965332 seconds
Time for backpropagation: 0.914365291595459
One training iteration takes: 1.7876498699188232 seconds
Index: 7
Then, training+dataloading take 1.787818431854248 seconds

Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2780752182006836
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.27938127517700195
Time for backpropagation: 0.46076035499572754
The whole process took 25.561538696289062 seconds
