Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=256, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5678441497992 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03 3.07200e+03 3.07200e+03
 8.80000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119087804.46840248 119087804.46840248
All candidates indexes:  (array([15, 16, 17, 18]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.0029296875
17.314453125
Total layers size  104.46981048583984
Server, client, server+client, vanilla  572.4375 3.79296875 576.23046875 4582.54296875
Candidate split  16
Server, client, server+client, vanilla  572.4375 3.79296875 576.23046875 4582.54296875
Model size  0.0
Intermediate:  0.0029296875
17.314453125
Total layers size  104.46981048583984
Server, client, server+client, vanilla  572.4375 3.79296875 576.23046875 4582.54296875
Fixed, scale_with_bsz  0.0 17.888671875
Mem usage  1250.0 3.0
Using split index: 16
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
Start 0, end 256, post_step 64

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.811638116836548 seconds
Streaming plantleave data took 2.8121917247772217 seconds
The mode is:  split
Start 256, end 512, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.26958298683166504
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.0012173652648925781
Time for backpropagation: 0.0035822391510009766
One training iteration takes: 0.33367252349853516 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.692044258117676 seconds
Streaming plantleave data took 2.6927361488342285 seconds
Then, training+dataloading take 2.6931004524230957 seconds
The mode is:  split
Start 512, end 768, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2496631145477295
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.0012328624725341797
Time for backpropagation: 0.0032694339752197266
One training iteration takes: 0.3094816207885742 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.793610095977783 seconds
Streaming plantleave data took 2.7944719791412354 seconds
Then, training+dataloading take 2.794992208480835 seconds
The mode is:  split
Start 768, end 1024, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.24999451637268066
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.0014379024505615234
Time for backpropagation: 0.0033049583435058594
One training iteration takes: 0.3114748001098633 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.7383389472961426 seconds
Streaming plantleave data took 2.739053249359131 seconds
Then, training+dataloading take 2.7394564151763916 seconds
The mode is:  split
Start 1024, end 1280, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24713969230651855
Time for copying to cuda: 8.344650268554688e-06
Time for forward pass: 0.0012524127960205078
Time for backpropagation: 0.003593921661376953
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.7235584259033203 seconds
Streaming plantleave data took 2.7244985103607178 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.264394044876099 seconds
Index: 3
Then, training+dataloading take 5.264461994171143 seconds
The mode is:  split
Start 1280, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.31078648567199707
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.0013492107391357422
Time for backpropagation: 0.0034973621368408203
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.37160634994506836 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.761143445968628 seconds
Streaming plantleave data took 2.7617835998535156 seconds
Then, training+dataloading take 2.7622058391571045 seconds
The mode is:  split
Start 1536, end 1792, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2595224380493164
Time for copying to cuda: 9.5367431640625e-06
Time for forward pass: 0.0012578964233398438
Time for backpropagation: 0.003635883331298828
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.8152637481689453 seconds
Streaming plantleave data took 2.815958261489868 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.288768291473389 seconds
Index: 5
Then, training+dataloading take 5.28883957862854 seconds
The mode is:  split
Start 1792, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.25241780281066895
Time for copying to cuda: 1.1205673217773438e-05
Time for forward pass: 0.0013747215270996094
Time for backpropagation: 0.003596067428588867
One training iteration takes: 0.31364965438842773 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.8072805404663086 seconds
Streaming plantleave data took 2.807924270629883 seconds
Then, training+dataloading take 2.8082566261291504 seconds
The mode is:  split
Start 2048, end 2304, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.24933433532714844
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.0012559890747070312
Time for backpropagation: 0.003576993942260742
One training iteration takes: 0.3094370365142822 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.8799564838409424 seconds
Streaming plantleave data took 2.8806443214416504 seconds
Then, training+dataloading take 2.8810575008392334 seconds
The mode is:  split
Start 2304, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2541179656982422
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.0014202594757080078
Time for backpropagation: 0.0037751197814941406
One training iteration takes: 0.31871533393859863 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.7539355754852295 seconds
Streaming plantleave data took 2.7544753551483154 seconds
Then, training+dataloading take 2.754854917526245 seconds
The mode is:  split
Start 2560, end 2816, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2812681198120117
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.0013110637664794922
Time for backpropagation: 0.0034279823303222656
One training iteration takes: 0.37009358406066895 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.8608956336975098 seconds
Streaming plantleave data took 2.8614561557769775 seconds
Then, training+dataloading take 2.86186146736145 seconds
The mode is:  split
Start 2816, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.25150513648986816
Time for copying to cuda: 9.059906005859375e-06
Time for forward pass: 0.0012280941009521484
Time for backpropagation: 0.003513813018798828
One training iteration takes: 0.3119184970855713 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.7066709995269775 seconds
Streaming plantleave data took 2.7073771953582764 seconds
Then, training+dataloading take 2.7077221870422363 seconds
The mode is:  split
Start 3072, end 3328, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24924159049987793
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.0012354850769042969
Time for backpropagation: 0.00386810302734375
One training iteration takes: 0.3128831386566162 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.7861154079437256 seconds
Streaming plantleave data took 2.7866742610931396 seconds
Then, training+dataloading take 2.7870688438415527 seconds
The mode is:  split
Start 3328, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.31332921981811523
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.0015060901641845703
Time for backpropagation: 0.004527091979980469
One training iteration takes: 0.3794577121734619 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.7160346508026123 seconds
Streaming plantleave data took 2.7166080474853516 seconds
Then, training+dataloading take 2.716989278793335 seconds
The mode is:  split
Start 3584, end 3840, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2538020610809326
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.0012729167938232422
Time for backpropagation: 0.003580331802368164
One training iteration takes: 0.3140256404876709 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.839264392852783 seconds
Streaming plantleave data took 2.8398139476776123 seconds
Then, training+dataloading take 2.8401901721954346 seconds
The mode is:  split
Start 3840, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2544827461242676
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.00106048583984375
Time for backpropagation: 0.003233671188354492
One training iteration takes: 0.33013319969177246 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.735973596572876 seconds
Streaming plantleave data took 2.736563205718994 seconds
Then, training+dataloading take 2.7369563579559326 seconds
The mode is:  split
Start 4096, end 4352, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2842996120452881
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.0013799667358398438
Time for backpropagation: 0.004304409027099609
One training iteration takes: 0.3794121742248535 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.7588310241699219 MBs for this batch
Executing all posts took 2.8117270469665527 seconds
Streaming plantleave data took 2.812270164489746 seconds
Then, training+dataloading take 2.812699317932129 seconds
The mode is:  split
Start 4352, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2579479217529297
Time for copying to cuda: 9.059906005859375e-06
Time for forward pass: 0.0011768341064453125
Time for backpropagation: 0.003528594970703125
One training iteration takes: 0.3270909786224365 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Read 0.44469738006591797 MBs for this batch
Executing all posts took 1.5492205619812012 seconds
Streaming plantleave data took 1.5496282577514648 seconds
Then, training+dataloading take 1.549971342086792 seconds

Epoch: 0
Time of next(dataloader) is: 0.2584218978881836
Time for copying to cuda: 8.821487426757812e-06
Time for forward pass: 0.0009791851043701172
Time for backpropagation: 0.003240823745727539
The whole process took 61.2548565864563 seconds
