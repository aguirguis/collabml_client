Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=256, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7823724452338 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 8.8000000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119115923.12114169 119115923.12114169
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.73641204833984
Server, client, server+client, vanilla  214.375 2.04296875 216.41796875 1715.04296875
Candidate split  21
Server, client, server+client, vanilla  214.375 2.04296875 216.41796875 1715.04296875
Model size  0.0
Intermediate:  0.0078125
6.125
Total layers size  110.73641204833984
Server, client, server+client, vanilla  214.375 2.04296875 216.41796875 1715.04296875
Fixed, scale_with_bsz  0.0 6.69921875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 256, post_step 64

Memory occpied: (1250.0, 3.0)
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.8017644882202148 seconds
Streaming plantleave data took 0.8034331798553467 seconds
The mode is:  split
Start 256, end 512, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2734091281890869
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 0.0012669563293457031
Time for backpropagation: 0.005250215530395508
One training iteration takes: 0.34148192405700684 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.6915349960327148 seconds
Streaming plantleave data took 0.6929640769958496 seconds
Then, training+dataloading take 0.6933426856994629 seconds
The mode is:  split
Start 512, end 768, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24387812614440918
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.0017931461334228516
Time for backpropagation: 0.00440216064453125
One training iteration takes: 0.3039233684539795 seconds
Index: 1
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.7560579776763916 seconds
Streaming plantleave data took 0.7574825286865234 seconds
Then, training+dataloading take 0.7577998638153076 seconds
The mode is:  split
Start 768, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.266355037689209
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.0018248558044433594
Time for backpropagation: 0.005120754241943359
One training iteration takes: 0.35912179946899414 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.6985461711883545 seconds
Streaming plantleave data took 0.6997275352478027 seconds
Then, training+dataloading take 0.7000331878662109 seconds
The mode is:  split
Start 1024, end 1280, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.23923444747924805
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.0018184185028076172
Time for backpropagation: 0.004167795181274414
One training iteration takes: 0.3022589683532715 seconds
Index: 3
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.7380368709564209 seconds
Streaming plantleave data took 0.7416553497314453 seconds
Then, training+dataloading take 0.742811918258667 seconds
The mode is:  split
Start 1280, end 1536, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.27008843421936035
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.0018436908721923828
Time for backpropagation: 0.004303932189941406
One training iteration takes: 0.33937978744506836 seconds
Index: 4
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.726825475692749 seconds
Streaming plantleave data took 0.7282967567443848 seconds
Then, training+dataloading take 0.7286887168884277 seconds
The mode is:  split
Start 1536, end 1792, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24437355995178223
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.0020775794982910156
Time for backpropagation: 0.004604816436767578
One training iteration takes: 0.304034948348999 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.6875896453857422 seconds
Streaming plantleave data took 0.6887412071228027 seconds
Then, training+dataloading take 0.6890561580657959 seconds
The mode is:  split
Start 1792, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2370893955230713
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 0.001779317855834961
Time for backpropagation: 0.004248142242431641
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.675635814666748 seconds
Streaming plantleave data took 0.6774563789367676 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.257116079330444 seconds
Index: 6
Then, training+dataloading take 5.257177829742432 seconds
The mode is:  split
Start 2048, end 2304, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2447185516357422
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 0.0021550655364990234
Time for backpropagation: 0.005202293395996094
One training iteration takes: 0.31447577476501465 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.8020305633544922 seconds
Streaming plantleave data took 0.8034253120422363 seconds
Then, training+dataloading take 0.8037588596343994 seconds
The mode is:  split
Start 2304, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2454357147216797
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.0021615028381347656
Time for backpropagation: 0.004856109619140625
One training iteration takes: 0.3046443462371826 seconds
Index: 8
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.6873366832733154 seconds
Streaming plantleave data took 0.6890945434570312 seconds
Then, training+dataloading take 0.6896114349365234 seconds
The mode is:  split
Start 2560, end 2816, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2783775329589844
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.0021674633026123047
Time for backpropagation: 0.0052416324615478516
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.3402276039123535 seconds
Index: 9
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.6558794975280762 seconds
Streaming plantleave data took 0.6570444107055664 seconds
Then, training+dataloading take 0.6573996543884277 seconds
The mode is:  split
Start 2816, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2463245391845703
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.0018162727355957031
Time for backpropagation: 0.004370450973510742
One training iteration takes: 0.3017542362213135 seconds
Index: 10
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.7226152420043945 seconds
Streaming plantleave data took 0.7260057926177979 seconds
Then, training+dataloading take 0.7268538475036621 seconds
The mode is:  split
Start 3072, end 3328, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2800486087799072
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.001730203628540039
Time for backpropagation: 0.00481724739074707
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.35405993461608887 seconds
Index: 11
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.6682267189025879 seconds
Streaming plantleave data took 0.6696724891662598 seconds
Then, training+dataloading take 0.6700749397277832 seconds
The mode is:  split
Start 3328, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24126815795898438
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.0018148422241210938
Time for backpropagation: 0.0048732757568359375
One training iteration takes: 0.29624032974243164 seconds
Index: 12
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.7058627605438232 seconds
Streaming plantleave data took 0.7091336250305176 seconds
Then, training+dataloading take 0.7096784114837646 seconds
The mode is:  split
Start 3584, end 3840, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2614302635192871
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.002203226089477539
Time for backpropagation: 0.004792928695678711
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.33347463607788086 seconds
Index: 13
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.6829729080200195 seconds
Streaming plantleave data took 0.6841387748718262 seconds
Then, training+dataloading take 0.6844875812530518 seconds
The mode is:  split
Start 3840, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.24208331108093262
Time for copying to cuda: 8.821487426757812e-06
Time for forward pass: 0.0021414756774902344
Time for backpropagation: 0.00518488883972168
One training iteration takes: 0.3031904697418213 seconds
Index: 14
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.7487239837646484 seconds
Streaming plantleave data took 0.7506852149963379 seconds
Then, training+dataloading take 0.7514562606811523 seconds
The mode is:  split
Start 4096, end 4352, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2517735958099365
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.0017898082733154297
Time for backpropagation: 0.0042231082916259766
One training iteration takes: 0.3075430393218994 seconds
Index: 15
Read 2.009979248046875 MBs for this batch
Executing all posts took 0.7310473918914795 seconds
Streaming plantleave data took 0.7321763038635254 seconds
Then, training+dataloading take 0.732520341873169 seconds
The mode is:  split
Start 4352, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.23958730697631836
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.0017242431640625
Time for backpropagation: 0.0042951107025146484
One training iteration takes: 0.29950952529907227 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Read 1.1777944564819336 MBs for this batch
Executing all posts took 0.5997130870819092 seconds
Streaming plantleave data took 0.6004626750946045 seconds
Then, training+dataloading take 0.6008212566375732 seconds

Epoch: 0
Time of next(dataloader) is: 0.23437190055847168
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.0015647411346435547
Time for backpropagation: 0.0042858123779296875
The whole process took 24.400421380996704 seconds
