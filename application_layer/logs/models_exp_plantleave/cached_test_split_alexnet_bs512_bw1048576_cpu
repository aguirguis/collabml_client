Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=512, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.1979311106256 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [7.74400e+05 7.74400e+05 1.86624e+05 5.59872e+05 5.59872e+05 1.29792e+05
 2.59584e+05 2.59584e+05 1.73056e+05 1.73056e+05 1.73056e+05 1.73056e+05
 3.68640e+04 3.68640e+04 3.68640e+04 1.63840e+04 1.63840e+04 1.63840e+04
 1.63840e+04 1.63840e+04 8.80000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119039319.22653192 119039319.22653192
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.123779296875
1.47705078125
Total layers size  4.185630798339844
Server, client, server+client, vanilla  65.640625 364.9609375 430.6015625 1351.8359375
Candidate split  6
Server, client, server+client, vanilla  65.640625 364.9609375 430.6015625 1351.8359375
Model size  0.0
Intermediate:  0.123779296875
1.47705078125
Total layers size  4.185630798339844
Server, client, server+client, vanilla  65.640625 364.9609375 430.6015625 1351.8359375
Fixed, scale_with_bsz  0.0 2.05126953125
Mem usage  1250.0 3.0
Using split index: 6
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 512, post_step 64

Memory occpied: (1250.0, 3.0)
Read 63.39838409423828 MBs for this batch
Executing all posts took 1.2365412712097168 seconds
Streaming plantleave data took 1.2939715385437012 seconds
The mode is:  split
Start 512, end 1024, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.30343198776245117
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.7723948955535889
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.17890381813049316
One training iteration takes: 1.335848331451416 seconds
Index: 0
Read 63.39838409423828 MBs for this batch
Executing all posts took 1.335719347000122 seconds
Streaming plantleave data took 1.3599958419799805 seconds
Then, training+dataloading take 1.360973834991455 seconds
The mode is:  split
Start 1024, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3013138771057129
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8815000057220459
Time for backpropagation: 0.15749359130859375
Read 63.39838409423828 MBs for this batch
Executing all posts took 1.368790864944458 seconds
Streaming plantleave data took 1.3943181037902832 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 6.386174440383911 seconds
Index: 1
Then, training+dataloading take 6.386298179626465 seconds
The mode is:  split
Start 1536, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3062622547149658
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8539137840270996
Time for backpropagation: 0.1642446517944336
Read 63.39838409423828 MBs for this batch
Executing all posts took 1.3517699241638184 seconds
Streaming plantleave data took 1.3777680397033691 seconds
One training iteration takes: 1.4309828281402588 seconds
Index: 2
Then, training+dataloading take 1.431293249130249 seconds
The mode is:  split
Start 2048, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.35158681869506836
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.886878252029419
Read 63.39838409423828 MBs for this batch
Executing all posts took 1.2992839813232422 seconds
Streaming plantleave data took 1.3331689834594727 seconds
Time for backpropagation: 0.1283888816833496
One training iteration takes: 1.472532033920288 seconds
Index: 3
Then, training+dataloading take 1.4747393131256104 seconds
The mode is:  split
Start 2560, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.34868884086608887
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.7917301654815674
Read 63.39838409423828 MBs for this batch
Executing all posts took 1.3135707378387451 seconds
Time for backpropagation: 0.1529395580291748
Streaming plantleave data took 1.3406903743743896 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 6.344055414199829 seconds
Index: 4
Then, training+dataloading take 6.345221519470215 seconds
The mode is:  split
Start 3072, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3126034736633301
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.9983761310577393
Read 63.39838409423828 MBs for this batch
Executing all posts took 1.4045891761779785 seconds
Streaming plantleave data took 1.4382243156433105 seconds
Time for backpropagation: 0.14992666244506836
One training iteration takes: 1.583411693572998 seconds
Index: 5
Then, training+dataloading take 1.5868849754333496 seconds
The mode is:  split
Start 3584, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.31604528427124023
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8984663486480713
Read 63.39838409423828 MBs for this batch
Executing all posts took 1.330615520477295 seconds
Streaming plantleave data took 1.3660905361175537 seconds
Time for backpropagation: 0.1292588710784912
One training iteration takes: 1.447199821472168 seconds
Index: 6
Then, training+dataloading take 1.449495553970337 seconds
The mode is:  split
Start 4096, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.31160545349121094
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Read 50.2730131149292 MBs for this batch
Executing all posts took 1.1481263637542725 seconds
Streaming plantleave data took 1.1749627590179443 seconds
Time for forward pass: 0.902376651763916
Time for backpropagation: 0.1166679859161377
One training iteration takes: 1.4772248268127441 seconds
Index: 7
Then, training+dataloading take 1.4794361591339111 seconds

Epoch: 0
Time of next(dataloader) is: 0.3575735092163086
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.559319019317627
Time for backpropagation: 0.09900236129760742
The whole process took 30.304327487945557 seconds
