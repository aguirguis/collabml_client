Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=256, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.9787082506987 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 3.211264e+06
 3.211264e+06 3.211264e+06 1.605632e+06 4.014080e+05 1.605632e+06
 1.605632e+06 1.605632e+06 8.028160e+05 2.007040e+05 8.028160e+05
 8.028160e+05 8.028160e+05 4.014080e+05 1.003520e+05 2.007040e+05
 2.007040e+05 8.800000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119010585.24783558 119010585.24783558
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.763755798339844
Server, client, server+client, vanilla  0.015625 -1416.83203125 -1416.81640625 273.66796875
Candidate split  19
Server, client, server+client, vanilla  0.015625 -1416.83203125 -1416.81640625 273.66796875
Model size  0.0
Intermediate:  0.095703125
6.125
Total layers size  29.763755798339844
Server, client, server+client, vanilla  0.015625 -1416.83203125 -1416.81640625 273.66796875
Fixed, scale_with_bsz  0.0 0.00048828125
Mem usage  1250.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 256, post_step 64

Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.9782392978668213 seconds
Streaming plantleave data took 0.9884724617004395 seconds
The mode is:  split
Start 256, end 512, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3023555278778076
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8612868785858154 seconds
Streaming plantleave data took 0.8750131130218506 seconds
Time for forward pass: 0.5989158153533936
Time for backpropagation: 0.02290487289428711
One training iteration takes: 0.9917416572570801 seconds
Index: 0
Then, training+dataloading take 0.991807222366333 seconds
The mode is:  split
Start 512, end 768, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.25971150398254395
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8001120090484619 seconds
Streaming plantleave data took 0.8131086826324463 seconds
Time for forward pass: 0.6971876621246338
Time for backpropagation: 0.025931358337402344
One training iteration takes: 1.0469117164611816 seconds
Index: 1
Then, training+dataloading take 1.0469598770141602 seconds
The mode is:  split
Start 768, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.27887582778930664
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5929384231567383
Time for backpropagation: 0.0347132682800293
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.9419395923614502 seconds
Streaming plantleave data took 0.9521090984344482 seconds
One training iteration takes: 0.9779801368713379 seconds
Index: 2
Then, training+dataloading take 0.9780240058898926 seconds
The mode is:  split
Start 1024, end 1280, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.26590585708618164
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.44629716873168945
Time for backpropagation: 0.02707386016845703
One training iteration takes: 0.8119115829467773 seconds
Index: 3
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.9069952964782715 seconds
Streaming plantleave data took 0.9171085357666016 seconds
Then, training+dataloading take 0.9177148342132568 seconds
The mode is:  split
Start 1280, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3097503185272217
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.49364566802978516
Time for backpropagation: 0.03252911567687988
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8609163761138916 seconds
Streaming plantleave data took 0.8723702430725098 seconds
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.9271340370178223 seconds
Index: 4
Then, training+dataloading take 0.9271790981292725 seconds
The mode is:  split
Start 1536, end 1792, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.27292490005493164
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.472123384475708
Time for backpropagation: 0.030832529067993164
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8357596397399902 seconds
One training iteration takes: 0.8444793224334717 seconds
Index: 5
Streaming plantleave data took 0.8513257503509521 seconds
Then, training+dataloading take 0.8518857955932617 seconds
The mode is:  split
Start 1792, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.33635592460632324
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5125830173492432
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8992059230804443 seconds
Time for backpropagation: 0.04845452308654785
Streaming plantleave data took 0.9105572700500488 seconds
One training iteration takes: 0.9750237464904785 seconds
Index: 6
Then, training+dataloading take 0.9750797748565674 seconds
The mode is:  split
Start 2048, end 2304, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2788410186767578
Time for copying to cuda: 5.9604644775390625e-06
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8405952453613281 seconds
Streaming plantleave data took 0.8529634475708008 seconds
Time for forward pass: 0.7021949291229248
Time for backpropagation: 0.02927851676940918
One training iteration takes: 1.0799028873443604 seconds
Index: 7
Then, training+dataloading take 1.080118179321289 seconds
The mode is:  split
Start 2304, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2865474224090576
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6445996761322021
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.9654862880706787 seconds
Time for backpropagation: 0.033493757247924805
Streaming plantleave data took 0.9776339530944824 seconds
One training iteration takes: 1.040189504623413 seconds
Index: 8
Then, training+dataloading take 1.0402345657348633 seconds
The mode is:  split
Start 2560, end 2816, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2841529846191406
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.4901409149169922
Time for backpropagation: 0.06280303001403809
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8792285919189453 seconds
Streaming plantleave data took 0.8906950950622559 seconds
One training iteration takes: 0.927196741104126 seconds
Index: 9
Then, training+dataloading take 0.9274122714996338 seconds
The mode is:  split
Start 2816, end 3072, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2818021774291992
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.5320653915405273
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8473131656646729 seconds
Time for backpropagation: 0.0377812385559082
Streaming plantleave data took 0.8638210296630859 seconds
One training iteration takes: 0.9214704036712646 seconds
Index: 10
Then, training+dataloading take 0.9215171337127686 seconds
The mode is:  split
Start 3072, end 3328, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.32158565521240234
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.526435136795044
Time for backpropagation: 0.027692079544067383
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.9268152713775635 seconds
One training iteration takes: 0.9686706066131592 seconds
Index: 11
Streaming plantleave data took 0.9727671146392822 seconds
Then, training+dataloading take 0.9738979339599609 seconds
The mode is:  split
Start 3328, end 3584, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.28806400299072266
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.5031988620758057
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8280856609344482 seconds
Time for backpropagation: 0.03552722930908203
Streaming plantleave data took 0.8406946659088135 seconds
One training iteration takes: 0.8957619667053223 seconds
Index: 12
Then, training+dataloading take 0.8958213329315186 seconds
The mode is:  split
Start 3584, end 3840, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.33098626136779785
Time for copying to cuda: 6.67572021484375e-06
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8648293018341064 seconds
Streaming plantleave data took 0.8768012523651123 seconds
Time for forward pass: 0.557091236114502
Time for backpropagation: 0.02613353729248047
One training iteration takes: 1.0065398216247559 seconds
Index: 13
Then, training+dataloading take 1.0067517757415771 seconds
The mode is:  split
Start 3840, end 4096, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.29352307319641113
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.5072319507598877
Time for backpropagation: 0.02970123291015625
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.9006555080413818 seconds
One training iteration takes: 0.908623456954956 seconds
Index: 14
Streaming plantleave data took 0.9109151363372803 seconds
Then, training+dataloading take 0.9113001823425293 seconds
The mode is:  split
Start 4096, end 4352, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.33420753479003906
Time for copying to cuda: 6.4373016357421875e-06
Read 24.51193618774414 MBs for this batch
Executing all posts took 0.8628628253936768 seconds
Streaming plantleave data took 0.8746969699859619 seconds
Time for forward pass: 0.5909006595611572
Time for backpropagation: 0.028003692626953125
One training iteration takes: 1.0417625904083252 seconds
Index: 15
Then, training+dataloading take 1.0419166088104248 seconds
The mode is:  split
Start 4352, end 4502, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2921478748321533
Time for copying to cuda: 7.3909759521484375e-06
Read 14.36253833770752 MBs for this batch
Executing all posts took 0.5824320316314697 seconds
Streaming plantleave data took 0.6072022914886475 seconds
Time for forward pass: 0.49878764152526855
Time for backpropagation: 0.02208256721496582
One training iteration takes: 0.8844091892242432 seconds
Index: 16
Then, training+dataloading take 0.8846662044525146 seconds

Epoch: 0
Time of next(dataloader) is: 0.31841564178466797
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.3247344493865967
Time for backpropagation: 0.012487411499023438
Memory occpied: (1250.0, 3.0)
The whole process took 25.05289649963379 seconds
