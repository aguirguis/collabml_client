Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=256, cached=True, cpuonly=False, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.8944328379586 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 8.8000000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118999539.1009369 118999539.1009369
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.33992767333984
Server, client, server+client, vanilla  1335.13818359375 972.80615234375 2307.9443359375 7293.80615234375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1878.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 256, post_step 64

Memory occpied: (1878.0, 3.0)
Memory occpied: (1878.0, 3.0)
Memory occpied: (1878.0, 3.0)
Memory occpied: (1878.0, 3.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.703892230987549 seconds
Streaming plantleave data took 3.740224838256836 seconds
The mode is:  split
Start 256, end 512, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3824641704559326
Time for copying to cuda: 0.026736974716186523
Memory occpied: (1976.0, 346.0)
Memory occpied: (1976.0, 808.0)
Memory occpied: (1976.0, 1262.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.7198634147644043 seconds
Streaming plantleave data took 3.7584545612335205 seconds
Time for forward pass: 3.740844249725342
Time for backpropagation: 0.056185245513916016
GPU memory for training: 4.470851898193359                          

One training iteration takes: 4.295701503753662 seconds
Index: 0
Then, training+dataloading take 4.295971155166626 seconds
The mode is:  split
Start 512, end 768, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.44686365127563477
Time for copying to cuda: 0.02617645263671875
Time for forward pass: 0.09681415557861328
Time for backpropagation: 0.005129337310791016
GPU memory for training: 3.533751964569092                          

One training iteration takes: 0.6888089179992676 seconds
Index: 1
Memory occpied: (3522.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.6814920902252197 seconds
Streaming plantleave data took 3.7180893421173096 seconds
Then, training+dataloading take 3.7207398414611816 seconds
The mode is:  split
Start 768, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4229757785797119
Time for copying to cuda: 0.0262448787689209
Time for forward pass: 0.13695955276489258
Time for backpropagation: 0.004485607147216797
GPU memory for training: 3.533751964569092                          

One training iteration takes: 0.7014951705932617 seconds
Index: 2
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.737074375152588 seconds
Streaming plantleave data took 3.773815631866455 seconds
Then, training+dataloading take 3.774627208709717 seconds
The mode is:  split
Start 1024, end 1280, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.46895313262939453
Time for copying to cuda: 0.025769948959350586
Time for forward pass: 0.1370534896850586
Time for backpropagation: 0.004559040069580078
GPU memory for training: 3.533751964569092                          

Memory occpied: (3998.0, 3552.0)
One training iteration takes: 0.749945878982544 seconds
Index: 3
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.654456377029419 seconds
Streaming plantleave data took 3.6906590461730957 seconds
Then, training+dataloading take 3.6927382946014404 seconds
The mode is:  split
Start 1280, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.42708492279052734
Time for copying to cuda: 0.025638580322265625
Time for forward pass: 0.17435431480407715
Time for backpropagation: 0.004606008529663086
GPU memory for training: 3.533751964569092                          

Memory occpied: (3998.0, 3552.0)
One training iteration takes: 0.7411525249481201 seconds
Index: 4
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.706890344619751 seconds
Streaming plantleave data took 3.7441537380218506 seconds
Then, training+dataloading take 3.7449867725372314 seconds
The mode is:  split
Start 1536, end 1792, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4293944835662842
Time for copying to cuda: 0.025770187377929688
Time for forward pass: 0.16841769218444824
Time for backpropagation: 0.004584550857543945
GPU memory for training: 3.533751964569092                          

Memory occpied: (3998.0, 3552.0)
One training iteration takes: 0.7324614524841309 seconds
Index: 5
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.721770763397217 seconds
Streaming plantleave data took 3.7587013244628906 seconds
Then, training+dataloading take 3.7595369815826416 seconds
The mode is:  split
Start 1792, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.43549227714538574
Time for copying to cuda: 0.07036828994750977
Time for forward pass: 0.1374521255493164
Time for backpropagation: 0.005005598068237305
GPU memory for training: 3.533751964569092                          

Memory occpied: (3998.0, 3552.0)
One training iteration takes: 0.7546639442443848 seconds
Index: 6
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.7503464221954346 seconds
Streaming plantleave data took 3.787933826446533 seconds
Then, training+dataloading take 3.7887163162231445 seconds
The mode is:  split
Start 2048, end 2304, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4354236125946045
Time for copying to cuda: 0.029079675674438477
Time for forward pass: 0.13660860061645508
Time for backpropagation: 0.004646778106689453
GPU memory for training: 3.533751964569092                          

Memory occpied: (3998.0, 3552.0)
One training iteration takes: 0.7081484794616699 seconds
Index: 7
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.6637001037597656 seconds
Streaming plantleave data took 3.701263427734375 seconds
Then, training+dataloading take 3.702113389968872 seconds
The mode is:  split
Start 2304, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.48636484146118164
Time for copying to cuda: 0.02588200569152832
Time for forward pass: 0.13706016540527344
Time for backpropagation: 0.004620790481567383
GPU memory for training: 3.533751964569092                          

Memory occpied: (3998.0, 3552.0)
One training iteration takes: 0.7611329555511475 seconds
Index: 8
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.679841995239258 seconds
Streaming plantleave data took 3.716102361679077 seconds
Then, training+dataloading take 3.7169528007507324 seconds
The mode is:  split
Start 2560, end 2816, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.43917083740234375
Time for copying to cuda: 0.07072091102600098
Time for forward pass: 0.1366746425628662
Time for backpropagation: 0.004629850387573242
GPU memory for training: 3.533751964569092                          

Memory occpied: (3998.0, 3552.0)
One training iteration takes: 0.7621877193450928 seconds
Index: 9
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.6394426822662354 seconds
Streaming plantleave data took 3.6769227981567383 seconds
Then, training+dataloading take 3.6777637004852295 seconds
The mode is:  split
Start 2816, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4691002368927002
Time for copying to cuda: 0.025828838348388672
Time for forward pass: 0.16834402084350586
Time for backpropagation: 0.004632472991943359
GPU memory for training: 3.533751964569092                          

One training iteration takes: 0.773787260055542 seconds
Index: 10
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.56923508644104 seconds
Streaming plantleave data took 3.6055939197540283 seconds
Then, training+dataloading take 3.606398582458496 seconds
The mode is:  split
Start 3072, end 3328, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.43302488327026367
Time for copying to cuda: 0.025962114334106445
Time for forward pass: 0.13581085205078125
Time for backpropagation: 0.004136562347412109
GPU memory for training: 3.533751964569092                          

One training iteration takes: 0.716200590133667 seconds
Index: 11
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.749140501022339 seconds
Streaming plantleave data took 3.7858662605285645 seconds
Then, training+dataloading take 3.7866506576538086 seconds
The mode is:  split
Start 3328, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4305233955383301
Time for copying to cuda: 0.025647401809692383
Time for forward pass: 0.13574504852294922
Time for backpropagation: 0.004074811935424805
GPU memory for training: 3.533751964569092                          

One training iteration takes: 0.7358391284942627 seconds
Index: 12
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.797186851501465 seconds
Streaming plantleave data took 3.833608865737915 seconds
Then, training+dataloading take 3.834420919418335 seconds
The mode is:  split
Start 3584, end 3840, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4571361541748047
Time for copying to cuda: 0.02593374252319336
Time for forward pass: 0.13607239723205566
Time for backpropagation: 0.004168510437011719
GPU memory for training: 3.533751964569092                          

One training iteration takes: 0.7625975608825684 seconds
Index: 13
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.7274646759033203 seconds
Streaming plantleave data took 3.7649383544921875 seconds
Then, training+dataloading take 3.7657694816589355 seconds
The mode is:  split
Start 3840, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4286003112792969
Time for copying to cuda: 0.02567911148071289
Time for forward pass: 0.1369178295135498
Time for backpropagation: 0.004437923431396484
GPU memory for training: 3.533751964569092                          

One training iteration takes: 0.7325527667999268 seconds
Index: 14
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.733628273010254 seconds
Streaming plantleave data took 3.770129680633545 seconds
Then, training+dataloading take 3.7709765434265137 seconds
The mode is:  split
Start 4096, end 4352, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.43454623222351074
Time for copying to cuda: 0.06974530220031738
Time for forward pass: 0.1371161937713623
Time for backpropagation: 0.004639148712158203
GPU memory for training: 3.533751964569092                          

Memory occpied: (3998.0, 3552.0)
One training iteration takes: 0.7500698566436768 seconds
Index: 15
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 98.01193618774414 MBs for this batch
Executing all posts took 3.6830403804779053 seconds
Streaming plantleave data took 3.7193491458892822 seconds
Then, training+dataloading take 3.720158576965332 seconds
The mode is:  split
Start 4352, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.4324648380279541
Time for copying to cuda: 0.025819063186645508
Time for forward pass: 0.136613130569458
Time for backpropagation: 0.004658699035644531
GPU memory for training: 3.533751964569092                          

One training iteration takes: 0.7061564922332764 seconds
Index: 16
Memory occpied: (3998.0, 3552.0)
Memory occpied: (3998.0, 3552.0)
Read 57.42894458770752 MBs for this batch
Executing all posts took 2.1506500244140625 seconds
Streaming plantleave data took 2.1723275184631348 seconds
Then, training+dataloading take 2.1730620861053467 seconds

Epoch: 0
Time of next(dataloader) is: 0.407698392868042
Time for copying to cuda: 0.015442848205566406
Time for forward pass: 0.3382143974304199
Time for backpropagation: 0.009061813354492188
GPU memory for training: 4.821247577667236                          

Memory occpied: (3890.0, 3552.0)
The whole process took 76.27312159538269 seconds
