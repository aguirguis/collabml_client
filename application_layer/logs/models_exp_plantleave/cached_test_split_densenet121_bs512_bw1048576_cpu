Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=512, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.289157781629 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 3.211264e+06
 3.211264e+06 3.211264e+06 1.605632e+06 4.014080e+05 1.605632e+06
 1.605632e+06 1.605632e+06 8.028160e+05 2.007040e+05 8.028160e+05
 8.028160e+05 8.028160e+05 4.014080e+05 1.003520e+05 2.007040e+05
 2.007040e+05 8.800000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119051276.48875368 119051276.48875368
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.763755798339844
Server, client, server+client, vanilla  0.015625 -2833.6640625 -2833.6484375 547.3359375
Candidate split  19
Server, client, server+client, vanilla  0.015625 -2833.6640625 -2833.6484375 547.3359375
Model size  0.0
Intermediate:  0.095703125
6.125
Total layers size  29.763755798339844
Server, client, server+client, vanilla  0.015625 -2833.6640625 -2833.6484375 547.3359375
Fixed, scale_with_bsz  0.0 0.00048828125
Mem usage  1250.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 512, post_step 64

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.6597845554351807 seconds
Streaming plantleave data took 1.678959846496582 seconds
The mode is:  split
Start 512, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.28516674041748047
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.3860979080200195 seconds
Streaming plantleave data took 1.4083530902862549 seconds
Time for forward pass: 1.136068344116211
Time for backpropagation: 0.055435895919799805
One training iteration takes: 1.5438563823699951 seconds
Index: 0
Then, training+dataloading take 1.5440635681152344 seconds
The mode is:  split
Start 1024, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2774059772491455
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.3505399227142334 seconds
Streaming plantleave data took 1.3797025680541992 seconds
Time for forward pass: 1.1409754753112793
Time for backpropagation: 0.044626712799072266
One training iteration takes: 1.5609283447265625 seconds
Index: 1
Then, training+dataloading take 1.5612115859985352 seconds
The mode is:  split
Start 1536, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.31873321533203125
Time for copying to cuda: 7.152557373046875e-06
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.5211741924285889 seconds
Streaming plantleave data took 1.546377420425415 seconds
Time for forward pass: 1.2532997131347656
Time for backpropagation: 0.043975830078125
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 6.636816501617432 seconds
Index: 2
Then, training+dataloading take 6.636934280395508 seconds
The mode is:  split
Start 2048, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.28947973251342773
Time for copying to cuda: 6.4373016357421875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.0371639728546143
Time for backpropagation: 0.05214381217956543
One training iteration takes: 1.4569034576416016 seconds
Index: 3
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.5721385478973389 seconds
Streaming plantleave data took 1.5908279418945312 seconds
Then, training+dataloading take 1.5916247367858887 seconds
The mode is:  split
Start 2560, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3069760799407959
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.342961072921753 seconds
Streaming plantleave data took 1.3647754192352295 seconds
Time for forward pass: 1.4072511196136475
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.05651593208312988
One training iteration takes: 1.8421270847320557 seconds
Index: 4
Then, training+dataloading take 1.8423621654510498 seconds
The mode is:  split
Start 3072, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.29238343238830566
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.2817699909210205 seconds
Streaming plantleave data took 1.3058724403381348 seconds
Time for forward pass: 1.1297297477722168
Time for backpropagation: 0.045092105865478516
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 6.484151601791382 seconds
Index: 5
Then, training+dataloading take 6.48426079750061 seconds
The mode is:  split
Start 3584, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2996368408203125
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Read 49.02387237548828 MBs for this batch
Executing all posts took 1.5232410430908203 seconds
Streaming plantleave data took 1.5479576587677002 seconds
Time for forward pass: 1.2871360778808594
Time for backpropagation: 0.08642148971557617
One training iteration takes: 1.7520434856414795 seconds
Index: 6
Then, training+dataloading take 1.7521989345550537 seconds
The mode is:  split
Start 4096, end 4502, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.29500293731689453
Time for copying to cuda: 7.152557373046875e-06
Read 38.87447452545166 MBs for this batch
Executing all posts took 1.1628541946411133 seconds
Streaming plantleave data took 1.184769868850708 seconds
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.1625075340270996
Time for backpropagation: 0.04707527160644531
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 6.522217512130737 seconds
Index: 7
Then, training+dataloading take 6.522335052490234 seconds

Epoch: 0
Time of next(dataloader) is: 0.2871220111846924
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.9168977737426758
Time for backpropagation: 0.04015159606933594
The whole process took 37.143184423446655 seconds
