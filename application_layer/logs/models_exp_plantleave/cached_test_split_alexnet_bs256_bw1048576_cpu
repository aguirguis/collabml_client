Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=256, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6013092820173 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [7.74400e+05 7.74400e+05 1.86624e+05 5.59872e+05 5.59872e+05 1.29792e+05
 2.59584e+05 2.59584e+05 1.73056e+05 1.73056e+05 1.73056e+05 1.73056e+05
 3.68640e+04 3.68640e+04 3.68640e+04 1.63840e+04 1.63840e+04 1.63840e+04
 1.63840e+04 1.63840e+04 8.80000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119092190.81021257 119092190.81021257
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.123779296875
1.47705078125
Total layers size  4.185630798339844
Server, client, server+client, vanilla  65.640625 182.48046875 248.12109375 675.91796875
Candidate split  6
Server, client, server+client, vanilla  65.640625 182.48046875 248.12109375 675.91796875
Model size  0.0
Intermediate:  0.123779296875
1.47705078125
Total layers size  4.185630798339844
Server, client, server+client, vanilla  65.640625 182.48046875 248.12109375 675.91796875
Fixed, scale_with_bsz  0.0 2.05126953125
Mem usage  1250.0 3.0
Using split index: 6
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 256, post_step 64

Memory occpied: (1250.0, 3.0)
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.8471689224243164 seconds
Streaming plantleave data took 0.8604331016540527 seconds
The mode is:  split
Start 256, end 512, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.28839731216430664
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5604546070098877
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.8499886989593506 seconds
Streaming plantleave data took 0.8667447566986084 seconds
Time for backpropagation: 0.0775904655456543
One training iteration takes: 0.9945924282073975 seconds
Index: 0
Then, training+dataloading take 0.994816780090332 seconds
The mode is:  split
Start 512, end 768, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2722806930541992
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.487501859664917
Time for backpropagation: 0.1092989444732666
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.909290075302124 seconds
Streaming plantleave data took 0.922025203704834 seconds
One training iteration takes: 0.9763805866241455 seconds
Index: 1
Then, training+dataloading take 0.9764280319213867 seconds
The mode is:  split
Start 768, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2827754020690918
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3579702377319336
Time for backpropagation: 0.1028599739074707
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.7913789749145508 seconds
Streaming plantleave data took 0.80428147315979 seconds
One training iteration takes: 0.8443706035614014 seconds
Index: 2
Then, training+dataloading take 0.8448681831359863 seconds
The mode is:  split
Start 1024, end 1280, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3204209804534912
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.42708849906921387
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.8572885990142822 seconds
Streaming plantleave data took 0.8751800060272217 seconds
Time for backpropagation: 0.11655378341674805
One training iteration takes: 0.9606654644012451 seconds
Index: 3
Then, training+dataloading take 0.9617502689361572 seconds
The mode is:  split
Start 1280, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3037984371185303
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.485241174697876
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.8455796241760254 seconds
Streaming plantleave data took 0.8626329898834229 seconds
Time for backpropagation: 0.11008715629577637
One training iteration takes: 1.0036451816558838 seconds
Index: 4
Then, training+dataloading take 1.0047876834869385 seconds
The mode is:  split
Start 1536, end 1792, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.28887438774108887
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5156197547912598
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.884526252746582 seconds
Streaming plantleave data took 0.9045662879943848 seconds
Time for backpropagation: 0.10656356811523438
One training iteration takes: 1.0126349925994873 seconds
Index: 5
Then, training+dataloading take 1.013824224472046 seconds
The mode is:  split
Start 1792, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2923007011413574
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.4351382255554199
Time for backpropagation: 0.19407129287719727
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.9807190895080566 seconds
Streaming plantleave data took 0.9949843883514404 seconds
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.0465750694274902 seconds
Index: 6
Then, training+dataloading take 1.0477032661437988 seconds
The mode is:  split
Start 2048, end 2304, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.29288554191589355
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.4295628070831299
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.864293098449707 seconds
Time for backpropagation: 0.11748218536376953
Streaming plantleave data took 0.8791873455047607 seconds
One training iteration takes: 0.9406673908233643 seconds
Index: 7
Then, training+dataloading take 0.941817045211792 seconds
The mode is:  split
Start 2304, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3245859146118164
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.4338195323944092
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.8355722427368164 seconds
Streaming plantleave data took 0.8531084060668945 seconds
Time for backpropagation: 0.10649776458740234
One training iteration takes: 0.9786124229431152 seconds
Index: 8
Then, training+dataloading take 0.9791452884674072 seconds
The mode is:  split
Start 2560, end 2816, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3034989833831787
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.395857572555542
Time for backpropagation: 0.12622523307800293
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.8533155918121338 seconds
Streaming plantleave data took 0.8668441772460938 seconds
One training iteration takes: 0.9338698387145996 seconds
Index: 9
Then, training+dataloading take 0.9350314140319824 seconds
The mode is:  split
Start 2816, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3691282272338867
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.429546594619751
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.8861045837402344 seconds
Streaming plantleave data took 0.9059040546417236 seconds
Time for backpropagation: 0.11439990997314453
One training iteration takes: 1.0180809497833252 seconds
Index: 10
Then, training+dataloading take 1.01979398727417 seconds
The mode is:  split
Start 3072, end 3328, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.29811882972717285
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5441644191741943
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.898087739944458 seconds
Streaming plantleave data took 0.9153962135314941 seconds
Time for backpropagation: 0.11568236351013184
One training iteration takes: 1.0586671829223633 seconds
Index: 11
Then, training+dataloading take 1.059882640838623 seconds
The mode is:  split
Start 3328, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.291654109954834
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.4954802989959717
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.8806438446044922 seconds
Memory occpied: (1250.0, 3.0)
Streaming plantleave data took 0.8986496925354004 seconds
Time for backpropagation: 0.14090824127197266
One training iteration takes: 1.027599811553955 seconds
Index: 12
Then, training+dataloading take 1.028796911239624 seconds
The mode is:  split
Start 3584, end 3840, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.29676127433776855
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.3722400665283203
Time for backpropagation: 0.11019086837768555
One training iteration takes: 0.9014279842376709 seconds
Index: 13
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.9385149478912354 seconds
Streaming plantleave data took 0.9513187408447266 seconds
Then, training+dataloading take 0.9530808925628662 seconds
The mode is:  split
Start 3840, end 4096, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3327929973602295
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.4337496757507324
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.886634111404419 seconds
Streaming plantleave data took 0.9052743911743164 seconds
Time for backpropagation: 0.12680578231811523
One training iteration takes: 0.9937257766723633 seconds
Index: 14
Then, training+dataloading take 0.9937725067138672 seconds
The mode is:  split
Start 4096, end 4352, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3651304244995117
Time for copying to cuda: 9.059906005859375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5061781406402588
Read 31.69919204711914 MBs for this batch
Executing all posts took 0.9723696708679199 seconds
Streaming plantleave data took 0.9872863292694092 seconds
Time for backpropagation: 0.10718941688537598
One training iteration takes: 1.0803961753845215 seconds
Index: 15
Then, training+dataloading take 1.0817444324493408 seconds
The mode is:  split
Start 4352, end 4502, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.30216169357299805
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Read 18.57382106781006 MBs for this batch
Executing all posts took 0.7053194046020508 seconds
Streaming plantleave data took 0.7161004543304443 seconds
Time for forward pass: 0.5555753707885742
Time for backpropagation: 0.09351897239685059
One training iteration takes: 1.050581455230713 seconds
Index: 16
Then, training+dataloading take 1.0506303310394287 seconds

Epoch: 0
Time of next(dataloader) is: 0.28785228729248047
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.2905607223510742
Time for backpropagation: 0.12729811668395996
Memory occpied: (1250.0, 3.0)
The whole process took 25.57388424873352 seconds
