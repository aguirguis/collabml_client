Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=256, cached=True, cpuonly=True, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5622496593393 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 8.8000000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119087071.18734892 119087071.18734892
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.095703125
24.5
Total layers size  62.683677673339844
Server, client, server+client, vanilla  802.375 97.54296875 899.91796875 6492.04296875
Candidate split  21
Server, client, server+client, vanilla  802.375 97.54296875 899.91796875 6492.04296875
Model size  0.0
Intermediate:  0.095703125
24.5
Total layers size  62.683677673339844
Server, client, server+client, vanilla  802.375 97.54296875 899.91796875 6492.04296875
Fixed, scale_with_bsz  0.0 25.07421875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 256, post_step 64

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.7403521537780762 seconds
Streaming plantleave data took 1.750596046447754 seconds
The mode is:  split
Start 256, end 512, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.30750393867492676
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.0996863842010498
Time for backpropagation: 0.06285452842712402
One training iteration takes: 0.531733512878418 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6858258247375488 seconds
Streaming plantleave data took 1.6954331398010254 seconds
Then, training+dataloading take 1.6958646774291992 seconds
The mode is:  split
Start 512, end 768, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3164045810699463
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.12308907508850098
Time for backpropagation: 0.09141159057617188
One training iteration takes: 0.6491532325744629 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6597473621368408 seconds
Streaming plantleave data took 1.6696405410766602 seconds
Then, training+dataloading take 1.6700091361999512 seconds
The mode is:  split
Start 768, end 1024, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3231990337371826
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.13084650039672852
Time for backpropagation: 0.09518790245056152
One training iteration takes: 0.6723079681396484 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6152427196502686 seconds
Streaming plantleave data took 1.6213653087615967 seconds
Then, training+dataloading take 1.622004747390747 seconds
The mode is:  split
Start 1024, end 1280, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.32077646255493164
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.1644439697265625
Time for backpropagation: 0.0935204029083252
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6778464317321777 seconds
Streaming plantleave data took 1.6886913776397705 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.622004508972168 seconds
Index: 3
Then, training+dataloading take 5.622071266174316 seconds
The mode is:  split
Start 1280, end 1536, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.29421281814575195
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.13034558296203613
Time for backpropagation: 0.09112024307250977
One training iteration takes: 0.5995829105377197 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6854627132415771 seconds
Streaming plantleave data took 1.6951897144317627 seconds
Then, training+dataloading take 1.695662021636963 seconds
The mode is:  split
Start 1536, end 1792, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.29100680351257324
Time for copying to cuda: 9.059906005859375e-06
Time for forward pass: 0.17500066757202148
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.09891152381896973
One training iteration takes: 0.7032115459442139 seconds
Index: 5
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.738595724105835 seconds
Memory occpied: (1250.0, 3.0)
Streaming plantleave data took 1.7485620975494385 seconds
Then, training+dataloading take 1.749006986618042 seconds
The mode is:  split
Start 1792, end 2048, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2891242504119873
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.14030694961547852
Time for backpropagation: 0.09226846694946289
One training iteration takes: 0.6255090236663818 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.673215389251709 seconds
Streaming plantleave data took 1.6793694496154785 seconds
Then, training+dataloading take 1.680009365081787 seconds
The mode is:  split
Start 2048, end 2304, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.2882657051086426
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.13167452812194824
Time for backpropagation: 0.15983986854553223
One training iteration takes: 0.6827683448791504 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.65207839012146 seconds
Streaming plantleave data took 1.6629738807678223 seconds
Then, training+dataloading take 1.663346290588379 seconds
The mode is:  split
Start 2304, end 2560, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3486809730529785
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.12264561653137207
Time for backpropagation: 0.09361791610717773
One training iteration takes: 0.7016401290893555 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.7110137939453125 seconds
Streaming plantleave data took 1.7171390056610107 seconds
Then, training+dataloading take 1.717531442642212 seconds
The mode is:  split
Start 2560, end 2816, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.33153700828552246
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.15744304656982422
Time for backpropagation: 0.09369826316833496
One training iteration takes: 0.7126255035400391 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.629185676574707 seconds
Streaming plantleave data took 1.6393420696258545 seconds
Then, training+dataloading take 1.6397147178649902 seconds
The mode is:  split
Start 2816, end 3072, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.33602023124694824
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.12060093879699707
Time for backpropagation: 0.09126019477844238
One training iteration takes: 0.6727054119110107 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6908860206604004 seconds
Streaming plantleave data took 1.6970884799957275 seconds
Then, training+dataloading take 1.6977038383483887 seconds
The mode is:  split
Start 3072, end 3328, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.32372546195983887
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.1205747127532959
Time for backpropagation: 0.10980415344238281
One training iteration takes: 0.6689174175262451 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6880836486816406 seconds
Streaming plantleave data took 1.6979618072509766 seconds
Then, training+dataloading take 1.6983332633972168 seconds
The mode is:  split
Start 3328, end 3584, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.33383679389953613
Time for copying to cuda: 6.4373016357421875e-06
Time for forward pass: 0.12485313415527344
Time for backpropagation: 0.09420180320739746
One training iteration takes: 0.6671140193939209 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.7640266418457031 seconds
Streaming plantleave data took 1.776036024093628 seconds
Then, training+dataloading take 1.7770090103149414 seconds
The mode is:  split
Start 3584, end 3840, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.32332348823547363
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.12666082382202148
Time for backpropagation: 0.09213829040527344
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.6484966278076172 seconds
Index: 13
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6396293640136719 seconds
Streaming plantleave data took 1.68399977684021 seconds
Then, training+dataloading take 1.6855111122131348 seconds
The mode is:  split
Start 3840, end 4096, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.33268189430236816
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.12795352935791016
Time for backpropagation: 0.09542274475097656
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.6558620929718018 seconds
Index: 14
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6977427005767822 seconds
Streaming plantleave data took 1.7076032161712646 seconds
Then, training+dataloading take 1.7085206508636475 seconds
The mode is:  split
Start 4096, end 4352, post_step 64


Epoch: 0
Time of next(dataloader) is: 0.3308238983154297
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.1298840045928955
Time for backpropagation: 0.0988919734954834
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.665257453918457 seconds
Index: 15
Read 24.51193618774414 MBs for this batch
Executing all posts took 1.6624295711517334 seconds
Streaming plantleave data took 1.706223964691162 seconds
Then, training+dataloading take 1.7077147960662842 seconds
The mode is:  split
Start 4352, end 4502, post_step 64


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.32763099670410156
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.13554000854492188
Time for backpropagation: 0.0933988094329834
One training iteration takes: 0.6527996063232422 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Read 14.36253833770752 MBs for this batch
Executing all posts took 1.5838968753814697 seconds
Streaming plantleave data took 1.589702844619751 seconds
Then, training+dataloading take 1.5904300212860107 seconds

Epoch: 0
Time of next(dataloader) is: 0.2846860885620117
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.08765459060668945
Time for backpropagation: 0.0955650806427002
The whole process took 42.5669903755188 seconds
