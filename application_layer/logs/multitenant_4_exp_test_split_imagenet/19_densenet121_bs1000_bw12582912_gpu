Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=19, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10582.884468400141 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1387119833.0421433 1387119833.0421433
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 19 20
Intermediate:  0.095703125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 4776.28125 4971.50732421875 11379.796875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.3226125240325928
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.65069580078125
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 2.973879814147949
Length of received data: 100399121
Read 95.74806308746338 MBs for this batch
Executing all posts took 3.9467248916625977 seconds
Streaming imagenet data took 4.015304088592529 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.3597104549407959
Time for copying to cuda: 0.025299072265625
Length of received data: 100399121
Read 95.74806308746338 MBs for this batch
Executing all posts took 3.853780508041382 seconds
Streaming imagenet data took 3.8897926807403564 seconds
Time for forward pass: 3.774020195007324
Time for backpropagation: 0.07851171493530273
GPU memory for training: 3.349872589111328                          

One training iteration takes: 4.355435848236084 seconds
Index: 0
Then, training+dataloading take 4.355636358261108 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 44, 19']
Memory occupied: [1318.0, 2134.0] Time: 8.641249179840088
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 44, 19']
Time of next(dataloader) is: 0.40731334686279297
Time for copying to cuda: 0.025262117385864258
Time for forward pass: 0.10536742210388184
Time for backpropagation: 0.010977029800415039
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.623060941696167 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 10.041244506835938
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 11.437920570373535
Length of received data: 100399121
Read 95.74806308746338 MBs for this batch
Executing all posts took 3.8615715503692627 seconds
Streaming imagenet data took 3.8974671363830566 seconds
Then, training+dataloading take 3.903031587600708 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.4603698253631592
Time for copying to cuda: 0.06190133094787598
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for forward pass: 0.12839627265930176
Time for backpropagation: 0.011677742004394531
GPU memory for training: 0.907660961151123                          

Memory occupied: [3948.0, 2150.0] Time: 12.948341608047485
One training iteration takes: 0.7430074214935303 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 14.359342813491821
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 15.771888256072998
Length of received data: 100399121
Read 95.74806308746338 MBs for this batch
Executing all posts took 3.8694992065429688 seconds
Streaming imagenet data took 3.9068126678466797 seconds
Then, training+dataloading take 3.9122281074523926 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3781158924102783
Time for copying to cuda: 0.024595022201538086
Time for forward pass: 0.12440133094787598
Time for backpropagation: 0.010878562927246094
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.6320569515228271 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 50, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 17.19299340248108
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 18.604365825653076
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 100399121
Memory occupied: [3948.0, 2150.0] Time: 20.05815815925598
Read 95.74806308746338 MBs for this batch
Executing all posts took 3.91375994682312 seconds
Streaming imagenet data took 3.9500629901885986 seconds
Then, training+dataloading take 3.955519199371338 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3734781742095947
Time for copying to cuda: 0.02454352378845215
Time for forward pass: 0.12479281425476074
Time for backpropagation: 0.010917186737060547
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.6082990169525146 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 21.46727681159973
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 22.87601327896118
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 24.28534245491028
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 25.69659948348999
Length of received data: 100399121
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.3044211864471436 seconds
Streaming imagenet data took 6.340346813201904 seconds
Then, training+dataloading take 6.344396352767944 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.421337366104126
Time for copying to cuda: 0.024759531021118164
Time for forward pass: 0.12519001960754395
Time for backpropagation: 0.011031389236450195
GPU memory for training: 0.907660961151123                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
One training iteration takes: 0.7007911205291748 seconds
Index: 5
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 34, 23']
Memory occupied: [3948.0, 2150.0] Time: 27.464643239974976
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 28.878456592559814
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 30.294090032577515
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 31.708566427230835
Length of received data: 100399121
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.2617621421813965 seconds
Streaming imagenet data took 6.339013576507568 seconds
Then, training+dataloading take 6.343783140182495 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.4257051944732666
Time for copying to cuda: 0.024595975875854492
Time for forward pass: 0.17067837715148926
Time for backpropagation: 0.010939836502075195
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.7495794296264648 seconds
Index: 6
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 17, 12']
Memory occupied: [3948.0, 2150.0] Time: 33.755762338638306
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 35.17391324043274
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 36.58885669708252
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3948.0, 2150.0] Time: 38.00497484207153
Length of received data: 100399121
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.250730991363525 seconds
Streaming imagenet data took 6.32710862159729 seconds
Then, training+dataloading take 6.33212947845459 seconds

Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.4238564968109131
Time for copying to cuda: 0.024823427200317383
Time for forward pass: 0.12509512901306152
Time for backpropagation: 0.011284589767456055
GPU memory for training: 0.907660961151123                          

GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 48, 34']
Memory occupied: [3948.0, 2150.0] Time: 40.02729535102844
The whole process took 47.152775287628174 seconds
