Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=14, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9999.11944665424 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1310604584.1118646 1310604584.1118646
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 14 20
Intermediate:  0.19140625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 6116.125 6311.35107421875 12623.9375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 14
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.32140064239501953
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.642948865890503
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 2.9647693634033203
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.512641429901123 seconds
Streaming imagenet data took 3.5852723121643066 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4123556613922119
Time for copying to cuda: 0.04969668388366699
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1510.0, 234.0] Time: 4.318566799163818
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1510.0, 750.0] Time: 5.685708999633789
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.5133650302886963 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Streaming imagenet data took 3.6724562644958496 seconds
Memory occupied: [1510.0, 1272.0] Time: 7.329133033752441
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 79, 62']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 63, 50']
Memory occupied: [4534.0, 4452.0] Time: 8.736979961395264
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 81, 53']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 83, 48']
Memory occupied: [6496.0, 4250.0] Time: 10.1486074924469
Time for forward pass: 6.831770896911621
Time for backpropagation: 0.08060264587402344
GPU memory for training: 5.916075706481934                          

One training iteration takes: 7.4567389488220215 seconds
Index: 0
Then, training+dataloading take 7.457321643829346 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.5111086368560791
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.08632588386535645
Memory occupied: [2016.0, 3372.0] Time: 11.676110029220581
Time for forward pass: 0.4657747745513916
Time for backpropagation: 0.01228475570678711
GPU memory for training: 2.4368205070495605                          

One training iteration takes: 1.176013708114624 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 13.082093954086304
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 14.502347469329834
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.6516003608703613 seconds
Streaming imagenet data took 3.7246811389923096 seconds
Then, training+dataloading take 3.734555244445801 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44004201889038086
Time for copying to cuda: 0.04889178276062012
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 79, 55']
Time for forward pass: 0.5226774215698242
Time for backpropagation: 0.012418746948242188
GPU memory for training: 2.4373278617858887                          

GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 92']
One training iteration takes: 1.149108648300171 seconds
Index: 2
Memory occupied: [10168.0, 3388.0] Time: 15.9367516040802
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 17.352844715118408
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.374680280685425 seconds
Streaming imagenet data took 3.4455084800720215 seconds
Then, training+dataloading take 3.4581518173217773 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.52596116065979
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.08631086349487305
Memory occupied: [10168.0, 3388.0] Time: 18.888282299041748
Time for forward pass: 0.5127015113830566
Time for backpropagation: 0.011207818984985352
GPU memory for training: 2.4373278617858887                          

One training iteration takes: 1.2362408638000488 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 20.30342721939087
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 200751121
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.57940411567688 seconds
Streaming imagenet data took 3.692711591720581 seconds
Then, training+dataloading take 3.7046875953674316 seconds
Memory occupied: [10168.0, 3388.0] Time: 21.950469970703125
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45548009872436523
Time for copying to cuda: 0.04873776435852051
Time for forward pass: 0.5405311584472656
Time for backpropagation: 0.011969566345214844
GPU memory for training: 2.4373278617858887                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 47, 49']
One training iteration takes: 1.185300588607788 seconds
Index: 4
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 23.41384196281433
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 24.83150815963745
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 26.25468373298645
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.663269281387329 seconds
Streaming imagenet data took 4.734350204467773 seconds
Then, training+dataloading take 4.745606899261475 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45397329330444336
Time for copying to cuda: 0.04883527755737305
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 48, 30']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 77']
Memory occupied: [10168.0, 3388.0] Time: 27.687199354171753
Time for forward pass: 0.5069544315338135
Time for backpropagation: 0.011247634887695312
GPU memory for training: 2.4373278617858887                          

One training iteration takes: 1.1231133937835693 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 29.10323715209961
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 30.519723415374756
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.681617021560669 seconds
Streaming imagenet data took 4.753309011459351 seconds
Then, training+dataloading take 4.760454416275024 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5118234157562256
Time for copying to cuda: 0.04880857467651367
Time for forward pass: 0.5639159679412842
Time for backpropagation: 0.011208057403564453
GPU memory for training: 2.4373278617858887                          

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
One training iteration takes: 1.2667860984802246 seconds
Index: 6
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 33.00757932662964
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 34.43296670913696
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10168.0, 3388.0] Time: 35.86472797393799
Length of received data: 200751121
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.752997636795044 seconds
Streaming imagenet data took 4.824024677276611 seconds
Then, training+dataloading take 4.83071756362915 seconds

Epoch: 0
Time of next(dataloader) is: 0.4496901035308838
Time for copying to cuda: 0.048638343811035156
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 79, 56']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 78']
Memory occupied: [10168.0, 3388.0] Time: 37.29103064537048
Time for forward pass: 0.5234074592590332
Time for backpropagation: 0.011384248733520508
GPU memory for training: 2.4373278617858887                          

The whole process took 44.43330430984497 seconds
