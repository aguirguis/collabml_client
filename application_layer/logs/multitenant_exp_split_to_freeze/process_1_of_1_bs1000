Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 16706.126236306576 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 2189705378.0451756 1505280000.0
All candidates indexes:  (array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 17
Intermediate:  0.015625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 350.46142578125 635.2001953125 2386.10595703125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Using split index: 17
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.3268957138061523 seconds
Streaming imagenet data took 1.3333673477172852 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28751087188720703
Time for copying to cuda: 0.004820823669433594
Memory occpied: (1530.0, 420.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.349729299545288 seconds
Streaming imagenet data took 1.3716156482696533 seconds
Memory occpied: (1530.0, 824.0)
Time for forward pass: 3.2133030891418457
Memory occpied: (1530.0, 1536.0)
Time for backpropagation: 0.05116462707519531
GPU memory for training: 0.9570660591125488                          

One training iteration takes: 3.6303963661193848 seconds
Index: 0
Then, training+dataloading take 3.630467653274536 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3060126304626465
Time for copying to cuda: 0.0045168399810791016
Time for forward pass: 0.03235173225402832
Time for backpropagation: 0.003440380096435547
GPU memory for training: 1.1122322082519531                          

One training iteration takes: 0.4298865795135498 seconds
Index: 1
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2849922180175781 seconds
Streaming imagenet data took 1.291560411453247 seconds
Then, training+dataloading take 1.2921137809753418 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31322360038757324
Time for copying to cuda: 0.004361629486083984
Time for forward pass: 0.031063079833984375
Time for backpropagation: 0.0026025772094726562
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4359602928161621 seconds
Index: 2
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.3058102130889893 seconds
Streaming imagenet data took 1.3123970031738281 seconds
Then, training+dataloading take 1.3129966259002686 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3081519603729248
Time for copying to cuda: 0.004410982131958008
Time for forward pass: 0.03105449676513672
Time for backpropagation: 0.0026874542236328125
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4371981620788574 seconds
Index: 3
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.3100190162658691 seconds
Streaming imagenet data took 1.3167774677276611 seconds
Then, training+dataloading take 1.3173596858978271 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31268930435180664
Time for copying to cuda: 0.0043451786041259766
Time for forward pass: 0.031064987182617188
Time for backpropagation: 0.002631664276123047
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4274559020996094 seconds
Index: 4
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.1606664657592773 seconds
Streaming imagenet data took 1.1648380756378174 seconds
Then, training+dataloading take 1.165419340133667 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.307706356048584
Time for copying to cuda: 0.004334926605224609
Time for forward pass: 0.031090497970581055
Time for backpropagation: 0.0026302337646484375
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.42890334129333496 seconds
Index: 5
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.1590237617492676 seconds
Streaming imagenet data took 1.1632814407348633 seconds
Then, training+dataloading take 1.1638550758361816 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31526851654052734
Time for copying to cuda: 0.004463672637939453
Time for forward pass: 0.03118157386779785
Time for backpropagation: 0.0026998519897460938
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.42702746391296387 seconds
Index: 6
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2886571884155273 seconds
Streaming imagenet data took 1.2929003238677979 seconds
Then, training+dataloading take 1.2934935092926025 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31725502014160156
Time for copying to cuda: 0.0044438838958740234
Time for forward pass: 0.031223773956298828
Time for backpropagation: 0.0027403831481933594
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.44663071632385254 seconds
Index: 7
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.198540210723877 seconds
Streaming imagenet data took 1.2026755809783936 seconds
Then, training+dataloading take 1.2032368183135986 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32469677925109863
Time for copying to cuda: 0.004439353942871094
Time for forward pass: 0.031024456024169922
Time for backpropagation: 0.0025975704193115234
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.43897533416748047 seconds
Index: 8
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2711141109466553 seconds
Streaming imagenet data took 1.2752785682678223 seconds
Then, training+dataloading take 1.2758574485778809 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31955981254577637
Time for copying to cuda: 0.004357099533081055
Time for forward pass: 0.03106999397277832
Time for backpropagation: 0.0026204586029052734
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.44666004180908203 seconds
Index: 9
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.276097059249878 seconds
Streaming imagenet data took 1.2804417610168457 seconds
Then, training+dataloading take 1.2810449600219727 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31682872772216797
Time for copying to cuda: 0.0392608642578125
Time for forward pass: 0.031650543212890625
Time for backpropagation: 0.0033550262451171875
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4662909507751465 seconds
Index: 10
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.233917236328125 seconds
Streaming imagenet data took 1.2381196022033691 seconds
Then, training+dataloading take 1.2386901378631592 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35098934173583984
Time for copying to cuda: 0.00452423095703125
Time for forward pass: 0.03140425682067871
Time for backpropagation: 0.0028922557830810547
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.47484397888183594 seconds
Index: 11
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2720894813537598 seconds
Streaming imagenet data took 1.2763245105743408 seconds
Then, training+dataloading take 1.2768778800964355 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3514401912689209
Time for copying to cuda: 0.00442051887512207
Time for forward pass: 0.05802583694458008
Time for backpropagation: 0.002878904342651367
GPU memory for training: 1.1125984191894531                          

Memory occpied: (2270.0, 1688.0)
One training iteration takes: 0.4949829578399658 seconds
Index: 12
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.149519681930542 seconds
Streaming imagenet data took 1.1537859439849854 seconds
Then, training+dataloading take 1.154296636581421 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3139536380767822
Time for copying to cuda: 0.004433393478393555
Time for forward pass: 0.04756975173950195
Time for backpropagation: 0.0032112598419189453
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.46405649185180664 seconds
Index: 13
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.167405128479004 seconds
Streaming imagenet data took 1.1716859340667725 seconds
Then, training+dataloading take 1.172215461730957 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3129427433013916
Time for copying to cuda: 0.004392862319946289
Time for forward pass: 0.031172752380371094
Time for backpropagation: 0.03960919380187988
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.48827290534973145 seconds
Index: 14
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2843918800354004 seconds
Streaming imagenet data took 1.2886347770690918 seconds
Then, training+dataloading take 1.289180040359497 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.327319860458374
Time for copying to cuda: 0.0044171810150146484
Time for forward pass: 0.03133869171142578
Time for backpropagation: 0.0028731822967529297
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.44324755668640137 seconds
Index: 15
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.1585614681243896 seconds
Streaming imagenet data took 1.1626689434051514 seconds
Then, training+dataloading take 1.1632080078125 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31645631790161133
Time for copying to cuda: 0.004297018051147461
Time for forward pass: 0.05062246322631836
Time for backpropagation: 0.003156900405883789
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.47205233573913574 seconds
Index: 16
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2580196857452393 seconds
Streaming imagenet data took 1.2621898651123047 seconds
Then, training+dataloading take 1.2627124786376953 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3312344551086426
Time for copying to cuda: 0.004456758499145508
Time for forward pass: 0.0313420295715332
Time for backpropagation: 0.002910137176513672
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4578056335449219 seconds
Index: 17
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.3973090648651123 seconds
Streaming imagenet data took 1.4014866352081299 seconds
Then, training+dataloading take 1.40201997756958 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34662938117980957
Time for copying to cuda: 0.004387855529785156
Time for forward pass: 0.031084299087524414
Time for backpropagation: 0.002611875534057617
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4978182315826416 seconds
Index: 18
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.143958330154419 seconds
Streaming imagenet data took 1.1481521129608154 seconds
Then, training+dataloading take 1.148684024810791 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31484007835388184
Time for copying to cuda: 0.004396677017211914
Time for forward pass: 0.031172752380371094
Time for backpropagation: 0.002748250961303711
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.44497132301330566 seconds
Index: 19
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2678046226501465 seconds
Streaming imagenet data took 1.2719902992248535 seconds
Then, training+dataloading take 1.2725515365600586 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31233859062194824
Time for copying to cuda: 0.004342079162597656
Time for forward pass: 0.04919552803039551
Time for backpropagation: 0.0031728744506835938
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4640660285949707 seconds
Index: 20
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.163949966430664 seconds
Streaming imagenet data took 1.168215036392212 seconds
Then, training+dataloading take 1.1687676906585693 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3143808841705322
Time for copying to cuda: 0.004438161849975586
Time for forward pass: 0.03114461898803711
Time for backpropagation: 0.002661466598510742
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4663240909576416 seconds
Index: 21
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.159294605255127 seconds
Streaming imagenet data took 1.1634600162506104 seconds
Then, training+dataloading take 1.1640198230743408 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.311931848526001
Time for copying to cuda: 0.004400730133056641
Time for forward pass: 0.03116774559020996
Time for backpropagation: 0.0027132034301757812
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.44475317001342773 seconds
Index: 22
Memory occpied: (2270.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2709596157073975 seconds
Streaming imagenet data took 1.2751972675323486 seconds
Then, training+dataloading take 1.275780200958252 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3091554641723633
Time for copying to cuda: 0.004370689392089844
Time for forward pass: 0.0467679500579834
Time for backpropagation: 0.0033736228942871094
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4609689712524414 seconds
Index: 23
Memory occpied: (2270.0, 1688.0)
Read 5.01116943359375 MBs for this batch
Executing all posts took 0.5288650989532471 seconds
Streaming imagenet data took 0.5312268733978271 seconds
Then, training+dataloading take 0.5315780639648438 seconds

Epoch: 0
Time of next(dataloader) is: 0.29723405838012695
Time for copying to cuda: 0.001634359359741211
Time for forward pass: 0.025908946990966797
Time for backpropagation: 0.0026655197143554688
GPU memory for training: 1.0834174156188965                          

The whole process took 40.211116313934326 seconds
