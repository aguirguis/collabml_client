Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.33046315622 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119056690.46681207 119056690.46681207
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 440.30517578125 725.0439453125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 440.30517578125 725.0439453125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 20.3331618309021 seconds
Streaming imagenet data took 20.34699511528015 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31333398818969727
Time for copying to cuda: 0.010080814361572266
Memory occpied: (1550.0, 250.0)
Memory occpied: (1550.0, 710.0)
Memory occpied: (1550.0, 1130.0)
Time for forward pass: 3.2798209190368652
Time for backpropagation: 0.049365997314453125
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.7372336387634277 seconds
Index: 0
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Memory occpied: (2064.0, 1570.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 18.790671348571777 seconds
Streaming imagenet data took 18.84599781036377 seconds
Then, training+dataloading take 18.85025143623352 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4126613140106201
Time for copying to cuda: 0.009487152099609375
Time for forward pass: 0.049729347229003906
Time for backpropagation: 0.003421783447265625
GPU memory for training: 1.1635355949401855                          

Memory occpied: (2064.0, 1570.0)
One training iteration takes: 0.5648050308227539 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 18.860103130340576 seconds
Streaming imagenet data took 18.87385654449463 seconds
Then, training+dataloading take 18.876510858535767 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37799549102783203
Time for copying to cuda: 0.009431123733520508
Time for forward pass: 0.049298763275146484
Time for backpropagation: 0.002803325653076172
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5416052341461182 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 18.667339324951172 seconds
Streaming imagenet data took 18.681320905685425 seconds
Then, training+dataloading take 18.683775901794434 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36191797256469727
Time for copying to cuda: 0.009526252746582031
Time for forward pass: 0.049471378326416016
Time for backpropagation: 0.0027222633361816406
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.526867151260376 seconds
Index: 3
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 18.80827808380127 seconds
Streaming imagenet data took 18.863537311553955 seconds
Then, training+dataloading take 18.867892742156982 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3804957866668701
Time for copying to cuda: 0.009473323822021484
Time for forward pass: 0.04938912391662598
Time for backpropagation: 0.0026552677154541016
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5440256595611572 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 18.711615324020386 seconds
Streaming imagenet data took 18.725276470184326 seconds
Then, training+dataloading take 18.72780990600586 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37497782707214355
Time for copying to cuda: 0.009357213973999023
Time for forward pass: 0.049439430236816406
Time for backpropagation: 0.002704143524169922
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5354301929473877 seconds
Index: 5
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 18.799391508102417 seconds
Streaming imagenet data took 18.81329345703125 seconds
Then, training+dataloading take 18.81573486328125 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4066965579986572
Time for copying to cuda: 0.009412050247192383
Time for forward pass: 0.04937100410461426
Time for backpropagation: 0.0026702880859375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5832538604736328 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 18.066805362701416 seconds
Streaming imagenet data took 18.08065629005432 seconds
Then, training+dataloading take 18.083147048950195 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36092472076416016
Time for copying to cuda: 0.009489774703979492
Time for forward pass: 0.04945015907287598
Time for backpropagation: 0.0026824474334716797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5001435279846191 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.3250906467437744 seconds
Streaming imagenet data took 2.3391315937042236 seconds
Then, training+dataloading take 2.34165358543396 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3807334899902344
Time for copying to cuda: 0.009444952011108398
Time for forward pass: 0.0494539737701416
Time for backpropagation: 0.0027618408203125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5372104644775391 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.3432371616363525 seconds
Streaming imagenet data took 2.356994867324829 seconds
Then, training+dataloading take 2.3594954013824463 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3782782554626465
Time for copying to cuda: 0.009472846984863281
Time for forward pass: 0.04941534996032715
Time for backpropagation: 0.002643585205078125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5263552665710449 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.4054343700408936 seconds
Streaming imagenet data took 2.4194726943969727 seconds
Then, training+dataloading take 2.4219915866851807 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38206028938293457
Time for copying to cuda: 0.009451627731323242
Time for forward pass: 0.04952716827392578
Time for backpropagation: 0.002652883529663086
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5389325618743896 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.34318208694458 seconds
Streaming imagenet data took 2.356994152069092 seconds
Then, training+dataloading take 2.3595030307769775 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36884427070617676
Time for copying to cuda: 0.009439945220947266
Time for forward pass: 0.049460411071777344
Time for backpropagation: 0.002698659896850586
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5168671607971191 seconds
Index: 11
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.413264274597168 seconds
Streaming imagenet data took 2.4272570610046387 seconds
Then, training+dataloading take 2.4297895431518555 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35817813873291016
Time for copying to cuda: 0.009500503540039062
Time for forward pass: 0.049341440200805664
Time for backpropagation: 0.002642393112182617
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5139226913452148 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.3399691581726074 seconds
Streaming imagenet data took 2.354229688644409 seconds
Then, training+dataloading take 2.356738567352295 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35814523696899414
Time for copying to cuda: 0.009408712387084961
Time for forward pass: 0.04932236671447754
Time for backpropagation: 0.0026047229766845703
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5123786926269531 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.3677375316619873 seconds
Streaming imagenet data took 2.3815393447875977 seconds
Then, training+dataloading take 2.384049654006958 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35861659049987793
Time for copying to cuda: 0.009390115737915039
Time for forward pass: 0.0493474006652832
Time for backpropagation: 0.002599477767944336
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.507986307144165 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.345529556274414 seconds
Memory occpied: (2290.0, 1578.0)
Streaming imagenet data took 2.359607458114624 seconds
Then, training+dataloading take 2.3620569705963135 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3636813163757324
Time for copying to cuda: 0.009661436080932617
Time for forward pass: 0.04949188232421875
Time for backpropagation: 0.002767801284790039
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5148158073425293 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.333061456680298 seconds
Streaming imagenet data took 2.387935161590576 seconds
Then, training+dataloading take 2.392371654510498 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3597135543823242
Time for copying to cuda: 0.009607553482055664
Time for forward pass: 0.0494847297668457
Time for backpropagation: 0.002688884735107422
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5163602828979492 seconds
Index: 16
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.2640397548675537 seconds
Streaming imagenet data took 2.2782859802246094 seconds
Then, training+dataloading take 2.2810912132263184 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40429210662841797
Time for copying to cuda: 0.009599447250366211
Time for forward pass: 0.04952716827392578
Time for backpropagation: 0.0027265548706054688
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5755946636199951 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.387890577316284 seconds
Streaming imagenet data took 2.4020495414733887 seconds
Then, training+dataloading take 2.404785394668579 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3779633045196533
Time for copying to cuda: 0.009528160095214844
Time for forward pass: 0.04945945739746094
Time for backpropagation: 0.0026640892028808594
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5343410968780518 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.3861074447631836 seconds
Streaming imagenet data took 2.4000673294067383 seconds
Then, training+dataloading take 2.402606725692749 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3660597801208496
Time for copying to cuda: 0.009516239166259766
Time for forward pass: 0.04941225051879883
Time for backpropagation: 0.0028433799743652344
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5323469638824463 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.4854543209075928 seconds
Streaming imagenet data took 2.4992294311523438 seconds
Then, training+dataloading take 2.501877546310425 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38875246047973633
Time for copying to cuda: 0.009524345397949219
Time for forward pass: 0.061319828033447266
Time for backpropagation: 0.0030927658081054688
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5711736679077148 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.1990418434143066 seconds
Streaming imagenet data took 2.2131762504577637 seconds
Then, training+dataloading take 2.2157905101776123 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37662196159362793
Time for copying to cuda: 0.009471416473388672
Time for forward pass: 0.049260854721069336
Time for backpropagation: 0.002604246139526367
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5208027362823486 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.369439125061035 seconds
Streaming imagenet data took 2.383514881134033 seconds
Then, training+dataloading take 2.38612699508667 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3864884376525879
Time for copying to cuda: 0.009561300277709961
Time for forward pass: 0.04938697814941406
Time for backpropagation: 0.002604961395263672
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5361402034759521 seconds
Index: 22
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.36055064201355 seconds
Streaming imagenet data took 2.374727964401245 seconds
Then, training+dataloading take 2.377410888671875 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3782806396484375
Time for copying to cuda: 0.009588479995727539
Time for forward pass: 0.049439430236816406
Time for backpropagation: 0.002670764923095703
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5334820747375488 seconds
Index: 23
Memory occpied: (2290.0, 1578.0)
Read 11.263076782226562 MBs for this batch
Executing all posts took 1.4734230041503906 seconds
Streaming imagenet data took 1.4785668849945068 seconds
Then, training+dataloading take 1.479219675064087 seconds

Epoch: 0
Time of next(dataloader) is: 0.35219311714172363
Time for copying to cuda: 0.0033566951751708984
Time for forward pass: 0.0325474739074707
Time for backpropagation: 0.0026106834411621094
GPU memory for training: 1.0986590385437012                          

The whole process took 197.69737124443054 seconds
