Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Decompress data took 0.14873862266540527 seconds
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Total decompress data took 2.995738983154297 seconds
Decompress data took 0.10339832305908203 seconds
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Total decompress data took 2.832648992538452 seconds
Decompress data took 0.10367727279663086 seconds
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Total decompress data took 2.83418607711792 seconds
Decompress data took 0.10206341743469238 seconds
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Total decompress data took 2.8434245586395264 seconds
Decompress data took 0.10271120071411133 seconds
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Total decompress data took 2.9272689819335938 seconds
Decompress data took 0.10266900062561035 seconds
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Total decompress data took 2.9487788677215576 seconds
Decompress data took 0.10424637794494629 seconds
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Total decompress data took 2.954385280609131 seconds
Decompress data took 0.10149550437927246 seconds
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Total decompress data took 2.9133403301239014 seconds
Read 1231.3178148269653 MBs for this batch
Memory occpied: (1494.0, 3.0)
Streaming imagenet data took 35.93353056907654 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 3.341073513031006
Time for copying to cuda: 1.2791688442230225
Decompress data took 0.10260462760925293 seconds
Total decompress data took 2.7065601348876953 seconds
Decompress data took 0.10169029235839844 seconds
Total decompress data took 2.5971460342407227 seconds
Decompress data took 0.10353422164916992 seconds
Total decompress data took 2.644294023513794 seconds
Decompress data took 0.10239529609680176 seconds
Total decompress data took 2.622288703918457 seconds
Decompress data took 0.10277414321899414 seconds
Time for forward pass: 17.231809854507446
Time for backpropagation: 0.292888879776001
GPU memory for training: 19.97019052505493                          

One training iteration takes: 22.845917224884033 seconds
Index: 0
Memory occpied: (1494.0, 6760.0)
Total decompress data took 3.205265998840332 seconds
Decompress data took 0.10599017143249512 seconds
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Total decompress data took 2.983809471130371 seconds
Decompress data took 0.1160125732421875 seconds
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Total decompress data took 3.0203492641448975 seconds
Decompress data took 0.10709285736083984 seconds
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Total decompress data took 3.0124127864837646 seconds
Read 1233.9197416305542 MBs for this batch
Memory occpied: (14514.0, 6760.0)
Streaming imagenet data took 34.51407480239868 seconds
Memory occpied: (14514.0, 6760.0)
Then, training+dataloading take 34.602675676345825 seconds
The mode is:  vanilla
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Time of next(dataloader) is: 3.455005645751953
Memory occpied: (14514.0, 6760.0)
Time for copying to cuda: 1.3855433464050293
Time for forward pass: 0.0302126407623291
Time for backpropagation: 0.004896402359008789
GPU memory for training: 20.09377908706665                          

One training iteration takes: 5.499114990234375 seconds
Index: 1
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Decompress data took 0.10258626937866211 seconds
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Total decompress data took 3.004607915878296 seconds
Decompress data took 0.11196088790893555 seconds
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Total decompress data took 2.900834083557129 seconds
Decompress data took 0.10478353500366211 seconds
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Total decompress data took 2.933614492416382 seconds
Decompress data took 0.1071932315826416 seconds
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Total decompress data took 2.941567897796631 seconds
Decompress data took 0.10391402244567871 seconds
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Total decompress data took 3.027132987976074 seconds
Decompress data took 0.10674118995666504 seconds
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Total decompress data took 3.078272819519043 seconds
Decompress data took 0.10515093803405762 seconds
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Total decompress data took 2.9709010124206543 seconds
Decompress data took 0.10492300987243652 seconds
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Total decompress data took 2.976849317550659 seconds
Read 1228.6364126205444 MBs for this batch
Memory occpied: (14522.0, 14026.0)
Streaming imagenet data took 36.83154296875 seconds
Then, training+dataloading take 36.934903383255005 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Decompress data took 0.04103541374206543 seconds
Total decompress data took 0.8859362602233887 seconds
Read 49.485840797424316 MBs for this batch
Streaming imagenet data took 1.9996552467346191 seconds
Time of next(dataloader) is: 3.415756940841675
Time for copying to cuda: 1.1562423706054688
Time for forward pass: 0.005371570587158203
Time for backpropagation: 0.0026040077209472656
GPU memory for training: 20.09377908706665                          

One training iteration takes: 5.2285473346710205 seconds
Index: 2
Then, training+dataloading take 5.238571643829346 seconds

Epoch: 0
Memory occpied: (14522.0, 14026.0)
Time of next(dataloader) is: 0.6535284519195557
Time for copying to cuda: 0.25863194465637207
Memory occpied: (5470.0, 3812.0)
Time for forward pass: 0.5898325443267822
Time for backpropagation: 0.002768278121948242
GPU memory for training: 2.636568069458008                          

The whole process took 120.19951891899109 seconds
