Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5433200526157 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119084590.04593645 119084590.04593645
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.4425790309906006 seconds
Streaming imagenet data took 2.4699723720550537 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.23721075057983398
Time for copying to cuda: 0.01866912841796875
Memory occpied: (1586.0, 380.0)
Memory occpied: (1586.0, 778.0)
Memory occpied: (1586.0, 1188.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.358546018600464 seconds
Streaming imagenet data took 3.3862948417663574 seconds
Time for forward pass: 3.3130605220794678
Time for backpropagation: 0.049004316329956055
GPU memory for training: 1.102445125579834                          

One training iteration takes: 3.677936315536499 seconds
Index: 0
Then, training+dataloading take 3.6781890392303467 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2518892288208008
Time for copying to cuda: 0.018002033233642578
Time for forward pass: 0.07527613639831543
Time for backpropagation: 0.003334522247314453
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.41400623321533203 seconds
Index: 1
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 5.064621210098267 seconds
Streaming imagenet data took 5.092374563217163 seconds
Then, training+dataloading take 5.097457647323608 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2898445129394531
Time for copying to cuda: 0.017864465713500977
Time for forward pass: 0.07529377937316895
Time for backpropagation: 0.002588987350463867
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4741020202636719 seconds
Index: 2
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.308713436126709 seconds
Streaming imagenet data took 9.336784362792969 seconds
Then, training+dataloading take 9.341026306152344 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31872105598449707
Time for copying to cuda: 0.01807689666748047
Memory occpied: (2326.0, 1632.0)
Time for forward pass: 0.0755012035369873
Time for backpropagation: 0.0025708675384521484
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.48256969451904297 seconds
Index: 3
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.6239309310913086 seconds
Streaming imagenet data took 3.651923894882202 seconds
Then, training+dataloading take 3.6545207500457764 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29469990730285645
Time for copying to cuda: 0.017961502075195312
Time for forward pass: 0.07538080215454102
Time for backpropagation: 0.002624988555908203
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4801144599914551 seconds
Index: 4
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 7.872761964797974 seconds
Streaming imagenet data took 7.90002965927124 seconds
Then, training+dataloading take 7.903559684753418 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26891350746154785
Time for copying to cuda: 0.01797008514404297
Time for forward pass: 0.07529973983764648
Time for backpropagation: 0.0024995803833007812
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4307892322540283 seconds
Index: 5
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.389984369277954 seconds
Streaming imagenet data took 8.417383193969727 seconds
Then, training+dataloading take 8.421054363250732 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29202985763549805
Time for copying to cuda: 0.01790022850036621
Time for forward pass: 0.07531166076660156
Time for backpropagation: 0.002533435821533203
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.47759199142456055 seconds
Index: 6
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 7.778182506561279 seconds
Streaming imagenet data took 7.806376934051514 seconds
Then, training+dataloading take 7.810574293136597 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2681162357330322
Time for copying to cuda: 0.01789069175720215
Time for forward pass: 0.07559537887573242
Time for backpropagation: 0.002622365951538086
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4330015182495117 seconds
Index: 7
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.788689613342285 seconds
Streaming imagenet data took 8.81633710861206 seconds
Then, training+dataloading take 8.81960391998291 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.269500732421875
Time for copying to cuda: 0.017871618270874023
Time for forward pass: 0.07532668113708496
Time for backpropagation: 0.0024793148040771484
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4333200454711914 seconds
Index: 8
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.214708805084229 seconds
Streaming imagenet data took 8.241481304168701 seconds
Then, training+dataloading take 8.2447350025177 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2657132148742676
Time for copying to cuda: 0.01812291145324707
Time for forward pass: 0.07550811767578125
Time for backpropagation: 0.002641916275024414
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4302358627319336 seconds
Index: 9
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.0954811573028564 seconds
Streaming imagenet data took 4.122854471206665 seconds
Then, training+dataloading take 4.126563310623169 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2950625419616699
Time for copying to cuda: 0.01778411865234375
Time for forward pass: 0.07534170150756836
Time for backpropagation: 0.0027582645416259766
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4814915657043457 seconds
Index: 10
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.7615649700164795 seconds
Streaming imagenet data took 2.8156397342681885 seconds
Then, training+dataloading take 2.8219525814056396 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Memory occpied: (2326.0, 1632.0)
Time of next(dataloader) is: 0.2616453170776367
Time for copying to cuda: 0.01781606674194336
Time for forward pass: 0.0753028392791748
Time for backpropagation: 0.0025119781494140625
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.42671704292297363 seconds
Index: 11
Memory occpied: (2326.0, 1632.0)
Read 11.263076782226562 MBs for this batch
Executing all posts took 1.237644910812378 seconds
Streaming imagenet data took 1.2425057888031006 seconds
Then, training+dataloading take 1.2432270050048828 seconds

Epoch: 0
Time of next(dataloader) is: 0.22612476348876953
Time for copying to cuda: 0.0031061172485351562
Time for forward pass: 0.0323333740234375
Time for backpropagation: 0.0024428367614746094
GPU memory for training: 1.0984325408935547                          

The whole process took 81.0022029876709 seconds
