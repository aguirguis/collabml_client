Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.4767354829154 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 118944790.67321669 118944790.67321669
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.5583794116973877 seconds
Streaming imagenet data took 2.5853216648101807 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.24666929244995117
Time for copying to cuda: 0.019204139709472656
Memory occpied: (1586.0, 336.0)
Memory occpied: (1586.0, 716.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.6837267875671387 seconds
Streaming imagenet data took 2.7112133502960205 seconds
Memory occpied: (1586.0, 1114.0)
Time for forward pass: 3.3899619579315186
Time for backpropagation: 0.050078392028808594
GPU memory for training: 1.102445125579834                          

One training iteration takes: 3.761793851852417 seconds
Index: 0
Then, training+dataloading take 3.7620456218719482 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2724425792694092
Time for copying to cuda: 0.01875019073486328
Time for forward pass: 0.07537555694580078
Time for backpropagation: 0.0035066604614257812
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4334604740142822 seconds
Index: 1
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.7670798301696777 seconds
Streaming imagenet data took 2.8241138458251953 seconds
Then, training+dataloading take 2.8311355113983154 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Time of next(dataloader) is: 0.292370080947876
Time for copying to cuda: 0.018468141555786133
Time for forward pass: 0.07554960250854492
Time for backpropagation: 0.002671957015991211
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.46006226539611816 seconds
Index: 2
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.6892309188842773 seconds
Streaming imagenet data took 2.7171738147735596 seconds
Then, training+dataloading take 2.7219767570495605 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2817678451538086
Time for copying to cuda: 0.018297910690307617
Time for forward pass: 0.0753941535949707
Time for backpropagation: 0.002602100372314453
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4485204219818115 seconds
Index: 3
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.631305694580078 seconds
Streaming imagenet data took 2.658439874649048 seconds
Then, training+dataloading take 2.6620657444000244 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2856171131134033
Time for copying to cuda: 0.018403053283691406
Time for forward pass: 0.07596254348754883
Time for backpropagation: 0.002844572067260742
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.48186373710632324 seconds
Index: 4
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.5938260555267334 seconds
Streaming imagenet data took 2.621657609939575 seconds
Then, training+dataloading take 2.6252434253692627 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3148155212402344
Time for copying to cuda: 0.018487215042114258
Time for forward pass: 0.07541251182556152
Time for backpropagation: 0.002570629119873047
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.48776984214782715 seconds
Index: 5
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.594336986541748 seconds
Streaming imagenet data took 3.6216132640838623 seconds
Then, training+dataloading take 3.6252543926239014 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28909945487976074
Time for copying to cuda: 0.01863408088684082
Time for forward pass: 0.07796335220336914
Time for backpropagation: 0.002809762954711914
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.4608802795410156 seconds
Index: 6
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.248342514038086 seconds
Streaming imagenet data took 3.2754242420196533 seconds
Then, training+dataloading take 3.2788355350494385 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2884790897369385
Time for copying to cuda: 0.018596172332763672
Time for forward pass: 0.07548403739929199
Time for backpropagation: 0.002664327621459961
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4570424556732178 seconds
Index: 7
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.6030848026275635 seconds
Streaming imagenet data took 3.630411148071289 seconds
Then, training+dataloading take 3.6338651180267334 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29715681076049805
Time for copying to cuda: 0.018942832946777344
Time for forward pass: 0.07676029205322266
Time for backpropagation: 0.0032465457916259766
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.47226476669311523 seconds
Index: 8
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.8105826377868652 seconds
Streaming imagenet data took 2.8383119106292725 seconds
Then, training+dataloading take 2.842068672180176 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29363465309143066
Time for copying to cuda: 0.018463850021362305
Time for forward pass: 0.07553219795227051
Time for backpropagation: 0.002744436264038086
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4673624038696289 seconds
Index: 9
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.382923126220703 seconds
Streaming imagenet data took 2.4099717140197754 seconds
Then, training+dataloading take 2.414745807647705 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2921943664550781
Time for copying to cuda: 0.018298864364624023
Time for forward pass: 0.0754690170288086
Time for backpropagation: 0.002701997756958008
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4440293312072754 seconds
Index: 10
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.3124125003814697 seconds
Memory occpied: (2326.0, 1632.0)
Streaming imagenet data took 3.3396847248077393 seconds
Then, training+dataloading take 3.3444604873657227 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2882113456726074
Time for copying to cuda: 0.018585205078125
Time for forward pass: 0.07543015480041504
Time for backpropagation: 0.0026311874389648438
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.45435571670532227 seconds
Index: 11
Read 11.263076782226562 MBs for this batch
Executing all posts took 0.6351416110992432 seconds
Streaming imagenet data took 0.6406149864196777 seconds
Then, training+dataloading take 0.6412296295166016 seconds

Epoch: 0
Time of next(dataloader) is: 0.2514920234680176
Time for copying to cuda: 0.003274679183959961
Time for forward pass: 0.03231930732727051
Time for backpropagation: 0.0025632381439208984
GPU memory for training: 1.0984325408935547                          

Memory occpied: (2326.0, 1632.0)
The whole process took 45.07808566093445 seconds
