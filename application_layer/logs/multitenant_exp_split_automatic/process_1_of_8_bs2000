Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.8290834554645 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 118990973.62667464 118990973.62667464
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.019329786300659 seconds
Streaming imagenet data took 2.0469930171966553 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35242486000061035
Time for copying to cuda: 0.019263505935668945
Memory occpied: (1586.0, 36.0)
Memory occpied: (1586.0, 574.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.018867015838623 seconds
Streaming imagenet data took 2.0471208095550537 seconds
Memory occpied: (1586.0, 1020.0)
Time for forward pass: 3.297483205795288
Time for backpropagation: 0.049822092056274414
GPU memory for training: 1.102445125579834                          

One training iteration takes: 3.806520462036133 seconds
Index: 0
Then, training+dataloading take 3.8068251609802246 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4652070999145508
Time for copying to cuda: 0.019039154052734375
Time for forward pass: 0.07552790641784668
Time for backpropagation: 0.0037496089935302734
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6797640323638916 seconds
Index: 1
Memory occpied: (2100.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.58192777633667 seconds
Streaming imagenet data took 2.6092584133148193 seconds
Then, training+dataloading take 2.6158626079559326 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40010809898376465
Time for copying to cuda: 0.020967960357666016
Time for forward pass: 0.10899090766906738
Time for backpropagation: 0.0031366348266601562
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.6328778266906738 seconds
Index: 2
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.676988363265991 seconds
Streaming imagenet data took 2.7045528888702393 seconds
Then, training+dataloading take 2.7091925144195557 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4421658515930176
Time for copying to cuda: 0.018512725830078125
Time for forward pass: 0.0772547721862793
Time for backpropagation: 0.003339052200317383
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6667637825012207 seconds
Index: 3
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.1459619998931885 seconds
Streaming imagenet data took 2.1729202270507812 seconds
Then, training+dataloading take 2.1773641109466553 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43515443801879883
Time for copying to cuda: 0.01829838752746582
Time for forward pass: 0.07792305946350098
Time for backpropagation: 0.0027265548706054688
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6231076717376709 seconds
Index: 4
Memory occpied: (2665.0, 1632.0)
Memory occpied: (3109.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.530094861984253 seconds
Streaming imagenet data took 2.557184934616089 seconds
Then, training+dataloading take 2.559537410736084 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40196657180786133
Time for copying to cuda: 0.018245458602905273
Time for forward pass: 0.08290553092956543
Time for backpropagation: 0.0027971267700195312
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6106252670288086 seconds
Index: 5
Memory occpied: (3491.0, 1632.0)
Memory occpied: (3817.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.3956212997436523 seconds
Streaming imagenet data took 3.4226245880126953 seconds
Then, training+dataloading take 3.4271063804626465 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3962087631225586
Time for copying to cuda: 0.018508434295654297
Time for forward pass: 0.07559394836425781
Time for backpropagation: 0.002757549285888672
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5852475166320801 seconds
Index: 6
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3909.0, 1797.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.95389723777771 seconds
Streaming imagenet data took 3.9815096855163574 seconds
Then, training+dataloading take 3.985058307647705 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40916943550109863
Time for copying to cuda: 0.018193721771240234
Time for forward pass: 0.08232641220092773
Time for backpropagation: 0.0028700828552246094
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6220338344573975 seconds
Index: 7
Memory occpied: (3909.0, 2245.0)
Memory occpied: (3909.0, 2705.0)
Memory occpied: (4423.0, 3253.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.119601249694824 seconds
Streaming imagenet data took 4.146576166152954 seconds
Then, training+dataloading take 4.151278495788574 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44274115562438965
Time for copying to cuda: 0.018671035766601562
Time for forward pass: 0.0755455493927002
Time for backpropagation: 0.002712249755859375
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.677060604095459 seconds
Index: 8
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.089803218841553 seconds
Streaming imagenet data took 4.116927146911621 seconds
Then, training+dataloading take 4.1210315227508545 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47688841819763184
Time for copying to cuda: 0.01824355125427246
Time for forward pass: 0.06881880760192871
Time for backpropagation: 0.0026459693908691406
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6789846420288086 seconds
Index: 9
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 5.230119466781616 seconds
Streaming imagenet data took 5.257455348968506 seconds
Then, training+dataloading take 5.2615392208099365 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43587589263916016
Time for copying to cuda: 0.01854848861694336
Time for forward pass: 0.07546782493591309
Time for backpropagation: 0.0027055740356445312
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6526346206665039 seconds
Index: 10
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 6.403771162033081 seconds
Streaming imagenet data took 6.430898904800415 seconds
Then, training+dataloading take 6.435080289840698 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4504208564758301
Time for copying to cuda: 0.01836252212524414
Memory occpied: (4649.0, 3261.0)
Time for forward pass: 0.07553410530090332
Time for backpropagation: 0.0033478736877441406
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6537363529205322 seconds
Index: 11
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 11.263076782226562 MBs for this batch
Executing all posts took 3.7462475299835205 seconds
Streaming imagenet data took 3.751319169998169 seconds
Then, training+dataloading take 3.7519278526306152 seconds

Epoch: 0
Time of next(dataloader) is: 0.44498419761657715
Time for copying to cuda: 0.0033576488494873047
Time for forward pass: 0.0330045223236084
Time for backpropagation: 0.0029342174530029297
GPU memory for training: 1.0984325408935547                          

Memory occpied: (4649.0, 3261.0)
The whole process took 55.05782890319824 seconds
