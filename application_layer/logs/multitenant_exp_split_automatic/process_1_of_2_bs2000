Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2844697363528 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119050662.01728323 119050662.01728323
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.0311498641967773 seconds
Streaming imagenet data took 2.058436632156372 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39647889137268066
Time for copying to cuda: 0.01904582977294922
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9329774379730225 seconds
Streaming imagenet data took 1.9604711532592773 seconds
Time for forward pass: 3.019747257232666
Time for backpropagation: 0.05036664009094238
GPU memory for training: 1.102445125579834                          

One training iteration takes: 3.608271837234497 seconds
Index: 0
Then, training+dataloading take 3.6084868907928467 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (1514.0, 1624.0)
Time of next(dataloader) is: 0.3949100971221924
Time for copying to cuda: 0.018829345703125
Time for forward pass: 0.07546305656433105
Time for backpropagation: 0.003628969192504883
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5899267196655273 seconds
Index: 1
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.20516300201416 seconds
Streaming imagenet data took 2.2321670055389404 seconds
Then, training+dataloading take 2.236893892288208 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4475429058074951
Time for copying to cuda: 0.018471240997314453
Time for forward pass: 0.07558631896972656
Time for backpropagation: 0.0028564929962158203
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6590378284454346 seconds
Index: 2
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.231241226196289 seconds
Streaming imagenet data took 2.2586095333099365 seconds
Then, training+dataloading take 2.2642030715942383 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39467453956604004
Time for copying to cuda: 0.018668174743652344
Time for forward pass: 0.07558774948120117
Time for backpropagation: 0.002883434295654297
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5772414207458496 seconds
Index: 3
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.147878408432007 seconds
Memory occpied: (2326.0, 1632.0)
Streaming imagenet data took 2.1753427982330322 seconds
Then, training+dataloading take 2.1810531616210938 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3922762870788574
Time for copying to cuda: 0.01868891716003418
Time for forward pass: 0.07561826705932617
Time for backpropagation: 0.0028238296508789062
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5959415435791016 seconds
Index: 4
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.789719820022583 seconds
Streaming imagenet data took 2.8178720474243164 seconds
Then, training+dataloading take 2.823293685913086 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39141225814819336
Time for copying to cuda: 0.018563508987426758
Time for forward pass: 0.0755765438079834
Time for backpropagation: 0.002885103225708008
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5849976539611816 seconds
Index: 5
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.910339117050171 seconds
Streaming imagenet data took 2.938281536102295 seconds
Then, training+dataloading take 2.94352126121521 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4850804805755615
Time for copying to cuda: 0.018510818481445312
Time for forward pass: 0.0754392147064209
Time for backpropagation: 0.00305938720703125
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.6765115261077881 seconds
Index: 6
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.1072041988372803 seconds
Streaming imagenet data took 2.1354568004608154 seconds
Then, training+dataloading take 2.1407182216644287 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39662885665893555
Time for copying to cuda: 0.01845693588256836
Time for forward pass: 0.07566261291503906
Time for backpropagation: 0.003101825714111328
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.588646411895752 seconds
Index: 7
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.1658613681793213 seconds
Streaming imagenet data took 2.1934590339660645 seconds
Then, training+dataloading take 2.1987671852111816 seconds
Memory occpied: (2326.0, 1632.0)
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3958563804626465
Time for copying to cuda: 0.01878643035888672
Time for forward pass: 0.0755765438079834
Time for backpropagation: 0.003043651580810547
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5829997062683105 seconds
Index: 8
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.0971081256866455 seconds
Streaming imagenet data took 2.124577522277832 seconds
Then, training+dataloading take 2.129136800765991 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44446492195129395
Time for copying to cuda: 0.01860189437866211
Time for forward pass: 0.07564020156860352
Time for backpropagation: 0.0029544830322265625
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6705362796783447 seconds
Index: 9
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.1680257320404053 seconds
Streaming imagenet data took 2.19547438621521 seconds
Then, training+dataloading take 2.2000110149383545 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43182849884033203
Time for copying to cuda: 0.018615245819091797
Time for forward pass: 0.0755000114440918
Time for backpropagation: 0.002808809280395508
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6060395240783691 seconds
Index: 10
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9813828468322754 seconds
Streaming imagenet data took 2.0518674850463867 seconds
Then, training+dataloading take 2.059920072555542 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Memory occpied: (2326.0, 1632.0)
Time of next(dataloader) is: 0.5047860145568848
Time for copying to cuda: 0.018764257431030273
Time for forward pass: 0.07566022872924805
Time for backpropagation: 0.0029671192169189453
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6968886852264404 seconds
Index: 11
Read 11.263076782226562 MBs for this batch
Executing all posts took 1.261502742767334 seconds
Streaming imagenet data took 1.2666378021240234 seconds
Then, training+dataloading take 1.26753568649292 seconds

Epoch: 0
Time of next(dataloader) is: 0.40407299995422363
Time for copying to cuda: 0.0032923221588134766
Time for forward pass: 0.03260612487792969
Time for backpropagation: 0.002874612808227539
GPU memory for training: 1.0984325408935547                          

Memory occpied: (2326.0, 1632.0)
The whole process took 38.22070813179016 seconds
