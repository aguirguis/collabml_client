Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.1371124179345 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119031347.59884351 119031347.59884351
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  3837.0 1632.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Memory occpied: (3837.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 13.811415433883667 seconds
Streaming imagenet data took 13.83893084526062 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2786717414855957
Time for copying to cuda: 0.019048452377319336
Memory occpied: (3909.0, 1885.0)
Memory occpied: (3909.0, 2313.0)
Memory occpied: (3909.0, 2701.0)
Time for forward pass: 3.3155159950256348
Time for backpropagation: 0.04988980293273926
GPU memory for training: 1.102445125579834                          

One training iteration takes: 3.7312259674072266 seconds
Index: 0
Memory occpied: (4423.0, 3253.0)
Memory occpied: (4423.0, 3253.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 6.227534770965576 seconds
Streaming imagenet data took 6.254547595977783 seconds
Then, training+dataloading take 6.25860595703125 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28690004348754883
Time for copying to cuda: 0.018264055252075195
Time for forward pass: 0.07547736167907715
Time for backpropagation: 0.0037145614624023438
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4686553478240967 seconds
Index: 1
Memory occpied: (4423.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 6.7423460483551025 seconds
Streaming imagenet data took 6.769826650619507 seconds
Then, training+dataloading take 6.774230003356934 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2689979076385498
Time for copying to cuda: 0.018354415893554688
Time for forward pass: 0.07534241676330566
Time for backpropagation: 0.0025942325592041016
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.41721105575561523 seconds
Index: 2
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 6.839831113815308 seconds
Streaming imagenet data took 6.867194890975952 seconds
Then, training+dataloading take 6.870294809341431 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2685723304748535
Time for copying to cuda: 0.018130064010620117
Time for forward pass: 0.07556748390197754
Time for backpropagation: 0.0026814937591552734
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4313802719116211 seconds
Index: 3
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.6751463413238525 seconds
Streaming imagenet data took 4.702366590499878 seconds
Then, training+dataloading take 4.705206871032715 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26816892623901367
Time for copying to cuda: 0.0182187557220459
Time for forward pass: 0.0874781608581543
Time for backpropagation: 0.0030930042266845703
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4674046039581299 seconds
Index: 4
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.7438836097717285 seconds
Streaming imagenet data took 4.771101474761963 seconds
Then, training+dataloading take 4.77508020401001 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31148481369018555
Time for copying to cuda: 0.018367528915405273
Memory occpied: (4649.0, 3261.0)
Time for forward pass: 0.06882023811340332
Time for backpropagation: 0.002566099166870117
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.47383594512939453 seconds
Index: 5
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.9213616847991943 seconds
Streaming imagenet data took 3.948364734649658 seconds
Then, training+dataloading take 3.9523990154266357 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28348565101623535
Time for copying to cuda: 0.01846933364868164
Time for forward pass: 0.07537055015563965
Time for backpropagation: 0.002586841583251953
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.44544076919555664 seconds
Index: 6
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Memory occpied: (4649.0, 3261.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.107417583465576 seconds
Streaming imagenet data took 4.134436368942261 seconds
Then, training+dataloading take 4.138666868209839 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30031323432922363
Time for copying to cuda: 0.018472671508789062
Memory occpied: (4649.0, 3261.0)
Time for forward pass: 0.0755760669708252
Time for backpropagation: 0.0027527809143066406
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4679524898529053 seconds
Index: 7
Memory occpied: (4649.0, 3261.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.47283673286438 seconds
Streaming imagenet data took 4.50039529800415 seconds
Then, training+dataloading take 4.505115985870361 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2729332447052002
Time for copying to cuda: 0.045148611068725586
Time for forward pass: 0.07684636116027832
Time for backpropagation: 0.0030798912048339844
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.46764492988586426 seconds
Index: 8
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.4203338623046875 seconds
Streaming imagenet data took 2.44767427444458 seconds
Then, training+dataloading take 2.452329635620117 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2982301712036133
Memory occpied: (2326.0, 1632.0)
Time for copying to cuda: 0.019524574279785156
Time for forward pass: 0.07551217079162598
Time for backpropagation: 0.0030362606048583984
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.473325252532959 seconds
Index: 9
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.397735357284546 seconds
Streaming imagenet data took 2.424757957458496 seconds
Then, training+dataloading take 2.429464817047119 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32358336448669434
Time for copying to cuda: 0.019484519958496094
Time for forward pass: 0.07541346549987793
Time for backpropagation: 0.002821683883666992
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.4975316524505615 seconds
Index: 10
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.05153751373291 seconds
Streaming imagenet data took 2.0789928436279297 seconds
Then, training+dataloading take 2.0848135948181152 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.27321434020996094
Time for copying to cuda: 0.01954197883605957
Time for forward pass: 0.07566571235656738
Time for backpropagation: 0.0029211044311523438
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4396374225616455 seconds
Index: 11
Read 11.263076782226562 MBs for this batch
Executing all posts took 0.6551535129547119 seconds
Streaming imagenet data took 0.6634211540222168 seconds
Then, training+dataloading take 0.664076566696167 seconds

Epoch: 0
Memory occpied: (2326.0, 1632.0)
Time of next(dataloader) is: 0.23001980781555176
Time for copying to cuda: 0.0033740997314453125
Time for forward pass: 0.031174421310424805
Time for backpropagation: 0.002635478973388672
GPU memory for training: 1.0984325408935547                          

The whole process took 69.91165375709534 seconds
