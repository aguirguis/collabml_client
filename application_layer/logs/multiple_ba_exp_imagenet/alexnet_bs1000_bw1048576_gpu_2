Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.3653103613251 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118930185.9596796 118930185.9596796
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6948065757751465 seconds
Streaming imagenet data took 1.7085447311401367 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32103514671325684
Time for copying to cuda: 0.010135412216186523
Memory occpied: (1550.0, 236.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5277297496795654 seconds
Streaming imagenet data took 1.5417988300323486 seconds
Memory occpied: (1550.0, 660.0)
Memory occpied: (1550.0, 1110.0)
Time for forward pass: 3.2237260341644287
Time for backpropagation: 0.05158853530883789
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.6805927753448486 seconds
Index: 0
Then, training+dataloading take 3.6808133125305176 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3317279815673828
Time for copying to cuda: 0.009516477584838867
Time for forward pass: 0.04995989799499512
Time for backpropagation: 0.003439188003540039
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.5018835067749023 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6145858764648438 seconds
Streaming imagenet data took 1.6284966468811035 seconds
Then, training+dataloading take 1.630728006362915 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3720371723175049
Time for copying to cuda: 0.009547233581542969
Time for forward pass: 0.04926252365112305
Time for backpropagation: 0.002828836441040039
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5298607349395752 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4916841983795166 seconds
Streaming imagenet data took 1.5056262016296387 seconds
Then, training+dataloading take 1.507901668548584 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38103818893432617
Time for copying to cuda: 0.009299516677856445
Time for forward pass: 0.049329280853271484
Time for backpropagation: 0.0025904178619384766
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5646898746490479 seconds
Index: 3
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4722604751586914 seconds
Streaming imagenet data took 1.4861030578613281 seconds
Then, training+dataloading take 1.4883463382720947 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3718142509460449
Time for copying to cuda: 0.009348154067993164
Time for forward pass: 0.04924178123474121
Time for backpropagation: 0.0026297569274902344
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5323381423950195 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.503206491470337 seconds
Streaming imagenet data took 1.5170009136199951 seconds
Then, training+dataloading take 1.5193040370941162 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37301063537597656
Time for copying to cuda: 0.009424448013305664
Time for forward pass: 0.04922032356262207
Time for backpropagation: 0.0025720596313476562
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5496587753295898 seconds
Index: 5
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.534367561340332 seconds
Streaming imagenet data took 1.5480694770812988 seconds
Then, training+dataloading take 1.550328016281128 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37178921699523926
Time for copying to cuda: 0.009430646896362305
Time for forward pass: 0.04926919937133789
Time for backpropagation: 0.002519369125366211
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5308613777160645 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5074617862701416 seconds
Streaming imagenet data took 1.5215396881103516 seconds
Then, training+dataloading take 1.5238511562347412 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3712468147277832
Time for copying to cuda: 0.009453296661376953
Time for forward pass: 0.04939413070678711
Time for backpropagation: 0.002645254135131836
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5393328666687012 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4884142875671387 seconds
Streaming imagenet data took 1.502255916595459 seconds
Then, training+dataloading take 1.5045373439788818 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4167616367340088
Time for copying to cuda: 0.009395599365234375
Time for forward pass: 0.04930543899536133
Time for backpropagation: 0.0026683807373046875
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5641684532165527 seconds
Index: 8
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5741419792175293 seconds
Streaming imagenet data took 1.5890610218048096 seconds
Then, training+dataloading take 1.5905976295471191 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.33264589309692383
Time for copying to cuda: 0.00937795639038086
Time for forward pass: 0.049254655838012695
Time for backpropagation: 0.002549886703491211
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48369646072387695 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5239601135253906 seconds
Streaming imagenet data took 1.5379772186279297 seconds
Then, training+dataloading take 1.540480613708496 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3328092098236084
Time for copying to cuda: 0.009358406066894531
Time for forward pass: 0.04933023452758789
Time for backpropagation: 0.002674102783203125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4706113338470459 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5055670738220215 seconds
Streaming imagenet data took 1.519258975982666 seconds
Then, training+dataloading take 1.5216634273529053 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3337283134460449
Time for copying to cuda: 0.009263038635253906
Time for forward pass: 0.049230337142944336
Time for backpropagation: 0.002579212188720703
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48357129096984863 seconds
Index: 11
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4923968315124512 seconds
Streaming imagenet data took 1.5062263011932373 seconds
Then, training+dataloading take 1.508638858795166 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.386080265045166
Time for copying to cuda: 0.009338855743408203
Time for forward pass: 0.04933500289916992
Time for backpropagation: 0.002572298049926758
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.546788215637207 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4930877685546875 seconds
Streaming imagenet data took 1.506746768951416 seconds
Then, training+dataloading take 1.5091497898101807 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.374316930770874
Time for copying to cuda: 0.00937509536743164
Time for forward pass: 0.0493776798248291
Time for backpropagation: 0.0026404857635498047
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5552101135253906 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5143852233886719 seconds
Streaming imagenet data took 1.5282859802246094 seconds
Then, training+dataloading take 1.5306599140167236 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3949463367462158
Time for copying to cuda: 0.00935053825378418
Time for forward pass: 0.049335479736328125
Time for backpropagation: 0.0026848316192626953
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5784809589385986 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4728164672851562 seconds
Streaming imagenet data took 1.4866418838500977 seconds
Then, training+dataloading take 1.4890127182006836 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38676023483276367
Time for copying to cuda: 0.009747743606567383
Time for forward pass: 0.04939746856689453
Time for backpropagation: 0.002707958221435547
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5767133235931396 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.509246587753296 seconds
Streaming imagenet data took 1.5231399536132812 seconds
Then, training+dataloading take 1.525542974472046 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40906381607055664
Time for copying to cuda: 0.009502410888671875
Time for forward pass: 0.049277305603027344
Time for backpropagation: 0.002585172653198242
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5626609325408936 seconds
Index: 16
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5265932083129883 seconds
Streaming imagenet data took 1.5789453983306885 seconds
Then, training+dataloading take 1.5833146572113037 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37050676345825195
Time for copying to cuda: 0.009389400482177734
Time for forward pass: 0.04939723014831543
Time for backpropagation: 0.0026574134826660156
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5200297832489014 seconds
Index: 17
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.493656873703003 seconds
Streaming imagenet data took 1.5073750019073486 seconds
Then, training+dataloading take 1.5099272727966309 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4072878360748291
Time for copying to cuda: 0.009370565414428711
Time for forward pass: 0.049286842346191406
Time for backpropagation: 0.0028891563415527344
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.55690598487854 seconds
Index: 18
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4859719276428223 seconds
Streaming imagenet data took 1.4996347427368164 seconds
Then, training+dataloading take 1.5021336078643799 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37877631187438965
Time for copying to cuda: 0.00942540168762207
Time for forward pass: 0.04928755760192871
Time for backpropagation: 0.002634763717651367
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5657100677490234 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4782507419586182 seconds
Streaming imagenet data took 1.4921698570251465 seconds
Then, training+dataloading take 1.4945824146270752 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38719701766967773
Time for copying to cuda: 0.009653806686401367
Time for forward pass: 0.049668073654174805
Memory occpied: (2290.0, 1578.0)
Time for backpropagation: 0.00283050537109375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5361802577972412 seconds
Index: 20
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5388739109039307 seconds
Streaming imagenet data took 1.6025464534759521 seconds
Then, training+dataloading take 1.606910228729248 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3387882709503174
Time for copying to cuda: 0.009415149688720703
Time for forward pass: 0.04931473731994629
Time for backpropagation: 0.002645730972290039
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48969244956970215 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.539748191833496 seconds
Streaming imagenet data took 1.5537831783294678 seconds
Then, training+dataloading take 1.5564186573028564 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3362772464752197
Time for copying to cuda: 0.009477376937866211
Time for forward pass: 0.049341678619384766
Time for backpropagation: 0.002606630325317383
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.47470951080322266 seconds
Index: 22
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4627079963684082 seconds
Streaming imagenet data took 1.4765722751617432 seconds
Then, training+dataloading take 1.479123830795288 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.367495059967041
Time for copying to cuda: 0.009420156478881836
Time for forward pass: 0.049222707748413086
Time for backpropagation: 0.0025441646575927734
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5235366821289062 seconds
Index: 23
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4975779056549072 seconds
Streaming imagenet data took 1.5114810466766357 seconds
Then, training+dataloading take 1.5139570236206055 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.374190092086792
Time for copying to cuda: 0.009423971176147461
Time for forward pass: 0.04925656318664551
Time for backpropagation: 0.0025544166564941406
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5517027378082275 seconds
Index: 24
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5376346111297607 seconds
Streaming imagenet data took 1.5514006614685059 seconds
Then, training+dataloading take 1.5538599491119385 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4105195999145508
Time for copying to cuda: 0.009375333786010742
Time for forward pass: 0.04929018020629883
Time for backpropagation: 0.002573728561401367
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5389926433563232 seconds
Index: 25
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5787427425384521 seconds
Memory occpied: (2290.0, 1578.0)
Streaming imagenet data took 1.59269118309021 seconds
Then, training+dataloading take 1.5951201915740967 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33259034156799316
Time for copying to cuda: 0.009405851364135742
Time for forward pass: 0.04925942420959473
Time for backpropagation: 0.0025773048400878906
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48011326789855957 seconds
Index: 26
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.566781759262085 seconds
Streaming imagenet data took 1.580458164215088 seconds
Then, training+dataloading take 1.582902193069458 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.345318078994751
Time for copying to cuda: 0.009320259094238281
Time for forward pass: 0.04924273490905762
Time for backpropagation: 0.0026280879974365234
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4906961917877197 seconds
Index: 27
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.50333571434021 seconds
Streaming imagenet data took 1.5170273780822754 seconds
Then, training+dataloading take 1.519521713256836 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36113452911376953
Time for copying to cuda: 0.009512662887573242
Time for forward pass: 0.049484968185424805
Time for backpropagation: 0.039582252502441406
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5511014461517334 seconds
Index: 28
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5218818187713623 seconds
Streaming imagenet data took 1.574204921722412 seconds
Then, training+dataloading take 1.578568696975708 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39992213249206543
Time for copying to cuda: 0.009438276290893555
Time for forward pass: 0.049489498138427734
Time for backpropagation: 0.0026619434356689453
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.547210693359375 seconds
Index: 29
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.482800006866455 seconds
Streaming imagenet data took 1.4967756271362305 seconds
Then, training+dataloading take 1.499436855316162 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39041709899902344
Time for copying to cuda: 0.009353160858154297
Time for forward pass: 0.04932236671447754
Time for backpropagation: 0.0026102066040039062
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.557013988494873 seconds
Index: 30
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5089237689971924 seconds
Streaming imagenet data took 1.5230388641357422 seconds
Then, training+dataloading take 1.5254807472229004 seconds

Epoch: 0
Time of next(dataloader) is: 0.3748617172241211
Time for copying to cuda: 0.009366273880004883
Time for forward pass: 0.049306631088256836
Time for backpropagation: 0.0026128292083740234
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
The whole process took 59.47892618179321 seconds
