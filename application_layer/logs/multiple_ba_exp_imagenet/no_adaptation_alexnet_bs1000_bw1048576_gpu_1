Cached  True
Transformed  True
All in COS  False
No adaptation  True
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=True, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.0362168118462 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118887051.0099623 118887051.0099623
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7992892265319824 seconds
Streaming imagenet data took 1.812983751296997 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.299851655960083
Time for copying to cuda: 0.009989738464355469
Memory occpied: (1550.0, 204.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.758239984512329 seconds
Streaming imagenet data took 1.817136526107788 seconds
Memory occpied: (1550.0, 648.0)
Memory occpied: (1550.0, 1068.0)
Time for forward pass: 3.27021861076355
Time for backpropagation: 0.049225568771362305
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.684130907058716 seconds
Index: 0
Then, training+dataloading take 3.6843178272247314 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3220674991607666
Time for copying to cuda: 0.009412050247192383
Time for forward pass: 0.06757974624633789
Time for backpropagation: 0.00426173210144043
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.5225887298583984 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8675894737243652 seconds
Streaming imagenet data took 1.881683588027954 seconds
Then, training+dataloading take 1.8840157985687256 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34057092666625977
Time for copying to cuda: 0.009441137313842773
Time for forward pass: 0.04939103126525879
Time for backpropagation: 0.0026276111602783203
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48704004287719727 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6992762088775635 seconds
Streaming imagenet data took 1.7131767272949219 seconds
Then, training+dataloading take 1.7156288623809814 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3377978801727295
Time for copying to cuda: 0.009332656860351562
Time for forward pass: 0.07127571105957031
Time for backpropagation: 0.0030868053436279297
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5397529602050781 seconds
Index: 3
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6980412006378174 seconds
Streaming imagenet data took 1.7603554725646973 seconds
Then, training+dataloading take 1.764739751815796 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.33154940605163574
Time for copying to cuda: 0.009253501892089844
Time for forward pass: 0.04935741424560547
Time for backpropagation: 0.002557039260864258
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.47258973121643066 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7295660972595215 seconds
Streaming imagenet data took 1.7438712120056152 seconds
Then, training+dataloading take 1.746490716934204 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34169673919677734
Time for copying to cuda: 0.00942850112915039
Time for forward pass: 0.04929852485656738
Time for backpropagation: 0.0025892257690429688
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4884145259857178 seconds
Index: 5
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7064621448516846 seconds
Streaming imagenet data took 1.7205226421356201 seconds
Then, training+dataloading take 1.7230567932128906 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39636898040771484
Time for copying to cuda: 0.009412527084350586
Time for forward pass: 0.049301862716674805
Time for backpropagation: 0.0026674270629882812
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5760366916656494 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8111021518707275 seconds
Streaming imagenet data took 1.825085163116455 seconds
Then, training+dataloading take 1.8266026973724365 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3340029716491699
Time for copying to cuda: 0.009575843811035156
Time for forward pass: 0.04933333396911621
Time for backpropagation: 0.0025854110717773438
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4805119037628174 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6904423236846924 seconds
Streaming imagenet data took 1.704580307006836 seconds
Then, training+dataloading take 1.7071819305419922 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33355093002319336
Time for copying to cuda: 0.00939488410949707
Time for forward pass: 0.049295902252197266
Time for backpropagation: 0.002557516098022461
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4801661968231201 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7120473384857178 seconds
Streaming imagenet data took 1.7257065773010254 seconds
Then, training+dataloading take 1.7281596660614014 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4080626964569092
Time for copying to cuda: 0.009457826614379883
Time for forward pass: 0.04939723014831543
Time for backpropagation: 0.0026667118072509766
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.557363748550415 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.769273281097412 seconds
Streaming imagenet data took 1.7830731868743896 seconds
Then, training+dataloading take 1.7853882312774658 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3331000804901123
Time for copying to cuda: 0.009241342544555664
Time for forward pass: 0.049241065979003906
Time for backpropagation: 0.0026443004608154297
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4850013256072998 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.666473388671875 seconds
Streaming imagenet data took 1.6806294918060303 seconds
Then, training+dataloading take 1.6830062866210938 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.337099552154541
Time for copying to cuda: 0.009331941604614258
Time for forward pass: 0.049422264099121094
Time for backpropagation: 0.002718687057495117
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5064756870269775 seconds
Index: 11
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6795260906219482 seconds
Streaming imagenet data took 1.7314045429229736 seconds
Then, training+dataloading take 1.7357020378112793 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37232089042663574
Time for copying to cuda: 0.009267807006835938
Time for forward pass: 0.049245357513427734
Time for backpropagation: 0.0025992393493652344
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5207748413085938 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.766526222229004 seconds
Streaming imagenet data took 1.7806966304779053 seconds
Then, training+dataloading take 1.7832581996917725 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32956504821777344
Time for copying to cuda: 0.009226083755493164
Time for forward pass: 0.04921388626098633
Time for backpropagation: 0.0025398731231689453
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.45728397369384766 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6670289039611816 seconds
Streaming imagenet data took 1.6807489395141602 seconds
Then, training+dataloading take 1.6831398010253906 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3442974090576172
Time for copying to cuda: 0.009408235549926758
Time for forward pass: 0.04934883117675781
Time for backpropagation: 0.0026302337646484375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5034425258636475 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8204505443572998 seconds
Streaming imagenet data took 1.834665060043335 seconds
Then, training+dataloading take 1.8361854553222656 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3422231674194336
Time for copying to cuda: 0.009441614151000977
Time for forward pass: 0.04924654960632324
Time for backpropagation: 0.0027742385864257812
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4808170795440674 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6982502937316895 seconds
Streaming imagenet data took 1.712116003036499 seconds
Then, training+dataloading take 1.714587688446045 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3386688232421875
Time for copying to cuda: 0.009480714797973633
Time for forward pass: 0.04923534393310547
Time for backpropagation: 0.0027322769165039062
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.49025750160217285 seconds
Index: 16
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6927742958068848 seconds
Streaming imagenet data took 1.706779956817627 seconds
Then, training+dataloading take 1.7091565132141113 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37436842918395996
Time for copying to cuda: 0.009447097778320312
Time for forward pass: 0.049408912658691406
Time for backpropagation: 0.0026357173919677734
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5584173202514648 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8167436122894287 seconds
Streaming imagenet data took 1.830664873123169 seconds
Then, training+dataloading take 1.8329541683197021 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3329741954803467
Time for copying to cuda: 0.009293317794799805
Time for forward pass: 0.04926252365112305
Time for backpropagation: 0.0025985240936279297
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4859654903411865 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.691434383392334 seconds
Streaming imagenet data took 1.705204963684082 seconds
Then, training+dataloading take 1.7076835632324219 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3359224796295166
Time for copying to cuda: 0.009365081787109375
Time for forward pass: 0.04927325248718262
Time for backpropagation: 0.0026388168334960938
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4837024211883545 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6677544116973877 seconds
Streaming imagenet data took 1.681596279144287 seconds
Then, training+dataloading take 1.6840426921844482 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3706235885620117
Time for copying to cuda: 0.009341955184936523
Time for forward pass: 0.049211740493774414
Time for backpropagation: 0.0026650428771972656
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5493988990783691 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7233185768127441 seconds
Streaming imagenet data took 1.7747349739074707 seconds
Then, training+dataloading take 1.7788028717041016 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3371002674102783
Time for copying to cuda: 0.009388208389282227
Time for forward pass: 0.04922962188720703
Time for backpropagation: 0.002776622772216797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4821915626525879 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6655335426330566 seconds
Streaming imagenet data took 1.6797747611999512 seconds
Then, training+dataloading take 1.680737018585205 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3311173915863037
Time for copying to cuda: 0.00937032699584961
Time for forward pass: 0.04919028282165527
Time for backpropagation: 0.002688884735107422
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4708528518676758 seconds
Index: 22
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7187182903289795 seconds
Streaming imagenet data took 1.7325074672698975 seconds
Then, training+dataloading take 1.7350220680236816 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38677239418029785
Time for copying to cuda: 0.00933837890625
Time for forward pass: 0.04930400848388672
Time for backpropagation: 0.0026612281799316406
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5489857196807861 seconds
Index: 23
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7099723815917969 seconds
Streaming imagenet data took 1.7621569633483887 seconds
Then, training+dataloading take 1.7665178775787354 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.34651613235473633
Time for copying to cuda: 0.009415626525878906
Time for forward pass: 0.04935860633850098
Time for backpropagation: 0.0027997493743896484
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.49847960472106934 seconds
Index: 24
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7191193103790283 seconds
Streaming imagenet data took 1.73295259475708 seconds
Then, training+dataloading take 1.7356512546539307 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33457517623901367
Time for copying to cuda: 0.009450674057006836
Time for forward pass: 0.049195051193237305
Time for backpropagation: 0.0026395320892333984
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.47969889640808105 seconds
Index: 25
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6664597988128662 seconds
Streaming imagenet data took 1.6803596019744873 seconds
Then, training+dataloading take 1.6829149723052979 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3769376277923584
Time for copying to cuda: 0.009517908096313477
Time for forward pass: 0.04946470260620117
Time for backpropagation: 0.0027916431427001953
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5514311790466309 seconds
Index: 26
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7285876274108887 seconds
Streaming imagenet data took 1.7808701992034912 seconds
Then, training+dataloading take 1.7851345539093018 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3433527946472168
Time for copying to cuda: 0.009368419647216797
Time for forward pass: 0.04918527603149414
Time for backpropagation: 0.002637147903442383
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4912099838256836 seconds
Index: 27
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.685302972793579 seconds
Streaming imagenet data took 1.6992945671081543 seconds
Then, training+dataloading take 1.7021682262420654 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34311890602111816
Time for copying to cuda: 0.0094451904296875
Time for forward pass: 0.04926109313964844
Time for backpropagation: 0.0028412342071533203
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4927408695220947 seconds
Index: 28
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.666961431503296 seconds
Streaming imagenet data took 1.6807775497436523 seconds
Then, training+dataloading take 1.683356523513794 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37377476692199707
Time for copying to cuda: 0.00954294204711914
Time for forward pass: 0.04926562309265137
Time for backpropagation: 0.0026760101318359375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5349125862121582 seconds
Index: 29
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7004172801971436 seconds
Streaming imagenet data took 1.7520546913146973 seconds
Then, training+dataloading take 1.7561099529266357 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.33770084381103516
Time for copying to cuda: 0.009362936019897461
Time for forward pass: 0.04932975769042969
Time for backpropagation: 0.0026743412017822266
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.49593234062194824 seconds
Index: 30
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6541476249694824 seconds
Streaming imagenet data took 1.6682713031768799 seconds
Then, training+dataloading take 1.6709587574005127 seconds

Epoch: 0
Time of next(dataloader) is: 0.33457255363464355
Time for copying to cuda: 0.00946187973022461
Time for forward pass: 0.049324750900268555
Time for backpropagation: 0.002771139144897461
GPU memory for training: 1.1639018058776855                          

The whole process took 64.81446027755737 seconds
