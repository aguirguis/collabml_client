Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.5706597186679 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118957101.51064524 118957101.51064524
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 647.1533203125 946.2509765625 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 647.1533203125 946.2509765625 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.040133476257324 seconds
Streaming imagenet data took 2.067121744155884 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3668947219848633
Time for copying to cuda: 0.018819332122802734
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9502177238464355 seconds
Streaming imagenet data took 1.9777982234954834 seconds
Time for forward pass: 2.9900732040405273
Time for backpropagation: 0.04839825630187988
GPU memory for training: 1.102445125579834                          

One training iteration takes: 3.514760971069336 seconds
Index: 0
Then, training+dataloading take 3.514937162399292 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (1514.0, 1624.0)
Time of next(dataloader) is: 0.3440713882446289
Time for copying to cuda: 0.0185089111328125
Time for forward pass: 0.07542586326599121
Time for backpropagation: 0.003853321075439453
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5247972011566162 seconds
Index: 1
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.0512070655822754 seconds
Streaming imagenet data took 2.078928232192993 seconds
Then, training+dataloading take 2.0833470821380615 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4155004024505615
Time for copying to cuda: 0.01836705207824707
Memory occpied: (2326.0, 1632.0)
Time for forward pass: 0.07568573951721191
Time for backpropagation: 0.002738475799560547
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5981442928314209 seconds
Index: 2
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9511046409606934 seconds
Streaming imagenet data took 1.978435754776001 seconds
Then, training+dataloading take 1.9830188751220703 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3626284599304199
Time for copying to cuda: 0.018431901931762695
Time for forward pass: 0.07552528381347656
Time for backpropagation: 0.0028009414672851562
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.557830810546875 seconds
Index: 3
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9244093894958496 seconds
Streaming imagenet data took 1.9907383918762207 seconds
Then, training+dataloading take 1.9987034797668457 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40410447120666504
Time for copying to cuda: 0.01831817626953125
Time for forward pass: 0.07549834251403809
Time for backpropagation: 0.002701282501220703
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.5859532356262207 seconds
Index: 4
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9695136547088623 seconds
Streaming imagenet data took 1.996872901916504 seconds
Then, training+dataloading take 2.002192974090576 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37398743629455566
Time for copying to cuda: 0.01839923858642578
Time for forward pass: 0.07534146308898926
Time for backpropagation: 0.0026082992553710938
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5558340549468994 seconds
Index: 5
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8616304397583008 seconds
Streaming imagenet data took 1.888659954071045 seconds
Then, training+dataloading take 1.8930611610412598 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4570152759552002
Time for copying to cuda: 0.01834273338317871
Time for forward pass: 0.07546043395996094
Time for backpropagation: 0.0026502609252929688
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.6339473724365234 seconds
Index: 6
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.956676721572876 seconds
Streaming imagenet data took 1.9839365482330322 seconds
Then, training+dataloading take 1.9883301258087158 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3639509677886963
Time for copying to cuda: 0.01824498176574707
Time for forward pass: 0.07532215118408203
Time for backpropagation: 0.0026323795318603516
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5471367835998535 seconds
Index: 7
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8862578868865967 seconds
Streaming imagenet data took 1.9134597778320312 seconds
Then, training+dataloading take 1.9178268909454346 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (2326.0, 1632.0)
Time of next(dataloader) is: 0.442368745803833
Time for copying to cuda: 0.018340587615966797
Time for forward pass: 0.0754849910736084
Time for backpropagation: 0.0030133724212646484
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6290323734283447 seconds
Index: 8
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9789869785308838 seconds
Streaming imagenet data took 2.0058727264404297 seconds
Then, training+dataloading take 2.010035514831543 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36524033546447754
Time for copying to cuda: 0.0181734561920166
Time for forward pass: 0.0719614028930664
Time for backpropagation: 0.002691984176635742
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5511794090270996 seconds
Index: 9
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9267194271087646 seconds
Streaming imagenet data took 1.9928584098815918 seconds
Then, training+dataloading take 2.000495672225952 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Time of next(dataloader) is: 0.3683605194091797
Time for copying to cuda: 0.018526315689086914
Time for forward pass: 0.07561588287353516
Time for backpropagation: 0.0028748512268066406
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5541954040527344 seconds
Index: 10
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.888488531112671 seconds
Streaming imagenet data took 1.9153485298156738 seconds
Then, training+dataloading take 1.9197885990142822 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3684573173522949
Time for copying to cuda: 0.018376827239990234
Time for forward pass: 0.08161544799804688
Time for backpropagation: 0.003355741500854492
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.5707039833068848 seconds
Index: 11
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.986325740814209 seconds
Streaming imagenet data took 2.0134172439575195 seconds
Then, training+dataloading take 2.0177953243255615 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3641626834869385
Time for copying to cuda: 0.018375873565673828
Time for forward pass: 0.0756988525390625
Time for backpropagation: 0.002844095230102539
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5513620376586914 seconds
Index: 12
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8380260467529297 seconds
Streaming imagenet data took 1.865354061126709 seconds
Then, training+dataloading take 1.8696036338806152 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4601142406463623
Time for copying to cuda: 0.01842522621154785
Time for forward pass: 0.07533574104309082
Time for backpropagation: 0.0027027130126953125
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.6387646198272705 seconds
Index: 13
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9725708961486816 seconds
Streaming imagenet data took 1.999762773513794 seconds
Then, training+dataloading take 2.0043628215789795 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3896663188934326
Time for copying to cuda: 0.018552064895629883
Time for forward pass: 0.07556462287902832
Time for backpropagation: 0.0027725696563720703
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5813462734222412 seconds
Index: 14
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9191944599151611 seconds
Streaming imagenet data took 1.9460382461547852 seconds
Then, training+dataloading take 1.9503788948059082 seconds

Epoch: 0
Time of next(dataloader) is: 0.406116247177124
Time for copying to cuda: 0.01855945587158203
Time for forward pass: 0.07563424110412598
Time for backpropagation: 0.0027780532836914062
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
The whole process took 41.33909320831299 seconds
