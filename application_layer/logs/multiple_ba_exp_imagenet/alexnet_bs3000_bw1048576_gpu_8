Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=3000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6259351276883 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119095418.56905636 119095418.56905636
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 854.00146484375 1153.09912109375 6902.34130859375
Candidate split  13
Server, client, server+client, vanilla  299.09765625 854.00146484375 1153.09912109375 6902.34130859375
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 3000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.1488869190216064 seconds
Streaming imagenet data took 3.189887046813965 seconds
The mode is:  split
Start 3000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3491098880767822
Time for copying to cuda: 0.05768322944641113
Memory occpied: (1620.0, 15.0)
Memory occpied: (1620.0, 612.0)
Memory occpied: (1620.0, 1058.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.240405797958374 seconds
Streaming imagenet data took 3.2816028594970703 seconds
Time for forward pass: 3.2565722465515137
Time for backpropagation: 0.04927349090576172
GPU memory for training: 1.195061206817627                          

One training iteration takes: 3.7867259979248047 seconds
Index: 0
Then, training+dataloading take 3.787076711654663 seconds
The mode is:  split
Start 6000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43405842781066895
Time for copying to cuda: 0.027551889419555664
Time for forward pass: 0.08953142166137695
Time for backpropagation: 0.003631114959716797
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6707804203033447 seconds
Index: 1
Memory occpied: (2134.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.4841129779815674 seconds
Streaming imagenet data took 2.5246636867523193 seconds
Then, training+dataloading take 2.5302703380584717 seconds
The mode is:  split
Start 9000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4639120101928711
Time for copying to cuda: 0.027163028717041016
Time for forward pass: 0.10327506065368652
Time for backpropagation: 0.003375530242919922
GPU memory for training: 1.3507170677185059                          

Memory occpied: (2440.0, 1680.0)
One training iteration takes: 0.6909618377685547 seconds
Index: 2
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.3444509506225586 seconds
Streaming imagenet data took 2.385633945465088 seconds
Then, training+dataloading take 2.391479015350342 seconds
The mode is:  split
Start 12000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40303659439086914
Time for copying to cuda: 0.02727508544921875
Time for forward pass: 0.10326147079467773
Time for backpropagation: 0.0031528472900390625
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6313924789428711 seconds
Index: 3
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.330451488494873 seconds
Streaming imagenet data took 2.3719100952148438 seconds
Then, training+dataloading take 2.3777670860290527 seconds
The mode is:  split
Start 15000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4018137454986572
Time for copying to cuda: 0.027365684509277344
Time for forward pass: 0.13212966918945312
Time for backpropagation: 0.0031583309173583984
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6931436061859131 seconds
Index: 4
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.8130810260772705 seconds
Streaming imagenet data took 2.8540306091308594 seconds
Then, training+dataloading take 2.8611345291137695 seconds
The mode is:  split
Start 18000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49965524673461914
Time for copying to cuda: 0.027359962463378906
Time for forward pass: 0.10200929641723633
Time for backpropagation: 0.002784252166748047
GPU memory for training: 1.3507170677185059                          

Memory occpied: (2440.0, 1680.0)
One training iteration takes: 0.7234535217285156 seconds
Index: 5
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.1166837215423584 seconds
Memory occpied: (2440.0, 1680.0)
Streaming imagenet data took 3.1578330993652344 seconds
Then, training+dataloading take 3.164398193359375 seconds
The mode is:  split
Start 21000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40194272994995117
Time for copying to cuda: 0.027373075485229492
Time for forward pass: 0.10185480117797852
Time for backpropagation: 0.0026514530181884766
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6098031997680664 seconds
Index: 6
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.151409149169922 seconds
Streaming imagenet data took 3.1924562454223633 seconds
Then, training+dataloading take 3.1995761394500732 seconds
The mode is:  split
Start 24000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4463930130004883
Time for copying to cuda: 0.02727222442626953
Time for forward pass: 0.10199356079101562
Time for backpropagation: 0.0027375221252441406
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6853713989257812 seconds
Index: 7
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.4270012378692627 seconds
Streaming imagenet data took 2.4679172039031982 seconds
Then, training+dataloading take 2.4736664295196533 seconds
The mode is:  split
Start 27000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4191884994506836
Time for copying to cuda: 0.027080774307250977
Time for forward pass: 0.10318398475646973
Time for backpropagation: 0.003737926483154297
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6502430438995361 seconds
Index: 8
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.314192295074463 seconds
Streaming imagenet data took 2.355318546295166 seconds
Then, training+dataloading take 2.3625969886779785 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.400068998336792
Time for copying to cuda: 0.027333736419677734
Time for forward pass: 0.10199666023254395
Time for backpropagation: 0.002750873565673828
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6202554702758789 seconds
Index: 9
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.352898359298706 seconds
Streaming imagenet data took 2.380160331726074 seconds
Then, training+dataloading take 2.38456130027771 seconds

Epoch: 0
Time of next(dataloader) is: 0.37993931770324707
Time for copying to cuda: 0.01853466033935547
Time for forward pass: 0.07564353942871094
Time for backpropagation: 0.0029664039611816406
GPU memory for training: 1.255445957183838                          

The whole process took 37.79750895500183 seconds
