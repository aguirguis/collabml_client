Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.6572163770697 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118968446.66497529 118968446.66497529
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6972787380218506 seconds
Streaming imagenet data took 1.7111570835113525 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3023645877838135
Time for copying to cuda: 0.010053396224975586
Memory occpied: (1550.0, 230.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.551995038986206 seconds
Streaming imagenet data took 1.5661470890045166 seconds
Memory occpied: (1550.0, 666.0)
Memory occpied: (1550.0, 1122.0)
Time for forward pass: 3.2327754497528076
Time for backpropagation: 0.050643205642700195
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.6689300537109375 seconds
Index: 0
Then, training+dataloading take 3.66911244392395 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32459044456481934
Time for copying to cuda: 0.00952291488647461
Time for forward pass: 0.04984545707702637
Time for backpropagation: 0.003319978713989258
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.4659547805786133 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6088831424713135 seconds
Streaming imagenet data took 1.6226847171783447 seconds
Then, training+dataloading take 1.6249079704284668 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3666059970855713
Time for copying to cuda: 0.00948953628540039
Time for forward pass: 0.04924178123474121
Time for backpropagation: 0.002658843994140625
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5268764495849609 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4833152294158936 seconds
Streaming imagenet data took 1.4970169067382812 seconds
Then, training+dataloading take 1.4993605613708496 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36661553382873535
Time for copying to cuda: 0.009380817413330078
Time for forward pass: 0.04926753044128418
Time for backpropagation: 0.002564668655395508
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5473973751068115 seconds
Index: 3
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5092394351959229 seconds
Streaming imagenet data took 1.5229153633117676 seconds
Then, training+dataloading take 1.5251884460449219 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3648104667663574
Time for copying to cuda: 0.009415864944458008
Time for forward pass: 0.04921245574951172
Time for backpropagation: 0.0025529861450195312
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5275604724884033 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4967741966247559 seconds
Streaming imagenet data took 1.5104918479919434 seconds
Then, training+dataloading take 1.5127828121185303 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37494921684265137
Time for copying to cuda: 0.009610891342163086
Time for forward pass: 0.049471139907836914
Time for backpropagation: 0.0026192665100097656
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5356724262237549 seconds
Index: 5
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5017831325531006 seconds
Streaming imagenet data took 1.5159509181976318 seconds
Then, training+dataloading take 1.5182254314422607 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3770439624786377
Time for copying to cuda: 0.009305238723754883
Time for forward pass: 0.04924297332763672
Time for backpropagation: 0.0025877952575683594
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5370440483093262 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4891440868377686 seconds
Streaming imagenet data took 1.5027847290039062 seconds
Then, training+dataloading take 1.5050196647644043 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4141056537628174
Time for copying to cuda: 0.009465217590332031
Time for forward pass: 0.049291133880615234
Time for backpropagation: 0.0026056766510009766
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5549178123474121 seconds
Index: 7
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5749452114105225 seconds
Streaming imagenet data took 1.5890414714813232 seconds
Then, training+dataloading take 1.590453863143921 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3353080749511719
Time for copying to cuda: 0.009404420852661133
Time for forward pass: 0.04924440383911133
Time for backpropagation: 0.0026857852935791016
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4754791259765625 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5368404388427734 seconds
Streaming imagenet data took 1.550736904144287 seconds
Then, training+dataloading take 1.5531907081604004 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3326089382171631
Time for copying to cuda: 0.009269952774047852
Time for forward pass: 0.049327850341796875
Time for backpropagation: 0.0026006698608398438
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.45963597297668457 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4721598625183105 seconds
Streaming imagenet data took 1.486478328704834 seconds
Then, training+dataloading take 1.4888412952423096 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3424961566925049
Time for copying to cuda: 0.009331703186035156
Time for forward pass: 0.04935717582702637
Time for backpropagation: 0.0026786327362060547
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4846363067626953 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4554729461669922 seconds
Streaming imagenet data took 1.469475507736206 seconds
Then, training+dataloading take 1.471971035003662 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3809995651245117
Time for copying to cuda: 0.009552001953125
Time for forward pass: 0.04944586753845215
Memory occpied: (2290.0, 1578.0)
Time for backpropagation: 0.0029189586639404297
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5237936973571777 seconds
Index: 11
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5521860122680664 seconds
Streaming imagenet data took 1.603733777999878 seconds
Then, training+dataloading take 1.6080656051635742 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.33122754096984863
Time for copying to cuda: 0.009523868560791016
Time for forward pass: 0.04934978485107422
Time for backpropagation: 0.00279998779296875
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4782414436340332 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5200600624084473 seconds
Streaming imagenet data took 1.533966302871704 seconds
Then, training+dataloading take 1.5365698337554932 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34077978134155273
Time for copying to cuda: 0.00945425033569336
Time for forward pass: 0.04920077323913574
Time for backpropagation: 0.0027971267700195312
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4824411869049072 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5140948295593262 seconds
Streaming imagenet data took 1.5279600620269775 seconds
Then, training+dataloading take 1.5304603576660156 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3340749740600586
Time for copying to cuda: 0.009347915649414062
Time for forward pass: 0.04920554161071777
Time for backpropagation: 0.002568960189819336
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.49679994583129883 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4767253398895264 seconds
Streaming imagenet data took 1.4904577732086182 seconds
Then, training+dataloading take 1.4929487705230713 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40401554107666016
Time for copying to cuda: 0.009469747543334961
Time for forward pass: 0.04953956604003906
Memory occpied: (2290.0, 1578.0)
Time for backpropagation: 0.002883434295654297
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5486500263214111 seconds
Index: 15
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5427913665771484 seconds
Streaming imagenet data took 1.556849479675293 seconds
Then, training+dataloading take 1.5593039989471436 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3671457767486572
Time for copying to cuda: 0.009366035461425781
Time for forward pass: 0.04923081398010254
Time for backpropagation: 0.0026023387908935547
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5092287063598633 seconds
Index: 16
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5045166015625 seconds
Streaming imagenet data took 1.5560259819030762 seconds
Then, training+dataloading take 1.5604922771453857 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37685179710388184
Time for copying to cuda: 0.00932931900024414
Time for forward pass: 0.04928183555603027
Time for backpropagation: 0.0026521682739257812
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5171144008636475 seconds
Index: 17
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4753098487854004 seconds
Streaming imagenet data took 1.4892027378082275 seconds
Then, training+dataloading take 1.4918646812438965 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38575267791748047
Time for copying to cuda: 0.009465456008911133
Time for forward pass: 0.049358367919921875
Time for backpropagation: 0.002641439437866211
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5549662113189697 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.496384859085083 seconds
Streaming imagenet data took 1.5102558135986328 seconds
Then, training+dataloading take 1.5127205848693848 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3738248348236084
Time for copying to cuda: 0.009326934814453125
Time for forward pass: 0.04924273490905762
Time for backpropagation: 0.002565622329711914
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5321478843688965 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5104279518127441 seconds
Streaming imagenet data took 1.5241081714630127 seconds
Then, training+dataloading take 1.526590347290039 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3986811637878418
Time for copying to cuda: 0.009337902069091797
Time for forward pass: 0.04932570457458496
Time for backpropagation: 0.002610445022583008
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5824508666992188 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4936738014221191 seconds
Streaming imagenet data took 1.5074610710144043 seconds
Then, training+dataloading take 1.5099906921386719 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38182973861694336
Time for copying to cuda: 0.00948190689086914
Time for forward pass: 0.04934215545654297
Time for backpropagation: 0.0027055740356445312
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5423719882965088 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4742488861083984 seconds
Streaming imagenet data took 1.48824143409729 seconds
Then, training+dataloading take 1.4907844066619873 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38089728355407715
Time for copying to cuda: 0.009619712829589844
Time for forward pass: 0.04958200454711914
Memory occpied: (2290.0, 1578.0)
Time for backpropagation: 0.0029556751251220703
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5307250022888184 seconds
Index: 22
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5233814716339111 seconds
Streaming imagenet data took 1.5376074314117432 seconds
Then, training+dataloading take 1.539287805557251 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.365368127822876
Time for copying to cuda: 0.009511470794677734
Time for forward pass: 0.04925727844238281
Time for backpropagation: 0.0025920867919921875
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5108199119567871 seconds
Index: 23
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.496781826019287 seconds
Streaming imagenet data took 1.548851490020752 seconds
Then, training+dataloading take 1.5533201694488525 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3720238208770752
Time for copying to cuda: 0.009559154510498047
Time for forward pass: 0.04940915107727051
Time for backpropagation: 0.002830028533935547
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5157735347747803 seconds
Index: 24
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.469590663909912 seconds
Streaming imagenet data took 1.4837658405303955 seconds
Then, training+dataloading take 1.484633445739746 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3668711185455322
Time for copying to cuda: 0.009367942810058594
Time for forward pass: 0.04931282997131348
Time for backpropagation: 0.002561807632446289
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5260870456695557 seconds
Index: 25
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4666874408721924 seconds
Streaming imagenet data took 1.4805889129638672 seconds
Then, training+dataloading take 1.4830846786499023 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4179704189300537
Time for copying to cuda: 0.009548664093017578
Time for forward pass: 0.049332618713378906
Time for backpropagation: 0.0026886463165283203
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5663371086120605 seconds
Index: 26
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5027813911437988 seconds
Streaming imagenet data took 1.5170598030090332 seconds
Then, training+dataloading take 1.519697904586792 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3654625415802002
Time for copying to cuda: 0.009387016296386719
Time for forward pass: 0.04928445816040039
Time for backpropagation: 0.002595663070678711
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.508718729019165 seconds
Index: 27
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5488619804382324 seconds
Streaming imagenet data took 1.5628905296325684 seconds
Then, training+dataloading take 1.5653834342956543 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.341921329498291
Time for copying to cuda: 0.009409427642822266
Time for forward pass: 0.04928421974182129
Time for backpropagation: 0.00260162353515625
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.495819091796875 seconds
Index: 28
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4854211807250977 seconds
Streaming imagenet data took 1.4995007514953613 seconds
Then, training+dataloading take 1.5020105838775635 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33260512351989746
Time for copying to cuda: 0.009547233581542969
Time for forward pass: 0.049500226974487305
Time for backpropagation: 0.0026972293853759766
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48325657844543457 seconds
Index: 29
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5375914573669434 seconds
Streaming imagenet data took 1.5514423847198486 seconds
Then, training+dataloading take 1.5539476871490479 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41428542137145996
Time for copying to cuda: 0.009584426879882812
Time for forward pass: 0.049447059631347656
Memory occpied: (2290.0, 1578.0)
Time for backpropagation: 0.0027947425842285156
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5605533123016357 seconds
Index: 30
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.484900951385498 seconds
Streaming imagenet data took 1.5363783836364746 seconds
Then, training+dataloading take 1.5407564640045166 seconds

Epoch: 0
Time of next(dataloader) is: 0.3672034740447998
Time for copying to cuda: 0.009432077407836914
Time for forward pass: 0.04922604560852051
Time for backpropagation: 0.00263214111328125
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
The whole process took 59.16341519355774 seconds
