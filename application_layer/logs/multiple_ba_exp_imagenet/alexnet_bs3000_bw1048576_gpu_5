Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=3000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.0322660536325 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119017605.17618172 119017605.17618172
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 854.00146484375 1153.09912109375 6902.34130859375
Candidate split  13
Server, client, server+client, vanilla  299.09765625 854.00146484375 1153.09912109375 6902.34130859375
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 3000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.5299339294433594 seconds
Streaming imagenet data took 2.570570707321167 seconds
The mode is:  split
Start 3000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38314366340637207
Time for copying to cuda: 0.027767419815063477
Memory occpied: (1620.0, 366.0)
Memory occpied: (1620.0, 752.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.423351764678955 seconds
Streaming imagenet data took 2.4644980430603027 seconds
Memory occpied: (1620.0, 1224.0)
Time for forward pass: 3.3645620346069336
Time for backpropagation: 0.04994964599609375
GPU memory for training: 1.195061206817627                          

One training iteration takes: 3.8989148139953613 seconds
Index: 0
Then, training+dataloading take 3.89927339553833 seconds
The mode is:  split
Start 6000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3751027584075928
Time for copying to cuda: 0.02760934829711914
Time for forward pass: 0.08068561553955078
Time for backpropagation: 0.0034797191619873047
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6101405620574951 seconds
Index: 1
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.4756526947021484 seconds
Streaming imagenet data took 2.5173330307006836 seconds
Then, training+dataloading take 2.5232434272766113 seconds
The mode is:  split
Start 9000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4006783962249756
Time for copying to cuda: 0.02734375
Time for forward pass: 0.10268449783325195
Time for backpropagation: 0.0031957626342773438
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6273918151855469 seconds
Index: 2
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.361729145050049 seconds
Streaming imagenet data took 2.403573989868164 seconds
Then, training+dataloading take 2.408186197280884 seconds
The mode is:  split
Start 12000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41559481620788574
Time for copying to cuda: 0.027368783950805664
Time for forward pass: 0.11179733276367188
Time for backpropagation: 0.003155946731567383
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6693871021270752 seconds
Index: 3
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.3872032165527344 seconds
Streaming imagenet data took 2.427842378616333 seconds
Then, training+dataloading take 2.433771848678589 seconds
The mode is:  split
Start 15000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41402220726013184
Time for copying to cuda: 0.027411222457885742
Time for forward pass: 0.11910128593444824
Time for backpropagation: 0.0035538673400878906
GPU memory for training: 1.3507170677185059                          

Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.401517629623413 seconds
Streaming imagenet data took 2.4419023990631104 seconds
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
One training iteration takes: 5.587031126022339 seconds
Index: 4
Then, training+dataloading take 5.587175607681274 seconds
The mode is:  split
Start 18000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40782904624938965
Time for copying to cuda: 0.027527809143066406
Time for forward pass: 0.10192394256591797
Time for backpropagation: 0.002727031707763672
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6322429180145264 seconds
Index: 5
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.493321418762207 seconds
Streaming imagenet data took 2.534325122833252 seconds
Then, training+dataloading take 2.5418758392333984 seconds
The mode is:  split
Start 21000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4144864082336426
Time for copying to cuda: 0.027208328247070312
Time for forward pass: 0.10207271575927734
Time for backpropagation: 0.002754688262939453
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6353046894073486 seconds
Index: 6
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.4092488288879395 seconds
Streaming imagenet data took 2.450042247772217 seconds
Then, training+dataloading take 2.4545328617095947 seconds
The mode is:  split
Start 24000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.413555383682251
Time for copying to cuda: 0.02736210823059082
Time for forward pass: 0.10191631317138672
Time for backpropagation: 0.0026280879974365234
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6422035694122314 seconds
Index: 7
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.4523823261260986 seconds
Streaming imagenet data took 2.494021415710449 seconds
Then, training+dataloading take 2.500962972640991 seconds
The mode is:  split
Start 27000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42328619956970215
Time for copying to cuda: 0.02710866928100586
Time for forward pass: 0.10193800926208496
Time for backpropagation: 0.0026788711547851562
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6587119102478027 seconds
Index: 8
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.379894495010376 seconds
Streaming imagenet data took 2.4201903343200684 seconds
Then, training+dataloading take 2.4259002208709717 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4070885181427002
Time for copying to cuda: 0.027384519577026367
Time for forward pass: 0.10191559791564941
Time for backpropagation: 0.0026710033416748047
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6182224750518799 seconds
Index: 9
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.378631353378296 seconds
Streaming imagenet data took 2.4062509536743164 seconds
Then, training+dataloading take 2.410280466079712 seconds

Epoch: 0
Time of next(dataloader) is: 0.3866407871246338
Time for copying to cuda: 0.018113374710083008
Time for forward pass: 0.07549142837524414
Time for backpropagation: 0.0026738643646240234
GPU memory for training: 1.255445957183838                          

The whole process took 39.04089593887329 seconds
