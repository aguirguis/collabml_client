Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.7702311389794 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118983259.73584831 118983259.73584831
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6234867572784424 seconds
Streaming imagenet data took 1.6372978687286377 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2977113723754883
Time for copying to cuda: 0.010030984878540039
Memory occpied: (1550.0, 274.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5381641387939453 seconds
Streaming imagenet data took 1.5521976947784424 seconds
Memory occpied: (1550.0, 738.0)
Memory occpied: (1550.0, 1170.0)
Time for forward pass: 3.212885856628418
Time for backpropagation: 0.04906821250915527
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.6291732788085938 seconds
Index: 0
Then, training+dataloading take 3.629394054412842 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3220484256744385
Time for copying to cuda: 0.009428977966308594
Time for forward pass: 0.04973125457763672
Time for backpropagation: 0.0034024715423583984
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.4738140106201172 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6812562942504883 seconds
Streaming imagenet data took 1.695542335510254 seconds
Then, training+dataloading take 1.6978280544281006 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3738887310028076
Time for copying to cuda: 0.00935673713684082
Time for forward pass: 0.04928231239318848
Time for backpropagation: 0.0025217533111572266
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5561754703521729 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4920897483825684 seconds
Streaming imagenet data took 1.5060102939605713 seconds
Then, training+dataloading take 1.5082628726959229 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42344164848327637
Time for copying to cuda: 0.009357690811157227
Time for forward pass: 0.04924345016479492
Time for backpropagation: 0.0025844573974609375
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5739092826843262 seconds
Index: 3
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4977331161499023 seconds
Streaming imagenet data took 1.5116279125213623 seconds
Then, training+dataloading take 1.5139739513397217 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37442517280578613
Time for copying to cuda: 0.009344816207885742
Time for forward pass: 0.04918956756591797
Time for backpropagation: 0.002744913101196289
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5428371429443359 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4991745948791504 seconds
Streaming imagenet data took 1.5131049156188965 seconds
Then, training+dataloading take 1.5154016017913818 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.429610013961792
Time for copying to cuda: 0.009364843368530273
Time for forward pass: 0.0491793155670166
Time for backpropagation: 0.002751588821411133
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5718698501586914 seconds
Index: 5
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5210082530975342 seconds
Streaming imagenet data took 1.5730957984924316 seconds
Then, training+dataloading take 1.577434778213501 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3372964859008789
Time for copying to cuda: 0.009493827819824219
Time for forward pass: 0.049302101135253906
Time for backpropagation: 0.0027091503143310547
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48964476585388184 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5359711647033691 seconds
Streaming imagenet data took 1.55008864402771 seconds
Then, training+dataloading take 1.5527887344360352 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3333616256713867
Time for copying to cuda: 0.009605169296264648
Time for forward pass: 0.04922294616699219
Time for backpropagation: 0.0026030540466308594
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4756298065185547 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4941022396087646 seconds
Streaming imagenet data took 1.5080406665802002 seconds
Then, training+dataloading take 1.510589361190796 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33743882179260254
Time for copying to cuda: 0.009349346160888672
Time for forward pass: 0.04921245574951172
Time for backpropagation: 0.002704620361328125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.49448180198669434 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5405631065368652 seconds
Streaming imagenet data took 1.5545682907104492 seconds
Then, training+dataloading take 1.5570569038391113 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3700840473175049
Time for copying to cuda: 0.009407520294189453
Time for forward pass: 0.04924798011779785
Time for backpropagation: 0.0025861263275146484
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5507755279541016 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4791600704193115 seconds
Streaming imagenet data took 1.493093490600586 seconds
Then, training+dataloading take 1.49560546875 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38033175468444824
Time for copying to cuda: 0.009395599365234375
Time for forward pass: 0.049320220947265625
Time for backpropagation: 0.0025653839111328125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.541205883026123 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5063397884368896 seconds
Streaming imagenet data took 1.5203757286071777 seconds
Then, training+dataloading take 1.5228044986724854 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39647364616394043
Time for copying to cuda: 0.009352684020996094
Time for forward pass: 0.04924201965332031
Time for backpropagation: 0.002611875534057617
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5747404098510742 seconds
Index: 11
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4925498962402344 seconds
Streaming imagenet data took 1.5064177513122559 seconds
Then, training+dataloading take 1.508894920349121 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3723123073577881
Time for copying to cuda: 0.00941610336303711
Time for forward pass: 0.04932570457458496
Time for backpropagation: 0.00254058837890625
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5312631130218506 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5113320350646973 seconds
Streaming imagenet data took 1.525277853012085 seconds
Then, training+dataloading take 1.52773118019104 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3826892375946045
Time for copying to cuda: 0.009433984756469727
Time for forward pass: 0.049291372299194336
Time for backpropagation: 0.002685070037841797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5433857440948486 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4897425174713135 seconds
Streaming imagenet data took 1.5035655498504639 seconds
Then, training+dataloading take 1.5059888362884521 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4135463237762451
Time for copying to cuda: 0.009326934814453125
Time for forward pass: 0.04929542541503906
Time for backpropagation: 0.0025963783264160156
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5573687553405762 seconds
Index: 14
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5855534076690674 seconds
Streaming imagenet data took 1.5995707511901855 seconds
Then, training+dataloading take 1.601130723953247 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3413660526275635
Time for copying to cuda: 0.009354352951049805
Time for forward pass: 0.04926323890686035
Time for backpropagation: 0.002569437026977539
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4909346103668213 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5200169086456299 seconds
Streaming imagenet data took 1.5339875221252441 seconds
Then, training+dataloading take 1.536482810974121 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33130526542663574
Time for copying to cuda: 0.009371519088745117
Time for forward pass: 0.049234867095947266
Time for backpropagation: 0.002616405487060547
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4798905849456787 seconds
Index: 16
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5472543239593506 seconds
Streaming imagenet data took 1.5611109733581543 seconds
Then, training+dataloading take 1.563621997833252 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3359513282775879
Time for copying to cuda: 0.00932931900024414
Time for forward pass: 0.07250809669494629
Time for backpropagation: 0.003189563751220703
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5207211971282959 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5096142292022705 seconds
Streaming imagenet data took 1.523505449295044 seconds
Then, training+dataloading take 1.5260326862335205 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3730356693267822
Time for copying to cuda: 0.009422540664672852
Time for forward pass: 0.04937553405761719
Time for backpropagation: 0.0025720596313476562
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5349290370941162 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4715826511383057 seconds
Streaming imagenet data took 1.4852988719940186 seconds
Then, training+dataloading take 1.4877793788909912 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3849155902862549
Time for copying to cuda: 0.009440183639526367
Time for forward pass: 0.049222707748413086
Time for backpropagation: 0.0026276111602783203
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5506670475006104 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5087757110595703 seconds
Streaming imagenet data took 1.5227775573730469 seconds
Then, training+dataloading take 1.5252556800842285 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4008638858795166
Time for copying to cuda: 0.009434223175048828
Time for forward pass: 0.04933667182922363
Time for backpropagation: 0.0026254653930664062
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5611875057220459 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5210118293762207 seconds
Streaming imagenet data took 1.5349504947662354 seconds
Then, training+dataloading take 1.5374879837036133 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4022202491760254
Time for copying to cuda: 0.00933694839477539
Time for forward pass: 0.049223899841308594
Time for backpropagation: 0.0026268959045410156
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5691487789154053 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4824957847595215 seconds
Streaming imagenet data took 1.496208906173706 seconds
Then, training+dataloading take 1.4986488819122314 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38092756271362305
Time for copying to cuda: 0.00931692123413086
Time for forward pass: 0.049306631088256836
Time for backpropagation: 0.00272369384765625
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5434105396270752 seconds
Index: 22
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4860725402832031 seconds
Streaming imagenet data took 1.4998993873596191 seconds
Then, training+dataloading take 1.5023458003997803 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41044163703918457
Time for copying to cuda: 0.009459972381591797
Time for forward pass: 0.049367666244506836
Time for backpropagation: 0.0026636123657226562
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5569202899932861 seconds
Index: 23
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4697351455688477 seconds
Streaming imagenet data took 1.4836304187774658 seconds
Then, training+dataloading take 1.4860942363739014 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3913412094116211
Time for copying to cuda: 0.009368896484375
Time for forward pass: 0.04920649528503418
Time for backpropagation: 0.0026264190673828125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5749397277832031 seconds
Index: 24
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5095276832580566 seconds
Streaming imagenet data took 1.5234527587890625 seconds
Then, training+dataloading take 1.5259404182434082 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3936030864715576
Time for copying to cuda: 0.00946354866027832
Time for forward pass: 0.04932141304016113
Time for backpropagation: 0.0026407241821289062
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.576122522354126 seconds
Index: 25
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.473811149597168 seconds
Streaming imagenet data took 1.4882574081420898 seconds
Then, training+dataloading take 1.490774154663086 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37932515144348145
Time for copying to cuda: 0.009493350982666016
Time for forward pass: 0.049284934997558594
Time for backpropagation: 0.0028030872344970703
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5409836769104004 seconds
Index: 26
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4845199584960938 seconds
Streaming imagenet data took 1.4987013339996338 seconds
Then, training+dataloading take 1.5012459754943848 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.422959566116333
Time for copying to cuda: 0.009567499160766602
Time for forward pass: 0.049456119537353516
Time for backpropagation: 0.002695798873901367
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5718064308166504 seconds
Index: 27
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5243089199066162 seconds
Streaming imagenet data took 1.5383470058441162 seconds
Then, training+dataloading take 1.5408153533935547 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37232160568237305
Time for copying to cuda: 0.009378671646118164
Time for forward pass: 0.04924917221069336
Time for backpropagation: 0.002847909927368164
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5311119556427002 seconds
Index: 28
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5313470363616943 seconds
Streaming imagenet data took 1.545154333114624 seconds
Then, training+dataloading take 1.5476148128509521 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3704404830932617
Time for copying to cuda: 0.009361743927001953
Time for forward pass: 0.049219369888305664
Time for backpropagation: 0.0026073455810546875
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5337104797363281 seconds
Index: 29
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4853971004486084 seconds
Streaming imagenet data took 1.499169111251831 seconds
Then, training+dataloading take 1.5016405582427979 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38045215606689453
Time for copying to cuda: 0.009383440017700195
Time for forward pass: 0.04923105239868164
Time for backpropagation: 0.0025861263275146484
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5550613403320312 seconds
Index: 30
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.497452735900879 seconds
Streaming imagenet data took 1.5112276077270508 seconds
Then, training+dataloading take 1.513737678527832 seconds

Epoch: 0
Time of next(dataloader) is: 0.3696866035461426
Time for copying to cuda: 0.009457826614379883
Time for forward pass: 0.04934239387512207
Time for backpropagation: 0.0026390552520751953
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
The whole process took 59.1950581073761 seconds
