Cached  True
Transformed  True
All in COS  False
No adaptation  True
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=True, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6109694027385 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119093456.98155575 119093456.98155575
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7637455463409424 seconds
Streaming imagenet data took 1.7776153087615967 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3107156753540039
Time for copying to cuda: 0.010014057159423828
Memory occpied: (1550.0, 214.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7894806861877441 seconds
Streaming imagenet data took 1.8384180068969727 seconds
Memory occpied: (1550.0, 680.0)
Memory occpied: (1550.0, 1132.0)
Time for forward pass: 3.222057580947876
Time for backpropagation: 0.04968714714050293
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.666532039642334 seconds
Index: 0
Then, training+dataloading take 3.6667327880859375 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32042622566223145
Time for copying to cuda: 0.009379863739013672
Time for forward pass: 0.049695491790771484
Time for backpropagation: 0.0033147335052490234
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.4741504192352295 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.792314052581787 seconds
Streaming imagenet data took 1.806161880493164 seconds
Then, training+dataloading take 1.808459997177124 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3321869373321533
Time for copying to cuda: 0.009454727172851562
Time for forward pass: 0.049256086349487305
Time for backpropagation: 0.0026013851165771484
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4781334400177002 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6606740951538086 seconds
Streaming imagenet data took 1.6748344898223877 seconds
Then, training+dataloading take 1.6772990226745605 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33736085891723633
Time for copying to cuda: 0.009522676467895508
Time for forward pass: 0.049248456954956055
Time for backpropagation: 0.0025942325592041016
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4831206798553467 seconds
Index: 3
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6857099533081055 seconds
Streaming imagenet data took 1.6997616291046143 seconds
Then, training+dataloading take 1.7022128105163574 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36859869956970215
Time for copying to cuda: 0.009334802627563477
Time for forward pass: 0.04931497573852539
Time for backpropagation: 0.002542734146118164
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5269546508789062 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6836121082305908 seconds
Streaming imagenet data took 1.697740077972412 seconds
Then, training+dataloading take 1.7000625133514404 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.37003469467163086
Time for copying to cuda: 0.009354829788208008
Time for forward pass: 0.04925847053527832
Time for backpropagation: 0.002590656280517578
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5136489868164062 seconds
Index: 5
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7034196853637695 seconds
Streaming imagenet data took 1.7174186706542969 seconds
Then, training+dataloading take 1.7199006080627441 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33130550384521484
Time for copying to cuda: 0.009407758712768555
Time for forward pass: 0.049280405044555664
Time for backpropagation: 0.002688884735107422
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.477402925491333 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6855731010437012 seconds
Streaming imagenet data took 1.699507713317871 seconds
Then, training+dataloading take 1.7019743919372559 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3716437816619873
Time for copying to cuda: 0.009346246719360352
Time for forward pass: 0.04935741424560547
Time for backpropagation: 0.0026917457580566406
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5540709495544434 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7052180767059326 seconds
Streaming imagenet data took 1.7572133541107178 seconds
Then, training+dataloading take 1.7615461349487305 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.33587002754211426
Time for copying to cuda: 0.009388208389282227
Time for forward pass: 0.049241065979003906
Time for backpropagation: 0.002532958984375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.46300435066223145 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.695417881011963 seconds
Streaming imagenet data took 1.7093982696533203 seconds
Then, training+dataloading take 1.711977243423462 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33498167991638184
Time for copying to cuda: 0.009437799453735352
Time for forward pass: 0.04934334754943848
Time for backpropagation: 0.002599954605102539
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48577046394348145 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6479911804199219 seconds
Streaming imagenet data took 1.6619935035705566 seconds
Then, training+dataloading take 1.6644771099090576 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3753666877746582
Time for copying to cuda: 0.009433507919311523
Time for forward pass: 0.04926156997680664
Time for backpropagation: 0.0027697086334228516
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5351691246032715 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7054357528686523 seconds
Streaming imagenet data took 1.7670605182647705 seconds
Then, training+dataloading take 1.7714247703552246 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.33147501945495605
Time for copying to cuda: 0.009414911270141602
Time for forward pass: 0.04934978485107422
Time for backpropagation: 0.0026056766510009766
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.47124433517456055 seconds
Index: 11
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7127571105957031 seconds
Streaming imagenet data took 1.7267177104949951 seconds
Then, training+dataloading take 1.7293846607208252 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3472716808319092
Time for copying to cuda: 0.009468317031860352
Time for forward pass: 0.049303293228149414
Time for backpropagation: 0.002762317657470703
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48616933822631836 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6898393630981445 seconds
Streaming imagenet data took 1.7039527893066406 seconds
Then, training+dataloading take 1.706477165222168 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.41361260414123535
Time for copying to cuda: 0.00940394401550293
Time for forward pass: 0.04935431480407715
Time for backpropagation: 0.0025658607482910156
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.564220666885376 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7436866760253906 seconds
Streaming imagenet data took 1.757455825805664 seconds
Then, training+dataloading take 1.759913682937622 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3303508758544922
Time for copying to cuda: 0.009462118148803711
Time for forward pass: 0.04938459396362305
Time for backpropagation: 0.0026235580444335938
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.484668493270874 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6883046627044678 seconds
Streaming imagenet data took 1.7024145126342773 seconds
Then, training+dataloading take 1.7049369812011719 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37166810035705566
Time for copying to cuda: 0.009631156921386719
Time for forward pass: 0.04954695701599121
Time for backpropagation: 0.04042816162109375
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5605974197387695 seconds
Index: 15
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7170140743255615 seconds
Streaming imagenet data took 1.731391429901123 seconds
Then, training+dataloading take 1.7336640357971191 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.33403539657592773
Time for copying to cuda: 0.009418010711669922
Time for forward pass: 0.04934334754943848
Time for backpropagation: 0.0027344226837158203
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4773826599121094 seconds
Index: 16
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6854722499847412 seconds
Streaming imagenet data took 1.6991844177246094 seconds
Then, training+dataloading take 1.7016115188598633 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.331101655960083
Time for copying to cuda: 0.009342670440673828
Time for forward pass: 0.0493161678314209
Time for backpropagation: 0.002743244171142578
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.46858930587768555 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.629758358001709 seconds
Streaming imagenet data took 1.6434664726257324 seconds
Then, training+dataloading take 1.6459674835205078 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40636420249938965
Time for copying to cuda: 0.009467363357543945
Time for forward pass: 0.049421072006225586
Time for backpropagation: 0.0025787353515625
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5568945407867432 seconds
Index: 18
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7307322025299072 seconds
Streaming imagenet data took 1.7449138164520264 seconds
Then, training+dataloading take 1.7472894191741943 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.34238529205322266
Time for copying to cuda: 0.009319305419921875
Time for forward pass: 0.04922604560852051
Time for backpropagation: 0.0026116371154785156
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4927546977996826 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6872172355651855 seconds
Streaming imagenet data took 1.7009122371673584 seconds
Then, training+dataloading take 1.7034251689910889 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3421764373779297
Time for copying to cuda: 0.009432077407836914
Time for forward pass: 0.049332380294799805
Time for backpropagation: 0.002651214599609375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.46965837478637695 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6576404571533203 seconds
Streaming imagenet data took 1.6714210510253906 seconds
Then, training+dataloading take 1.673823595046997 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3848283290863037
Time for copying to cuda: 0.009340286254882812
Time for forward pass: 0.049276113510131836
Time for backpropagation: 0.002590656280517578
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5688245296478271 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7055280208587646 seconds
Streaming imagenet data took 1.7195191383361816 seconds
Then, training+dataloading take 1.721949815750122 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37250638008117676
Time for copying to cuda: 0.009418487548828125
Time for forward pass: 0.04934835433959961
Time for backpropagation: 0.0025177001953125
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5197560787200928 seconds
Index: 22
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.725435733795166 seconds
Memory occpied: (2290.0, 1578.0)
Streaming imagenet data took 1.7392754554748535 seconds
Then, training+dataloading take 1.7417664527893066 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3280203342437744
Time for copying to cuda: 0.00935816764831543
Time for forward pass: 0.04919171333312988
Time for backpropagation: 0.0027625560760498047
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.47569704055786133 seconds
Index: 23
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6567256450653076 seconds
Streaming imagenet data took 1.670562744140625 seconds
Then, training+dataloading take 1.6730940341949463 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3481137752532959
Time for copying to cuda: 0.009615421295166016
Time for forward pass: 0.04940438270568848
Time for backpropagation: 0.0027878284454345703
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4928464889526367 seconds
Index: 24
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6490490436553955 seconds
Streaming imagenet data took 1.6629674434661865 seconds
Then, training+dataloading take 1.6654818058013916 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36936092376708984
Time for copying to cuda: 0.009356498718261719
Time for forward pass: 0.04921984672546387
Time for backpropagation: 0.002816915512084961
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.528416633605957 seconds
Index: 25
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7635464668273926 seconds
Streaming imagenet data took 1.7777533531188965 seconds
Then, training+dataloading take 1.7802386283874512 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.33396077156066895
Time for copying to cuda: 0.009384870529174805
Time for forward pass: 0.04928255081176758
Time for backpropagation: 0.0026586055755615234
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.47664880752563477 seconds
Index: 26
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.648862600326538 seconds
Streaming imagenet data took 1.6625409126281738 seconds
Then, training+dataloading take 1.665050983428955 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3379092216491699
Time for copying to cuda: 0.009417533874511719
Time for forward pass: 0.04924321174621582
Time for backpropagation: 0.002712249755859375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48629307746887207 seconds
Index: 27
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6798458099365234 seconds
Streaming imagenet data took 1.6938364505767822 seconds
Then, training+dataloading take 1.6963422298431396 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37197136878967285
Time for copying to cuda: 0.00948476791381836
Time for forward pass: 0.049272775650024414
Time for backpropagation: 0.002852201461791992
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.529949426651001 seconds
Index: 28
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.705777883529663 seconds
Streaming imagenet data took 1.7572603225708008 seconds
Then, training+dataloading take 1.7615885734558105 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3348515033721924
Time for copying to cuda: 0.009537220001220703
Time for forward pass: 0.04935765266418457
Time for backpropagation: 0.002798795700073242
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.47856616973876953 seconds
Index: 29
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6476624011993408 seconds
Streaming imagenet data took 1.6615383625030518 seconds
Then, training+dataloading take 1.6642229557037354 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.342374324798584
Time for copying to cuda: 0.009404420852661133
Time for forward pass: 0.04937744140625
Time for backpropagation: 0.0029489994049072266
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.498016357421875 seconds
Index: 30
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.684626817703247 seconds
Streaming imagenet data took 1.698481559753418 seconds
Then, training+dataloading take 1.7012038230895996 seconds

Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4356560707092285
Time for copying to cuda: 0.009411811828613281
Time for forward pass: 0.049315690994262695
Time for backpropagation: 0.0026688575744628906
GPU memory for training: 1.1639018058776855                          

The whole process took 64.70703434944153 seconds
