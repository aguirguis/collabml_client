Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3554489689977 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119059965.40726447 119059965.40726447
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6611652374267578 seconds
Streaming imagenet data took 1.6750104427337646 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3077235221862793
Time for copying to cuda: 0.010035991668701172
Memory occpied: (1550.0, 250.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.511643648147583 seconds
Streaming imagenet data took 1.5257008075714111 seconds
Memory occpied: (1550.0, 708.0)
Memory occpied: (1550.0, 1146.0)
Time for forward pass: 3.2339704036712646
Time for backpropagation: 0.05182933807373047
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.6719884872436523 seconds
Index: 0
Then, training+dataloading take 3.6721808910369873 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3246653079986572
Time for copying to cuda: 0.00940704345703125
Time for forward pass: 0.04988288879394531
Time for backpropagation: 0.0034971237182617188
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.4711761474609375 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.624246597290039 seconds
Streaming imagenet data took 1.6383163928985596 seconds
Then, training+dataloading take 1.6405847072601318 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37408924102783203
Time for copying to cuda: 0.009398460388183594
Time for forward pass: 0.04925942420959473
Time for backpropagation: 0.002658367156982422
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5339632034301758 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4799089431762695 seconds
Streaming imagenet data took 1.493718147277832 seconds
Then, training+dataloading take 1.4961071014404297 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.41624879837036133
Time for copying to cuda: 0.009506940841674805
Time for forward pass: 0.04937481880187988
Time for backpropagation: 0.0027246475219726562
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.543851375579834 seconds
Index: 3
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5388720035552979 seconds
Streaming imagenet data took 1.5903899669647217 seconds
Then, training+dataloading take 1.5947155952453613 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3477756977081299
Time for copying to cuda: 0.00948643684387207
Time for forward pass: 0.04930591583251953
Time for backpropagation: 0.002707242965698242
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4976677894592285 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5232961177825928 seconds
Streaming imagenet data took 1.5374536514282227 seconds
Then, training+dataloading take 1.5402038097381592 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3333249092102051
Time for copying to cuda: 0.009351730346679688
Time for forward pass: 0.04932427406311035
Time for backpropagation: 0.0027687549591064453
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4859488010406494 seconds
Index: 5
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.49979567527771 seconds
Streaming imagenet data took 1.5136544704437256 seconds
Then, training+dataloading take 1.5160646438598633 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33058857917785645
Time for copying to cuda: 0.009410619735717773
Time for forward pass: 0.04925251007080078
Time for backpropagation: 0.002827167510986328
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4796485900878906 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.484562635421753 seconds
Streaming imagenet data took 1.4987194538116455 seconds
Then, training+dataloading take 1.5011820793151855 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3726060390472412
Time for copying to cuda: 0.009430646896362305
Time for forward pass: 0.049341440200805664
Time for backpropagation: 0.0026214122772216797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5334248542785645 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5197558403015137 seconds
Streaming imagenet data took 1.533869743347168 seconds
Then, training+dataloading take 1.5362310409545898 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3734910488128662
Time for copying to cuda: 0.009344339370727539
Time for forward pass: 0.04924964904785156
Time for backpropagation: 0.002614259719848633
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5372028350830078 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4949438571929932 seconds
Streaming imagenet data took 1.508683443069458 seconds
Then, training+dataloading take 1.5109987258911133 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37015223503112793
Time for copying to cuda: 0.009657859802246094
Time for forward pass: 0.04931139945983887
Time for backpropagation: 0.0026700496673583984
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5465743541717529 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.478907585144043 seconds
Streaming imagenet data took 1.4926655292510986 seconds
Then, training+dataloading take 1.4949965476989746 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37859678268432617
Time for copying to cuda: 0.009404420852661133
Time for forward pass: 0.049341678619384766
Time for backpropagation: 0.002603292465209961
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5410027503967285 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4753222465515137 seconds
Streaming imagenet data took 1.489424705505371 seconds
Then, training+dataloading take 1.491811990737915 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.43280696868896484
Time for copying to cuda: 0.009465456008911133
Time for forward pass: 0.04933810234069824
Time for backpropagation: 0.0026597976684570312
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5779585838317871 seconds
Index: 11
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5322496891021729 seconds
Streaming imagenet data took 1.5859460830688477 seconds
Then, training+dataloading take 1.590202808380127 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.33417367935180664
Time for copying to cuda: 0.009543895721435547
Time for forward pass: 0.04936814308166504
Time for backpropagation: 0.0025739669799804688
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4799540042877197 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5061845779418945 seconds
Streaming imagenet data took 1.5202460289001465 seconds
Then, training+dataloading take 1.5228447914123535 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33428168296813965
Time for copying to cuda: 0.009320259094238281
Time for forward pass: 0.04932093620300293
Time for backpropagation: 0.0026884078979492188
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.47571873664855957 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.502425193786621 seconds
Streaming imagenet data took 1.5163121223449707 seconds
Then, training+dataloading take 1.518803596496582 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3331644535064697
Time for copying to cuda: 0.009311914443969727
Time for forward pass: 0.04938507080078125
Time for backpropagation: 0.0026209354400634766
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4855625629425049 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.468230962753296 seconds
Streaming imagenet data took 1.4821898937225342 seconds
Then, training+dataloading take 1.484710931777954 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.374373197555542
Time for copying to cuda: 0.009420394897460938
Time for forward pass: 0.04927945137023926
Time for backpropagation: 0.0026366710662841797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5498740673065186 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4803054332733154 seconds
Streaming imagenet data took 1.4944045543670654 seconds
Then, training+dataloading take 1.496898889541626 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3697364330291748
Time for copying to cuda: 0.00939798355102539
Time for forward pass: 0.04937481880187988
Time for backpropagation: 0.0026388168334960938
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5313947200775146 seconds
Index: 16
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.526824712753296 seconds
Streaming imagenet data took 1.5404880046844482 seconds
Then, training+dataloading take 1.5429308414459229 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3845067024230957
Time for copying to cuda: 0.00929403305053711
Time for forward pass: 0.04925227165222168
Time for backpropagation: 0.002604246139526367
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5490741729736328 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5064854621887207 seconds
Streaming imagenet data took 1.5202884674072266 seconds
Then, training+dataloading take 1.5227136611938477 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39109063148498535
Time for copying to cuda: 0.009418725967407227
Time for forward pass: 0.049337148666381836
Time for backpropagation: 0.0026955604553222656
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5517628192901611 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5086402893066406 seconds
Streaming imagenet data took 1.5225107669830322 seconds
Then, training+dataloading take 1.5249202251434326 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3736541271209717
Time for copying to cuda: 0.009503841400146484
Time for forward pass: 0.04945731163024902
Time for backpropagation: 0.002722501754760742
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.534306526184082 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4790046215057373 seconds
Streaming imagenet data took 1.493065357208252 seconds
Then, training+dataloading take 1.495528221130371 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37462520599365234
Time for copying to cuda: 0.009362936019897461
Time for forward pass: 0.04937601089477539
Time for backpropagation: 0.002722024917602539
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5355305671691895 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4875168800354004 seconds
Streaming imagenet data took 1.5012602806091309 seconds
Then, training+dataloading take 1.5037376880645752 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3772001266479492
Time for copying to cuda: 0.009400367736816406
Time for forward pass: 0.0495610237121582
Time for backpropagation: 0.0027446746826171875
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.557344913482666 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4907739162445068 seconds
Streaming imagenet data took 1.5049068927764893 seconds
Then, training+dataloading take 1.5073904991149902 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3750293254852295
Time for copying to cuda: 0.009435892105102539
Time for forward pass: 0.04928731918334961
Time for backpropagation: 0.002642393112182617
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5348777770996094 seconds
Index: 22
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5060148239135742 seconds
Streaming imagenet data took 1.5200064182281494 seconds
Then, training+dataloading take 1.522472620010376 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37195348739624023
Time for copying to cuda: 0.009444236755371094
Time for forward pass: 0.049512386322021484
Time for backpropagation: 0.0028722286224365234
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5486447811126709 seconds
Index: 23
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.512622594833374 seconds
Streaming imagenet data took 1.5265262126922607 seconds
Then, training+dataloading take 1.5287537574768066 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40503978729248047
Time for copying to cuda: 0.009407520294189453
Time for forward pass: 0.04944896697998047
Time for backpropagation: 0.002803802490234375
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5883677005767822 seconds
Index: 24
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.502333164215088 seconds
Streaming imagenet data took 1.5162827968597412 seconds
Then, training+dataloading take 1.5185811519622803 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38785576820373535
Time for copying to cuda: 0.009250879287719727
Time for forward pass: 0.04930424690246582
Time for backpropagation: 0.0026438236236572266
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5494997501373291 seconds
Index: 25
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.456329345703125 seconds
Streaming imagenet data took 1.4700682163238525 seconds
Then, training+dataloading take 1.4708278179168701 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37624216079711914
Time for copying to cuda: 0.009383201599121094
Time for forward pass: 0.049257755279541016
Time for backpropagation: 0.0026187896728515625
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5399761199951172 seconds
Index: 26
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4962940216064453 seconds
Streaming imagenet data took 1.5104074478149414 seconds
Then, training+dataloading take 1.5127816200256348 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3754761219024658
Time for copying to cuda: 0.009324073791503906
Time for forward pass: 0.049315690994262695
Time for backpropagation: 0.0025675296783447266
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5357050895690918 seconds
Index: 27
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4930088520050049 seconds
Streaming imagenet data took 1.5068421363830566 seconds
Then, training+dataloading take 1.5091369152069092 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.385300874710083
Time for copying to cuda: 0.009380102157592773
Time for forward pass: 0.04928326606750488
Time for backpropagation: 0.0026314258575439453
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.545201301574707 seconds
Index: 28
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5456430912017822 seconds
Streaming imagenet data took 1.5597615242004395 seconds
Then, training+dataloading take 1.5620372295379639 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38831067085266113
Time for copying to cuda: 0.009365081787109375
Time for forward pass: 0.04934072494506836
Time for backpropagation: 0.0025675296783447266
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5739109516143799 seconds
Index: 29
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4978318214416504 seconds
Streaming imagenet data took 1.5120022296905518 seconds
Then, training+dataloading take 1.5143311023712158 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37735438346862793
Time for copying to cuda: 0.009607076644897461
Time for forward pass: 0.04945635795593262
Time for backpropagation: 0.0026667118072509766
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5380432605743408 seconds
Index: 30
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4836454391479492 seconds
Streaming imagenet data took 1.4973669052124023 seconds
Then, training+dataloading take 1.4996800422668457 seconds

Epoch: 0
Time of next(dataloader) is: 0.38658571243286133
Time for copying to cuda: 0.00926661491394043
Time for forward pass: 0.04923510551452637
Time for backpropagation: 0.0025665760040283203
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
The whole process took 59.07889676094055 seconds
