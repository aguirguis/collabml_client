Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=4000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.2886494368832 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118920137.85899116 118920137.85899116
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  1350.7978515625 7453.9404296875 8804.73828125 106219.5654296875
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 4000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 36.928964614868164 seconds
Streaming imagenet data took 37.54725694656372 seconds
The mode is:  split
Start 4000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.2729580402374268
Time for copying to cuda: 0.39046692848205566
Time for forward pass: 7.993836402893066
Time for backpropagation: 0.11332130432128906
GPU memory for training: 23.539535999298096                          

Memory occpied: (1894.0, 3.0)
One training iteration takes: 10.020638704299927 seconds
Index: 0
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Memory occpied: (4944.0, 12948.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 37.20234751701355 seconds
Memory occpied: (4944.0, 12948.0)
Streaming imagenet data took 37.891117572784424 seconds
Then, training+dataloading take 37.97491455078125 seconds
The mode is:  split
Start 8000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (4944.0, 12948.0)
Time of next(dataloader) is: 1.2780258655548096
Time for copying to cuda: 0.3890345096588135
Memory occpied: (11792.0, 12956.0)
Time for forward pass: 0.970496654510498
Time for backpropagation: 0.004326820373535156
GPU memory for training: 12.767632007598877                          

One training iteration takes: 2.901660680770874 seconds
Index: 1
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 37.29271197319031 seconds
Memory occpied: (11792.0, 12956.0)
Streaming imagenet data took 37.990240812301636 seconds
Then, training+dataloading take 38.06995701789856 seconds
The mode is:  split
Start 12000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (11792.0, 12956.0)
Time of next(dataloader) is: 1.2443196773529053
Time for copying to cuda: 0.3893580436706543
Memory occpied: (11792.0, 12956.0)
Time for forward pass: 0.9969229698181152
Time for backpropagation: 0.0043087005615234375
GPU memory for training: 12.767632007598877                          

One training iteration takes: 2.8752167224884033 seconds
Index: 2
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 37.06337594985962 seconds
Memory occpied: (11792.0, 12956.0)
Streaming imagenet data took 37.683998823165894 seconds
Then, training+dataloading take 37.76423645019531 seconds
The mode is:  split
Start 16000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (11792.0, 12956.0)
Time of next(dataloader) is: 1.2436602115631104
Time for copying to cuda: 0.3887193202972412
Memory occpied: (11792.0, 12956.0)
Time for forward pass: 0.9996986389160156
Time for backpropagation: 0.004286289215087891
GPU memory for training: 12.767632007598877                          

One training iteration takes: 2.8953495025634766 seconds
Index: 3
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 37.23607778549194 seconds
Memory occpied: (11792.0, 12956.0)
Streaming imagenet data took 37.92778205871582 seconds
Then, training+dataloading take 38.0082893371582 seconds
The mode is:  split
Start 20000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (11792.0, 12956.0)
Time of next(dataloader) is: 1.21718168258667
Time for copying to cuda: 0.39046764373779297
Memory occpied: (11792.0, 12956.0)
Time for forward pass: 0.9750425815582275
Time for backpropagation: 0.004575967788696289
GPU memory for training: 12.767632007598877                          

One training iteration takes: 2.8557822704315186 seconds
Index: 4
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 37.24589443206787 seconds
Memory occpied: (11792.0, 12956.0)
Streaming imagenet data took 37.94489932060242 seconds
Then, training+dataloading take 38.05574989318848 seconds
The mode is:  split
Start 24000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (11792.0, 12956.0)
Time of next(dataloader) is: 1.2192583084106445
Time for copying to cuda: 0.38983917236328125
Memory occpied: (11792.0, 12956.0)
Time for forward pass: 1.0073518753051758
Time for backpropagation: 0.004531145095825195
GPU memory for training: 12.767632007598877                          

One training iteration takes: 2.851789712905884 seconds
Index: 5
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 37.29450464248657 seconds
Memory occpied: (11792.0, 12956.0)
Streaming imagenet data took 37.977699518203735 seconds
Then, training+dataloading take 38.072930335998535 seconds
The mode is:  split
Start 28000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (11792.0, 12956.0)
Time of next(dataloader) is: 1.217717170715332
Time for copying to cuda: 0.39065074920654297
Memory occpied: (11792.0, 12956.0)
Time for forward pass: 0.9608666896820068
Time for backpropagation: 0.004546403884887695
GPU memory for training: 12.767632007598877                          

One training iteration takes: 2.8138608932495117 seconds
Index: 6
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Memory occpied: (11792.0, 12956.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 37.30943965911865 seconds
Memory occpied: (11792.0, 12956.0)
Streaming imagenet data took 38.011380195617676 seconds
Then, training+dataloading take 38.107115030288696 seconds

Epoch: 0
Memory occpied: (11792.0, 12956.0)
Time of next(dataloader) is: 1.2152330875396729
Time for copying to cuda: 0.3870515823364258
Memory occpied: (11792.0, 12956.0)
Time for forward pass: 0.9857664108276367
Time for backpropagation: 0.004592180252075195
GPU memory for training: 12.767632007598877                          

The whole process took 314.620041847229 seconds
