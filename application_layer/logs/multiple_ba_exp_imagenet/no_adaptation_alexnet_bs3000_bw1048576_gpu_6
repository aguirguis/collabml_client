Cached  True
Transformed  True
All in COS  False
No adaptation  True
Namespace(all_in_cos=False, batch_size=3000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=True, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3433236823646 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119058376.1216949 119058376.1216949
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 854.00146484375 1153.09912109375 6902.34130859375
Candidate split  13
Server, client, server+client, vanilla  299.09765625 854.00146484375 1153.09912109375 6902.34130859375
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 3000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.2686378955841064 seconds
Streaming imagenet data took 3.3089585304260254 seconds
The mode is:  split
Start 3000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3838515281677246
Time for copying to cuda: 0.02787327766418457
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.3186285495758057 seconds
Streaming imagenet data took 3.3619279861450195 seconds
Time for forward pass: 3.026496648788452
Time for backpropagation: 0.049002647399902344
GPU memory for training: 1.195061206817627                          

One training iteration takes: 3.5830438137054443 seconds
Index: 0
Then, training+dataloading take 3.583258867263794 seconds
The mode is:  split
Start 6000, end 9000, post_step 1000


Epoch: 0
Memory occpied: (1514.0, 1672.0)
Time of next(dataloader) is: 0.37937045097351074
Time for copying to cuda: 0.027683734893798828
Time for forward pass: 0.0847785472869873
Time for backpropagation: 0.004087209701538086
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.5853898525238037 seconds
Index: 1
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.685478448867798 seconds
Streaming imagenet data took 2.7262930870056152 seconds
Then, training+dataloading take 2.730604887008667 seconds
The mode is:  split
Start 9000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3947582244873047
Time for copying to cuda: 0.02722954750061035
Time for forward pass: 0.10199785232543945
Time for backpropagation: 0.0028018951416015625
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6148707866668701 seconds
Index: 2
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.637910842895508 seconds
Streaming imagenet data took 2.6820785999298096 seconds
Then, training+dataloading take 2.6874582767486572 seconds
The mode is:  split
Start 12000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38951635360717773
Time for copying to cuda: 0.02741527557373047
Time for forward pass: 0.13855981826782227
Time for backpropagation: 0.0034143924713134766
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6691889762878418 seconds
Index: 3
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.60215163230896 seconds
Streaming imagenet data took 2.643090009689331 seconds
Then, training+dataloading take 2.6485655307769775 seconds
The mode is:  split
Start 15000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39383721351623535
Time for copying to cuda: 0.027071475982666016
Memory occpied: (2440.0, 1680.0)
Time for forward pass: 0.11858487129211426
Time for backpropagation: 0.002862215042114258
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.633465051651001 seconds
Index: 4
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.3415329456329346 seconds
Streaming imagenet data took 3.3822860717773438 seconds
Then, training+dataloading take 3.387784242630005 seconds
The mode is:  split
Start 18000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4082520008087158
Time for copying to cuda: 0.02705097198486328
Time for forward pass: 0.10207748413085938
Time for backpropagation: 0.0028738975524902344
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6653625965118408 seconds
Index: 5
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.1196720600128174 seconds
Streaming imagenet data took 3.200371265411377 seconds
Then, training+dataloading take 3.211054801940918 seconds
The mode is:  split
Start 21000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (2440.0, 1680.0)
Time of next(dataloader) is: 0.3966503143310547
Time for copying to cuda: 0.027157306671142578
Time for forward pass: 0.10199308395385742
Time for backpropagation: 0.0028181076049804688
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.632770299911499 seconds
Index: 6
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 3.357990026473999 seconds
Streaming imagenet data took 3.39959979057312 seconds
Then, training+dataloading take 3.405522108078003 seconds
The mode is:  split
Start 24000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47548627853393555
Time for copying to cuda: 0.027307510375976562
Time for forward pass: 0.10210180282592773
Time for backpropagation: 0.002910614013671875
GPU memory for training: 1.3507170677185059                          

Memory occpied: (2440.0, 1680.0)
One training iteration takes: 0.6944029331207275 seconds
Index: 7
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.675208568572998 seconds
Streaming imagenet data took 2.7159183025360107 seconds
Then, training+dataloading take 2.7216289043426514 seconds
The mode is:  split
Start 27000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.452392578125
Time for copying to cuda: 0.027231931686401367
Time for forward pass: 0.10191559791564941
Time for backpropagation: 0.0027348995208740234
GPU memory for training: 1.3507170677185059                          

One training iteration takes: 0.6904597282409668 seconds
Index: 8
Memory occpied: (2440.0, 1680.0)
Memory occpied: (2440.0, 1680.0)
Read 105.59066390991211 MBs for this batch
Executing all posts took 2.6109907627105713 seconds
Streaming imagenet data took 2.652627468109131 seconds
Then, training+dataloading take 2.658383369445801 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40082311630249023
Time for copying to cuda: 0.027553081512451172
Time for forward pass: 0.1024627685546875
Time for backpropagation: 0.003312349319458008
GPU memory for training: 1.3507170677185059                          

Memory occpied: (2440.0, 1680.0)
One training iteration takes: 0.610356330871582 seconds
Index: 9
Memory occpied: (2440.0, 1680.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.432328701019287 seconds
Streaming imagenet data took 2.460000991821289 seconds
Then, training+dataloading take 2.464348316192627 seconds

Epoch: 0
Time of next(dataloader) is: 0.3863379955291748
Time for copying to cuda: 0.01860952377319336
Time for forward pass: 0.07709550857543945
Time for backpropagation: 0.0037996768951416016
GPU memory for training: 1.255445957183838                          

Memory occpied: (2440.0, 1680.0)
The whole process took 40.80723428726196 seconds
