Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 906.8783750479098 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118866362.37427963 118866362.37427963
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 647.1533203125 946.2509765625 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 647.1533203125 946.2509765625 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.029303550720215 seconds
Streaming imagenet data took 2.056443929672241 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.326953649520874
Time for copying to cuda: 0.019183874130249023
Memory occpied: (1586.0, 22.0)
Memory occpied: (1586.0, 598.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9787461757659912 seconds
Streaming imagenet data took 2.006134033203125 seconds
Memory occpied: (1586.0, 1054.0)
Time for forward pass: 3.2316577434539795
Time for backpropagation: 0.04853177070617676
GPU memory for training: 1.102445125579834                          

One training iteration takes: 3.704955577850342 seconds
Index: 0
Then, training+dataloading take 3.7052175998687744 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39228010177612305
Time for copying to cuda: 0.018657445907592773
Time for forward pass: 0.07554435729980469
Time for backpropagation: 0.0037078857421875
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6131501197814941 seconds
Index: 1
Memory occpied: (2100.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.140378475189209 seconds
Streaming imagenet data took 2.1679019927978516 seconds
Then, training+dataloading take 2.1742560863494873 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36565065383911133
Time for copying to cuda: 0.0187528133392334
Time for forward pass: 0.0754690170288086
Time for backpropagation: 0.0026841163635253906
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5524871349334717 seconds
Index: 2
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8409581184387207 seconds
Streaming imagenet data took 1.8687753677368164 seconds
Then, training+dataloading take 1.8732068538665771 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.400554895401001
Time for copying to cuda: 0.018181562423706055
Time for forward pass: 0.07539200782775879
Time for backpropagation: 0.002707958221435547
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5987389087677002 seconds
Index: 3
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9792125225067139 seconds
Streaming imagenet data took 2.006439685821533 seconds
Then, training+dataloading take 2.0112879276275635 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3628814220428467
Time for copying to cuda: 0.018340349197387695
Time for forward pass: 0.0753321647644043
Time for backpropagation: 0.0026781558990478516
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5461897850036621 seconds
Index: 4
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8759970664978027 seconds
Streaming imagenet data took 1.9030437469482422 seconds
Then, training+dataloading take 1.9077136516571045 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4411773681640625
Memory occpied: (2326.0, 1632.0)
Time for copying to cuda: 0.018517255783081055
Time for forward pass: 0.07538247108459473
Time for backpropagation: 0.0026366710662841797
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.6289613246917725 seconds
Index: 5
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9576709270477295 seconds
Streaming imagenet data took 1.9848928451538086 seconds
Then, training+dataloading take 1.989229440689087 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36109423637390137
Time for copying to cuda: 0.01861858367919922
Time for forward pass: 0.07550215721130371
Time for backpropagation: 0.0027289390563964844
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5467431545257568 seconds
Index: 6
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8863296508789062 seconds
Streaming imagenet data took 1.9530084133148193 seconds
Then, training+dataloading take 1.9609911441802979 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3996260166168213
Time for copying to cuda: 0.018370628356933594
Time for forward pass: 0.07555294036865234
Time for backpropagation: 0.002743244171142578
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.58614182472229 seconds
Index: 7
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9634826183319092 seconds
Streaming imagenet data took 1.9907591342926025 seconds
Then, training+dataloading take 1.995389699935913 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36124324798583984
Time for copying to cuda: 0.01835012435913086
Time for forward pass: 0.07541346549987793
Time for backpropagation: 0.0027208328247070312
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5706560611724854 seconds
Index: 8
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.888091802597046 seconds
Streaming imagenet data took 1.9155457019805908 seconds
Then, training+dataloading take 1.9201111793518066 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4029109477996826
Time for copying to cuda: 0.01844930648803711
Time for forward pass: 0.07465386390686035
Time for backpropagation: 0.0026044845581054688
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.617279052734375 seconds
Index: 9
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9398627281188965 seconds
Streaming imagenet data took 1.9676415920257568 seconds
Then, training+dataloading take 1.9726381301879883 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37053680419921875
Time for copying to cuda: 0.018388748168945312
Time for forward pass: 0.0755155086517334
Time for backpropagation: 0.002729177474975586
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5637507438659668 seconds
Index: 10
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8743841648101807 seconds
Streaming imagenet data took 1.9018185138702393 seconds
Then, training+dataloading take 1.9066097736358643 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4152259826660156
Time for copying to cuda: 0.01835799217224121
Time for forward pass: 0.07558774948120117
Time for backpropagation: 0.002744913101196289
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.606947660446167 seconds
Index: 11
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9490303993225098 seconds
Streaming imagenet data took 1.9767146110534668 seconds
Then, training+dataloading take 1.9814059734344482 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36479854583740234
Time for copying to cuda: 0.01845264434814453
Time for forward pass: 0.07408833503723145
Time for backpropagation: 0.0026826858520507812
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.5478003025054932 seconds
Index: 12
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8524837493896484 seconds
Streaming imagenet data took 1.879455327987671 seconds
Then, training+dataloading take 1.8839364051818848 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3687925338745117
Time for copying to cuda: 0.018878936767578125
Time for forward pass: 0.07654953002929688
Time for backpropagation: 0.003321409225463867
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
One training iteration takes: 0.5810117721557617 seconds
Index: 13
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.941730260848999 seconds
Streaming imagenet data took 1.9699220657348633 seconds
Then, training+dataloading take 1.9749770164489746 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3652064800262451
Time for copying to cuda: 0.018435239791870117
Time for forward pass: 0.07539963722229004
Time for backpropagation: 0.0026845932006835938
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.562110424041748 seconds
Index: 14
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8413221836090088 seconds
Streaming imagenet data took 1.868382453918457 seconds
Then, training+dataloading take 1.8733642101287842 seconds

Epoch: 0
Time of next(dataloader) is: 0.40509557723999023
Time for copying to cuda: 0.018809795379638672
Time for forward pass: 0.0754244327545166
Time for backpropagation: 0.002621173858642578
GPU memory for training: 1.2580008506774902                          

Memory occpied: (2326.0, 1632.0)
The whole process took 41.33157515525818 seconds
