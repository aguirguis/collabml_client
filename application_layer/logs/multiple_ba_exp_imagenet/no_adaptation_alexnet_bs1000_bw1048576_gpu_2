Cached  True
Transformed  True
All in COS  False
No adaptation  True
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=True, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.4943117223085 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119078166.42606641 119078166.42606641
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  299.09765625 440.30517578125 739.40283203125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.832716703414917 seconds
Streaming imagenet data took 1.8464491367340088 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3043670654296875
Time for copying to cuda: 0.010019063949584961
Memory occpied: (1550.0, 192.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.809149980545044 seconds
Memory occpied: (1550.0, 650.0)
Streaming imagenet data took 1.8235158920288086 seconds
Memory occpied: (1550.0, 1072.0)
Time for forward pass: 3.237985610961914
Time for backpropagation: 0.04875683784484863
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.6663119792938232 seconds
Index: 0
Then, training+dataloading take 3.6665172576904297 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3260231018066406
Time for copying to cuda: 0.04449200630187988
Time for forward pass: 0.050357818603515625
Time for backpropagation: 0.0035009384155273438
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.5043339729309082 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.893965244293213 seconds
Streaming imagenet data took 1.9078235626220703 seconds
Then, training+dataloading take 1.9100425243377686 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32801318168640137
Time for copying to cuda: 0.009439468383789062
Time for forward pass: 0.049198150634765625
Time for backpropagation: 0.0025682449340820312
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4738333225250244 seconds
Index: 2
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7500827312469482 seconds
Streaming imagenet data took 1.7643017768859863 seconds
Then, training+dataloading take 1.7666685581207275 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3687307834625244
Time for copying to cuda: 0.009411811828613281
Time for forward pass: 0.04925727844238281
Time for backpropagation: 0.002527475357055664
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5294649600982666 seconds
Index: 3
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.782989263534546 seconds
Memory occpied: (2290.0, 1578.0)
Streaming imagenet data took 1.79718017578125 seconds
Then, training+dataloading take 1.7995266914367676 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33649730682373047
Time for copying to cuda: 0.009354114532470703
Time for forward pass: 0.04921746253967285
Time for backpropagation: 0.0027208328247070312
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4807875156402588 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7050936222076416 seconds
Streaming imagenet data took 1.7188835144042969 seconds
Then, training+dataloading take 1.7212424278259277 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3260819911956787
Time for copying to cuda: 0.009407758712768555
Time for forward pass: 0.049226999282836914
Time for backpropagation: 0.0026085376739501953
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4615168571472168 seconds
Index: 5
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7533936500549316 seconds
Streaming imagenet data took 1.7673957347869873 seconds
Then, training+dataloading take 1.7697560787200928 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.373032808303833
Time for copying to cuda: 0.009587526321411133
Time for forward pass: 0.049494266510009766
Time for backpropagation: 0.002698659896850586
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5176811218261719 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7456600666046143 seconds
Streaming imagenet data took 1.7597827911376953 seconds
Then, training+dataloading take 1.7621808052062988 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3237338066101074
Time for copying to cuda: 0.009348154067993164
Time for forward pass: 0.04940986633300781
Time for backpropagation: 0.002668142318725586
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4716203212738037 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6858432292938232 seconds
Streaming imagenet data took 1.699573278427124 seconds
Then, training+dataloading take 1.7019882202148438 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33202505111694336
Time for copying to cuda: 0.009513378143310547
Time for forward pass: 0.04923105239868164
Time for backpropagation: 0.0027565956115722656
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48461079597473145 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7511045932769775 seconds
Streaming imagenet data took 1.8021562099456787 seconds
Then, training+dataloading take 1.8063874244689941 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.32996535301208496
Time for copying to cuda: 0.009486198425292969
Time for forward pass: 0.0493776798248291
Time for backpropagation: 0.0026009082794189453
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4840552806854248 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6977391242980957 seconds
Streaming imagenet data took 1.7116138935089111 seconds
Then, training+dataloading take 1.714221477508545 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33748674392700195
Time for copying to cuda: 0.009458780288696289
Time for forward pass: 0.0493466854095459
Time for backpropagation: 0.0028259754180908203
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4814155101776123 seconds
Index: 10
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6647753715515137 seconds
Streaming imagenet data took 1.6788091659545898 seconds
Then, training+dataloading take 1.6812636852264404 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4181349277496338
Time for copying to cuda: 0.009467124938964844
Time for forward pass: 0.0492706298828125
Time for backpropagation: 0.0025811195373535156
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5624773502349854 seconds
Index: 11
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8094825744628906 seconds
Streaming imagenet data took 1.823373556137085 seconds
Then, training+dataloading take 1.825866937637329 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3394796848297119
Time for copying to cuda: 0.009397029876708984
Time for forward pass: 0.04926347732543945
Time for backpropagation: 0.002518892288208008
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.46657490730285645 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7523231506347656 seconds
Streaming imagenet data took 1.766728162765503 seconds
Then, training+dataloading take 1.7692337036132812 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3769712448120117
Time for copying to cuda: 0.009380578994750977
Time for forward pass: 0.04931783676147461
Time for backpropagation: 0.0028600692749023438
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5562140941619873 seconds
Index: 13
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7191882133483887 seconds
Streaming imagenet data took 1.7707479000091553 seconds
Then, training+dataloading take 1.775073766708374 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3409135341644287
Time for copying to cuda: 0.009411811828613281
Time for forward pass: 0.04942035675048828
Time for backpropagation: 0.0026116371154785156
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4891035556793213 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7159850597381592 seconds
Streaming imagenet data took 1.730135440826416 seconds
Then, training+dataloading take 1.7327940464019775 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3372929096221924
Time for copying to cuda: 0.009607791900634766
Time for forward pass: 0.049306392669677734
Time for backpropagation: 0.002664804458618164
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4900674819946289 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6773788928985596 seconds
Streaming imagenet data took 1.6916348934173584 seconds
Then, training+dataloading take 1.6941814422607422 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3674647808074951
Time for copying to cuda: 0.009472131729125977
Time for forward pass: 0.04925227165222168
Time for backpropagation: 0.0025649070739746094
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5449275970458984 seconds
Index: 16
Memory occpied: (2290.0, 1578.0)
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8390746116638184 seconds
Streaming imagenet data took 1.8532323837280273 seconds
Then, training+dataloading take 1.855696678161621 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3323338031768799
Time for copying to cuda: 0.009453296661376953
Time for forward pass: 0.049341678619384766
Time for backpropagation: 0.002591848373413086
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4758718013763428 seconds
Index: 17
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7095913887023926 seconds
Streaming imagenet data took 1.7240722179412842 seconds
Then, training+dataloading take 1.7265808582305908 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.326829195022583
Time for copying to cuda: 0.009386777877807617
Time for forward pass: 0.04936385154724121
Time for backpropagation: 0.002640247344970703
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.47826600074768066 seconds
Index: 18
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7441718578338623 seconds
Streaming imagenet data took 1.8060367107391357 seconds
Then, training+dataloading take 1.8104753494262695 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3521890640258789
Time for copying to cuda: 0.009504079818725586
Time for forward pass: 0.04926943778991699
Time for backpropagation: 0.002671957015991211
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4953429698944092 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7177939414978027 seconds
Streaming imagenet data took 1.7315595149993896 seconds
Then, training+dataloading take 1.7343018054962158 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3312711715698242
Time for copying to cuda: 0.009398460388183594
Time for forward pass: 0.04925704002380371
Time for backpropagation: 0.002614736557006836
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4850330352783203 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6749837398529053 seconds
Streaming imagenet data took 1.6889374256134033 seconds
Then, training+dataloading take 1.6913025379180908 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3814852237701416
Time for copying to cuda: 0.009250640869140625
Time for forward pass: 0.049303531646728516
Time for backpropagation: 0.0025594234466552734
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5482485294342041 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6983451843261719 seconds
Streaming imagenet data took 1.7122743129730225 seconds
Then, training+dataloading take 1.7147133350372314 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.3701207637786865
Time for copying to cuda: 0.009396791458129883
Time for forward pass: 0.04948019981384277
Time for backpropagation: 0.002698183059692383
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.51548171043396 seconds
Index: 22
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.728879690170288 seconds
Streaming imagenet data took 1.7427427768707275 seconds
Then, training+dataloading take 1.7453160285949707 seconds
The mode is:  split
Start 24000, end 25000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33383941650390625
Time for copying to cuda: 0.009473562240600586
Time for forward pass: 0.0492701530456543
Time for backpropagation: 0.002752542495727539
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4827878475189209 seconds
Index: 23
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.677593469619751 seconds
Streaming imagenet data took 1.6917166709899902 seconds
Then, training+dataloading take 1.6942765712738037 seconds
The mode is:  split
Start 25000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4298276901245117
Time for copying to cuda: 0.009583711624145508
Time for forward pass: 0.04938864707946777
Time for backpropagation: 0.0026712417602539062
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5811312198638916 seconds
Index: 24
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7708420753479004 seconds
Streaming imagenet data took 1.7846834659576416 seconds
Then, training+dataloading take 1.7871856689453125 seconds
The mode is:  split
Start 26000, end 27000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3413093090057373
Time for copying to cuda: 0.00956869125366211
Time for forward pass: 0.049437761306762695
Time for backpropagation: 0.0030035972595214844
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.49184703826904297 seconds
Index: 25
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6827011108398438 seconds
Streaming imagenet data took 1.6965081691741943 seconds
Then, training+dataloading take 1.6989917755126953 seconds
The mode is:  split
Start 27000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37824368476867676
Time for copying to cuda: 0.009621620178222656
Time for forward pass: 0.04959750175476074
Time for backpropagation: 0.040224313735961914
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5656082630157471 seconds
Index: 26
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7496905326843262 seconds
Memory occpied: (2290.0, 1578.0)
Streaming imagenet data took 1.763993501663208 seconds
Then, training+dataloading take 1.7665727138519287 seconds
The mode is:  split
Start 28000, end 29000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33185362815856934
Time for copying to cuda: 0.009532928466796875
Time for forward pass: 0.049280405044555664
Time for backpropagation: 0.0025577545166015625
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.4730217456817627 seconds
Index: 27
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7243068218231201 seconds
Streaming imagenet data took 1.7384848594665527 seconds
Then, training+dataloading take 1.7411179542541504 seconds
The mode is:  split
Start 29000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33148860931396484
Time for copying to cuda: 0.009506702423095703
Time for forward pass: 0.04927325248718262
Time for backpropagation: 0.002630949020385742
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48701047897338867 seconds
Index: 28
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7291944026947021 seconds
Streaming imagenet data took 1.7435834407806396 seconds
Then, training+dataloading take 1.7459557056427002 seconds
The mode is:  split
Start 30000, end 31000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3695387840270996
Time for copying to cuda: 0.009518623352050781
Time for forward pass: 0.04932403564453125
Time for backpropagation: 0.002741098403930664
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5224449634552002 seconds
Index: 29
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.795318365097046 seconds
Streaming imagenet data took 1.8092117309570312 seconds
Then, training+dataloading take 1.8117082118988037 seconds
The mode is:  split
Start 31000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33632564544677734
Time for copying to cuda: 0.009415626525878906
Time for forward pass: 0.04930853843688965
Time for backpropagation: 0.0025408267974853516
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.48894762992858887 seconds
Index: 30
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.6933388710021973 seconds
Streaming imagenet data took 1.707263469696045 seconds
Then, training+dataloading take 1.709794282913208 seconds

Epoch: 0
Time of next(dataloader) is: 0.334522008895874
Time for copying to cuda: 0.009307622909545898
Time for forward pass: 0.08645415306091309
Time for backpropagation: 0.0031898021697998047
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
The whole process took 66.23158669471741 seconds
