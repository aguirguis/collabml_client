Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=4000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3375805943728 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119057623.36366563 119057623.36366563
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.015625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  1309.583984375 1100.2265625 2409.810546875 101334.6015625
Candidate split  23
Server, client, server+client, vanilla  1309.583984375 1100.2265625 2409.810546875 101334.6015625
Model size  507.208984375
Fixed, scale_with_bsz  507.208984375 25.07421875
Mem usage  1840.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 4000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 10.977751731872559 seconds
Streaming imagenet data took 11.002837657928467 seconds
The mode is:  split
Start 4000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3374507427215576
Time for copying to cuda: 0.01705789566040039
Memory occpied: (1904.0, 188.0)
Memory occpied: (1904.0, 640.0)
Memory occpied: (1904.0, 1068.0)
Time for forward pass: 3.2903854846954346
Time for backpropagation: 0.048964500427246094
GPU memory for training: 2.1986184120178223                          

One training iteration takes: 3.7678308486938477 seconds
Index: 0
Memory occpied: (3090.0, 1922.0)
Memory occpied: (3090.0, 1922.0)
Memory occpied: (3090.0, 1922.0)
Memory occpied: (3090.0, 1922.0)
Memory occpied: (3090.0, 1922.0)
Memory occpied: (3090.0, 1922.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 10.970660924911499 seconds
Streaming imagenet data took 10.995674848556519 seconds
Then, training+dataloading take 10.997275114059448 seconds
The mode is:  split
Start 8000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40332818031311035
Time for copying to cuda: 0.016715526580810547
Time for forward pass: 0.081451416015625
Time for backpropagation: 0.0031239986419677734
GPU memory for training: 2.354409694671631                          

One training iteration takes: 0.6257917881011963 seconds
Index: 1
Memory occpied: (3090.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 10.966519355773926 seconds
Streaming imagenet data took 10.991894245147705 seconds
Then, training+dataloading take 10.993571281433105 seconds
The mode is:  split
Start 12000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.420032262802124
Time for copying to cuda: 0.016647815704345703
Time for forward pass: 0.08164262771606445
Time for backpropagation: 0.0031404495239257812
GPU memory for training: 2.354409694671631                          

One training iteration takes: 0.6244325637817383 seconds
Index: 2
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 11.041883707046509 seconds
Streaming imagenet data took 11.066450357437134 seconds
Then, training+dataloading take 11.068135261535645 seconds
The mode is:  split
Start 16000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39836621284484863
Time for copying to cuda: 0.01656818389892578
Memory occpied: (3492.0, 1930.0)
Time for forward pass: 0.08172726631164551
Time for backpropagation: 0.0032024383544921875
GPU memory for training: 2.354409694671631                          

One training iteration takes: 0.5694732666015625 seconds
Index: 3
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 11.356891870498657 seconds
Streaming imagenet data took 11.381911754608154 seconds
Then, training+dataloading take 11.38430118560791 seconds
The mode is:  split
Start 20000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3611173629760742
Time for copying to cuda: 0.016615629196166992
Time for forward pass: 0.08148789405822754
Time for backpropagation: 0.0030946731567382812
GPU memory for training: 2.354409694671631                          

One training iteration takes: 0.5457265377044678 seconds
Index: 4
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 11.129125356674194 seconds
Streaming imagenet data took 11.153818368911743 seconds
Then, training+dataloading take 11.155503034591675 seconds
The mode is:  split
Start 24000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36862754821777344
Time for copying to cuda: 0.01647496223449707
Time for forward pass: 0.08148026466369629
Time for backpropagation: 0.003117799758911133
GPU memory for training: 2.354409694671631                          

One training iteration takes: 0.5636537075042725 seconds
Index: 5
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 11.129009485244751 seconds
Streaming imagenet data took 11.15441107749939 seconds
Then, training+dataloading take 11.156111717224121 seconds
The mode is:  split
Start 28000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40227580070495605
Time for copying to cuda: 0.016630172729492188
Time for forward pass: 0.0816645622253418
Time for backpropagation: 0.0031652450561523438
GPU memory for training: 2.354409694671631                          

Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
One training iteration takes: 5.5211100578308105 seconds
Index: 6
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Memory occpied: (3492.0, 1930.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 11.113592863082886 seconds
Streaming imagenet data took 11.13855266571045 seconds
Then, training+dataloading take 11.140256643295288 seconds

Epoch: 0
Time of next(dataloader) is: 0.397411584854126
Time for copying to cuda: 0.01653313636779785
Time for forward pass: 0.08157205581665039
Time for backpropagation: 0.003122568130493164
GPU memory for training: 2.354409694671631                          

Memory occpied: (3492.0, 1930.0)
The whole process took 98.3486795425415 seconds
