Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='myvit', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Error of iperf: unable to connect to server: 
Recorded bandwidth: 908.2855256674147 Mbps
All candidates indexes:  (array([15, 16, 17, 18]),)
Communication time:  [5.05760564e-03 5.08340975e-03 5.08340975e-03 1.42732614e-01
 1.42732614e-01 1.42732614e-01 1.42732614e-01 1.42732614e-01
 1.42732614e-01 1.42732614e-01 1.42732614e-01 1.42732614e-01
 1.42732614e-01 1.42732614e-01 1.42732614e-01 2.58041104e-05
 2.58041104e-05 2.58041104e-05 3.35991021e-05]
Computation time:  [0.09811711311340332, 0.0960381031036377, 0.09562301635742188, 0.09554481506347656, 0.08618521690368652, 0.07825732231140137, 0.07053637504577637, 0.062338829040527344, 0.05419421195983887, 0.04647970199584961, 0.0387420654296875, 0.031044721603393555, 0.023382186889648438, 0.015708208084106445, 0.007991313934326172, 0.0003063678741455078, 0.00012874603271484375, 0.00012493133544921875, 0.0001227855682373047]
Indexes that satisfies the communication less than computation:  [15, 16, 17, 18]
330.2294006347656 0.024540250142415364
Using split index: 16
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Memory occpied: (1630.0, 3.0)
Read 23.700912475585938 MBs for this batch
Executing all posts took 67.10807394981384 seconds
Streaming imagenet data took 67.12005567550659 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36434006690979004
Time for copying to cuda: 0.007182121276855469
Memory occpied: (1654.0, 258.0)
Memory occpied: (1654.0, 686.0)
Memory occpied: (1654.0, 1156.0)
Time for forward pass: 3.3628854751586914
Time for backpropagation: 0.07824563980102539
GPU memory for training: 1.3932108879089355                          

One training iteration takes: 3.8955605030059814 seconds
Index: 0
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Memory occpied: (2426.0, 1672.0)
Read 23.700912475585938 MBs for this batch
Executing all posts took 70.70086979866028 seconds
Streaming imagenet data took 70.71318459510803 seconds
Then, training+dataloading take 70.71562170982361 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4974031448364258
Time for copying to cuda: 0.006597995758056641
Time for forward pass: 0.057227134704589844
Time for backpropagation: 0.05753803253173828
GPU memory for training: 1.4081978797912598                          

Memory occpied: (2434.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
One training iteration takes: 10.639614343643188 seconds
Index: 1
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Read 23.700912475585938 MBs for this batch
Executing all posts took 69.22576093673706 seconds
Streaming imagenet data took 69.23830842971802 seconds
Then, training+dataloading take 69.2409098148346 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (2454.0, 1680.0)
Time of next(dataloader) is: 0.4539353847503662
Time for copying to cuda: 0.00655817985534668
Time for forward pass: 0.05695199966430664
Time for backpropagation: 0.008324146270751953
GPU memory for training: 1.408215045928955                          

One training iteration takes: 0.6267185211181641 seconds
Index: 2
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Read 23.700912475585938 MBs for this batch
Executing all posts took 70.94358682632446 seconds
Streaming imagenet data took 70.95205783843994 seconds
Then, training+dataloading take 70.95482850074768 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4426865577697754
Time for copying to cuda: 0.006516456604003906
Time for forward pass: 0.056702375411987305
Time for backpropagation: 0.008287191390991211
GPU memory for training: 1.408215045928955                          

One training iteration takes: 0.6161448955535889 seconds
Index: 3
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Read 23.700912475585938 MBs for this batch
Executing all posts took 70.48669075965881 seconds
Streaming imagenet data took 70.49895977973938 seconds
Then, training+dataloading take 70.50228333473206 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4254786968231201
Time for copying to cuda: 0.00665283203125
Time for forward pass: 0.05710148811340332
Time for backpropagation: 0.00834798812866211
GPU memory for training: 1.408215045928955                          

One training iteration takes: 0.6023209095001221 seconds
Index: 4
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Read 23.700912475585938 MBs for this batch
Executing all posts took 70.33160519599915 seconds
Streaming imagenet data took 70.3397843837738 seconds
Then, training+dataloading take 70.34334659576416 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46794915199279785
Time for copying to cuda: 0.00657963752746582
Time for forward pass: 0.05679035186767578
Time for backpropagation: 0.008095741271972656
GPU memory for training: 1.408215045928955                          

One training iteration takes: 0.6763396263122559 seconds
Index: 5
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Memory occpied: (2454.0, 1680.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 22.547686338424683 seconds
Streaming imagenet data took 22.550570726394653 seconds
Then, training+dataloading take 22.551421403884888 seconds

Epoch: 0
Time of next(dataloader) is: 0.4335014820098877
Time for copying to cuda: 0.0019567012786865234
Time for forward pass: 0.05539369583129883
Time for backpropagation: 0.008089542388916016
GPU memory for training: 1.3573598861694336                          

Memory occpied: (2454.0, 1680.0)
The whole process took 450.08340716362 seconds
