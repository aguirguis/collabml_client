Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=19, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1604833602905273
Time to prepare transforms: 0.0002446174621582031
Time to download labels: 0.04929184913635254
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3416547164386 Mbps
Get bandwitdh took 1.236259937286377
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119058157.36699304 119058157.36699304
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 19 20
Intermediate:  0.095703125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 4776.28125 4971.50732421875 11379.796875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.926029682159424
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015668869018554688
Time for model prep: 0.004583835601806641
Time for model and splitting algorithm: 4.932203769683838
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.3364999294281006
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6721932888031006
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 3.0032765865325928
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 4.350201845169067
Length of received data: 100399121
Future took 4.739897966384888 seconds
Pickle took 0.05312681198120117 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.793172597885132 seconds
Dataloader took 0.036420583724975586 seconds
Streaming imagenet data took 4.829630613327026 seconds
First stream takes: 4.835076808929443 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.048180580139160156
Time for copying to cuda: 0.021751880645751953
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1414.0, 398.0] Time: 5.73120641708374
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1414.0, 916.0] Time: 7.139432430267334
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 22, 9']
Memory occupied: [2926.0, 2986.0] Time: 8.561786890029907
Time for forward pass: 4.2789483070373535
Time for backpropagation: 0.07609319686889648
GPU memory for training: 3.349872589111328                          

One training iteration takes: 4.430222511291504 seconds
Index: 0
Length of received data: 100399121
Future took 4.604730844497681 seconds
Pickle took 0.04961752891540527 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.6544716358184814 seconds
Dataloader took 0.03660297393798828 seconds
Streaming imagenet data took 4.691118240356445 seconds
Then, training+dataloading take 4.696285724639893 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08760929107666016
Time for copying to cuda: 0.021335363388061523
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 0.2210712432861328
Time for backpropagation: 0.012057304382324219
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.34593796730041504 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 42, 39']
Memory occupied: [3594.0, 2150.0] Time: 10.032253742218018
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 11.456238031387329
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 12.87608814239502
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 100399121
Future took 4.662102699279785 seconds
Pickle took 0.04700803756713867 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.709258794784546 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.07786822319030762 seconds
Streaming imagenet data took 4.7871973514556885 seconds
Then, training+dataloading take 4.792335033416748 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [3594.0, 2150.0] Time: 14.354297876358032
Time of next(dataloader) is: 0.04917430877685547
Time for copying to cuda: 0.02116847038269043
Time for forward pass: 0.12296080589294434
Time for backpropagation: 0.010076522827148438
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.20993328094482422 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 15.778259992599487
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 17.203644275665283
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 18.635496377944946
Length of received data: 100399121
Future took 4.665913820266724 seconds
Pickle took 0.042719125747680664 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.708758592605591 seconds
Dataloader took 0.03658342361450195 seconds
Streaming imagenet data took 4.7453978061676025 seconds
Then, training+dataloading take 4.749964714050293 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04822516441345215
Time for copying to cuda: 0.021042346954345703
Time for forward pass: 0.12270641326904297
Time for backpropagation: 0.010078191757202148
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.2076888084411621 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 20.059415340423584
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 21.482920169830322
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 22.91731095314026
Length of received data: 100399121
Future took 4.5882158279418945 seconds
Pickle took 0.04271531105041504 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.631078004837036 seconds
Dataloader took 0.03656625747680664 seconds
Streaming imagenet data took 4.667687654495239 seconds
Then, training+dataloading take 4.671978235244751 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.048081398010253906
Time for copying to cuda: 0.02115917205810547
Time for forward pass: 0.1468038558959961
Time for backpropagation: 0.011837005615234375
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.23182439804077148 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 10, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 24.349422216415405
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 25.78305411338806
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 27.208568334579468
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 100399121
Future took 4.617528915405273 seconds
Pickle took 0.06330347061157227 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.681013345718384 seconds
Dataloader took 0.07814359664916992 seconds
Streaming imagenet data took 4.759222507476807 seconds
Then, training+dataloading take 4.76432991027832 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.09037518501281738
Time for copying to cuda: 0.02124500274658203
Memory occupied: [3594.0, 2150.0] Time: 28.65702199935913
Time for forward pass: 0.12469792366027832
Time for backpropagation: 0.010238409042358398
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.2533731460571289 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 30.0816810131073
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 31.509039878845215
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 32.95047926902771
Length of received data: 100399121
Future took 4.691643476486206 seconds
Pickle took 0.04228973388671875 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.734064817428589 seconds
Dataloader took 0.03653597831726074 seconds
Streaming imagenet data took 4.770654678344727 seconds
Then, training+dataloading take 4.775483846664429 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04879927635192871
Time for copying to cuda: 0.02106332778930664
Time for forward pass: 0.1229860782623291
Time for backpropagation: 0.010696649551391602
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.20955181121826172 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 34.37565517425537
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 35.80122232437134
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 2150.0] Time: 37.22751045227051
Length of received data: 100399121
Future took 4.624422073364258 seconds
Pickle took 0.04224061965942383 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.6667985916137695 seconds
Dataloader took 0.03637504577636719 seconds
Streaming imagenet data took 4.7032201290130615 seconds
Then, training+dataloading take 4.70785665512085 seconds

Epoch: 0
Time of next(dataloader) is: 0.0485072135925293
Time for copying to cuda: 0.02106308937072754
Time for forward pass: 0.12304186820983887
Time for backpropagation: 0.010309219360351562
GPU memory for training: 0.907660961151123                          

Last train takes: 0.20843291282653809 seconds
Total time for streaming and training: 38.20193433761597
Finish gpu thread time: 0.02659010887145996
The whole process took 44.37109661102295 seconds
