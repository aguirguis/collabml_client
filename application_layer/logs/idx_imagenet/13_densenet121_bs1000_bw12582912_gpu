Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=13, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1622490882873535
Time to prepare transforms: 0.000244140625
Time to download labels: 0.0630486011505127
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10099.98169641418 Mbps
Get bandwitdh took 1.2398459911346436
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1323824800.9123993 1323824800.9123993
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 13 20
Intermediate:  0.765625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 6690.34375 6885.56982421875 12623.9375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.941258192062378
Using split index: 13
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015468597412109375
Time for model prep: 0.004553079605102539
Time for model and splitting algorithm: 4.947382926940918
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.3346281051635742
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6651465892791748
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 2.999882698059082
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 4.497475862503052
Length of received data: 802863121
Future took 5.228528261184692 seconds
Pickle took 0.4153473377227783 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.64404296875 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4558217525482178 seconds
Streaming imagenet data took 6.099908113479614 seconds
First stream takes: 6.145517110824585 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occupied: [1318.0, 3.0] Time: 6.147972583770752
Time of next(dataloader) is: 0.10402894020080566
Time for copying to cuda: 0.16824126243591309
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2084.0, 836.0] Time: 7.591497421264648
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2084.0, 1322.0] Time: 9.070832252502441
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 64, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 59, 47']
Memory occupied: [4344.0, 4308.0] Time: 10.577532529830933
Length of received data: 802863121
Future took 5.186776638031006 seconds
Pickle took 0.4162118434906006 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.6032984256744385 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 5, 5']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 59, 41']
Dataloader took 0.515148401260376 seconds
Streaming imagenet data took 6.118517637252808 seconds
Memory occupied: [6198.0, 4770.0] Time: 12.355170726776123
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 73, 52']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 83, 56']
Memory occupied: [4900.0, 3268.0] Time: 13.855198621749878
Time for forward pass: 7.946722507476807
Time for backpropagation: 0.07814240455627441
GPU memory for training: 6.756712913513184                          

One training iteration takes: 8.324022054672241 seconds
Index: 0
Then, training+dataloading take 8.325756072998047 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09619641304016113
Time for copying to cuda: 0.1672515869140625
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 45, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 98']
Time for forward pass: 0.5584607124328613
Time for backpropagation: 0.011968612670898438
GPU memory for training: 3.4651026725769043                          

One training iteration takes: 0.8470685482025146 seconds
Index: 1
Memory occupied: [4040.0, 8500.0] Time: 15.382128238677979
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 16.809869527816772
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 18.240971326828003
Length of received data: 802863121
Future took 5.231610059738159 seconds
Pickle took 0.420424222946167 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.706159591674805 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4499223232269287 seconds
Streaming imagenet data took 6.1562018394470215 seconds
Then, training+dataloading take 6.178231477737427 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [4040.0, 8500.0] Time: 20.738216638565063
Time of next(dataloader) is: 0.10939145088195801
Time for copying to cuda: 0.16849231719970703
Time for forward pass: 0.5277760028839111
Time for backpropagation: 0.010727643966674805
GPU memory for training: 3.4650301933288574                          

One training iteration takes: 0.8447635173797607 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 22.173086643218994
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 23.61635732650757
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 25.209518671035767
Length of received data: 802863121
Future took 5.194594860076904 seconds
Pickle took 0.4134492874145508 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.60821533203125 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.5008707046508789 seconds
Streaming imagenet data took 6.109174013137817 seconds
Then, training+dataloading take 6.13104510307312 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occupied: [4040.0, 8500.0] Time: 26.841848134994507
Time of next(dataloader) is: 0.10800457000732422
Time for copying to cuda: 0.16816258430480957
Time for forward pass: 0.5351762771606445
Time for backpropagation: 0.01064753532409668
GPU memory for training: 3.4650301933288574                          

One training iteration takes: 0.850269079208374 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 28.2789044380188
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 29.715717792510986
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 31.17286443710327
Length of received data: 802863121
Future took 5.219256639480591 seconds
Pickle took 0.4115750789642334 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.631019353866577 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49797940254211426 seconds
Streaming imagenet data took 6.129080057144165 seconds
Then, training+dataloading take 6.150269985198975 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occupied: [4040.0, 8500.0] Time: 32.99723553657532
Time of next(dataloader) is: 0.10868453979492188
Time for copying to cuda: 0.16851043701171875
Time for forward pass: 0.5265288352966309
Time for backpropagation: 0.010483026504516602
GPU memory for training: 3.4650301933288574                          

One training iteration takes: 0.8423709869384766 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 34.43994140625
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 35.880518198013306
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 37.374842405319214
Length of received data: 802863121
Future took 5.3574066162109375 seconds
Pickle took 0.41214847564697266 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.769729137420654 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49767160415649414 seconds
Streaming imagenet data took 6.267498254776001 seconds
Then, training+dataloading take 6.289516448974609 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occupied: [4040.0, 8500.0] Time: 39.29146218299866
Time of next(dataloader) is: 0.1072227954864502
Time for copying to cuda: 0.1690502166748047
Time for forward pass: 0.5335745811462402
Time for backpropagation: 0.010592937469482422
GPU memory for training: 3.4650301933288574                          

One training iteration takes: 0.8486630916595459 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 40.73341464996338
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 42.176141023635864
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 43.742552042007446
Length of received data: 802863121
Future took 5.202381610870361 seconds
Pickle took 0.41463136672973633 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.61719536781311 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49721670150756836 seconds
Streaming imagenet data took 6.114492416381836 seconds
Then, training+dataloading take 6.136099338531494 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occupied: [4040.0, 8500.0] Time: 45.426734924316406
Time of next(dataloader) is: 0.10749554634094238
Time for copying to cuda: 0.168776273727417
Time for forward pass: 0.5315032005310059
Time for backpropagation: 0.010497808456420898
GPU memory for training: 3.4650301933288574                          

One training iteration takes: 0.8465123176574707 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 5, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 46.867629289627075
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 48.312830448150635
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4040.0, 8500.0] Time: 49.773184061050415
Length of received data: 802863121
Future took 5.382749557495117 seconds
Pickle took 0.41083502769470215 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.793755531311035 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49631524085998535 seconds
Streaming imagenet data took 6.290157079696655 seconds
Then, training+dataloading take 6.311787128448486 seconds

Epoch: 0
Memory occupied: [4040.0, 8500.0] Time: 51.7663791179657
Time of next(dataloader) is: 0.10824131965637207
Time for copying to cuda: 0.1687941551208496
Time for forward pass: 0.5255684852600098
Time for backpropagation: 0.010625362396240234
GPU memory for training: 3.4650301933288574                          

Last train takes: 0.840813159942627 seconds
Total time for streaming and training: 52.50929045677185
Finish gpu thread time: 0.25815653800964355
The whole process took 58.94072341918945 seconds
