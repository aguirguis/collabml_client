Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.160034418106079
Time to prepare transforms: 0.00023651123046875
Time to download labels: 0.04699516296386719
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10072.133703692005 Mbps
Get bandwitdh took 1.2319653034210205
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1320174708.8103185 1320174708.8103185
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 17
Intermediate:  0.533935546875
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 1526.48681640625 1792.76416015625 3043.82080078125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.211595773696899
Using split index: 5
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.00022530555725097656
Time for model prep: 0.0007987022399902344
Time for model and splitting algorithm: 5.212639570236206
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.32248878479003906
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6529462337493896
Length of received data: 559918121
Future took 2.5730485916137695 seconds
Pickle took 0.2939133644104004 seconds
Read 533.979531288147 MBs for this batch
Executing all posts took 2.867168426513672 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.3163278102874756 seconds
Streaming imagenet data took 3.183535099029541 seconds
First stream takes: 3.206279754638672 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000

GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']

Epoch: 0
Memory occupied: [1514.0, 3.0] Time: 3.3025479316711426
Time of next(dataloader) is: 0.11544418334960938
Time for copying to cuda: 0.11843991279602051
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2048.0, 824.0] Time: 4.728949785232544
Length of received data: 559918121
Future took 2.643202781677246 seconds
Pickle took 0.3112516403198242 seconds
Read 533.979531288147 MBs for this batch
Executing all posts took 2.9548072814941406 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 1, 0']
Dataloader took 0.36846923828125 seconds
Streaming imagenet data took 3.323375940322876 seconds
Memory occupied: [2048.0, 1404.0] Time: 6.555055379867554
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 99, 30']
Time for forward pass: 4.4761786460876465
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 77, 40']
Time for backpropagation: 0.09515953063964844
GPU memory for training: 5.032950401306152                          

One training iteration takes: 4.814026117324829 seconds
Index: 0
Then, training+dataloading take 4.814339637756348 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occupied: [4072.0, 1898.0] Time: 8.068235158920288
Time of next(dataloader) is: 0.09054303169250488
Time for copying to cuda: 0.11699390411376953
Time for forward pass: 0.10397982597351074
Time for backpropagation: 0.0021271705627441406
GPU memory for training: 3.050595283508301                          

One training iteration takes: 0.3338327407836914 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4090.0, 3098.0] Time: 9.494386911392212
Length of received data: 559918121
Future took 2.617098331451416 seconds
Pickle took 0.2928578853607178 seconds
Read 533.979531288147 MBs for this batch
Executing all posts took 2.910261869430542 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.346590518951416 seconds
Streaming imagenet data took 3.2569310665130615 seconds
Then, training+dataloading take 3.267812728881836 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [4090.0, 3098.0] Time: 11.348641157150269
Time of next(dataloader) is: 0.07983875274658203
Time for copying to cuda: 0.11703777313232422
Time for forward pass: 0.15244030952453613
Time for backpropagation: 0.002297639846801758
GPU memory for training: 3.050595283508301                          

One training iteration takes: 0.37024879455566406 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4090.0, 3098.0] Time: 12.815589904785156
Length of received data: 559918121
Future took 2.5207059383392334 seconds
Pickle took 0.25167036056518555 seconds
Read 533.979531288147 MBs for this batch
Executing all posts took 2.772517204284668 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.35129714012145996 seconds
Streaming imagenet data took 3.1238927841186523 seconds
Then, training+dataloading take 3.1337783336639404 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.12647581100463867
Memory occupied: [4090.0, 3098.0] Time: 14.611825466156006
Time for copying to cuda: 0.11704277992248535
Time for forward pass: 0.1523876190185547
Time for backpropagation: 0.002234935760498047
GPU memory for training: 3.050595283508301                          

One training iteration takes: 0.4163811206817627 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4090.0, 3098.0] Time: 16.084355115890503
Length of received data: 559918121
Future took 2.6046199798583984 seconds
Pickle took 0.23360276222229004 seconds
Read 533.979531288147 MBs for this batch
Executing all posts took 2.8383586406707764 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.348388671875 seconds
Streaming imagenet data took 3.1868271827697754 seconds
Then, training+dataloading take 3.196268320083618 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.12813758850097656
Memory occupied: [4090.0, 3098.0] Time: 17.81592631340027
Time for copying to cuda: 0.11701202392578125
Time for forward pass: 0.1523914337158203
Time for backpropagation: 0.0023474693298339844
GPU memory for training: 3.050595283508301                          

One training iteration takes: 0.41816139221191406 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4090.0, 3098.0] Time: 19.284615993499756
Length of received data: 559918121
Future took 2.5230095386505127 seconds
Pickle took 0.2320117950439453 seconds
Read 533.979531288147 MBs for this batch
Executing all posts took 2.755190134048462 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.3478834629058838 seconds
Streaming imagenet data took 3.10315203666687 seconds
Then, training+dataloading take 3.1128995418548584 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.12798857688903809
Memory occupied: [4090.0, 3098.0] Time: 20.94665241241455
Time for copying to cuda: 0.1230173110961914
Time for forward pass: 0.15237140655517578
Time for backpropagation: 0.0022797584533691406
GPU memory for training: 3.050595283508301                          

One training iteration takes: 0.42410731315612793 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4090.0, 3098.0] Time: 22.416401147842407
Length of received data: 559918121
Future took 2.5948703289031982 seconds
Pickle took 0.25128960609436035 seconds
Read 533.979531288147 MBs for this batch
Executing all posts took 2.8463313579559326 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.35825014114379883 seconds
Streaming imagenet data took 3.204664468765259 seconds
Then, training+dataloading take 3.2144699096679688 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.13561773300170898
Memory occupied: [4090.0, 3098.0] Time: 24.141942024230957
Time for copying to cuda: 0.11795186996459961
Time for forward pass: 0.1523885726928711
Time for backpropagation: 0.0023620128631591797
GPU memory for training: 3.050595283508301                          

One training iteration takes: 0.4267878532409668 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4090.0, 3098.0] Time: 25.615228414535522
Length of received data: 559918121
Future took 2.5108280181884766 seconds
Pickle took 0.252765417098999 seconds
Read 533.979531288147 MBs for this batch
Executing all posts took 2.7637619972229004 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.3531007766723633 seconds
Streaming imagenet data took 3.1169395446777344 seconds
Then, training+dataloading take 3.128286123275757 seconds

Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.14647364616394043
Memory occupied: [4090.0, 3098.0] Time: 27.260083436965942
Time for copying to cuda: 0.1179351806640625
Time for forward pass: 0.15236783027648926
Time for backpropagation: 0.0023021697998046875
GPU memory for training: 3.050595283508301                          

Last train takes: 0.4368250370025635 seconds
Total time for streaming and training: 27.51117205619812
Finish gpu thread time: 0.7499232292175293
The whole process took 34.68140435218811 seconds
