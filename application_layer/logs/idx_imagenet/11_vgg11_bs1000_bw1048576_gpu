Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=11, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6504618962446 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119098633.34166457 119098633.34166457
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 11 25
Intermediate:  0.765625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 4436.71337890625 5345.10986328125 28745.30712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 11
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.212668895721436 seconds
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 12.535948753356934 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7381653785705566
Memory occpied: (2606.0, 3.0)
Time for copying to cuda: 0.2594113349914551
Memory occpied: (2606.0, 822.0)
Memory occpied: (2606.0, 1304.0)
Memory occpied: (7220.0, 6372.0)
Memory occpied: (7220.0, 6372.0)
Memory occpied: (13660.0, 13264.0)
Memory occpied: (13660.0, 13264.0)
Memory occpied: (6768.0, 13264.0)
Time for forward pass: 9.098114013671875
Time for backpropagation: 0.051843881607055664
GPU memory for training: 18.56304168701172                          

One training iteration takes: 10.298946142196655 seconds
Index: 0
Memory occpied: (3724.0, 6380.0)
Memory occpied: (3724.0, 6380.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.359522581100464 seconds
Streaming imagenet data took 12.645261764526367 seconds
Then, training+dataloading take 12.682462215423584 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8775739669799805
Time for copying to cuda: 0.19567537307739258
Time for forward pass: 0.5020272731781006
Time for backpropagation: 0.003325939178466797
GPU memory for training: 11.879486083984375                          

Memory occpied: (3724.0, 6380.0)
One training iteration takes: 1.7555935382843018 seconds
Index: 1
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.376569032669067 seconds
Memory occpied: (10376.0, 9952.0)
Streaming imagenet data took 12.768923044204712 seconds
Then, training+dataloading take 12.825079917907715 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7796404361724854
Time for copying to cuda: 0.23517274856567383
Memory occpied: (10376.0, 9952.0)
Time for forward pass: 0.508101224899292
Time for backpropagation: 0.0033125877380371094
GPU memory for training: 11.879486083984375                          

One training iteration takes: 1.6997921466827393 seconds
Index: 2
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.318013906478882 seconds
Memory occpied: (10376.0, 9952.0)
Streaming imagenet data took 12.70212197303772 seconds
Then, training+dataloading take 12.755650281906128 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7624256610870361
Time for copying to cuda: 0.269805908203125
Memory occpied: (10376.0, 9952.0)
Time for forward pass: 0.5319478511810303
Time for backpropagation: 0.003122091293334961
GPU memory for training: 11.879486083984375                          

One training iteration takes: 1.7281124591827393 seconds
Index: 3
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.378007173538208 seconds
Memory occpied: (10376.0, 9952.0)
Streaming imagenet data took 12.663086175918579 seconds
Then, training+dataloading take 12.71658992767334 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8013584613800049
Memory occpied: (10376.0, 9952.0)
Time for copying to cuda: 0.19750761985778809
Time for forward pass: 0.5236289501190186
Time for backpropagation: 0.0031189918518066406
GPU memory for training: 11.879486083984375                          

One training iteration takes: 1.695741891860962 seconds
Index: 4
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.312597513198853 seconds
Streaming imagenet data took 12.597646236419678 seconds
Then, training+dataloading take 12.651244878768921 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (10376.0, 9952.0)
Time of next(dataloader) is: 0.8278436660766602
Time for copying to cuda: 0.19861793518066406
Time for forward pass: 0.5146260261535645
Time for backpropagation: 0.0039098262786865234
GPU memory for training: 11.879486083984375                          

One training iteration takes: 1.6626951694488525 seconds
Index: 5
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.333198070526123 seconds
Streaming imagenet data took 12.726014375686646 seconds
Then, training+dataloading take 12.771461963653564 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000

Memory occpied: (10376.0, 9952.0)

Epoch: 0
Time of next(dataloader) is: 0.7897555828094482
Time for copying to cuda: 0.19849038124084473
Memory occpied: (10376.0, 9952.0)
Time for forward pass: 0.49059247970581055
Time for backpropagation: 0.0032715797424316406
GPU memory for training: 11.879486083984375                          

One training iteration takes: 1.6386158466339111 seconds
Index: 6
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Memory occpied: (10376.0, 9952.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.310622453689575 seconds
Memory occpied: (10376.0, 9952.0)
Streaming imagenet data took 12.703486204147339 seconds
Then, training+dataloading take 12.75018048286438 seconds

Epoch: 0
Time of next(dataloader) is: 0.7768111228942871
Memory occpied: (10376.0, 9952.0)
Time for copying to cuda: 0.28664422035217285
Time for forward pass: 0.5020854473114014
Time for backpropagation: 0.0033071041107177734
GPU memory for training: 11.879486083984375                          

The whole process took 111.59887552261353 seconds
