Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=17, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5781246055797 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119089151.94830254 119089151.94830254
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 17 36
Intermediate:  3.0625
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 10313.86474609375 11263.47509765625 32325.58349609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 17
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.33115100860596 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 43.60156488418579 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.1878302097320557
Time for copying to cuda: 0.7766351699829102
Time for forward pass: 9.751296997070312
Time for backpropagation: 0.05221724510192871
GPU memory for training: 19.48909854888916                          

Memory occpied: (1894.0, 3.0)
One training iteration takes: 13.176953315734863 seconds
Index: 0
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Memory occpied: (6476.0, 7572.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.97760033607483 seconds
Memory occpied: (6476.0, 7572.0)
Streaming imagenet data took 44.25777626037598 seconds
Then, training+dataloading take 44.401124477386475 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.203845500946045
Time for copying to cuda: 0.7710874080657959
Time for forward pass: 1.022592306137085
Time for backpropagation: 0.004097938537597656
GPU memory for training: 15.749543190002441                          

One training iteration takes: 4.445666790008545 seconds
Index: 1
Memory occpied: (6476.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 43.2102324962616 seconds
Memory occpied: (13128.0, 10794.0)
Streaming imagenet data took 44.520063400268555 seconds
Then, training+dataloading take 44.71170139312744 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2220420837402344
Time for copying to cuda: 0.7762906551361084
Time for forward pass: 1.0382699966430664
Time for backpropagation: 0.0040585994720458984
GPU memory for training: 15.748566627502441                          

Memory occpied: (13128.0, 10794.0)
One training iteration takes: 4.462040424346924 seconds
Index: 2
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.9229371547699 seconds
Memory occpied: (13128.0, 10794.0)
Streaming imagenet data took 44.2406907081604 seconds
Then, training+dataloading take 44.306336402893066 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Time of next(dataloader) is: 2.148836612701416
Memory occpied: (13128.0, 10794.0)
Time for copying to cuda: 0.8735437393188477
Memory occpied: (13128.0, 10794.0)
Time for forward pass: 1.0512516498565674
Time for backpropagation: 0.0043544769287109375
GPU memory for training: 15.748566627502441                          

One training iteration takes: 4.4952497482299805 seconds
Index: 3
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.7921826839447 seconds
Memory occpied: (13128.0, 10794.0)
Streaming imagenet data took 43.99886608123779 seconds
Then, training+dataloading take 44.14551281929016 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Time of next(dataloader) is: 2.209416627883911
Memory occpied: (13128.0, 10794.0)
Time for copying to cuda: 0.8691473007202148
Time for forward pass: 1.020219087600708
Time for backpropagation: 0.004658937454223633
GPU memory for training: 15.748566627502441                          

Memory occpied: (13128.0, 10794.0)
One training iteration takes: 4.5801122188568115 seconds
Index: 4
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.98436784744263 seconds
Memory occpied: (13128.0, 10794.0)
Streaming imagenet data took 44.21987962722778 seconds
Then, training+dataloading take 44.36862874031067 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2685797214508057
Time for copying to cuda: 0.7743916511535645
Time for forward pass: 1.0578556060791016
Time for backpropagation: 0.004027843475341797
GPU memory for training: 15.748566627502441                          

Memory occpied: (13128.0, 10794.0)
One training iteration takes: 4.529930353164673 seconds
Index: 5
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.85821199417114 seconds
Memory occpied: (13128.0, 10794.0)
Streaming imagenet data took 44.15057301521301 seconds
Then, training+dataloading take 44.345425844192505 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2369470596313477
Time for copying to cuda: 0.7746539115905762
Time for forward pass: 1.0689036846160889
Time for backpropagation: 0.004103422164916992
GPU memory for training: 15.748566627502441                          

Memory occpied: (13128.0, 10794.0)
One training iteration takes: 4.4926371574401855 seconds
Index: 6
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Memory occpied: (13128.0, 10794.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 42.83232021331787 seconds
Memory occpied: (13128.0, 10794.0)
Streaming imagenet data took 44.1292986869812 seconds
Then, training+dataloading take 44.283799171447754 seconds

Epoch: 0
Time of next(dataloader) is: 2.2421305179595947
Time for copying to cuda: 0.7811188697814941
Time for forward pass: 1.0146961212158203
Time for backpropagation: 0.004142284393310547
GPU memory for training: 15.748566627502441                          

Memory occpied: (13128.0, 10794.0)
The whole process took 367.4150240421295 seconds
