Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=4, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1612508296966553
Time to prepare transforms: 0.0002589225769042969
Time to download labels: 0.06352877616882324
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9926.588755349541 Mbps
Get bandwitdh took 1.228234052658081
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03
 3.07200e+03 3.07200e+03 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1301097841.341175 1301097841.341175
All candidates indexes:  (array([17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 4 17
Intermediate:  0.0
1.1484375
Total layers size  104.47354125976562
Server, client, server+client, vanilla  357.7919921875 17669.89013671875 18027.68212890625 19392.54638671875
Fixed, scale_with_bsz  0 1.72265625
Mem usage  1654.0 3.0
Time for splitting algorithm: 5.976794719696045
Using split index: 4
Freezing the lower layers of the model (myvit) till index 17
Time to freeze model: 0.0008883476257324219
Time for model prep: 0.0023126602172851562
Time for model and splitting algorithm: 5.980014801025391
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 0.32391858100891113
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 1.649184226989746
Length of received data: 605229121
Future took 2.7205519676208496 seconds
Pickle took 0.3206593990325928 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0823605060577393 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.3403952121734619 seconds
Streaming imagenet data took 3.422853708267212 seconds
First stream takes: 3.4402685165405273 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occupied: [1654.0, 3.0] Time: 3.5218911170959473
Time of next(dataloader) is: 0.09316611289978027
Time for copying to cuda: 0.1284492015838623
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2232.0, 830.0] Time: 4.943514823913574
Length of received data: 605229121
Future took 2.63651180267334 seconds
Pickle took 0.3181338310241699 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.007127285003662 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.34572577476501465 seconds
Streaming imagenet data took 3.3530263900756836 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2232.0, 1482.0] Time: 6.941878318786621
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8390.0, 8012.0] Time: 8.428637027740479
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8390.0, 8012.0] Time: 9.911932229995728
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 49']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8390.0, 8012.0] Time: 11.390849351882935
Time for forward pass: 8.822850942611694
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 32']
Time for backpropagation: 0.10155844688415527
GPU memory for training: 8.35290813446045                          

One training iteration takes: 9.157880306243896 seconds
Index: 0
Then, training+dataloading take 9.158234357833862 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.13140487670898438
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 22, 10']
Time for copying to cuda: 0.17188000679016113
Memory occupied: [8390.0, 8020.0] Time: 12.922297954559326
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 42']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 14.40589427947998
Length of received data: 605229121
Future took 2.6605403423309326 seconds
Pickle took 0.31673169136047363 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 2.977445363998413 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 37']
Dataloader took 0.3820302486419678 seconds
Streaming imagenet data took 3.359557628631592 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8398.0, 8020.0] Time: 16.145958185195923
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 43']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 50']
Memory occupied: [8398.0, 8020.0] Time: 17.67360281944275
Time for forward pass: 5.343601703643799
Time for backpropagation: 0.007662057876586914
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.6806511878967285 seconds
Index: 1
Then, training+dataloading take 5.682072162628174 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08182334899902344
Time for copying to cuda: 0.12794756889343262
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 76, 19']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 19.18807816505432
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 45']
Memory occupied: [8398.0, 8020.0] Time: 20.73130178451538
Length of received data: 605229121
Future took 2.8573949337005615 seconds
Pickle took 0.31235766410827637 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.1699039936065674 seconds
Dataloader took 0.21274209022521973 seconds
Streaming imagenet data took 3.382690906524658 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 39']
Memory occupied: [8398.0, 8020.0] Time: 22.26637053489685
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 42']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 45']
Memory occupied: [8398.0, 8020.0] Time: 23.806275606155396
Time for forward pass: 5.389918804168701
Time for backpropagation: 0.007769584655761719
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.631179332733154 seconds
Index: 2
Then, training+dataloading take 5.647055625915527 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08176517486572266
Time for copying to cuda: 0.12774109840393066
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 32']
Memory occupied: [8398.0, 8020.0] Time: 25.31206178665161
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
Length of received data: 605229121
Future took 2.9035775661468506 seconds
Pickle took 0.30846190452575684 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.2121825218200684 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 31']
Memory occupied: [8398.0, 8020.0] Time: 27.431620121002197
Dataloader took 0.3235645294189453 seconds
Streaming imagenet data took 3.535790205001831 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 34']
Memory occupied: [8398.0, 8020.0] Time: 28.968610286712646
Time for forward pass: 5.375421762466431
Time for backpropagation: 0.0077631473541259766
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.616856336593628 seconds
Index: 3
Then, training+dataloading take 5.620107412338257 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08182382583618164
Time for copying to cuda: 0.12814903259277344
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 90, 47']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 30.487956047058105
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 42']
Memory occupied: [8398.0, 8020.0] Time: 32.16848015785217
Length of received data: 605229121
Future took 2.860215425491333 seconds
Pickle took 0.3124074935913086 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.1727638244628906 seconds
Dataloader took 0.210845947265625 seconds
Streaming imagenet data took 3.3836514949798584 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 33.70345902442932
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 26']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Time for forward pass: 5.40506911277771
Time for backpropagation: 0.008769989013671875
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.6405029296875 seconds
Index: 4
Then, training+dataloading take 5.640763759613037 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08489608764648438
Memory occupied: [8398.0, 8020.0] Time: 35.28091859817505
Time for copying to cuda: 0.12813973426818848
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 23']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 45']
Memory occupied: [8398.0, 8020.0] Time: 36.809590578079224
Length of received data: 605229121
Future took 2.747948169708252 seconds
Pickle took 0.28975391387939453 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0380160808563232 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 41']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Dataloader took 0.3819711208343506 seconds
Streaming imagenet data took 3.4200937747955322 seconds
Memory occupied: [8398.0, 8020.0] Time: 38.67762613296509
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 45']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 34']
Memory occupied: [8398.0, 8020.0] Time: 40.181050300598145
Time for forward pass: 5.44360089302063
Time for backpropagation: 0.007760524749755859
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.688937664031982 seconds
Index: 5
Then, training+dataloading take 5.690311431884766 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08249092102050781
Time for copying to cuda: 0.12750005722045898
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 89, 45']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 41.68360352516174
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 25']
Memory occupied: [8398.0, 8020.0] Time: 43.20421075820923
Length of received data: 605229121
Future took 2.801609992980957 seconds
Pickle took 0.30232691764831543 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.104079008102417 seconds
Dataloader took 0.21778368949890137 seconds
Streaming imagenet data took 3.321906328201294 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 32']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Memory occupied: [8398.0, 8020.0] Time: 44.732431173324585
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 31']
Memory occupied: [8398.0, 8020.0] Time: 46.233784198760986
Time for forward pass: 5.48596715927124
Time for backpropagation: 0.007764577865600586
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.727841377258301 seconds
Index: 6
Then, training+dataloading take 5.7292094230651855 seconds

Epoch: 0
Time of next(dataloader) is: 0.0819852352142334
Time for copying to cuda: 0.12723255157470703
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 47.73615074157715
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 25']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 32']
Memory occupied: [8398.0, 8020.0] Time: 49.231608867645264
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 50.73364853858948
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 34']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 28']
Memory occupied: [8398.0, 8020.0] Time: 52.233319997787476
Time for forward pass: 5.514845609664917
Time for backpropagation: 0.0077931880950927734
GPU memory for training: 8.37738037109375                          

Last train takes: 5.755330562591553 seconds
Total time for streaming and training: 52.36354947090149
Finish gpu thread time: 0.8707623481750488
The whole process took 60.43987774848938 seconds
