Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=6, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10479.385216488503 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1373553979.095581 1373553979.095581
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 6 21
Intermediate:  3.0625
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 9292.857421875 9497.77294921875 12929.576171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Using split index: 6
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.536184072494507 seconds
Memory occpied: (1410.0, 3.0)
Streaming imagenet data took 15.811035394668579 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Time of next(dataloader) is: 2.092235565185547
Memory occpied: (4474.0, 3.0)
Time for copying to cuda: 0.8390836715698242
Memory occpied: (4474.0, 1980.0)
Memory occpied: (4474.0, 2442.0)
Memory occpied: (9520.0, 7936.0)
Memory occpied: (14294.0, 11678.0)
Memory occpied: (9112.0, 10766.0)
Memory occpied: (12328.0, 7552.0)
Memory occpied: (9112.0, 7552.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.468630075454712 seconds
Memory occpied: (13670.0, 12110.0)
Time for forward pass: 12.47231388092041
Time for backpropagation: 0.07836127281188965
GPU memory for training: 17.884191036224365                          

One training iteration takes: 15.866450786590576 seconds
Index: 0
Memory occpied: (9140.0, 7576.0)
Streaming imagenet data took 16.246821403503418 seconds
Then, training+dataloading take 16.371361017227173 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (9140.0, 7576.0)
Time of next(dataloader) is: 2.163635730743408
Memory occpied: (9140.0, 7576.0)
Time for copying to cuda: 0.8150923252105713
Memory occpied: (9148.0, 7584.0)
Time for forward pass: 1.2484383583068848
Time for backpropagation: 0.006831645965576172
GPU memory for training: 12.174184322357178                          

One training iteration takes: 4.632624387741089 seconds
Index: 1
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.615890741348267 seconds
Memory occpied: (9148.0, 7584.0)
Streaming imagenet data took 15.907384634017944 seconds
Then, training+dataloading take 16.040804624557495 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2546584606170654
Time for copying to cuda: 0.7690229415893555
Time for forward pass: 1.2612662315368652
Time for backpropagation: 0.00667881965637207
GPU memory for training: 12.174184322357178                          

One training iteration takes: 4.752485752105713 seconds
Index: 2
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.234352350234985 seconds
Memory occpied: (9148.0, 7584.0)
Streaming imagenet data took 15.447372198104858 seconds
Then, training+dataloading take 15.62572717666626 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Time of next(dataloader) is: 2.241575002670288
Memory occpied: (9148.0, 7584.0)
Time for copying to cuda: 0.8877720832824707
Memory occpied: (9148.0, 7584.0)
Time for forward pass: 1.2886595726013184
Time for backpropagation: 0.006680727005004883
GPU memory for training: 12.174184322357178                          

One training iteration takes: 4.849646329879761 seconds
Index: 3
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.75319242477417 seconds
Memory occpied: (9148.0, 7584.0)
Streaming imagenet data took 16.05624771118164 seconds
Then, training+dataloading take 16.195754051208496 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3105947971343994
Time for copying to cuda: 0.7782621383666992
Time for forward pass: 1.2570178508758545
Time for backpropagation: 0.006693840026855469
GPU memory for training: 12.174184322357178                          

Memory occpied: (9148.0, 7584.0)
One training iteration takes: 4.782728910446167 seconds
Index: 4
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.030877351760864 seconds
Memory occpied: (9148.0, 7584.0)
Streaming imagenet data took 15.356122732162476 seconds
Then, training+dataloading take 15.415898561477661 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2576632499694824
Time for copying to cuda: 0.7773935794830322
Time for forward pass: 1.2687709331512451
Time for backpropagation: 0.006663322448730469
GPU memory for training: 12.174184322357178                          

Memory occpied: (9148.0, 7584.0)
One training iteration takes: 4.73050332069397 seconds
Index: 5
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 13.999284982681274 seconds
Memory occpied: (9148.0, 7584.0)
Streaming imagenet data took 15.317968368530273 seconds
Then, training+dataloading take 15.483154535293579 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.262053966522217
Time for copying to cuda: 0.7774636745452881
Time for forward pass: 1.287447214126587
Time for backpropagation: 0.006686210632324219
GPU memory for training: 12.174184322357178                          

Memory occpied: (9148.0, 7584.0)
One training iteration takes: 4.743737459182739 seconds
Index: 6
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Memory occpied: (9148.0, 7584.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.617583990097046 seconds
Memory occpied: (9148.0, 7584.0)
Streaming imagenet data took 15.856150388717651 seconds
Then, training+dataloading take 15.99849557876587 seconds

Epoch: 0
Time of next(dataloader) is: 2.3070168495178223
Time for copying to cuda: 0.7757108211517334
Time for forward pass: 1.2680580615997314
Time for backpropagation: 0.00671076774597168
GPU memory for training: 12.174184322357178                          

Memory occpied: (9148.0, 7584.0)
The whole process took 138.90543603897095 seconds
