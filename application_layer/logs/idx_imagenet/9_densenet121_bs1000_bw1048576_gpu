Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=9, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1622076034545898
Time to prepare transforms: 0.0002415180206298828
Time to download labels: 0.06527304649353027
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.0101773793667 Mbps
Get bandwitdh took 1.2409324645996094
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119014709.96946836 119014709.96946836
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 9 20
Intermediate:  0.3828125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 7838.78125 8034.00732421875 14155.1875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.925994396209717
Using split index: 9
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015721321105957031
Time for model prep: 0.004602670669555664
Time for model and splitting algorithm: 4.932204723358154
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.3386399745941162
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6743309497833252
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 3.037247896194458
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 4.414402961730957
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 5.806246280670166
Length of received data: 401454121
Future took 5.983892917633057 seconds
Pickle took 0.21001315116882324 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 6.194062948226929 seconds
Dataloader took 0.1407032012939453 seconds
Streaming imagenet data took 6.334804534912109 seconds
First stream takes: 6.359203338623047 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06534028053283691
Time for copying to cuda: 0.08452558517456055
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1702.0, 466.0] Time: 7.206758737564087
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1702.0, 982.0] Time: 8.63156247138977
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1702.0, 2734.0] Time: 10.093586921691895
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 76, 65']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 76, 55']
Memory occupied: [6738.0, 8692.0] Time: 11.576249361038208
Length of received data: 401454121
Future took 5.965435743331909 seconds
Pickle took 0.20609736442565918 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 6.1718175411224365 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 97, 53']
Dataloader took 0.24274444580078125 seconds
Streaming imagenet data took 6.41466212272644 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 66, 54']
Memory occupied: [3376.0, 3160.0] Time: 13.074240684509277
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 99, 62']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 63, 46']
Memory occupied: [6692.0, 5326.0] Time: 14.537880659103394
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 78, 57']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 74, 54']
Time for forward pass: 9.429046630859375
Memory occupied: [3828.0, 2318.0] Time: 16.00357460975647
Time for backpropagation: 0.07523870468139648
GPU memory for training: 9.715926170349121                          

One training iteration takes: 9.668574571609497 seconds
Index: 0
Then, training+dataloading take 9.669514179229736 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06506824493408203
Time for copying to cuda: 0.0837862491607666
Time for forward pass: 0.925102710723877
Time for backpropagation: 0.010840654373168945
GPU memory for training: 4.842838764190674                          

One training iteration takes: 1.0992333889007568 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 93']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 62, 62']
Memory occupied: [5310.0, 11636.0] Time: 17.448585033416748
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 18.886688709259033
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 20.336595058441162
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 21.799638032913208
Length of received data: 401454121
Future took 6.091493606567383 seconds
Pickle took 0.20755839347839355 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 6.2992024421691895 seconds
Dataloader took 0.1447916030883789 seconds
Streaming imagenet data took 6.44403862953186 seconds
Then, training+dataloading take 6.4656476974487305 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06483817100524902
Time for copying to cuda: 0.08416628837585449
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 87']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 95']
Memory occupied: [5310.0, 11636.0] Time: 23.268572092056274
Time for forward pass: 0.9175331592559814
Time for backpropagation: 0.010979413986206055
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.0921454429626465 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 24.703600645065308
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 26.15048384666443
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 27.61170983314514
Length of received data: 401454121
Future took 6.213108062744141 seconds
Pickle took 0.2072315216064453 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 6.420644283294678 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.23623871803283691 seconds
Streaming imagenet data took 6.6569647789001465 seconds
Then, training+dataloading take 6.671852350234985 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000

GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']

Epoch: 0
Time of next(dataloader) is: 0.1139988899230957
Memory occupied: [5310.0, 11636.0] Time: 29.28642249107361
Time for copying to cuda: 0.08376932144165039
Time for forward pass: 0.9720451831817627
Time for backpropagation: 0.011539697647094727
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.1892776489257812 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 74, 72']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 29, 30']
Memory occupied: [5310.0, 11636.0] Time: 30.755301475524902
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 32.22868871688843
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 33.7018723487854
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 35.19387769699097
Length of received data: 401454121
Future took 6.162649154663086 seconds
Pickle took 0.16448450088500977 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 6.327295780181885 seconds
Dataloader took 0.14020490646362305 seconds
Streaming imagenet data took 6.467545986175537 seconds
Then, training+dataloading take 6.4820497035980225 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06961822509765625
Time for copying to cuda: 0.08382344245910645
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 100']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 96']
Memory occupied: [5310.0, 11636.0] Time: 36.68269491195679
Time for forward pass: 0.9336321353912354
Time for backpropagation: 0.010634899139404297
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.1124515533447266 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 38.14123058319092
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 39.61447548866272
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 41.10010099411011
Length of received data: 401454121
Future took 5.963253021240234 seconds
Pickle took 0.16429543495178223 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 6.1277055740356445 seconds
Dataloader took 0.14323854446411133 seconds
Streaming imagenet data took 6.270989179611206 seconds
Then, training+dataloading take 6.285546064376831 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06963610649108887
Time for copying to cuda: 0.08363533020019531
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 38, 12']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 76, 57']
Memory occupied: [5310.0, 11636.0] Time: 42.60251069068909
Time for forward pass: 0.96173095703125
Time for backpropagation: 0.010776042938232422
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.1405904293060303 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 44.062573194503784
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 45.54516649246216
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 47.03476023674011
Length of received data: 401454121
Future took 6.050883531570435 seconds
Pickle took 0.16360783576965332 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 6.214637041091919 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.2378380298614502 seconds
Streaming imagenet data took 6.452545881271362 seconds
Then, training+dataloading take 6.475109577178955 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.16807937622070312
Memory occupied: [5310.0, 11636.0] Time: 48.648940086364746
Time for copying to cuda: 0.08400845527648926
Time for forward pass: 0.9358677864074707
Time for backpropagation: 0.010393381118774414
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.2133548259735107 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 73, 70']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 50.09281873703003
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 51.54133367538452
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 53.01580548286438
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11636.0] Time: 54.521440744400024
Length of received data: 401454121
Future took 6.15304708480835 seconds
Pickle took 0.19427180290222168 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 6.3474650382995605 seconds
Dataloader took 0.1407921314239502 seconds
Streaming imagenet data took 6.488301992416382 seconds
Then, training+dataloading take 6.503072500228882 seconds

Epoch: 0
Time of next(dataloader) is: 0.07816386222839355
Time for copying to cuda: 0.08402347564697266
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 100']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 95']
Memory occupied: [5310.0, 11636.0] Time: 56.01329755783081
Time for forward pass: 0.939476490020752
Time for backpropagation: 0.010445594787597656
GPU memory for training: 4.842915058135986                          

Last train takes: 1.1264050006866455 seconds
Total time for streaming and training: 56.03860807418823
Finish gpu thread time: 0.9758102893829346
The whole process took 63.17471432685852 seconds
