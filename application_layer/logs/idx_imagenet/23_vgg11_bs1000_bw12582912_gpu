Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=23, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.2409672737121582
Time to prepare transforms: 0.00024580955505371094
Time to download labels: 0.062417030334472656
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9891.659817426204 Mbps
Get bandwitdh took 1.2219951152801514
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1296519635.5896873 1296519635.5896873
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 23 25
Intermediate:  0.015625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 655.46337890625 1563.85986328125 25714.05712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Time for splitting algorithm: 6.5781567096710205
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
Time to freeze model: 0.00023508071899414062
Time for model prep: 0.0008635520935058594
Time for model and splitting algorithm: 6.579275846481323
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 5, 2']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 0.31226468086242676
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 1.6260907649993896
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 2.9476635456085205
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 4.278404474258423
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 5.595861196517944
Length of received data: 16420362
Future took 6.015711545944214 seconds
Pickle took 0.010062932968139648 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.0259058475494385 seconds
Dataloader took 0.006413936614990234 seconds
Streaming imagenet data took 6.032349586486816 seconds
First stream takes: 6.032639741897583 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.010930538177490234
Time for copying to cuda: 0.0036814212799072266
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1840.0, 352.0] Time: 6.956146001815796
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1840.0, 874.0] Time: 8.346933126449585
Time for forward pass: 3.3446223735809326
Time for backpropagation: 0.05142045021057129
GPU memory for training: 2.037003993988037                          

One training iteration takes: 3.4118010997772217 seconds
Index: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 33, 7']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 21, 1']
Memory occupied: [3026.0, 1814.0] Time: 9.757668495178223
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3026.0, 1814.0] Time: 11.165902137756348
Length of received data: 16420362
Future took 5.929560661315918 seconds
Pickle took 0.007974386215209961 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.937662839889526 seconds
Dataloader took 0.00722503662109375 seconds
Streaming imagenet data took 5.944926738739014 seconds
Then, training+dataloading take 5.945456027984619 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.008481025695800781
Time for copying to cuda: 0.0036547183990478516
Time for forward pass: 0.05603337287902832
Time for backpropagation: 0.0026063919067382812
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.07187056541442871 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 32, 7']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 12.582530975341797
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 13.994576215744019
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 15.408324003219604
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 16.825156211853027
Length of received data: 16420362
Future took 5.943490028381348 seconds
Pickle took 0.00806283950805664 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.95171332359314 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.04819488525390625 seconds
Streaming imagenet data took 5.999969482421875 seconds
Then, training+dataloading take 6.003520250320435 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.01362156867980957
Time for copying to cuda: 0.003667116165161133
Time for forward pass: 0.0770564079284668
Time for backpropagation: 0.00350189208984375
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.09966111183166504 seconds
Index: 2
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 8, 4']
Memory occupied: [3428.0, 1822.0] Time: 18.248437643051147
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 19.668197631835938
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 21.0844988822937
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 22.4970486164093
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 23.913370847702026
Length of received data: 16420362
Future took 5.967748641967773 seconds
Pickle took 0.008003473281860352 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.975867509841919 seconds
Dataloader took 0.0070323944091796875 seconds
Streaming imagenet data took 5.982943534851074 seconds
Then, training+dataloading take 5.983579158782959 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0077512264251708984
Time for copying to cuda: 0.003674030303955078
Time for forward pass: 0.056023359298706055
Time for backpropagation: 0.002474546432495117
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.0709848403930664 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 25.330015897750854
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 26.751744031906128
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 28.162364959716797
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 29.578492403030396
Length of received data: 16420362
Future took 5.9840357303619385 seconds
Pickle took 0.008044719696044922 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.992198944091797 seconds
Dataloader took 0.004991054534912109 seconds
Streaming imagenet data took 5.997225999832153 seconds
Then, training+dataloading take 5.997777223587036 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007731199264526367
Time for copying to cuda: 0.003691434860229492
Time for forward pass: 0.05597972869873047
Time for backpropagation: 0.0025718212127685547
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.07103896141052246 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 30.995737314224243
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 32.408878326416016
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 33.82756209373474
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 35.244932651519775
Length of received data: 16420362
Future took 5.977469444274902 seconds
Pickle took 0.008131027221679688 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.985731840133667 seconds
Dataloader took 0.0071527957916259766 seconds
Streaming imagenet data took 5.992933511734009 seconds
Then, training+dataloading take 5.993466377258301 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007794857025146484
Time for copying to cuda: 0.003643512725830078
Time for forward pass: 0.05610942840576172
Time for backpropagation: 0.002554178237915039
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.07119989395141602 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 36.66507863998413
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 38.08151626586914
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 39.504048109054565
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 40.91838598251343
Length of received data: 16420362
Future took 6.032422065734863 seconds
Pickle took 0.013516426086425781 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.046151399612427 seconds
Dataloader took 0.009365081787109375 seconds
Streaming imagenet data took 6.055591344833374 seconds
Then, training+dataloading take 6.056210279464722 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007843971252441406
Time for copying to cuda: 0.0036711692810058594
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 0.056937217712402344
Time for backpropagation: 0.0033087730407714844
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.0733175277709961 seconds
Index: 6
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 34, 7']
Memory occupied: [3428.0, 1822.0] Time: 42.345829010009766
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 43.76384234428406
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 45.179391860961914
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 46.591575145721436
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 48.003373861312866
Length of received data: 16420362
Future took 6.000455856323242 seconds
Pickle took 0.007695436477661133 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.008244752883911 seconds
Dataloader took 0.007054805755615234 seconds
Streaming imagenet data took 6.015350818634033 seconds
Then, training+dataloading take 6.015912771224976 seconds

Epoch: 0
Time of next(dataloader) is: 0.007588863372802734
Time for copying to cuda: 0.0036962032318115234
Time for forward pass: 0.05596494674682617
Time for backpropagation: 0.002530813217163086
GPU memory for training: 2.192574977874756                          

Last train takes: 0.0704948902130127 seconds
Total time for streaming and training: 48.099215030670166
Finish gpu thread time: 0.9051690101623535
The whole process took 56.88768672943115 seconds
