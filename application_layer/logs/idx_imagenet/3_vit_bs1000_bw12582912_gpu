Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=3, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1616477966308594
Time to prepare transforms: 0.0002455711364746094
Time to download labels: 0.0631258487701416
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9915.255232758745 Mbps
Get bandwitdh took 1.2260713577270508
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03
 3.07200e+03 3.07200e+03 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1299612333.8681543 1299612333.8681543
All candidates indexes:  (array([17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 3 17
Intermediate:  0.0
1.1484375
Total layers size  104.47354125976562
Server, client, server+client, vanilla  357.7919921875 17669.89013671875 18027.68212890625 19392.54638671875
Fixed, scale_with_bsz  0 1.72265625
Mem usage  1654.0 3.0
Time for splitting algorithm: 5.953175067901611
Using split index: 3
Freezing the lower layers of the model (myvit) till index 17
Time to freeze model: 0.0008721351623535156
Time for model prep: 0.0022993087768554688
Time for model and splitting algorithm: 5.9563679695129395
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 11, 2']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 0.3218512535095215
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 1.6436505317687988
Length of received data: 605229121
Future took 2.6669399738311768 seconds
Pickle took 0.3207285404205322 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.028362989425659 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.3346850872039795 seconds
Streaming imagenet data took 3.3631441593170166 seconds
First stream takes: 3.3753950595855713 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occupied: [1654.0, 3.0] Time: 3.459132194519043
Time of next(dataloader) is: 0.08487701416015625
Time for copying to cuda: 0.12742996215820312
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2232.0, 838.0] Time: 4.897576093673706
Length of received data: 605229121
Future took 2.7050116062164307 seconds
Pickle took 0.3342766761779785 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0395901203155518 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Dataloader took 0.38820457458496094 seconds
Streaming imagenet data took 3.427891969680786 seconds
Memory occupied: [2232.0, 1474.0] Time: 6.82333517074585
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 37']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 38']
Memory occupied: [8390.0, 8012.0] Time: 8.321129083633423
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 41']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8390.0, 8012.0] Time: 9.797942161560059
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 27']
Memory occupied: [8390.0, 8012.0] Time: 11.275733232498169
Time for forward pass: 8.771631956100464
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 44, 21']
Time for backpropagation: 0.1036376953125
GPU memory for training: 8.35290813446045                          

One training iteration takes: 9.097902536392212 seconds
Index: 0
Then, training+dataloading take 9.09822702407837 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.14536476135253906
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 39, 20']
Memory occupied: [8390.0, 8012.0] Time: 12.778019666671753
Time for copying to cuda: 0.16963839530944824
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 28']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 14.256507635116577
Length of received data: 605229121
Future took 2.7038843631744385 seconds
Pickle took 0.3242788314819336 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0283255577087402 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
Dataloader took 0.381624698638916 seconds
Streaming imagenet data took 3.410050630569458 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 45']
Memory occupied: [8398.0, 8020.0] Time: 16.057084798812866
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 39']
Memory occupied: [8398.0, 8020.0] Time: 17.582244634628296
Time for forward pass: 5.345012426376343
Time for backpropagation: 0.007719278335571289
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.690691232681274 seconds
Index: 1
Then, training+dataloading take 5.6920716762542725 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09496760368347168
Time for copying to cuda: 0.12633609771728516
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 53']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 19.09615993499756
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Memory occupied: [8398.0, 8020.0] Time: 20.6308274269104
Length of received data: 605229121
Future took 2.8314781188964844 seconds
Pickle took 0.31647729873657227 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.1481151580810547 seconds
Dataloader took 0.21490049362182617 seconds
Streaming imagenet data took 3.36305832862854 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 22.161299228668213
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 28']
Memory occupied: [8398.0, 8020.0] Time: 23.698424816131592
Time for forward pass: 5.389642238616943
Time for backpropagation: 0.0077533721923828125
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.639468193054199 seconds
Index: 2
Then, training+dataloading take 5.655633926391602 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09684205055236816
Time for copying to cuda: 0.12743163108825684
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 23']
Memory occupied: [8398.0, 8020.0] Time: 25.209100008010864
Length of received data: 605229121
Future took 2.662498950958252 seconds
Pickle took 0.31262850761413574 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0314764976501465 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
Dataloader took 0.32581591606140137 seconds
Streaming imagenet data took 3.3574912548065186 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 34']
Memory occupied: [8398.0, 8020.0] Time: 27.374796628952026
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 49']
Memory occupied: [8398.0, 8020.0] Time: 28.909483671188354
Time for forward pass: 5.368183612823486
Time for backpropagation: 0.007979154586791992
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.621386528015137 seconds
Index: 3
Then, training+dataloading take 5.622823476791382 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08951520919799805
Time for copying to cuda: 0.12777113914489746
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 30.441518783569336
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Length of received data: 605229121
Memory occupied: [8398.0, 8020.0] Time: 32.275630235672
Future took 2.8311893939971924 seconds
Pickle took 0.284787654876709 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.116118907928467 seconds
Dataloader took 0.21323037147521973 seconds
Streaming imagenet data took 3.3293938636779785 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 38']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 34.09374690055847
Time for forward pass: 5.40305757522583
Time for backpropagation: 0.00773310661315918
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.648935794830322 seconds
Index: 4
Then, training+dataloading take 5.650280475616455 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 47, 24']
Time of next(dataloader) is: 0.1987011432647705
Time for copying to cuda: 0.17460346221923828
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8398.0, 8020.0] Time: 35.62852096557617
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 45']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 37']
Memory occupied: [8398.0, 8020.0] Time: 37.17113447189331
Length of received data: 605229121
Future took 2.790799140930176 seconds
Pickle took 0.24698352813720703 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0379316806793213 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 34']
Dataloader took 0.32607007026672363 seconds
Streaming imagenet data took 3.3640568256378174 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 31']
Memory occupied: [8398.0, 8020.0] Time: 38.74198269844055
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 40.25513768196106
Time for forward pass: 5.436081409454346
Time for backpropagation: 0.007778167724609375
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.838639974594116 seconds
Index: 5
Then, training+dataloading take 5.847181797027588 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09022665023803711
Time for copying to cuda: 0.1268291473388672
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 76, 18']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 41.76106095314026
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8398.0, 8020.0] Time: 43.30131149291992
Length of received data: 605229121
Future took 2.839745044708252 seconds
Pickle took 0.31305694580078125 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.1529486179351807 seconds
Dataloader took 0.27897071838378906 seconds
Streaming imagenet data took 3.432025671005249 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 31']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Memory occupied: [8398.0, 8020.0] Time: 44.867228746414185
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 45']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8398.0, 8020.0] Time: 46.39248538017273
Time for forward pass: 5.4783852100372314
Time for backpropagation: 0.007868289947509766
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.724644899368286 seconds
Index: 6
Then, training+dataloading take 5.725986480712891 seconds

Epoch: 0
Time of next(dataloader) is: 0.08075380325317383
Time for copying to cuda: 0.12680745124816895
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 40']
Memory occupied: [8398.0, 8020.0] Time: 47.91847324371338
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 44']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8398.0, 8020.0] Time: 49.42398428916931
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 48']
Memory occupied: [8398.0, 8020.0] Time: 50.92907357215881
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 26']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Time for forward pass: 5.5211217403411865
Time for backpropagation: 0.008544206619262695
GPU memory for training: 8.37738037109375                          

Last train takes: 5.746531963348389 seconds
Total time for streaming and training: 52.41437268257141
Memory occupied: [8398.0, 8020.0] Time: 52.45809578895569
Finish gpu thread time: 1.044792652130127
The whole process took 60.641010761260986 seconds
