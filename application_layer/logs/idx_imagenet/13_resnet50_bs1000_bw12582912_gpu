Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=13, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.161203145980835
Time to prepare transforms: 0.0002543926239013672
Time to download labels: 0.0625462532043457
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10086.469475874124 Mbps
Get bandwitdh took 1.2350056171417236
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1322053727.1417732 1322053727.1417732
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 13 21
Intermediate:  0.765625
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 2402.232421875 2607.14794921875 8335.826171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Time for splitting algorithm: 5.126180648803711
Using split index: 13
Freezing the lower layers of the model (myresnet50) till index 21
Time to freeze model: 0.0007152557373046875
Time for model prep: 0.0022406578063964844
Time for model and splitting algorithm: 5.12915563583374
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 0.3270409107208252
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 1.6582767963409424
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 2.9912219047546387
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 4.345343828201294
Length of received data: 802863121
Future took 5.193412780761719 seconds
Pickle took 0.4161794185638428 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.609798908233643 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.45231127738952637 seconds
Streaming imagenet data took 6.062161207199097 seconds
First stream takes: 6.108031749725342 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000

Memory occupied: [1410.0, 3.0] Time: 6.108725309371948

Epoch: 0
Time of next(dataloader) is: 0.10426902770996094
Time for copying to cuda: 0.1680002212524414
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 4, 0']
Memory occupied: [2176.0, 812.0] Time: 7.553081512451172
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2176.0, 1354.0] Time: 9.016952514648438
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 99, 39']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 62, 30']
Memory occupied: [3958.0, 6660.0] Time: 10.543413877487183
Length of received data: 802863121
Future took 5.2926483154296875 seconds
Pickle took 0.4209120273590088 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.71377158164978 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 77, 19']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 82']
Dataloader took 0.5122218132019043 seconds
Streaming imagenet data took 6.226071834564209 seconds
Memory occupied: [7076.0, 5958.0] Time: 12.420294523239136
Time for forward pass: 7.040041208267212
Time for backpropagation: 0.11603975296020508
GPU memory for training: 10.686818599700928                          

One training iteration takes: 7.454597473144531 seconds
Index: 0
Then, training+dataloading take 7.456374168395996 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 56, 40']
Time of next(dataloader) is: 0.19376206398010254
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [8448.0, 3110.0] Time: 13.925391912460327
Time for copying to cuda: 0.20931267738342285
Time for forward pass: 0.4532959461212158
Time for backpropagation: 0.006341457366943359
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.8895416259765625 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 15.355355978012085
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 16.78328776359558
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 18.24688220024109
Length of received data: 802863121
Future took 5.310840845108032 seconds
Pickle took 0.41666698455810547 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.727690696716309 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49461865425109863 seconds
Streaming imagenet data took 6.222377777099609 seconds
Then, training+dataloading take 6.243651866912842 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [8456.0, 3502.0] Time: 19.874640941619873
Time of next(dataloader) is: 0.1062309741973877
Time for copying to cuda: 0.16820025444030762
Time for forward pass: 0.5377559661865234
Time for backpropagation: 0.0061419010162353516
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.845897912979126 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 21.312087059020996
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 22.75157380104065
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 24.231118202209473
Length of received data: 802863121
Future took 5.226651906967163 seconds
Pickle took 0.4113802909851074 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.6382200717926025 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4954965114593506 seconds
Streaming imagenet data took 6.133806228637695 seconds
Then, training+dataloading take 6.15682315826416 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occupied: [8456.0, 3502.0] Time: 26.027637481689453
Time of next(dataloader) is: 0.10651302337646484
Time for copying to cuda: 0.16809558868408203
Time for forward pass: 0.5181789398193359
Time for backpropagation: 0.0060732364654541016
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.8271911144256592 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 27.465028762817383
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 28.90325903892517
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 30.35615825653076
Length of received data: 802863121
Future took 5.266875267028809 seconds
Pickle took 0.4135136604309082 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.680523872375488 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.5014286041259766 seconds
Streaming imagenet data took 6.182042121887207 seconds
Then, training+dataloading take 6.204949378967285 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occupied: [8456.0, 3502.0] Time: 32.2245728969574
Time of next(dataloader) is: 0.10566425323486328
Time for copying to cuda: 0.1685028076171875
Time for forward pass: 0.5124344825744629
Time for backpropagation: 0.006108760833740234
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.8207342624664307 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 33.66332125663757
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 35.10324764251709
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 36.706971406936646
Length of received data: 802863121
Future took 5.208292245864868 seconds
Pickle took 0.4117164611816406 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.6201581954956055 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49567294120788574 seconds
Streaming imagenet data took 6.11592173576355 seconds
Then, training+dataloading take 6.137791156768799 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occupied: [8456.0, 3502.0] Time: 38.37772464752197
Time of next(dataloader) is: 0.10548686981201172
Time for copying to cuda: 0.16864800453186035
Time for forward pass: 0.530024528503418
Time for backpropagation: 0.006213188171386719
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.8381178379058838 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 39.81466293334961
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 41.25377678871155
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 42.70822525024414
Length of received data: 802863121
Future took 5.364088535308838 seconds
Pickle took 0.41377997398376465 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.778061389923096 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49589109420776367 seconds
Streaming imagenet data took 6.274031400680542 seconds
Then, training+dataloading take 6.295636177062988 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10333967208862305
Memory occupied: [8456.0, 3502.0] Time: 44.70940089225769
Time for copying to cuda: 0.16746211051940918
Time for forward pass: 0.5101823806762695
Time for backpropagation: 0.006543874740600586
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.8153817653656006 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 46.14716601371765
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 47.58362698554993
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3502.0] Time: 49.05487012863159
Length of received data: 802863121
Future took 5.287840843200684 seconds
Pickle took 0.41165709495544434 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.699678659439087 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49383020401000977 seconds
Streaming imagenet data took 6.193591833114624 seconds
Then, training+dataloading take 6.215073823928833 seconds

Epoch: 0
Time of next(dataloader) is: 0.10353231430053711
Memory occupied: [8456.0, 3502.0] Time: 50.92752695083618
Time for copying to cuda: 0.1679680347442627
Time for forward pass: 0.520618200302124
Time for backpropagation: 0.00611567497253418
GPU memory for training: 3.575498104095459                          

Last train takes: 0.8251547813415527 seconds
Total time for streaming and training: 51.643749952316284
Finish gpu thread time: 0.28478288650512695
The whole process took 58.28209209442139 seconds
