Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7418291088428 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119110609.02495424 119110609.02495424
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 11
Intermediate:  0.3828125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 1396.06982421875 1547.94775390625 7712.47607421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 7
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 5.310679197311401 seconds
Streaming imagenet data took 5.452898025512695 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5123095512390137
Memory occpied: (1336.0, 3.0)
Time for copying to cuda: 0.09815573692321777
Memory occpied: (1720.0, 710.0)
Memory occpied: (1720.0, 1158.0)
Memory occpied: (3678.0, 3436.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 5.272487163543701 seconds
Time for forward pass: 4.76457405090332
Streaming imagenet data took 5.506069898605347 seconds
Memory occpied: (6864.0, 6660.0)
Time for backpropagation: 0.7290878295898438
GPU memory for training: 7.353196620941162                          

One training iteration takes: 6.199275732040405 seconds
Index: 0
Then, training+dataloading take 6.2001776695251465 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (3654.0, 4902.0)
Time of next(dataloader) is: 0.5592045783996582
Time for copying to cuda: 0.0972757339477539
Time for forward pass: 0.16765117645263672
Time for backpropagation: 0.004587650299072266
GPU memory for training: 2.883979320526123                          

One training iteration takes: 0.9456961154937744 seconds
Index: 1
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 5.271585941314697 seconds
Streaming imagenet data took 5.506591081619263 seconds
Then, training+dataloading take 5.529773950576782 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (3670.0, 4918.0)
Time of next(dataloader) is: 0.5562911033630371
Time for copying to cuda: 0.09743475914001465
Time for forward pass: 0.24840569496154785
Time for backpropagation: 0.004912614822387695
GPU memory for training: 2.883979320526123                          

One training iteration takes: 1.0356054306030273 seconds
Index: 2
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 5.360646724700928 seconds
Streaming imagenet data took 5.502002239227295 seconds
Then, training+dataloading take 5.524629354476929 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5532073974609375
Memory occpied: (3670.0, 4918.0)
Time for copying to cuda: 0.13679814338684082
Time for forward pass: 0.2414078712463379
Time for backpropagation: 0.004678010940551758
GPU memory for training: 2.883979320526123                          

One training iteration takes: 1.0466442108154297 seconds
Index: 3
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 5.3257622718811035 seconds
Streaming imagenet data took 5.576410531997681 seconds
Then, training+dataloading take 5.5998454093933105 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000

Memory occpied: (3670.0, 4918.0)

Epoch: 0
Time of next(dataloader) is: 0.5540256500244141
Time for copying to cuda: 0.09846925735473633
Time for forward pass: 0.24300909042358398
Time for backpropagation: 0.004657745361328125
GPU memory for training: 2.883979320526123                          

One training iteration takes: 1.0246613025665283 seconds
Index: 4
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 5.316558837890625 seconds
Streaming imagenet data took 5.4590983390808105 seconds
Then, training+dataloading take 5.481894016265869 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5818991661071777
Memory occpied: (3670.0, 4918.0)
Time for copying to cuda: 0.09871816635131836
Time for forward pass: 0.23264694213867188
Time for backpropagation: 0.0047070980072021484
GPU memory for training: 2.883979320526123                          

One training iteration takes: 1.0388755798339844 seconds
Index: 5
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 5.3055806159973145 seconds
Streaming imagenet data took 5.543972492218018 seconds
Then, training+dataloading take 5.55741810798645 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Time of next(dataloader) is: 0.5558059215545654
Time for copying to cuda: 0.09814763069152832
Time for forward pass: 0.2454841136932373
Time for backpropagation: 0.004648685455322266
GPU memory for training: 2.883979320526123                          

One training iteration takes: 1.040454626083374 seconds
Index: 6
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Memory occpied: (3670.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 5.347660541534424 seconds
Streaming imagenet data took 5.4899516105651855 seconds
Then, training+dataloading take 5.512848854064941 seconds

Epoch: 0
Time of next(dataloader) is: 0.5922937393188477
Memory occpied: (3670.0, 4918.0)
Time for copying to cuda: 0.09781908988952637
Time for forward pass: 0.24284672737121582
Time for backpropagation: 0.0046160221099853516
GPU memory for training: 2.883979320526123                          

The whole process took 52.686628580093384 seconds
