Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1635315418243408
Time to prepare transforms: 0.00024271011352539062
Time to download labels: 0.06499838829040527
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5416483259798 Mbps
Get bandwitdh took 1.2375385761260986
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119084370.92938283 119084370.92938283
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 11
Intermediate:  0.3828125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 1396.06982421875 1547.94775390625 7712.47607421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Time for splitting algorithm: 4.9421000480651855
Using split index: 7
Freezing the lower layers of the model (myresnet18) till index 11
Time to freeze model: 0.0003573894500732422
Time for model prep: 0.0013310909271240234
Time for model and splitting algorithm: 4.943807125091553
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 3, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 0.33112263679504395
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 1.66587233543396
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 3.0312702655792236
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 4.394007682800293
Length of received data: 401454121
Future took 5.169791221618652 seconds
Pickle took 0.2101285457611084 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.380074739456177 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.21726584434509277 seconds
Streaming imagenet data took 5.597387790679932 seconds
First stream takes: 5.614990711212158 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.14539647102355957
Memory occupied: [1336.0, 3.0] Time: 5.81175971031189
Time for copying to cuda: 0.08492565155029297
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1720.0, 792.0] Time: 7.227996826171875
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1720.0, 1252.0] Time: 8.711733341217041
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 96, 29']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 75, 26']
Memory occupied: [5778.0, 8788.0] Time: 10.192854404449463
Time for forward pass: 4.7146642208099365
Length of received data: 401454121
Future took 5.21742582321167 seconds
Pickle took 0.20653438568115234 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.424084901809692 seconds
Dataloader took 0.14143633842468262 seconds
Streaming imagenet data took 5.565565824508667 seconds
Time for backpropagation: 0.7505474090576172
GPU memory for training: 7.353196620941162                          

One training iteration takes: 5.70923924446106 seconds
Index: 0
Then, training+dataloading take 5.710204601287842 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 77']
Time of next(dataloader) is: 0.16521525382995605
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Time for copying to cuda: 0.125471830368042
Memory occupied: [3654.0, 4918.0] Time: 11.67253851890564
Time for forward pass: 0.1693108081817627
Time for backpropagation: 0.004079103469848633
GPU memory for training: 2.950934886932373                          

One training iteration takes: 0.4781956672668457 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 13.100116491317749
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 14.544655799865723
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 15.99893569946289
Length of received data: 401454121
Future took 5.253085613250732 seconds
Pickle took 0.20786523818969727 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.461103916168213 seconds
Dataloader took 0.14063024520874023 seconds
Streaming imagenet data took 5.601778745651245 seconds
Then, training+dataloading take 5.6160783767700195 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.12795591354370117
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.1281282901763916
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 54, 32']
Time for forward pass: 0.23579883575439453
Time for backpropagation: 0.0052716732025146484
GPU memory for training: 2.950934886932373                          

One training iteration takes: 0.5042574405670166 seconds
Index: 2
Memory occupied: [3670.0, 4918.0] Time: 17.49775004386902
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 18.976770401000977
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 20.463308572769165
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 21.962714672088623
Length of received data: 401454121
Future took 5.375744819641113 seconds
Pickle took 0.1640303134918213 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.539920806884766 seconds
Dataloader took 0.14303278923034668 seconds
Streaming imagenet data took 5.683000087738037 seconds
Then, training+dataloading take 5.6975109577178955 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08019566535949707
Time for copying to cuda: 0.0837700366973877
Time for forward pass: 0.24124407768249512
Time for backpropagation: 0.005400896072387695
GPU memory for training: 2.950934886932373                          

One training iteration takes: 0.41732239723205566 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 42']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 55, 29']
Memory occupied: [3670.0, 4918.0] Time: 23.450884103775024
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 24.910595893859863
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 26.38537859916687
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 27.87180757522583
Length of received data: 401454121
Future took 5.376849412918091 seconds
Pickle took 0.16382575035095215 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.540834426879883 seconds
Dataloader took 0.14243078231811523 seconds
Streaming imagenet data took 5.68331241607666 seconds
Then, training+dataloading take 5.698082208633423 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06614327430725098
Time for copying to cuda: 0.08397698402404785
Time for forward pass: 0.24511098861694336
Time for backpropagation: 0.003951072692871094
GPU memory for training: 2.950934886932373                          

One training iteration takes: 0.4129819869995117 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 60, 32']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 29.32617950439453
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 30.81204319000244
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 32.287007570266724
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 401454121
Future took 5.395277500152588 seconds
Pickle took 0.17808008193969727 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.573646068572998 seconds
Memory occupied: [3670.0, 4918.0] Time: 33.91132378578186
Dataloader took 0.14127206802368164 seconds
Streaming imagenet data took 5.714964866638184 seconds
Then, training+dataloading take 5.737126111984253 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06628656387329102
Time for copying to cuda: 0.08403491973876953
Time for forward pass: 0.2480638027191162
Time for backpropagation: 0.004005908966064453
GPU memory for training: 2.950934886932373                          

One training iteration takes: 0.41655683517456055 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 35.352694511413574
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 36.80369448661804
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 38.26474404335022
Length of received data: 401454121
Future took 5.2716124057769775 seconds
Pickle took 0.2021951675415039 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.474123001098633 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.23856759071350098 seconds
Streaming imagenet data took 5.712764263153076 seconds
Then, training+dataloading take 5.728898048400879 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.11603951454162598
Memory occupied: [3670.0, 4918.0] Time: 39.95079159736633
Time for copying to cuda: 0.08424019813537598
Time for forward pass: 0.23913359642028809
Time for backpropagation: 0.003998994827270508
GPU memory for training: 2.950934886932373                          

One training iteration takes: 0.4576075077056885 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 41.40527677536011
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 42.87602996826172
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 44.36395454406738
Length of received data: 401454121
Future took 5.27101993560791 seconds
Pickle took 0.1831216812133789 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.454280614852905 seconds
Dataloader took 0.18923306465148926 seconds
Streaming imagenet data took 5.643592357635498 seconds
Then, training+dataloading take 5.653183221817017 seconds

Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.11638450622558594
Time for copying to cuda: 0.12862181663513184
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3670.0, 4918.0] Time: 45.89420413970947
Time for forward pass: 0.2391366958618164
Time for backpropagation: 0.004173755645751953
GPU memory for training: 2.950934886932373                          

Last train takes: 0.5030896663665771 seconds
Total time for streaming and training: 45.95937418937683
Finish gpu thread time: 0.9357705116271973
The whole process took 53.06820893287659 seconds
