Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=17, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.163947582244873
Time to prepare transforms: 0.00023937225341796875
Time to download labels: 0.04979538917541504
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2899179721476 Mbps
Get bandwitdh took 1.2318229675292969
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119051376.12844533 119051376.12844533
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 17 17
Intermediate:  0.015625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 350.46142578125 616.73876953125 2386.10595703125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.227912425994873
Using split index: 17
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.0002048015594482422
Time for model prep: 0.0008401870727539062
Time for model and splitting algorithm: 5.228975772857666
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.3219022750854492
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6473984718322754
Length of received data: 16420362
Future took 1.8066084384918213 seconds
Pickle took 0.010120153427124023 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.8168659210205078 seconds
Dataloader took 0.006498098373413086 seconds
Streaming imagenet data took 1.8233942985534668 seconds
First stream takes: 1.823674201965332 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.010985612869262695
Time for copying to cuda: 0.003926277160644531
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1530.0, 520.0] Time: 3.0202927589416504
Length of received data: 16420362
Future took 1.6723315715789795 seconds
Pickle took 0.00823068618774414 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6807262897491455 seconds
Dataloader took 0.007880449295043945 seconds
Streaming imagenet data took 1.688645601272583 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1530.0, 982.0] Time: 4.426623106002808
Time for forward pass: 3.2935659885406494
Time for backpropagation: 0.04997730255126953
GPU memory for training: 0.9570660591125488                          

One training iteration takes: 3.359524965286255 seconds
Index: 0
Then, training+dataloading take 3.3595831394195557 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.010116100311279297
Time for copying to cuda: 0.014903068542480469
Time for forward pass: 0.03132343292236328
Time for backpropagation: 0.0027930736541748047
GPU memory for training: 1.1122322082519531                          

One training iteration takes: 0.06024527549743652 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 11, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 5.841655969619751
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 16420362
Future took 1.8640716075897217 seconds
Pickle took 0.009734392166137695 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.8739597797393799 seconds
Dataloader took 0.04549551010131836 seconds
Streaming imagenet data took 1.9195244312286377 seconds
Then, training+dataloading take 1.922713041305542 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.013796806335449219
Time for copying to cuda: 0.003701448440551758
Time for forward pass: 0.031093120574951172
Time for backpropagation: 0.002238750457763672
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.052336931228637695 seconds
Index: 2
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 7.26861834526062
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 8.692362546920776
Length of received data: 16420362
Future took 1.6720867156982422 seconds
Pickle took 0.008036136627197266 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6802384853363037 seconds
Dataloader took 0.006524562835693359 seconds
Streaming imagenet data took 1.6868071556091309 seconds
Then, training+dataloading take 1.6874918937683105 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007555961608886719
Time for copying to cuda: 0.0037529468536376953
Time for forward pass: 0.030843734741210938
Time for backpropagation: 0.002132415771484375
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.04538083076477051 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 10.110759496688843
Length of received data: 16420362
Future took 1.6704378128051758 seconds
Pickle took 0.007951974868774414 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6785285472869873 seconds
Dataloader took 0.004011869430541992 seconds
Streaming imagenet data took 1.682579517364502 seconds
Then, training+dataloading take 1.6831035614013672 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0076634883880615234
Time for copying to cuda: 0.003707408905029297
Time for forward pass: 0.030801057815551758
Time for backpropagation: 0.002147197723388672
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.04536581039428711 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 11.529149055480957
Length of received data: 16420362
Future took 1.6751844882965088 seconds
Pickle took 0.008025646209716797 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6833398342132568 seconds
Dataloader took 0.004060268402099609 seconds
Streaming imagenet data took 1.6874361038208008 seconds
Then, training+dataloading take 1.6879808902740479 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007572174072265625
Time for copying to cuda: 0.0037152767181396484
Time for forward pass: 0.030892133712768555
Time for backpropagation: 0.0023734569549560547
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.04571342468261719 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 12.948464155197144
Length of received data: 16420362
Future took 1.674072027206421 seconds
Pickle took 0.008063554763793945 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6823046207427979 seconds
Dataloader took 0.007001638412475586 seconds
Streaming imagenet data took 1.6893482208251953 seconds
Then, training+dataloading take 1.6899418830871582 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00799107551574707
Time for copying to cuda: 0.003711223602294922
Time for forward pass: 0.031029224395751953
Time for backpropagation: 0.002325773239135742
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.046295166015625 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 16, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 14.372649192810059
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 16420362
Future took 1.7350223064422607 seconds
Pickle took 0.01184844970703125 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.7471072673797607 seconds
Dataloader took 0.004479646682739258 seconds
Streaming imagenet data took 1.7516567707061768 seconds
Then, training+dataloading take 1.7524597644805908 seconds

Epoch: 0
Time of next(dataloader) is: 0.007703304290771484
Time for copying to cuda: 0.04119563102722168
Time for forward pass: 0.0315706729888916
Time for backpropagation: 0.00286865234375
GPU memory for training: 1.1125984191894531                          

Last train takes: 0.08463191986083984 seconds
Total time for streaming and training: 15.691822528839111
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 15.828154563903809
Finish gpu thread time: 1.137406826019287
The whole process took 23.272594213485718 seconds
