Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=6, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1634106636047363
Time to prepare transforms: 0.0002465248107910156
Time to download labels: 0.06231045722961426
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10088.91689415949 Mbps
Get bandwitdh took 1.2303557395935059
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03
 3.07200e+03 3.07200e+03 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1322374515.1512728 1322374515.1512728
All candidates indexes:  (array([17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 6 17
Intermediate:  8.6572265625
8.6572265625
Total layers size  104.47354125976562
Server, client, server+client, vanilla  477.9326171875 26327.11669921875 26805.04931640625 26901.33544921875
Fixed, scale_with_bsz  0 9.2314453125
Mem usage  1654.0 3.0
Time for splitting algorithm: 5.978088617324829
Using split index: 6
Freezing the lower layers of the model (myvit) till index 17
Time to freeze model: 0.0008921623229980469
Time for model prep: 0.0023338794708251953
Time for model and splitting algorithm: 5.981334924697876
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 0.32044482231140137
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 1.6455764770507812
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 2.9938290119171143
Length of received data: 605229121
Future took 3.6928577423095703 seconds
Pickle took 0.320723295211792 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.013750314712524 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.3890035152435303 seconds
Streaming imagenet data took 4.402815103530884 seconds
First stream takes: 4.415217161178589 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occupied: [1654.0, 3.0] Time: 4.496328353881836
Time of next(dataloader) is: 0.09117293357849121
Time for copying to cuda: 0.12851524353027344
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2232.0, 810.0] Time: 5.932711124420166
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2232.0, 1300.0] Time: 7.400716543197632
Length of received data: 605229121
Future took 3.5962958335876465 seconds
Pickle took 0.31620192527770996 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.9126369953155518 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 86, 22']
Dataloader took 0.3239884376525879 seconds
Streaming imagenet data took 4.236731290817261 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 41']
Memory occupied: [8390.0, 8012.0] Time: 8.91542100906372
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 40']
Memory occupied: [8390.0, 8012.0] Time: 10.387484550476074
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 32']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8390.0, 8012.0] Time: 11.855278968811035
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
Time for forward pass: 8.549575328826904
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 37']
Time for backpropagation: 0.1015315055847168
GPU memory for training: 8.35290813446045                          

One training iteration takes: 8.881409168243408 seconds
Index: 0
Then, training+dataloading take 8.881736993789673 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occupied: [8390.0, 8012.0] Time: 13.360487222671509
Time of next(dataloader) is: 0.08730673789978027
Time for copying to cuda: 0.12777996063232422
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 34']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 14.846784591674805
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 16.385698795318604
Length of received data: 605229121
Future took 3.684326171875 seconds
Pickle took 0.31412601470947266 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.9985947608947754 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 32']
Dataloader took 0.337369441986084 seconds
Streaming imagenet data took 4.33607816696167 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 17.973063945770264
Time for forward pass: 4.8182053565979
Time for backpropagation: 0.007801532745361328
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.064723968505859 seconds
Index: 1
Then, training+dataloading take 5.066059112548828 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08175063133239746
Time for copying to cuda: 0.1259450912475586
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 45']
Memory occupied: [8398.0, 8020.0] Time: 19.483020305633545
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 30']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 20.993379831314087
Length of received data: 605229121
Future took 3.4045729637145996 seconds
Pickle took 0.31574392318725586 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.7205066680908203 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
Dataloader took 0.3831775188446045 seconds
Streaming imagenet data took 4.10377311706543 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 22.677520751953125
Time for forward pass: 4.8733437061309814
Time for backpropagation: 0.007753610610961914
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.109851360321045 seconds
Index: 2
Then, training+dataloading take 5.111223459243774 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0814359188079834
Time for copying to cuda: 0.1747899055480957
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 38, 4']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 50']
Memory occupied: [8398.0, 8020.0] Time: 24.2083637714386
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 41']
Memory occupied: [8398.0, 8020.0] Time: 25.73761248588562
Length of received data: 605229121
Future took 3.3694379329681396 seconds
Pickle took 0.31131529808044434 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.7384090423583984 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
Dataloader took 0.32923340797424316 seconds
Streaming imagenet data took 4.067824125289917 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 50']
Memory occupied: [8398.0, 8020.0] Time: 27.734277963638306
Time for forward pass: 4.872318267822266
Time for backpropagation: 0.0077555179595947266
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.158145427703857 seconds
Index: 3
Then, training+dataloading take 5.161355495452881 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08213543891906738
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 66, 27']
Time for copying to cuda: 0.2046198844909668
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 37, 24']
Memory occupied: [8398.0, 8020.0] Time: 29.255512475967407
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 50']
Memory occupied: [8398.0, 8020.0] Time: 30.77367091178894
Length of received data: 605229121
Future took 3.367410898208618 seconds
Pickle took 0.32457613945007324 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.6921567916870117 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
Dataloader took 0.3908963203430176 seconds
Streaming imagenet data took 4.083161115646362 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 32.93461203575134
Time for forward pass: 4.89323353767395
Time for backpropagation: 0.007847309112548828
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.215999603271484 seconds
Index: 4
Then, training+dataloading take 5.231839179992676 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.13198542594909668
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 48, 24']
Time for copying to cuda: 0.16153216361999512
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 48, 33']
Memory occupied: [8398.0, 8020.0] Time: 34.45096397399902
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 44']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 35.95242762565613
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 37.49142599105835
Length of received data: 605229121
Future took 3.7892699241638184 seconds
Pickle took 0.3100581169128418 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.099478244781494 seconds
Dataloader took 0.21707391738891602 seconds
Streaming imagenet data took 4.316598892211914 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Memory occupied: [8398.0, 8020.0] Time: 38.99329972267151
Time for forward pass: 4.920461654663086
Time for backpropagation: 0.007883787155151367
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.244369268417358 seconds
Index: 5
Then, training+dataloading take 5.245755910873413 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0823214054107666
Time for copying to cuda: 0.12620306015014648
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 40.495054483413696
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 41']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 42.075746297836304
Length of received data: 605229121
Future took 3.640979051589966 seconds
Pickle took 0.28451108932495117 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.925632953643799 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
Dataloader took 0.37932920455932617 seconds
Streaming imagenet data took 4.305078506469727 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 31']
Memory occupied: [8398.0, 8020.0] Time: 43.64437651634216
Time for forward pass: 4.9593346118927
Time for backpropagation: 0.007858514785766602
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.198084115982056 seconds
Index: 6
Then, training+dataloading take 5.199438095092773 seconds

Epoch: 0
Time of next(dataloader) is: 0.09064555168151855
Time for copying to cuda: 0.12572097778320312
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 87, 41']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 45.14475440979004
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 29']
Memory occupied: [8398.0, 8020.0] Time: 46.6452751159668
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 48.14876079559326
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 31']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 34']
Time for forward pass: 5.04825758934021
Time for backpropagation: 0.010941505432128906
GPU memory for training: 8.37738037109375                          

Last train takes: 5.285335063934326 seconds
Total time for streaming and training: 49.598206758499146
Memory occupied: [8398.0, 8020.0] Time: 49.670592308044434
Finish gpu thread time: 1.0734124183654785
The whole process took 57.87942385673523 seconds
