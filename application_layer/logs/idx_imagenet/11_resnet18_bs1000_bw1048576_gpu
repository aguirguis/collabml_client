Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=11, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1615517139434814
Time to prepare transforms: 0.00025534629821777344
Time to download labels: 0.04980039596557617
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6903840742497 Mbps
Get bandwitdh took 1.2385046482086182
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119103866.02138005 119103866.02138005
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 11 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 343.33544921875 495.21337890625 6946.85107421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Time for splitting algorithm: 4.940803050994873
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
Time to freeze model: 0.0003712177276611328
Time for model prep: 0.0013494491577148438
Time for model and splitting algorithm: 4.942542791366577
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 3, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 0.3301730155944824
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 1.6632983684539795
Length of received data: 100399121
Future took 2.6330418586730957 seconds
Pickle took 0.05219459533691406 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6854171752929688 seconds
Dataloader took 0.06918072700500488 seconds
Streaming imagenet data took 2.7546534538269043 seconds
First stream takes: 2.759484052658081 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.08087348937988281
Time for copying to cuda: 0.022040605545043945
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1432.0, 158.0] Time: 3.0478200912475586
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1432.0, 698.0] Time: 4.439271926879883
Length of received data: 100399121
Future took 2.540148973464966 seconds
Pickle took 0.050060272216796875 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.5903539657592773 seconds
Dataloader took 0.03665614128112793 seconds
Streaming imagenet data took 2.627060651779175 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1432.0, 1158.0] Time: 5.864961385726929
Time for forward pass: 3.8605940341949463
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 82, 49']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 90, 28']
Memory occupied: [7922.0, 7828.0] Time: 7.296159982681274
Time for backpropagation: 0.8037447929382324
GPU memory for training: 6.8614277839660645                          

One training iteration takes: 4.772278070449829 seconds
Index: 0
Then, training+dataloading take 4.772665977478027 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04811978340148926
Time for copying to cuda: 0.021192550659179688
Time for forward pass: 0.030115604400634766
Time for backpropagation: 0.0035219192504882812
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.10744953155517578 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4728.0, 4630.0] Time: 8.732983827590942
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4728.0, 4630.0] Time: 10.180492162704468
Length of received data: 100399121
Future took 2.7632198333740234 seconds
Pickle took 0.0530850887298584 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.816438913345337 seconds
Dataloader took 0.03647470474243164 seconds
Streaming imagenet data took 2.8529579639434814 seconds
Then, training+dataloading take 2.8582215309143066 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04832124710083008
Time for copying to cuda: 0.021437406539916992
Time for forward pass: 0.046181440353393555
Time for backpropagation: 0.003780364990234375
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.12439560890197754 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4728.0, 4630.0] Time: 11.617374420166016
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4728.0, 4630.0] Time: 13.071672916412354
Length of received data: 100399121
Future took 2.699779748916626 seconds
Pickle took 0.04684901237487793 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.7467715740203857 seconds
Dataloader took 0.036873579025268555 seconds
Streaming imagenet data took 2.783693552017212 seconds
Then, training+dataloading take 2.7882843017578125 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04822254180908203
Time for copying to cuda: 0.021300077438354492
Time for forward pass: 0.045987844467163086
Time for backpropagation: 0.003656148910522461
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.12394380569458008 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4728.0, 4630.0] Time: 14.52099871635437
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 100399121
Future took 2.6796071529388428 seconds
Pickle took 0.0426478385925293 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.7225794792175293 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.07892966270446777 seconds
Streaming imagenet data took 2.8015782833099365 seconds
Then, training+dataloading take 2.8071887493133545 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occupied: [4728.0, 4630.0] Time: 16.018094539642334
Time of next(dataloader) is: 0.04970955848693848
Time for copying to cuda: 0.021355152130126953
Time for forward pass: 0.04608726501464844
Time for backpropagation: 0.0037398338317871094
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.1261134147644043 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4728.0, 4630.0] Time: 17.455749034881592
Length of received data: 100399121
Future took 2.573594570159912 seconds
Pickle took 0.04656386375427246 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.6203157901763916 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.07881307601928711 seconds
Streaming imagenet data took 2.699214458465576 seconds
Then, training+dataloading take 2.7042510509490967 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0916757583618164
Time for copying to cuda: 0.021613597869873047
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for forward pass: 0.07548046112060547
Time for backpropagation: 0.0054285526275634766
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.19766879081726074 seconds
Index: 5
Memory occupied: [4728.0, 4630.0] Time: 18.953172206878662
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4728.0, 4630.0] Time: 20.398144721984863
Length of received data: 100399121
Future took 2.544930934906006 seconds
Pickle took 0.04230022430419922 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.587369203567505 seconds
Dataloader took 0.03578662872314453 seconds
Streaming imagenet data took 2.6232054233551025 seconds
Then, training+dataloading take 2.6279168128967285 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04884028434753418
Time for copying to cuda: 0.021254777908325195
Time for forward pass: 0.05462813377380371
Time for backpropagation: 0.005161285400390625
GPU memory for training: 1.2606515884399414                          

One training iteration takes: 0.1330125331878662 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 23, 7']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 47, 19']
Memory occupied: [4728.0, 4630.0] Time: 21.848644971847534
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4728.0, 4630.0] Time: 23.30457901954651
Length of received data: 100399121
Future took 2.5985071659088135 seconds
Pickle took 0.04277992248535156 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 2.64143705368042 seconds
Dataloader took 0.037039756774902344 seconds
Streaming imagenet data took 2.6785225868225098 seconds
Then, training+dataloading take 2.6828670501708984 seconds

Epoch: 0
Time of next(dataloader) is: 0.04833412170410156
Time for copying to cuda: 0.0214078426361084
Time for forward pass: 0.046271562576293945
Time for backpropagation: 0.003860950469970703
GPU memory for training: 1.2606515884399414                          

Last train takes: 0.12411260604858398 seconds
Total time for streaming and training: 24.125179052352905
Finish gpu thread time: 0.18037939071655273
The whole process took 30.460134744644165 seconds
