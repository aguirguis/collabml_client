Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=18, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1629669666290283
Time to prepare transforms: 0.00024080276489257812
Time to download labels: 0.04643678665161133
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10214.140759140117 Mbps
Get bandwitdh took 1.2351596355438232
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1338787857.5820134 1338787857.5820134
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 18 21
Intermediate:  0.3828125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 1253.794921875 1458.71044921875 7570.201171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Time for splitting algorithm: 5.154350996017456
Using split index: 18
Freezing the lower layers of the model (myresnet50) till index 21
Time to freeze model: 0.0007266998291015625
Time for model prep: 0.002293109893798828
Time for model and splitting algorithm: 5.157390594482422
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 0.33363819122314453
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 1.667273759841919
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 3.0031442642211914
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 4.389212608337402
Length of received data: 401455121
Future took 4.77012825012207 seconds
Pickle took 0.21016764640808105 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.980465412139893 seconds
Dataloader took 0.14120244979858398 seconds
Streaming imagenet data took 5.121706247329712 seconds
First stream takes: 5.145549058914185 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06513524055480957
Time for copying to cuda: 0.08528327941894531
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 17, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1794.0, 388.0] Time: 5.795001983642578
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1794.0, 896.0] Time: 7.232285499572754
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1794.0, 1362.0] Time: 8.692922353744507
Length of received data: 401455121
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 73, 23']
Future took 4.732140302658081 seconds
Pickle took 0.20968174934387207 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.989185094833374 seconds
Dataloader took 0.19529008865356445 seconds
Streaming imagenet data took 5.184650897979736 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 44, 39']
Time for forward pass: 5.104381799697876
Memory occupied: [6384.0, 4844.0] Time: 10.466383695602417
Time for backpropagation: 0.06493282318115234
GPU memory for training: 9.752721309661865                          

One training iteration takes: 5.334208250045776 seconds
Index: 0
Then, training+dataloading take 5.335111379623413 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0775597095489502
Time for copying to cuda: 0.08367180824279785
Time for forward pass: 0.10535359382629395
Time for backpropagation: 0.005830049514770508
GPU memory for training: 1.9656119346618652                          

One training iteration takes: 0.28705263137817383 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 11.90022587776184
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 13.331194162368774
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 14.776646614074707
Length of received data: 401455121
Future took 4.666133880615234 seconds
Pickle took 0.2055361270904541 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.871822834014893 seconds
Dataloader took 0.14244580268859863 seconds
Streaming imagenet data took 5.0143141746521 seconds
Then, training+dataloading take 5.037434816360474 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06412196159362793
Time for copying to cuda: 0.08372640609741211
Time for forward pass: 0.16114568710327148
Time for backpropagation: 0.007102489471435547
GPU memory for training: 1.9656119346618652                          

One training iteration takes: 0.3232762813568115 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 76, 22']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 57, 26']
Memory occupied: [6372.0, 4852.0] Time: 16.236650705337524
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 17.672654390335083
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 19.1121346950531
Length of received data: 401455121
Future took 4.686258554458618 seconds
Pickle took 0.21889138221740723 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.9054484367370605 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.23447585105895996 seconds
Streaming imagenet data took 5.139978885650635 seconds
Then, training+dataloading take 5.163313388824463 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occupied: [6372.0, 4852.0] Time: 20.7938871383667
Time of next(dataloader) is: 0.11824893951416016
Time for copying to cuda: 0.08446931838989258
Time for forward pass: 0.1596848964691162
Time for backpropagation: 0.00637054443359375
GPU memory for training: 1.9656119346618652                          

One training iteration takes: 0.3833153247833252 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 22.219617128372192
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 23.645578145980835
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 25.08087134361267
Length of received data: 401455121
Future took 4.773327827453613 seconds
Pickle took 0.2031724452972412 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.976646184921265 seconds
Dataloader took 0.14154720306396484 seconds
Streaming imagenet data took 5.1182379722595215 seconds
Then, training+dataloading take 5.140918970108032 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07410264015197754
Time for copying to cuda: 0.08379554748535156
Time for forward pass: 0.1611340045928955
Time for backpropagation: 0.0068547725677490234
GPU memory for training: 1.9656119346618652                          

One training iteration takes: 0.33277058601379395 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 40, 7']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 26.53462529182434
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 27.970135927200317
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 29.399652004241943
Length of received data: 401455121
Future took 4.670983791351318 seconds
Pickle took 0.20298051834106445 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.920436143875122 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.1959226131439209 seconds
Streaming imagenet data took 5.116439342498779 seconds
Then, training+dataloading take 5.139368295669556 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.22359824180603027
Memory occupied: [6372.0, 4852.0] Time: 31.20567274093628
Time for copying to cuda: 0.08414936065673828
Time for forward pass: 0.15991783142089844
Time for backpropagation: 0.006094932556152344
GPU memory for training: 1.9656119346618652                          

One training iteration takes: 0.4883110523223877 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 32.634400844573975
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 34.06355619430542
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 35.51215624809265
Length of received data: 401455121
Future took 4.881954908370972 seconds
Pickle took 0.20446205139160156 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 5.086562395095825 seconds
Dataloader took 0.14217805862426758 seconds
Streaming imagenet data took 5.228782892227173 seconds
Then, training+dataloading take 5.25147271156311 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07068133354187012
Time for copying to cuda: 0.08399677276611328
Time for forward pass: 0.19075918197631836
Time for backpropagation: 0.006971120834350586
GPU memory for training: 1.9656119346618652                          

One training iteration takes: 0.359527587890625 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 68, 19']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 36.96118426322937
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 38.388818979263306
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 39.81969904899597
Length of received data: 401455121
Future took 4.56343412399292 seconds
Pickle took 0.2037029266357422 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.767323732376099 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.23395299911499023 seconds
Streaming imagenet data took 5.001328468322754 seconds
Then, training+dataloading take 5.024906873703003 seconds

Epoch: 0
Time of next(dataloader) is: 0.10823726654052734
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 41.46898078918457
Time for copying to cuda: 0.12491750717163086
Time for forward pass: 0.1598670482635498
Time for backpropagation: 0.006008625030517578
GPU memory for training: 1.9656119346618652                          

Last train takes: 0.41320133209228516 seconds
Total time for streaming and training: 41.651503801345825
Finish gpu thread time: 0.8185598850250244
The whole process took 48.83748126029968 seconds
