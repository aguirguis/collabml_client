Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=21, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.161067008972168
Time to prepare transforms: 0.00025963783264160156
Time to download labels: 0.06243586540222168
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10137.760504334978 Mbps
Get bandwitdh took 1.2253022193908691
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1328776544.8241942 1328776544.8241942
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 21 25
Intermediate:  0.095703125
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 895.69775390625 1804.09423828125 25874.21337890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Time for splitting algorithm: 6.592761993408203
Using split index: 21
Freezing the lower layers of the model (myvgg11) till index 25
Time to freeze model: 0.0002357959747314453
Time for model prep: 0.0008685588836669922
Time for model and splitting algorithm: 6.593885660171509
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 0.317934513092041
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 1.6370232105255127
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 2.953857183456421
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 4.2757039070129395
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 5.602768659591675
Length of received data: 100399121
Future took 6.045533657073975 seconds
Pickle took 0.054410457611083984 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.100093126296997 seconds
Dataloader took 0.03627753257751465 seconds
Streaming imagenet data took 6.136406183242798 seconds
First stream takes: 6.143216371536255 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04919314384460449
Time for copying to cuda: 0.02155447006225586
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1936.0, 342.0] Time: 6.963366985321045
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1936.0, 844.0] Time: 8.358221530914307
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 3.4302408695220947
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 27, 7']
Time for backpropagation: 0.09460854530334473
GPU memory for training: 2.182957649230957                          

One training iteration takes: 3.5987462997436523 seconds
Index: 0
Memory occupied: [2338.0, 1890.0] Time: 9.78505539894104
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3122.0, 1890.0] Time: 11.189837217330933
Length of received data: 100399121
Future took 5.9738664627075195 seconds
Pickle took 0.05173063278198242 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.025749444961548 seconds
Dataloader took 0.08576393127441406 seconds
Streaming imagenet data took 6.111593961715698 seconds
Then, training+dataloading take 6.117331504821777 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.049468040466308594
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.05825614929199219
Time for forward pass: 0.10625386238098145
Time for backpropagation: 0.003693103790283203
GPU memory for training: 2.3380250930786133                          

One training iteration takes: 0.22121095657348633 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 14, 5']
Memory occupied: [3524.0, 1898.0] Time: 12.630473136901855
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 14.052104234695435
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 15.46707558631897
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 16.881443738937378
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 18.339832305908203
Length of received data: 100399121
Future took 6.109492778778076 seconds
Pickle took 0.04661297798156738 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.156245231628418 seconds
Dataloader took 0.036463260650634766 seconds
Streaming imagenet data took 6.192762613296509 seconds
Then, training+dataloading take 6.1975812911987305 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04868268966674805
Time for copying to cuda: 0.021268606185913086
Time for forward pass: 0.10454368591308594
Time for backpropagation: 0.0026710033416748047
GPU memory for training: 2.3380250930786133                          

One training iteration takes: 0.18216991424560547 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 19.75697660446167
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 21.17230725288391
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 22.586617469787598
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 24.00169038772583
Length of received data: 100399121
Future took 5.9992995262146 seconds
Pickle took 0.04276728630065918 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.0422070026397705 seconds
Dataloader took 0.03677034378051758 seconds
Streaming imagenet data took 6.079024076461792 seconds
Then, training+dataloading take 6.082929611206055 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04831290245056152
Time for copying to cuda: 0.021342039108276367
Time for forward pass: 0.1045680046081543
Time for backpropagation: 0.002653837203979492
GPU memory for training: 2.3380250930786133                          

One training iteration takes: 0.18183493614196777 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 7, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 25.41697359085083
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 26.833237648010254
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 28.24969720840454
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 29.662018537521362
Length of received data: 100399121
Future took 6.039535999298096 seconds
Pickle took 0.04279017448425293 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.082473039627075 seconds
Dataloader took 0.036008596420288086 seconds
Streaming imagenet data took 6.118524074554443 seconds
Then, training+dataloading take 6.123033046722412 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08918595314025879
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.057940006256103516
Time for forward pass: 0.10628390312194824
Time for backpropagation: 0.0035772323608398438
GPU memory for training: 2.3380250930786133                          

One training iteration takes: 0.26032090187072754 seconds
Index: 4
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 30, 8']
Memory occupied: [3524.0, 1898.0] Time: 31.090968132019043
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 32.50630259513855
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 33.92557144165039
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 35.34104371070862
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 100399121
Memory occupied: [3524.0, 1898.0] Time: 36.802159786224365
Future took 6.137737989425659 seconds
Pickle took 0.043296098709106445 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.181173801422119 seconds
Dataloader took 0.036612510681152344 seconds
Streaming imagenet data took 6.21783447265625 seconds
Then, training+dataloading take 6.222374439239502 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04848670959472656
Time for copying to cuda: 0.021122455596923828
Time for forward pass: 0.10463190078735352
Time for backpropagation: 0.0029337406158447266
GPU memory for training: 2.3380250930786133                          

One training iteration takes: 0.18217778205871582 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 38.26261043548584
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 39.67819905281067
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 41.09538722038269
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 42.5090868473053
Length of received data: 100399121
Future took 6.0559470653533936 seconds
Pickle took 0.04248332977294922 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.098584890365601 seconds
Dataloader took 0.036145925521850586 seconds
Streaming imagenet data took 6.134786605834961 seconds
Then, training+dataloading take 6.138701438903809 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04846906661987305
Time for copying to cuda: 0.021193504333496094
Time for forward pass: 0.10452485084533691
Time for backpropagation: 0.00262451171875
GPU memory for training: 2.3380250930786133                          

One training iteration takes: 0.18175339698791504 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 11, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 43.925323247909546
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 45.34475302696228
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 46.7573401927948
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3524.0, 1898.0] Time: 48.17268347740173
Length of received data: 100399121
Future took 6.077755689620972 seconds
Pickle took 0.04269218444824219 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 6.120595455169678 seconds
Dataloader took 0.07738661766052246 seconds
Streaming imagenet data took 6.1980485916137695 seconds
Then, training+dataloading take 6.20287299156189 seconds

Epoch: 0
Time of next(dataloader) is: 0.04958677291870117
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.05077695846557617
Time for forward pass: 0.10618090629577637
Time for backpropagation: 0.0035920143127441406
GPU memory for training: 2.3380250930786133                          

Last train takes: 0.21311306953430176 seconds
Total time for streaming and training: 49.441385984420776
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 11, 4']
Memory occupied: [3524.0, 1898.0] Time: 49.606168031692505
Finish gpu thread time: 1.1658563613891602
The whole process took 58.425307512283325 seconds
