Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=20, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.161430835723877
Time to prepare transforms: 0.00024819374084472656
Time to download labels: 0.06676054000854492
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7263849456668 Mbps
Get bandwitdh took 1.2400803565979004
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119108584.72759844 119108584.72759844
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 20 20
Intermediate:  0.19140625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 4584.875 4780.10107421875 11092.6875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.929721832275391
Using split index: 20
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015413761138916016
Time for model prep: 0.0046062469482421875
Time for model and splitting algorithm: 4.935892105102539
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.3387453556060791
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6729183197021484
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 3.010254144668579
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 4.3496949672698975
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 5.7049713134765625
Length of received data: 200751121
Future took 5.902903318405151 seconds
Pickle took 0.10488438606262207 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 6.007943391799927 seconds
Dataloader took 0.07064175605773926 seconds
Streaming imagenet data took 6.07862401008606 seconds
First stream takes: 6.08932900428772 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.057303667068481445
Time for copying to cuda: 0.042829275131225586
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1510.0, 466.0] Time: 7.096650838851929
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1510.0, 1006.0] Time: 8.5133798122406
Time for forward pass: 3.3168692588806152
Time for backpropagation: 0.11174988746643066
GPU memory for training: 0.8954982757568359                          

One training iteration takes: 3.537167549133301 seconds
Index: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 12, 5']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 8, 5']
Memory occupied: [1856.0, 1734.0] Time: 9.948944807052612
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1856.0, 1734.0] Time: 11.372464895248413
Length of received data: 200751121
Future took 6.033360958099365 seconds
Pickle took 0.10219717025756836 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 6.135706663131714 seconds
Dataloader took 0.07192277908325195 seconds
Streaming imagenet data took 6.207676887512207 seconds
Then, training+dataloading take 6.217200756072998 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0569000244140625
Time for copying to cuda: 0.07795119285583496
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 0.12878704071044922
Time for backpropagation: 0.012021541595458984
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.2812793254852295 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 8, 5']
Memory occupied: [1968.0, 1750.0] Time: 12.844510078430176
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 14.264623165130615
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 15.684015989303589
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 17.137718439102173
Length of received data: 200751121
Future took 5.939729452133179 seconds
Pickle took 0.10187005996704102 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 6.041757106781006 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.15934276580810547 seconds
Streaming imagenet data took 6.201175689697266 seconds
Then, training+dataloading take 6.2080419063568115 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06435346603393555
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.08050012588500977
Time for forward pass: 0.029622316360473633
Time for backpropagation: 0.011275053024291992
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.1924433708190918 seconds
Index: 2
Memory occupied: [1968.0, 1750.0] Time: 18.727203130722046
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 20.159278631210327
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 21.589590549468994
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 23.021385192871094
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 24.46881914138794
Length of received data: 200751121
Future took 6.07513952255249 seconds
Pickle took 0.09945821762084961 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 6.174728870391846 seconds
Dataloader took 0.07208061218261719 seconds
Streaming imagenet data took 6.246867656707764 seconds
Then, training+dataloading take 6.260497331619263 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05713319778442383
Time for copying to cuda: 0.04258298873901367
Time for forward pass: 0.026762962341308594
Time for backpropagation: 0.010306596755981445
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.1456739902496338 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 25.894628763198853
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 27.317846536636353
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 28.74225950241089
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 30.183062314987183
Length of received data: 200751121
Future took 5.8692946434021 seconds
Pickle took 0.09758114814758301 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.9670164585113525 seconds
Dataloader took 0.07057547569274902 seconds
Streaming imagenet data took 6.037639379501343 seconds
Then, training+dataloading take 6.048497676849365 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.056998491287231445
Time for copying to cuda: 0.042508840560913086
Time for forward pass: 0.026961088180541992
Time for backpropagation: 0.010460853576660156
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.1456458568572998 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 31.61294198036194
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 33.046226501464844
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 34.47649264335632
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 35.913164377212524
Length of received data: 200751121
Future took 6.008518218994141 seconds
Pickle took 0.09814262390136719 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 6.106844663619995 seconds
Dataloader took 0.11678671836853027 seconds
Streaming imagenet data took 6.223678112030029 seconds
Then, training+dataloading take 6.235361337661743 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09956955909729004
Time for copying to cuda: 0.08238577842712402
Time for forward pass: 0.03042745590209961
Time for backpropagation: 0.011719942092895508
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.23344993591308594 seconds
Index: 5
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 37.41213059425354
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 38.84404492378235
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 40.27572202682495
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 41.72390961647034
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 200751121
Future took 6.059956312179565 seconds
Pickle took 0.11431050300598145 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 6.174579381942749 seconds
Memory occupied: [1968.0, 1750.0] Time: 43.234397172927856
Dataloader took 0.07148003578186035 seconds
Streaming imagenet data took 6.246114492416382 seconds
Then, training+dataloading take 6.257906675338745 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05742311477661133
Time for copying to cuda: 0.04231595993041992
Time for forward pass: 0.026545047760009766
Time for backpropagation: 0.010328292846679688
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.14572620391845703 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 44.65852975845337
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 46.08653497695923
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 47.516300201416016
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 48.97819447517395
Length of received data: 200751121
Future took 5.888347387313843 seconds
Pickle took 0.09767866134643555 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.986166477203369 seconds
Dataloader took 0.07204675674438477 seconds
Streaming imagenet data took 6.058258295059204 seconds
Then, training+dataloading take 6.069766044616699 seconds

Epoch: 0
Time of next(dataloader) is: 0.05768465995788574
Time for copying to cuda: 0.04257035255432129
Time for forward pass: 0.026695966720581055
Time for backpropagation: 0.010362863540649414
GPU memory for training: 0.9105677604675293                          

Last train takes: 0.146043062210083 seconds
Total time for streaming and training: 49.532856702804565
Finish gpu thread time: 0.44634389877319336
The whole process took 56.14392352104187 seconds
