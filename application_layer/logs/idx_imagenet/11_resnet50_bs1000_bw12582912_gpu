Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=11, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9804.553548291791 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1285102442.6817017 1285102442.6817017
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 11 21
Intermediate:  1.53125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 3933.482421875 4138.39794921875 9101.451171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.210456609725952 seconds
Memory occpied: (1410.0, 3.0)
Streaming imagenet data took 8.878674030303955 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1410.0, 3.0)
Time of next(dataloader) is: 1.1444549560546875
Time for copying to cuda: 0.3922414779663086
Memory occpied: (2942.0, 942.0)
Memory occpied: (2942.0, 1410.0)
Memory occpied: (2942.0, 1820.0)
Memory occpied: (6526.0, 4236.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.228766679763794 seconds
Memory occpied: (8804.0, 8394.0)
Streaming imagenet data took 8.932778358459473 seconds
Memory occpied: (9738.0, 10288.0)
Time for forward pass: 9.224347591400146
Time for backpropagation: 0.11260485649108887
GPU memory for training: 11.809072017669678                          

One training iteration takes: 10.988812923431396 seconds
Index: 0
Then, training+dataloading take 10.989530563354492 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (10726.0, 2540.0)
Time of next(dataloader) is: 1.2755720615386963
Memory occpied: (10726.0, 2540.0)
Time for copying to cuda: 0.4383049011230469
Time for forward pass: 0.7389082908630371
Time for backpropagation: 0.006545543670654297
GPU memory for training: 4.697751522064209                          

One training iteration takes: 2.7353405952453613 seconds
Index: 1
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.36182975769043 seconds
Memory occpied: (10734.0, 3764.0)
Streaming imagenet data took 9.075566530227661 seconds
Then, training+dataloading take 9.15851378440857 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (10734.0, 3764.0)
Time of next(dataloader) is: 1.2731549739837646
Time for copying to cuda: 0.38437414169311523
Memory occpied: (10734.0, 3764.0)
Time for forward pass: 0.7242143154144287
Time for backpropagation: 0.0066530704498291016
GPU memory for training: 4.697751522064209                          

One training iteration takes: 2.638899564743042 seconds
Index: 2
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.11972427368164 seconds
Memory occpied: (10734.0, 3764.0)
Streaming imagenet data took 8.73700213432312 seconds
Then, training+dataloading take 8.810359954833984 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (10734.0, 3764.0)
Time of next(dataloader) is: 1.2316374778747559
Time for copying to cuda: 0.38543081283569336
Memory occpied: (10734.0, 3764.0)
Time for forward pass: 0.7429299354553223
Time for backpropagation: 0.0066373348236083984
GPU memory for training: 4.697751522064209                          

One training iteration takes: 2.601681709289551 seconds
Index: 3
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.270114660263062 seconds
Memory occpied: (10734.0, 3764.0)
Streaming imagenet data took 8.892248153686523 seconds
Then, training+dataloading take 8.939449548721313 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (10734.0, 3764.0)
Time of next(dataloader) is: 1.2829828262329102
Time for copying to cuda: 0.3874640464782715
Memory occpied: (10734.0, 3764.0)
Time for forward pass: 0.7373406887054443
Time for backpropagation: 0.006703376770019531
GPU memory for training: 4.697751522064209                          

One training iteration takes: 2.660379409790039 seconds
Index: 4
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.216577291488647 seconds
Memory occpied: (10734.0, 3764.0)
Streaming imagenet data took 8.845727443695068 seconds
Then, training+dataloading take 8.892839431762695 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (10734.0, 3764.0)
Time of next(dataloader) is: 1.298642635345459
Time for copying to cuda: 0.38608574867248535
Memory occpied: (10734.0, 3764.0)
Time for forward pass: 0.7398889064788818
Time for backpropagation: 0.006744861602783203
GPU memory for training: 4.697751522064209                          

One training iteration takes: 2.6667771339416504 seconds
Index: 5
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.189220428466797 seconds
Memory occpied: (10734.0, 3764.0)
Streaming imagenet data took 8.80669903755188 seconds
Then, training+dataloading take 8.853707790374756 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (10734.0, 3764.0)
Time of next(dataloader) is: 1.2809250354766846
Time for copying to cuda: 0.38948750495910645
Memory occpied: (10734.0, 3764.0)
Time for forward pass: 0.7422082424163818
Time for backpropagation: 0.006754875183105469
GPU memory for training: 4.697751522064209                          

One training iteration takes: 2.67564058303833 seconds
Index: 6
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Memory occpied: (10734.0, 3764.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 8.207327842712402 seconds
Memory occpied: (10734.0, 3764.0)
Streaming imagenet data took 8.826570510864258 seconds
Then, training+dataloading take 8.873882532119751 seconds

Epoch: 0
Memory occpied: (10734.0, 3764.0)
Time of next(dataloader) is: 1.2945263385772705
Time for copying to cuda: 0.388336181640625
Memory occpied: (10734.0, 3764.0)
Time for forward pass: 0.7238764762878418
Time for backpropagation: 0.006741762161254883
GPU memory for training: 4.697751522064209                          

The whole process took 82.85191345214844 seconds
