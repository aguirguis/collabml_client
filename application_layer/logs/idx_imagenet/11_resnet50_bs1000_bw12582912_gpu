Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=11, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.2393314838409424
Time to prepare transforms: 0.0002415180206298828
Time to download labels: 0.06372952461242676
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10115.249906631578 Mbps
Get bandwitdh took 1.2383522987365723
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1325826035.7620142 1325826035.7620142
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 11 21
Intermediate:  1.53125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 3933.482421875 4138.39794921875 9101.451171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Time for splitting algorithm: 5.169173955917358
Using split index: 11
Freezing the lower layers of the model (myresnet50) till index 21
Time to freeze model: 0.0007185935974121094
Time for model prep: 0.002294301986694336
Time for model and splitting algorithm: 5.172206163406372
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 0.3233633041381836
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 1.6503875255584717
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 2.979384422302246
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 4.326399564743042
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 5.74836802482605
Length of received data: 1605679121
Future took 6.883730173110962 seconds
Pickle took 0.8299338817596436 seconds
Read 1531.2949380874634 MBs for this batch
Executing all posts took 7.713858604431152 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 8.263325214385986
Dataloader took 0.7803490161895752 seconds
Streaming imagenet data took 8.49424433708191 seconds
First stream takes: 8.58136534690857 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.17871975898742676
Time for copying to cuda: 0.33724093437194824
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 12, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2942.0, 1010.0] Time: 9.75180959701538
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2942.0, 1566.0] Time: 11.261975526809692
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2942.0, 5730.0] Time: 12.801158666610718
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 79, 50']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 95, 47']
Memory occupied: [6524.0, 5730.0] Time: 15.20488715171814
Length of received data: 1605679121
Future took 6.8270227909088135 seconds
Pickle took 0.8226189613342285 seconds
Read 1531.2949380874634 MBs for this batch
Executing all posts took 7.649824142456055 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 1, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 67, 21']
Memory occupied: [9396.0, 8944.0] Time: 16.97977590560913
Dataloader took 0.871741771697998 seconds
Streaming imagenet data took 8.521617889404297 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 1']
Time for forward pass: 9.10835313796997
Time for backpropagation: 0.16429972648620605
GPU memory for training: 11.809072017669678                          

One training iteration takes: 9.810711860656738 seconds
Index: 0
Then, training+dataloading take 9.811249017715454 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 5, 1']
Time of next(dataloader) is: 0.2819788455963135
Memory occupied: [3054.0, 9928.0] Time: 18.678388833999634
Time for copying to cuda: 0.3344588279724121
Time for forward pass: 0.6605381965637207
Time for backpropagation: 0.006235599517822266
GPU memory for training: 4.697751522064209                          

One training iteration takes: 1.3377711772918701 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 80, 61']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 20.162646055221558
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 21.59745979309082
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 23.034647703170776
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 1605679121
Future took 7.005998611450195 seconds
Pickle took 0.8308823108673096 seconds
Read 1531.2949380874634 MBs for this batch
Executing all posts took 7.837163209915161 seconds
Memory occupied: [4762.0, 9936.0] Time: 26.230528593063354
Dataloader took 0.569929838180542 seconds
Streaming imagenet data took 8.407146692276001 seconds
Then, training+dataloading take 8.455143451690674 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.17620587348937988
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 29, 2']
Time for copying to cuda: 0.4489316940307617
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 4']
Memory occupied: [4762.0, 9936.0] Time: 27.880573987960815
Time for forward pass: 0.7296867370605469
Time for backpropagation: 0.0062541961669921875
GPU memory for training: 4.697751522064209                          

One training iteration takes: 1.4067950248718262 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 29.418869733810425
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 30.95889115333557
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 33.07082271575928
Length of received data: 1605679121
Future took 6.8077521324157715 seconds
Pickle took 0.6619157791137695 seconds
Read 1531.2949380874634 MBs for this batch
Executing all posts took 7.469866991043091 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 34.960413455963135
Dataloader took 0.8113815784454346 seconds
Streaming imagenet data took 8.28129529953003 seconds
Then, training+dataloading take 8.328444480895996 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.17080235481262207
Time for copying to cuda: 0.3339102268218994
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 79']
Time for forward pass: 0.7300069332122803
Time for backpropagation: 0.006917715072631836
GPU memory for training: 4.697751522064209                          

One training iteration takes: 1.2872226238250732 seconds
Index: 3
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 73']
Memory occupied: [4762.0, 9936.0] Time: 36.5990891456604
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 38.14063239097595
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 39.68725562095642
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 41.40018892288208
Length of received data: 1605679121
Future took 7.0363240242004395 seconds
Pickle took 0.6637473106384277 seconds
Read 1531.2949380874634 MBs for this batch
Executing all posts took 7.700260400772095 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 43.52450442314148
Dataloader took 0.8216409683227539 seconds
Streaming imagenet data took 8.521946430206299 seconds
Then, training+dataloading take 8.5692617893219 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.17044448852539062
Time for copying to cuda: 0.3345339298248291
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 85']
Time for forward pass: 0.7224087715148926
Time for backpropagation: 0.006959199905395508
GPU memory for training: 4.697751522064209                          

One training iteration takes: 1.2801170349121094 seconds
Index: 4
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 75']
Memory occupied: [4762.0, 9936.0] Time: 45.16239261627197
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 46.70503091812134
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 48.270411252975464
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 1605679121
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Future took 6.8417747020721436 seconds
Pickle took 0.7808389663696289 seconds
Read 1531.2949380874634 MBs for this batch
Executing all posts took 7.622816324234009 seconds
Memory occupied: [4762.0, 9936.0] Time: 51.531469106674194
Dataloader took 0.624971866607666 seconds
Streaming imagenet data took 8.247829914093018 seconds
Then, training+dataloading take 8.295647621154785 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.21860480308532715
Time for copying to cuda: 0.3955531120300293
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 34, 2']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 69, 40']
Memory occupied: [4762.0, 9936.0] Time: 53.17937660217285
Time for forward pass: 0.7162439823150635
Time for backpropagation: 0.00632476806640625
GPU memory for training: 4.697751522064209                          

One training iteration takes: 1.3826963901519775 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 54.723899126052856
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 56.266292095184326
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 58.257028579711914
Length of received data: 1605679121
Future took 6.833858013153076 seconds
Pickle took 0.6632020473480225 seconds
Read 1531.2949380874634 MBs for this batch
Executing all posts took 7.497212886810303 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 60.18652153015137
Dataloader took 0.8218686580657959 seconds
Streaming imagenet data took 8.319124937057495 seconds
Then, training+dataloading take 8.36685848236084 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.17146015167236328
Time for copying to cuda: 0.33483242988586426
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 81']
Time for forward pass: 0.721376895904541
Time for backpropagation: 0.006813764572143555
GPU memory for training: 4.697751522064209                          

One training iteration takes: 1.280468463897705 seconds
Index: 6
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 73']
Memory occupied: [4762.0, 9936.0] Time: 61.82735896110535
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 63.37154006958008
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4762.0, 9936.0] Time: 64.91610550880432
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 1605679121
Future took 7.00467848777771 seconds
Pickle took 0.6749074459075928 seconds
Read 1531.2949380874634 MBs for this batch
Executing all posts took 7.679854869842529 seconds
Memory occupied: [4762.0, 9936.0] Time: 68.08856868743896
Dataloader took 0.5610077381134033 seconds
Streaming imagenet data took 8.240912675857544 seconds
Then, training+dataloading take 8.287272214889526 seconds

Epoch: 0
Time of next(dataloader) is: 0.17670488357543945
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 28, 2']
Time for copying to cuda: 0.45750856399536133
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 72, 42']
Memory occupied: [4762.0, 9936.0] Time: 69.72250318527222
Time for forward pass: 0.7126672267913818
Time for backpropagation: 0.006388425827026367
GPU memory for training: 4.697751522064209                          

Last train takes: 1.3992657661437988 seconds
Total time for streaming and training: 70.09474492073059
Finish gpu thread time: 0.6287767887115479
The whole process took 77.19942617416382 seconds
