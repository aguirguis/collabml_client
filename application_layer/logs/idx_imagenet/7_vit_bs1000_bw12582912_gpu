Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1642143726348877
Time to prepare transforms: 0.0002455711364746094
Time to download labels: 0.06228065490722656
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10036.570674456734 Mbps
Get bandwitdh took 1.2249500751495361
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03
 3.07200e+03 3.07200e+03 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1315513391.442393 1315513391.442393
All candidates indexes:  (array([17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 17
Intermediate:  8.6572265625
17.314453125
Total layers size  104.47354125976562
Server, client, server+client, vanilla  616.4482421875 26327.11669921875 26943.56494140625 35558.56201171875
Fixed, scale_with_bsz  0 17.888671875
Mem usage  1654.0 3.0
Time for splitting algorithm: 5.982644557952881
Using split index: 7
Freezing the lower layers of the model (myvit) till index 17
Time to freeze model: 0.0009069442749023438
Time for model prep: 0.0022776126861572266
Time for model and splitting algorithm: 5.985849857330322
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 0.3288447856903076
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 1.648149013519287
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 2.9735023975372314
Length of received data: 605229121
Future took 4.248506307601929 seconds
Pickle took 0.31794095039367676 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.566646575927734 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.37262988090515137 seconds
Streaming imagenet data took 4.939334392547607 seconds
First stream takes: 4.951606035232544 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occupied: [1654.0, 3.0] Time: 5.0143983364105225
Time of next(dataloader) is: 0.08833646774291992
Time for copying to cuda: 0.12819957733154297
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 5, 0']
Memory occupied: [2232.0, 800.0] Time: 6.449430227279663
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2232.0, 1334.0] Time: 7.918343782424927
Length of received data: 605229121
Future took 4.211477279663086 seconds
Pickle took 0.32196784019470215 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.585449457168579 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
Dataloader took 0.3179504871368408 seconds
Streaming imagenet data took 4.9036033153533936 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8390.0, 8012.0] Time: 10.004292249679565
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 49']
Memory occupied: [8390.0, 8012.0] Time: 11.473132133483887
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
Time for forward pass: 7.64683985710144
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 39']
Time for backpropagation: 0.10436773300170898
GPU memory for training: 8.35290813446045                          

One training iteration takes: 7.97821307182312 seconds
Index: 0
Then, training+dataloading take 7.979846477508545 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occupied: [8390.0, 8012.0] Time: 12.967496633529663
Time of next(dataloader) is: 0.08755040168762207
Time for copying to cuda: 0.12686419486999512
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 37']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 14.44229769706726
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 37']
Memory occupied: [8398.0, 8020.0] Time: 15.915773153305054
Length of received data: 605229121
Future took 4.303722620010376 seconds
Pickle took 0.3238339424133301 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.627799987792969 seconds
Time for forward pass: 4.413171052932739
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 29']
Time for backpropagation: 0.06461000442504883
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.703284502029419 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 22, 7']
Dataloader took 0.379863977432251 seconds
Streaming imagenet data took 5.007741689682007 seconds
Then, training+dataloading take 5.029335260391235 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [8398.0, 8020.0] Time: 17.96960163116455
Time of next(dataloader) is: 0.08477640151977539
Time for copying to cuda: 0.12688922882080078
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 19.491828203201294
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 20.99678921699524
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 40']
Length of received data: 605229121
Future took 4.398611545562744 seconds
Pickle took 0.24751830101013184 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.646522045135498 seconds
Time for forward pass: 4.489121913909912
Time for backpropagation: 0.010163068771362305
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.7215471267700195 seconds
Index: 2
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 88, 34']
Memory occupied: [8398.0, 8020.0] Time: 22.887076139450073
Dataloader took 0.33158326148986816 seconds
Streaming imagenet data took 4.978153228759766 seconds
Then, training+dataloading take 5.01222562789917 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08066201210021973
Time for copying to cuda: 0.12689948081970215
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 30']
Memory occupied: [8398.0, 8020.0] Time: 24.36472988128662
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 25.842575311660767
Length of received data: 605229121
Future took 4.233453989028931 seconds
Pickle took 0.309598445892334 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.597312688827515 seconds
Time for forward pass: 4.438803434371948
Time for backpropagation: 0.009122133255004883
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.665604591369629 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
Dataloader took 0.328505277633667 seconds
Streaming imagenet data took 4.9259984493255615 seconds
Then, training+dataloading take 4.947553873062134 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 17, 3']
Memory occupied: [8398.0, 8020.0] Time: 28.045085906982422
Time of next(dataloader) is: 0.14048242568969727
Time for copying to cuda: 0.12705469131469727
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 29.576899528503418
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 38']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8398.0, 8020.0] Time: 31.08925771713257
Length of received data: 605229121
Future took 4.2200281620025635 seconds
Pickle took 0.2966954708099365 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.517005205154419 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
Time for forward pass: 4.455040454864502
Time for backpropagation: 0.009409189224243164
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.742877960205078 seconds
Index: 4
Dataloader took 0.3898580074310303 seconds
Streaming imagenet data took 4.906938791275024 seconds
Then, training+dataloading take 4.94293212890625 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 98, 39']
Memory occupied: [8398.0, 8020.0] Time: 32.97751808166504
Time of next(dataloader) is: 0.13873600959777832
Time for copying to cuda: 0.1271800994873047
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 34.4595263004303
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 40']
Memory occupied: [8398.0, 8020.0] Time: 35.94775104522705
Length of received data: 605229121
Future took 4.282819747924805 seconds
Pickle took 0.30867981910705566 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.645729064941406 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
Time for forward pass: 4.520347595214844
Time for backpropagation: 0.015618324279785156
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.812817811965942 seconds
Index: 5
Dataloader took 0.33709096908569336 seconds
Streaming imagenet data took 4.982989072799683 seconds
Then, training+dataloading take 5.018366813659668 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 55, 22']
Memory occupied: [8398.0, 8020.0] Time: 37.995858907699585
Time of next(dataloader) is: 0.13841605186462402
Time for copying to cuda: 0.12682271003723145
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 39.47956895828247
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 40.96219515800476
Length of received data: 605229121
Future took 4.2376389503479 seconds
Pickle took 0.3139042854309082 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 4.551723003387451 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
Time for forward pass: 4.506739616394043
Time for backpropagation: 0.009365320205688477
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.792195081710815 seconds
Index: 6
Dataloader took 0.38698840141296387 seconds
Streaming imagenet data took 4.93877911567688 seconds
Then, training+dataloading take 4.960383653640747 seconds

Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 53, 24']
Memory occupied: [8398.0, 8020.0] Time: 42.97581934928894
Time of next(dataloader) is: 0.13675999641418457
Time for copying to cuda: 0.12665128707885742
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 31']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 43']
Memory occupied: [8398.0, 8020.0] Time: 44.50433349609375
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 39']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 46.017711877822876
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 31']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 26']
Memory occupied: [8398.0, 8020.0] Time: 47.5290105342865
Time for forward pass: 4.504361152648926
Time for backpropagation: 0.007767200469970703
GPU memory for training: 8.37738037109375                          

Last train takes: 4.796208143234253 seconds
Total time for streaming and training: 47.63869595527649
Finish gpu thread time: 0.891364336013794
The whole process took 55.743125200271606 seconds
