Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=20, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1619749069213867
Time to prepare transforms: 0.00023794174194335938
Time to download labels: 0.04729461669921875
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9996.093369745644 Mbps
Get bandwitdh took 1.2357971668243408
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1310207950.159301 1310207950.159301
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 20 20
Intermediate:  0.19140625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 4584.875 4780.10107421875 11092.6875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.922210931777954
Using split index: 20
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.001575469970703125
Time for model prep: 0.004583597183227539
Time for model and splitting algorithm: 4.928397178649902
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.33209657669067383
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6652274131774902
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 2.995076894760132
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 4.333157300949097
Length of received data: 200751121
Future took 4.5154218673706055 seconds
Pickle took 0.10404396057128906 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.619622707366943 seconds
Dataloader took 0.07081317901611328 seconds
Streaming imagenet data took 4.690473794937134 seconds
First stream takes: 4.70050573348999 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05687999725341797
Time for copying to cuda: 0.042542219161987305
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1510.0, 494.0] Time: 5.714338064193726
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1510.0, 972.0] Time: 7.126549005508423
Time for forward pass: 3.2608141899108887
Time for backpropagation: 0.10733890533447266
GPU memory for training: 0.8954982757568359                          

One training iteration takes: 3.472609758377075 seconds
Index: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 14, 5']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1856.0, 1734.0] Time: 8.542639970779419
Length of received data: 200751121
Future took 4.387449026107788 seconds
Pickle took 0.10176944732666016 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.489361524581909 seconds
Dataloader took 0.0721437931060791 seconds
Streaming imagenet data took 4.561551809310913 seconds
Then, training+dataloading take 4.570476531982422 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05632662773132324
Time for copying to cuda: 0.042368173599243164
Time for forward pass: 0.07688212394714355
Time for backpropagation: 0.01089024543762207
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.19489645957946777 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 12, 5']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 9.958009958267212
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 11.379308700561523
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 12.798439979553223
Length of received data: 200751121
Future took 4.386267900466919 seconds
Pickle took 0.10412263870239258 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.490535020828247 seconds
Dataloader took 0.12874555587768555 seconds
Streaming imagenet data took 4.6193459033966064 seconds
Then, training+dataloading take 4.6258299350738525 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.10046100616455078
Time for copying to cuda: 0.04222702980041504
Time for forward pass: 0.07105517387390137
Time for backpropagation: 0.011348247528076172
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.23116087913513184 seconds
Index: 2
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 8, 5']
Memory occupied: [1968.0, 1750.0] Time: 14.28326416015625
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 15.715460300445557
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 17.137532472610474
Length of received data: 200751121
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Future took 4.425983190536499 seconds
Pickle took 0.10300040245056152 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.529162645339966 seconds
Dataloader took 0.1593332290649414 seconds
Streaming imagenet data took 4.688593864440918 seconds
Then, training+dataloading take 4.697042942047119 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05704164505004883
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.08015847206115723
Time for forward pass: 0.02976512908935547
Time for backpropagation: 0.011106252670288086
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.18742609024047852 seconds
Index: 3
Memory occupied: [1968.0, 1750.0] Time: 18.78995704650879
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 20.211284160614014
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 21.63602375984192
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 200751121
Future took 4.474204778671265 seconds
Pickle took 0.09843134880065918 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.572782278060913 seconds
Memory occupied: [1968.0, 1750.0] Time: 23.281375408172607
Dataloader took 0.11505484580993652 seconds
Streaming imagenet data took 4.687885046005249 seconds
Then, training+dataloading take 4.699185609817505 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05657482147216797
Time for copying to cuda: 0.042006492614746094
Time for forward pass: 0.026611804962158203
Time for backpropagation: 0.01012730598449707
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.1437366008758545 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 24.702889680862427
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 26.124836444854736
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 27.60146975517273
Length of received data: 200751121
Future took 4.410142421722412 seconds
Pickle took 0.09904217720031738 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.509327173233032 seconds
Dataloader took 0.07180356979370117 seconds
Streaming imagenet data took 4.581175327301025 seconds
Then, training+dataloading take 4.591413736343384 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.056551456451416016
Time for copying to cuda: 0.042249441146850586
Time for forward pass: 0.02665400505065918
Time for backpropagation: 0.010005474090576172
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.14380764961242676 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 29.025261878967285
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 30.453705310821533
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 31.881946802139282
Length of received data: 200751121
Future took 4.3861212730407715 seconds
Pickle took 0.09818601608276367 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.484451532363892 seconds
Dataloader took 0.07206583023071289 seconds
Streaming imagenet data took 4.556563377380371 seconds
Then, training+dataloading take 4.566957712173462 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05639314651489258
Time for copying to cuda: 0.0420384407043457
Time for forward pass: 0.026714086532592773
Time for backpropagation: 0.01001596450805664
GPU memory for training: 0.9105677604675293                          

One training iteration takes: 0.14340782165527344 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 33.30798316001892
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 34.73609900474548
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 36.16239094734192
Length of received data: 200751121
Future took 4.405353546142578 seconds
Pickle took 0.09859514236450195 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 4.504086971282959 seconds
Dataloader took 0.0720372200012207 seconds
Streaming imagenet data took 4.576170206069946 seconds
Then, training+dataloading take 4.5864551067352295 seconds

Epoch: 0
Time of next(dataloader) is: 0.061096906661987305
Time for copying to cuda: 0.042278289794921875
Time for forward pass: 0.06856656074523926
Time for backpropagation: 0.011559247970581055
GPU memory for training: 0.9105677604675293                          

Last train takes: 0.18804550170898438 seconds
Total time for streaming and training: 37.22615957260132
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1968.0, 1750.0] Time: 37.59879231452942
Finish gpu thread time: 1.373703956604004
The whole process took 44.73816680908203 seconds
