Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=3, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10062.471503844703 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1318908264.951933 1318908264.951933
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 3 25
Intermediate:  3.0625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 15921.08837890625 16829.48486328125 37932.80712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 3
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 14.227070569992065 seconds
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 15.408344984054565 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.067847728729248
Time for copying to cuda: 0.7794816493988037
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.933526277542114 seconds
Streaming imagenet data took 15.08158802986145 seconds
Time for forward pass: 16.742450952529907
Time for backpropagation: 0.04924774169921875
GPU memory for training: 22.67772674560547                          

Memory occpied: (1840.0, 3.0)
One training iteration takes: 20.027336359024048 seconds
Index: 0
Then, training+dataloading take 20.033966302871704 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (6396.0, 14506.0)
Time of next(dataloader) is: 2.1281867027282715
Memory occpied: (6396.0, 14506.0)
Time for copying to cuda: 0.7786102294921875
Memory occpied: (13390.0, 14506.0)
Time for forward pass: 1.264646291732788
Time for backpropagation: 0.003333568572998047
GPU memory for training: 20.857208251953125                          

One training iteration takes: 4.584828853607178 seconds
Index: 1
Memory occpied: (11148.0, 14514.0)
Memory occpied: (11148.0, 14514.0)
Memory occpied: (11148.0, 14514.0)
Memory occpied: (11148.0, 14514.0)
Memory occpied: (11148.0, 14514.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 14.196370840072632 seconds
Memory occpied: (11148.0, 14514.0)
Streaming imagenet data took 15.40464162826538 seconds
Then, training+dataloading take 15.543030977249146 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2249317169189453
Time for copying to cuda: 0.7709071636199951
Time for forward pass: 1.2147319316864014
Time for backpropagation: 0.0031282901763916016
GPU memory for training: 20.857208251953125                          

Memory occpied: (11148.0, 14514.0)
One training iteration takes: 4.692344427108765 seconds
Index: 2
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Length of received data: 3211310121
Memory occpied: (13546.0, 14514.0)
Read 3062.543984413147 MBs for this batch
Executing all posts took 14.527074098587036 seconds
Streaming imagenet data took 15.73107099533081 seconds
Then, training+dataloading take 15.926904678344727 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Time of next(dataloader) is: 2.238441228866577
Memory occpied: (13546.0, 14514.0)
Time for copying to cuda: 0.8695263862609863
Memory occpied: (13546.0, 14514.0)
Time for forward pass: 1.168705701828003
Time for backpropagation: 0.0032324790954589844
GPU memory for training: 20.856231689453125                          

One training iteration takes: 4.682833433151245 seconds
Index: 3
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 14.07776403427124 seconds
Memory occpied: (13546.0, 14514.0)
Streaming imagenet data took 15.28327488899231 seconds
Then, training+dataloading take 15.426074504852295 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.278653621673584
Time for copying to cuda: 0.7669782638549805
Time for forward pass: 1.2089521884918213
Time for backpropagation: 0.0031659603118896484
GPU memory for training: 20.856231689453125                          

Memory occpied: (13546.0, 14514.0)
One training iteration takes: 4.6672022342681885 seconds
Index: 4
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 14.487545728683472 seconds
Memory occpied: (13546.0, 14514.0)
Streaming imagenet data took 15.688894510269165 seconds
Then, training+dataloading take 15.834609270095825 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2282443046569824
Time for copying to cuda: 0.7659480571746826
Time for forward pass: 1.2113330364227295
Time for backpropagation: 0.0031592845916748047
GPU memory for training: 20.856231689453125                          

Memory occpied: (13546.0, 14514.0)
One training iteration takes: 4.66991400718689 seconds
Index: 5
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 14.095736503601074 seconds
Memory occpied: (13546.0, 14514.0)
Streaming imagenet data took 15.37624454498291 seconds
Then, training+dataloading take 15.515714645385742 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.241320848464966
Time for copying to cuda: 0.7713422775268555
Time for forward pass: 1.2075285911560059
Time for backpropagation: 0.0031795501708984375
GPU memory for training: 20.856231689453125                          

One training iteration takes: 4.692378282546997 seconds
Index: 6
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Memory occpied: (13546.0, 14514.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 14.02874755859375 seconds
Memory occpied: (13546.0, 14514.0)
Streaming imagenet data took 15.23891568183899 seconds
Then, training+dataloading take 15.387547254562378 seconds

Epoch: 0
Time of next(dataloader) is: 2.285832643508911
Time for copying to cuda: 0.7679860591888428
Time for forward pass: 1.1792635917663574
Time for backpropagation: 0.0031523704528808594
GPU memory for training: 20.856231689453125                          

Memory occpied: (13546.0, 14514.0)
The whole process took 142.3649799823761 seconds
