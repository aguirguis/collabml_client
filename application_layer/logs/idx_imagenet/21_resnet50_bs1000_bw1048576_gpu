Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=21, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.8085030123268 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 118988276.1068317 118988276.1068317
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 21 21
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 113.169921875 318.08544921875 6804.576171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Length of received data: 8231237
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.932629108428955 seconds
Streaming imagenet data took 3.936429023742676 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2898447513580322
Time for copying to cuda: 0.0023767948150634766
Memory occpied: (1410.0, 308.0)
Memory occpied: (1410.0, 770.0)
Memory occpied: (1410.0, 1206.0)
Time for forward pass: 3.1835684776306152
Time for backpropagation: 0.06438374519348145
GPU memory for training: 0.4265751838684082                          

One training iteration takes: 3.603769540786743 seconds
Index: 0
Length of received data: 8231237
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.831676483154297 seconds
Streaming imagenet data took 3.8360307216644287 seconds
Then, training+dataloading take 3.8365278244018555 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3321366310119629
Time for copying to cuda: 0.0024356842041015625
Time for forward pass: 0.014168024063110352
Time for backpropagation: 0.007291555404663086
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.42705869674682617 seconds
Index: 1
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Length of received data: 8231237
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.8201677799224854 seconds
Streaming imagenet data took 3.824363946914673 seconds
Then, training+dataloading take 3.8248822689056396 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37709760665893555
Time for copying to cuda: 0.0023844242095947266
Time for forward pass: 0.013740301132202148
Time for backpropagation: 0.006845235824584961
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.5047969818115234 seconds
Index: 2
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Length of received data: 8231237
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.8445932865142822 seconds
Streaming imagenet data took 3.8485465049743652 seconds
Then, training+dataloading take 3.8490939140319824 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40770864486694336
Time for copying to cuda: 0.0024471282958984375
Time for forward pass: 0.013784408569335938
Time for backpropagation: 0.006490230560302734
GPU memory for training: 0.4421114921569824                          

Memory occpied: (1660.0, 1416.0)
One training iteration takes: 0.5284748077392578 seconds
Index: 3
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Length of received data: 8231237
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.8184828758239746 seconds
Streaming imagenet data took 3.8215744495391846 seconds
Then, training+dataloading take 3.8221044540405273 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3857550621032715
Time for copying to cuda: 0.0023834705352783203
Time for forward pass: 0.013747453689575195
Time for backpropagation: 0.006315708160400391
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.532395601272583 seconds
Index: 4
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Length of received data: 8231237
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.8405253887176514 seconds
Streaming imagenet data took 3.844568967819214 seconds
Then, training+dataloading take 3.8451032638549805 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.415555477142334
Time for copying to cuda: 0.0024023056030273438
Time for forward pass: 0.013786077499389648
Time for backpropagation: 0.006597757339477539
GPU memory for training: 0.4421114921569824                          

Memory occpied: (1660.0, 1416.0)
One training iteration takes: 0.5223612785339355 seconds
Index: 5
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Length of received data: 8231237
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.8142201900482178 seconds
Streaming imagenet data took 3.817301034927368 seconds
Then, training+dataloading take 3.817814826965332 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37523889541625977
Time for copying to cuda: 0.002379179000854492
Time for forward pass: 0.013699531555175781
Time for backpropagation: 0.006400346755981445
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.5057787895202637 seconds
Index: 6
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Memory occpied: (1660.0, 1416.0)
Length of received data: 8231237
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.8185479640960693 seconds
Streaming imagenet data took 3.822449207305908 seconds
Then, training+dataloading take 3.8230080604553223 seconds

Epoch: 0
Time of next(dataloader) is: 0.37307262420654297
Time for copying to cuda: 0.002344846725463867
Time for forward pass: 0.013521432876586914
Time for backpropagation: 0.006434202194213867
GPU memory for training: 0.4421114921569824                          

Memory occpied: (1660.0, 1416.0)
The whole process took 38.660484313964844 seconds
