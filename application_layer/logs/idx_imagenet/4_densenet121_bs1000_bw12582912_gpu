Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=4, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.162212610244751
Time to prepare transforms: 0.00024390220642089844
Time to download labels: 0.04758191108703613
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10080.174387143952 Mbps
Get bandwitdh took 1.2370038032531738
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1321228617.271732 1321228617.271732
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 4 20
Intermediate:  0.765625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 11284.09375 11479.31982421875 17217.6875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.930512189865112
Using split index: 4
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015799999237060547
Time for model prep: 0.004546642303466797
Time for model and splitting algorithm: 4.9366631507873535
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.33334803581237793
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6721522808074951
Length of received data: 802862121
Future took 3.1698689460754395 seconds
Pickle took 0.41889333724975586 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.5890660285949707 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 3.9302077293395996
Dataloader took 0.412365198135376 seconds
Streaming imagenet data took 4.00147271156311 seconds
First stream takes: 4.04658055305481 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10268211364746094
Time for copying to cuda: 0.16840863227844238
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2084.0, 822.0] Time: 5.36467981338501
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 5, 0']
Memory occupied: [2084.0, 1412.0] Time: 7.212631464004517
Length of received data: 802862121
Future took 3.2822201251983643 seconds
Pickle took 0.4210336208343506 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.7063965797424316 seconds
Dataloader took 0.29860973358154297 seconds
Streaming imagenet data took 4.005050420761108 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 99, 23']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 89, 54']
Memory occupied: [12578.0, 10490.0] Time: 8.725972175598145
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 79']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 58, 46']
Memory occupied: [14342.0, 15024.0] Time: 10.321057081222534
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 76, 63']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 83, 62']
Memory occupied: [9492.0, 6982.0] Time: 11.8233060836792
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 98, 59']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 77, 57']
Memory occupied: [3424.0, 2846.0] Time: 13.325896501541138
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 78, 58']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 64, 53']
Memory occupied: [6652.0, 4616.0] Time: 14.831050634384155
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 86, 53']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 82, 54']
Memory occupied: [2796.0, 3408.0] Time: 16.34058117866516
Time for forward pass: 12.343154907226562
Time for backpropagation: 0.07048368453979492
GPU memory for training: 18.321105003356934                          

One training iteration takes: 12.711573839187622 seconds
Index: 0
Then, training+dataloading take 12.713272094726562 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09706616401672363
Time for copying to cuda: 0.16729736328125
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 92, 97']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 82']
Memory occupied: [13948.0, 4762.0] Time: 17.84497857093811
Time for forward pass: 1.74680757522583
Time for backpropagation: 0.0237276554107666
GPU memory for training: 9.796103954315186                          

One training iteration takes: 2.061708450317383 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 40, 43']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5910.0, 4794.0] Time: 19.326852560043335
Length of received data: 802862121
Future took 3.422410726547241 seconds
Pickle took 0.41858506202697754 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.8411448001861572 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4983823299407959 seconds
Streaming imagenet data took 4.339602947235107 seconds
Then, training+dataloading take 4.361101150512695 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [5910.0, 4794.0] Time: 21.193814754486084
Time of next(dataloader) is: 0.10692214965820312
Time for copying to cuda: 0.16745424270629883
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 98']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 98']
Memory occupied: [9166.0, 8050.0] Time: 22.715433835983276
Time for forward pass: 1.5015232563018799
Time for backpropagation: 0.010700464248657227
GPU memory for training: 9.796897411346436                          

One training iteration takes: 1.8145883083343506 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [9166.0, 8050.0] Time: 24.48481035232544
Length of received data: 802862121
Future took 3.5594775676727295 seconds
Pickle took 0.4101676940917969 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.9697790145874023 seconds
Dataloader took 0.2823166847229004 seconds
Streaming imagenet data took 4.252165794372559 seconds
Then, training+dataloading take 4.298887014389038 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.15290522575378418
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.27672433853149414
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 2']
Memory occupied: [9166.0, 8050.0] Time: 26.0128231048584
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 98']
Time for forward pass: 1.4982924461364746
Time for backpropagation: 0.017386198043823242
GPU memory for training: 9.795432567596436                          

One training iteration takes: 1.959521770477295 seconds
Index: 3
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 88']
Memory occupied: [9166.0, 8050.0] Time: 27.524950742721558
Length of received data: 802862121
Future took 3.2027816772460938 seconds
Pickle took 0.4281003475189209 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.6312334537506104 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [9166.0, 8050.0] Time: 29.47230815887451
Dataloader took 0.44249582290649414 seconds
Streaming imagenet data took 4.073776006698608 seconds
Then, training+dataloading take 4.121311664581299 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10268187522888184
Time for copying to cuda: 0.1678018569946289
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 99']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 98']
Memory occupied: [9166.0, 8050.0] Time: 30.981343984603882
Time for forward pass: 1.5113797187805176
Time for backpropagation: 0.01061391830444336
GPU memory for training: 9.795432567596436                          

One training iteration takes: 1.819502353668213 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [9166.0, 8050.0] Time: 32.67505478858948
Length of received data: 802862121
Future took 3.3091981410980225 seconds
Pickle took 0.41036009788513184 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.719707489013672 seconds
Dataloader took 0.28109025955200195 seconds
Streaming imagenet data took 4.000854253768921 seconds
Then, training+dataloading take 4.047409772872925 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.148392915725708
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 14, 1']
Time for copying to cuda: 0.2610900402069092
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [9166.0, 8050.0] Time: 34.19735598564148
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 96']
Time for forward pass: 1.5040721893310547
Time for backpropagation: 0.012112855911254883
GPU memory for training: 9.795432567596436                          

One training iteration takes: 1.9389750957489014 seconds
Index: 5
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 75, 68']
Memory occupied: [9166.0, 8050.0] Time: 35.70725703239441
Length of received data: 802862121
Future took 3.229198932647705 seconds
Pickle took 0.4091160297393799 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.6385576725006104 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4967472553253174 seconds
Streaming imagenet data took 4.135392665863037 seconds
Then, training+dataloading take 4.157286643981934 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.1051781177520752
Memory occupied: [9166.0, 8050.0] Time: 37.86363887786865
Time for copying to cuda: 0.16942954063415527
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 97']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 96']
Memory occupied: [9166.0, 8050.0] Time: 39.37619423866272
Time for forward pass: 1.4993665218353271
Time for backpropagation: 0.010777711868286133
GPU memory for training: 9.795432567596436                          

One training iteration takes: 1.8129291534423828 seconds
Index: 6
Length of received data: 802862121
Future took 3.046241521835327 seconds
Pickle took 0.41037917137145996 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.456728935241699 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49770092964172363 seconds
Streaming imagenet data took 3.954512596130371 seconds
Then, training+dataloading take 3.9765756130218506 seconds

Epoch: 0
Memory occupied: [9166.0, 8050.0] Time: 41.82342982292175
Time of next(dataloader) is: 0.10957217216491699
Time for copying to cuda: 0.16980862617492676
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 99']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 100']
Memory occupied: [9166.0, 8050.0] Time: 43.34152293205261
Time for forward pass: 1.4922492504119873
Time for backpropagation: 0.010959863662719727
GPU memory for training: 9.795432567596436                          

Last train takes: 1.8101258277893066 seconds
Total time for streaming and training: 43.53277921676636
Finish gpu thread time: 0.8097572326660156
The whole process took 50.48963379859924 seconds
