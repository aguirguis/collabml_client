Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=9, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.162294864654541
Time to prepare transforms: 0.00023937225341796875
Time to download labels: 0.047948598861694336
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10068.006411629716 Mbps
Get bandwitdh took 1.234083652496338
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1319633736.3851302 1319633736.3851302
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 9 17
Intermediate:  0.1650390625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 829.95361328125 1096.23095703125 2716.18408203125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.230050086975098
Using split index: 9
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.00020647048950195312
Time for model prep: 0.0007946491241455078
Time for model and splitting algorithm: 5.23106837272644
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.3264284133911133
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6543982028961182
Length of received data: 173103121
Future took 1.8694078922271729 seconds
Pickle took 0.09185957908630371 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.9614171981811523 seconds
Dataloader took 0.06244397163391113 seconds
Streaming imagenet data took 2.023898124694824 seconds
First stream takes: 2.0325698852539062 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05080556869506836
Time for copying to cuda: 0.037006378173828125
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1680.0, 436.0] Time: 3.036330461502075
Length of received data: 173103121
Future took 1.7110438346862793 seconds
Pickle took 0.09255433082580566 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.803743600845337 seconds
Dataloader took 0.06234550476074219 seconds
Streaming imagenet data took 1.866133213043213 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1680.0, 952.0] Time: 4.454543590545654
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 32, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 77, 7']
Time for forward pass: 3.716442584991455
Time for backpropagation: 0.050110816955566406
GPU memory for training: 3.466838836669922                          

One training iteration takes: 3.8623456954956055 seconds
Index: 0
Then, training+dataloading take 3.862830877304077 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occupied: [3178.0, 1674.0] Time: 5.902055501937866
Time of next(dataloader) is: 0.05063366889953613
Time for copying to cuda: 0.036579132080078125
Time for forward pass: 0.0552976131439209
Time for backpropagation: 0.0020952224731445312
GPU memory for training: 1.852118968963623                          

One training iteration takes: 0.15273284912109375 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3196.0, 2110.0] Time: 7.317230224609375
Length of received data: 173103121
Future took 1.8055498600006104 seconds
Pickle took 0.09208035469055176 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8977742195129395 seconds
Dataloader took 0.062161922454833984 seconds
Streaming imagenet data took 1.9599809646606445 seconds
Then, training+dataloading take 1.965998649597168 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04929709434509277
Time for copying to cuda: 0.03660011291503906
Time for forward pass: 0.08090400695800781
Time for backpropagation: 0.0024666786193847656
GPU memory for training: 1.852118968963623                          

One training iteration takes: 0.17543768882751465 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3196.0, 2110.0] Time: 8.751290798187256
Length of received data: 173103121
Future took 1.6805541515350342 seconds
Pickle took 0.07242846488952637 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7531256675720215 seconds
Dataloader took 0.062245845794677734 seconds
Streaming imagenet data took 1.8154246807098389 seconds
Then, training+dataloading take 1.8250031471252441 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.049690961837768555
Time for copying to cuda: 0.07199740409851074
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 0.0954275131225586
Time for backpropagation: 0.0036618709564208984
GPU memory for training: 1.852118968963623                          

One training iteration takes: 0.22481417655944824 seconds
Index: 3
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 39, 10']
Memory occupied: [3196.0, 2110.0] Time: 10.187055349349976
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 173103121
Future took 1.9264891147613525 seconds
Pickle took 0.09268546104431152 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.0194787979125977 seconds
Memory occupied: [3196.0, 2110.0] Time: 11.706621170043945
Dataloader took 0.06255888938903809 seconds
Streaming imagenet data took 2.0820817947387695 seconds
Then, training+dataloading take 2.0918798446655273 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.049623727798461914
Time for copying to cuda: 0.036370038986206055
Time for forward pass: 0.08086133003234863
Time for backpropagation: 0.0021719932556152344
GPU memory for training: 1.852118968963623                          

One training iteration takes: 0.17604660987854004 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3196.0, 2110.0] Time: 13.131309032440186
Length of received data: 173103121
Future took 1.6936261653900146 seconds
Pickle took 0.08327484130859375 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.777040719985962 seconds
Dataloader took 0.061260223388671875 seconds
Streaming imagenet data took 1.8383417129516602 seconds
Then, training+dataloading take 1.846207857131958 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.049443960189819336
Time for copying to cuda: 0.03668212890625
Time for forward pass: 0.08077549934387207
Time for backpropagation: 0.002198934555053711
GPU memory for training: 1.852118968963623                          

One training iteration takes: 0.175933837890625 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3196.0, 2110.0] Time: 14.559624671936035
Length of received data: 173103121
Future took 1.7074992656707764 seconds
Pickle took 0.0808563232421875 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7885057926177979 seconds
Dataloader took 0.06317758560180664 seconds
Streaming imagenet data took 1.8517262935638428 seconds
Then, training+dataloading take 1.8597238063812256 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04945993423461914
Time for copying to cuda: 0.07510733604431152
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 0.10476207733154297
Time for backpropagation: 0.0032820701599121094
GPU memory for training: 1.852118968963623                          

One training iteration takes: 0.23670721054077148 seconds
Index: 6
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 38, 8']
Memory occupied: [3196.0, 2110.0] Time: 16.000040769577026
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 173103121
Future took 1.8183317184448242 seconds
Pickle took 0.09865307807922363 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.9173610210418701 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.10907268524169922 seconds
Streaming imagenet data took 2.0264880657196045 seconds
Then, training+dataloading take 2.0355536937713623 seconds

Epoch: 0
Memory occupied: [3196.0, 2110.0] Time: 17.52049708366394
Time of next(dataloader) is: 0.04996228218078613
Time for copying to cuda: 0.03668951988220215
Time for forward pass: 0.0809326171875
Time for backpropagation: 0.0022771358489990234
GPU memory for training: 1.852118968963623                          

Last train takes: 0.17672181129455566 seconds
Total time for streaming and training: 17.696691751480103
Finish gpu thread time: 0.8248529434204102
The whole process took 24.963499546051025 seconds
