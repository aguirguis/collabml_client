Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=2, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1643140316009521
Time to prepare transforms: 0.0002598762512207031
Time to download labels: 0.06462860107421875
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10449.454236552174 Mbps
Get bandwitdh took 1.2391958236694336
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03
 3.07200e+03 3.07200e+03 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1369630865.6933665 1369630865.6933665
All candidates indexes:  (array([17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 2 17
Intermediate:  0.0
1.1484375
Total layers size  104.47354125976562
Server, client, server+client, vanilla  357.7919921875 17669.89013671875 18027.68212890625 19392.54638671875
Fixed, scale_with_bsz  0 1.72265625
Mem usage  1654.0 3.0
Time for splitting algorithm: 5.975545167922974
Using split index: 2
Freezing the lower layers of the model (myvit) till index 17
Time to freeze model: 0.000873565673828125
Time for model prep: 0.002270221710205078
Time for model and splitting algorithm: 5.978708505630493
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 0.3246169090270996
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 1.6477558612823486
Length of received data: 605229121
Future took 2.6960129737854004 seconds
Pickle took 0.31845712661743164 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0553271770477295 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.3361380100250244 seconds
Streaming imagenet data took 3.391566276550293 seconds
First stream takes: 3.403935194015503 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occupied: [1654.0, 3.0] Time: 3.4915452003479004
Time of next(dataloader) is: 0.09884333610534668
Time for copying to cuda: 0.12894558906555176
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2232.0, 836.0] Time: 4.9237847328186035
Length of received data: 605229121
Future took 2.664680004119873 seconds
Pickle took 0.3200666904449463 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0366528034210205 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.33422207832336426 seconds
Streaming imagenet data took 3.371058940887451 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 4, 0']
Memory occupied: [2232.0, 1524.0] Time: 6.922668218612671
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 37']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 43']
Memory occupied: [8390.0, 8012.0] Time: 8.394431114196777
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8390.0, 8012.0] Time: 9.866920948028564
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 40']
Memory occupied: [8390.0, 8012.0] Time: 11.338542222976685
Time for forward pass: 8.638992071151733
Time for backpropagation: 0.052496910095214844
GPU memory for training: 8.35290813446045                          

One training iteration takes: 8.940246820449829 seconds
Index: 0
Then, training+dataloading take 8.941712141036987 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.13282990455627441
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 35, 17']
Time for copying to cuda: 0.20003008842468262
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8390.0, 8020.0] Time: 12.850924968719482
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 34']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 29']
Memory occupied: [8398.0, 8020.0] Time: 14.32504391670227
Length of received data: 605229121
Future took 2.7166223526000977 seconds
Pickle took 0.31413817405700684 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.030956983566284 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 29']
Dataloader took 0.37595534324645996 seconds
Streaming imagenet data took 3.407008647918701 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 31']
Memory occupied: [8398.0, 8020.0] Time: 15.924888134002686
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 17.43656277656555
Time for forward pass: 5.2687883377075195
Time for backpropagation: 0.007683277130126953
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.630618333816528 seconds
Index: 1
Then, training+dataloading take 5.631991624832153 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08241677284240723
Time for copying to cuda: 0.12653565406799316
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 55']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 34']
Memory occupied: [8398.0, 8020.0] Time: 18.9556622505188
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 29']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 20.52350687980652
Length of received data: 605229121
Future took 2.866417407989502 seconds
Pickle took 0.31459832191467285 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.181154251098633 seconds
Dataloader took 0.21435117721557617 seconds
Streaming imagenet data took 3.3955509662628174 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 37']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 22.05350923538208
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Time for forward pass: 5.326023101806641
Time for backpropagation: 0.008790016174316406
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.553354740142822 seconds
Index: 2
Then, training+dataloading take 5.553606748580933 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09331011772155762
Memory occupied: [8398.0, 8020.0] Time: 23.647074937820435
Time for copying to cuda: 0.1262674331665039
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 34']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 40']
Memory occupied: [8398.0, 8020.0] Time: 25.21405339241028
Length of received data: 605229121
Future took 2.662907361984253 seconds
Pickle took 0.3120732307434082 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 2.9751224517822266 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 29']
Dataloader took 0.3941159248352051 seconds
Streaming imagenet data took 3.3693480491638184 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 32']
Memory occupied: [8398.0, 8020.0] Time: 27.095133304595947
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 28.64803385734558
Time for forward pass: 5.321751117706299
Time for backpropagation: 0.007696390151977539
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.570219278335571 seconds
Index: 3
Then, training+dataloading take 5.573370933532715 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08264517784118652
Time for copying to cuda: 0.12668061256408691
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 29']
Memory occupied: [8398.0, 8020.0] Time: 30.18110227584839
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 31.880836725234985
Length of received data: 605229121
Future took 2.8468689918518066 seconds
Pickle took 0.32320594787597656 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.170224189758301 seconds
Dataloader took 0.21396994590759277 seconds
Streaming imagenet data took 3.3842387199401855 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 29']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 33.414876222610474
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 45']
Time for forward pass: 5.34126353263855
Time for backpropagation: 0.008543014526367188
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.584561347961426 seconds
Index: 4
Then, training+dataloading take 5.585987329483032 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.12943577766418457
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 76, 25']
Memory occupied: [8398.0, 8020.0] Time: 34.97741174697876
Time for copying to cuda: 0.162489652633667
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 23']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 36.510777711868286
Length of received data: 605229121
Future took 2.6983559131622314 seconds
Pickle took 0.25078415870666504 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 2.949294328689575 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
Dataloader took 0.3823513984680176 seconds
Streaming imagenet data took 3.331756114959717 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Memory occupied: [8398.0, 8020.0] Time: 38.21611189842224
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 42']
Memory occupied: [8398.0, 8020.0] Time: 39.714139461517334
Time for forward pass: 5.385409116744995
Time for backpropagation: 0.007883071899414062
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.705890893936157 seconds
Index: 5
Then, training+dataloading take 5.709095239639282 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08219671249389648
Time for copying to cuda: 0.12608551979064941
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 43, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 40']
Memory occupied: [8398.0, 8020.0] Time: 41.21059036254883
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 42.7223424911499
Length of received data: 605229121
Future took 2.8823986053466797 seconds
Pickle took 0.301084041595459 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.1836299896240234 seconds
Dataloader took 0.26967692375183105 seconds
Streaming imagenet data took 3.453362226486206 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 34']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 44.2561354637146
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 39']
Memory occupied: [8398.0, 8020.0] Time: 45.77473974227905
Time for forward pass: 5.428950786590576
Time for backpropagation: 0.007800102233886719
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.668221473693848 seconds
Index: 6
Then, training+dataloading take 5.6696085929870605 seconds

Epoch: 0
Time of next(dataloader) is: 0.08210897445678711
Time for copying to cuda: 0.1263716220855713
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 47.27077078819275
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 44']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8398.0, 8020.0] Time: 48.77540421485901
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 48']
Memory occupied: [8398.0, 8020.0] Time: 50.269914388656616
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 26']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 45']
Time for forward pass: 5.473625659942627
Time for backpropagation: 0.008318185806274414
GPU memory for training: 8.37738037109375                          

Last train takes: 5.710695505142212 seconds
Total time for streaming and training: 51.78020715713501
Memory occupied: [8398.0, 8020.0] Time: 51.78058385848999
Finish gpu thread time: 1.0012359619140625
The whole process took 59.989837408065796 seconds
