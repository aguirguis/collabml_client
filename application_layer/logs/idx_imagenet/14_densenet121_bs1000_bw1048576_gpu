Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=14, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1616973876953125
Time to prepare transforms: 0.0002472400665283203
Time to download labels: 0.04848337173461914
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5542194879162 Mbps
Get bandwitdh took 1.236940622329712
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119086018.65672015 119086018.65672015
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 14 20
Intermediate:  0.19140625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 6116.125 6311.35107421875 12623.9375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.94310736656189
Using split index: 14
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015659332275390625
Time for model prep: 0.0045473575592041016
Time for model and splitting algorithm: 4.94924521446228
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.33513975143432617
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6708366870880127
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 3.011068820953369
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 4.360248327255249
Length of received data: 200751121
Future took 4.982693433761597 seconds
Pickle took 0.10538935661315918 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.088237524032593 seconds
Dataloader took 0.07097697257995605 seconds
Streaming imagenet data took 5.15925407409668 seconds
First stream takes: 5.169970512390137 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.057153940200805664
Time for copying to cuda: 0.04304218292236328
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 8, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 5, 0']
Memory occupied: [1510.0, 296.0] Time: 5.740463018417358
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1510.0, 828.0] Time: 7.144279956817627
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1510.0, 1276.0] Time: 8.575730085372925
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 90, 71']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 61, 50']
Memory occupied: [3694.0, 4542.0] Time: 10.044480085372925
Length of received data: 200751121
Future took 5.030403137207031 seconds
Pickle took 0.10171151161193848 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.132331132888794 seconds
Dataloader took 0.07297873497009277 seconds
Streaming imagenet data took 5.20535135269165 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 96, 67']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 60']
Memory occupied: [4766.0, 2722.0] Time: 11.48270058631897
Time for forward pass: 6.931525707244873
Time for backpropagation: 0.07884669303894043
GPU memory for training: 5.916075706481934                          

One training iteration takes: 7.119053602218628 seconds
Index: 0
Then, training+dataloading take 7.119675159454346 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.056354522705078125
Time for copying to cuda: 0.042495012283325195
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 15, 4']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 95']
Time for forward pass: 0.5110149383544922
Time for backpropagation: 0.01167154312133789
GPU memory for training: 2.436349391937256                          

One training iteration takes: 0.6299669742584229 seconds
Index: 1
Memory occupied: [3318.0, 6722.0] Time: 12.92369556427002
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 14.341571807861328
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 15.77244782447815
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 17.2221360206604
Length of received data: 200751121
Future took 5.063150405883789 seconds
Pickle took 0.10504484176635742 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.168350458145142 seconds
Dataloader took 0.07124733924865723 seconds
Streaming imagenet data took 5.239640951156616 seconds
Then, training+dataloading take 5.247409820556641 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05688905715942383
Time for copying to cuda: 0.04231119155883789
Time for forward pass: 0.5111126899719238
Time for backpropagation: 0.010630130767822266
GPU memory for training: 2.4390311241149902                          

One training iteration takes: 0.6297667026519775 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 58, 58']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 18.654592037200928
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 20.08297872543335
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 21.53550124168396
Length of received data: 200751121
Future took 4.9845898151397705 seconds
Pickle took 0.10024666786193848 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.085003614425659 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.16083025932312012 seconds
Streaming imagenet data took 5.2459046840667725 seconds
Then, training+dataloading take 5.253942489624023 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.057721853256225586
Time for copying to cuda: 0.08307790756225586
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 23.090489864349365
Time for forward pass: 0.5175046920776367
Time for backpropagation: 0.010826587677001953
GPU memory for training: 2.4390311241149902                          

One training iteration takes: 0.6786577701568604 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 24.522445678710938
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 25.959498643875122
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 27.42204523086548
Length of received data: 200751121
Future took 4.985179901123047 seconds
Pickle took 0.09767293930053711 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.082998752593994 seconds
Dataloader took 0.07157301902770996 seconds
Streaming imagenet data took 5.154623508453369 seconds
Then, training+dataloading take 5.165651798248291 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05673074722290039
Time for copying to cuda: 0.04216408729553223
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 98']
Time for forward pass: 0.5252809524536133
Time for backpropagation: 0.011887311935424805
GPU memory for training: 2.4390311241149902                          

One training iteration takes: 0.6413724422454834 seconds
Index: 4
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 77, 68']
Memory occupied: [3318.0, 6722.0] Time: 28.868669033050537
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 30.302526712417603
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 31.741732120513916
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 200751121
Future took 5.06535530090332 seconds
Pickle took 0.11711859703063965 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.182844161987305 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.11658620834350586 seconds
Streaming imagenet data took 5.299482345581055 seconds
Then, training+dataloading take 5.311554908752441 seconds
Memory occupied: [3318.0, 6722.0] Time: 33.26865601539612
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05714869499206543
Time for copying to cuda: 0.042398929595947266
Time for forward pass: 0.5168063640594482
Time for backpropagation: 0.010776996612548828
GPU memory for training: 2.4390311241149902                          

One training iteration takes: 0.6362683773040771 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 34.70649552345276
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 36.14306998252869
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 37.586501598358154
Length of received data: 200751121
Future took 4.994079113006592 seconds
Pickle took 0.09819889068603516 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.0924296379089355 seconds
Dataloader took 0.07338595390319824 seconds
Streaming imagenet data took 5.165860176086426 seconds
Then, training+dataloading take 5.1773669719696045 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.057076454162597656
Time for copying to cuda: 0.042671918869018555
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 5, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 82']
Memory occupied: [3318.0, 6722.0] Time: 39.04234337806702
Time for forward pass: 0.5164046287536621
Time for backpropagation: 0.011086463928222656
GPU memory for training: 2.4390311241149902                          

One training iteration takes: 0.6362917423248291 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 40.47572326660156
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 41.925118923187256
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3318.0, 6722.0] Time: 43.37595534324646
Length of received data: 200751121
Future took 5.054003477096558 seconds
Pickle took 0.09797978401184082 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 5.1521265506744385 seconds
Dataloader took 0.0729219913482666 seconds
Streaming imagenet data took 5.225094556808472 seconds
Then, training+dataloading take 5.2367942333221436 seconds

Epoch: 0
Time of next(dataloader) is: 0.05704689025878906
Time for copying to cuda: 0.04231381416320801
Time for forward pass: 0.5237319469451904
Time for backpropagation: 0.010610103607177734
GPU memory for training: 2.4390311241149902                          

Last train takes: 0.6423077583312988 seconds
Total time for streaming and training: 44.32486891746521
Finish gpu thread time: 0.05204629898071289
The whole process took 50.53698754310608 seconds
