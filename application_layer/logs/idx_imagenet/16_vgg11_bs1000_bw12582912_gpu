Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=16, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.163137435913086
Time to prepare transforms: 0.00024700164794921875
Time to download labels: 0.06321096420288086
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10059.376748903383 Mbps
Get bandwitdh took 1.223463773727417
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1318502629.2322643 1318502629.2322643
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 16 25
Intermediate:  0.3828125
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 1757.02587890625 2665.42236328125 26448.43212890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Time for splitting algorithm: 6.612694501876831
Using split index: 16
Freezing the lower layers of the model (myvgg11) till index 25
Time to freeze model: 0.00024700164794921875
Time for model prep: 0.0008370876312255859
Time for model and splitting algorithm: 6.613797187805176
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 0.30974769592285156
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 1.6252052783966064
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 2.943436622619629
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 4.25880765914917
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 5.578139781951904
Length of received data: 401455121
Future took 6.284676790237427 seconds
Pickle took 0.21613121032714844 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 6.500959157943726 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.21836566925048828 seconds
Streaming imagenet data took 6.719387054443359 seconds
First stream takes: 6.732960224151611 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.1112821102142334
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.11771273612976074
Memory occupied: [1840.0, 15.0] Time: 6.996796607971191
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2224.0, 782.0] Time: 8.405653238296509
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2224.0, 1252.0] Time: 9.844118118286133
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 31']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 87, 32']
Memory occupied: [5840.0, 5374.0] Time: 11.299259662628174
Time for forward pass: 4.539268493652344
Time for backpropagation: 0.051000118255615234
GPU memory for training: 8.204551696777344                          

One training iteration takes: 4.836559295654297 seconds
Index: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3362.0, 5382.0] Time: 12.712249279022217
Length of received data: 401455121
Future took 6.363612174987793 seconds
Pickle took 0.20863580703735352 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 6.5723912715911865 seconds
Dataloader took 0.14069151878356934 seconds
Streaming imagenet data took 6.713132619857788 seconds
Then, training+dataloading take 6.732605218887329 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07367229461669922
Time for copying to cuda: 0.08507895469665527
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 56, 7']
Time for forward pass: 0.2480168342590332
Time for backpropagation: 0.0037093162536621094
GPU memory for training: 4.73736572265625                          

One training iteration takes: 0.41720008850097656 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 45, 8']
Memory occupied: [4952.0, 5390.0] Time: 14.15647840499878
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 15.57455825805664
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 16.990556001663208
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 18.410059452056885
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 19.86715602874756
Length of received data: 401455121
Future took 6.461760759353638 seconds
Pickle took 0.20897126197814941 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 6.670876502990723 seconds
Dataloader took 0.14529895782470703 seconds
Streaming imagenet data took 6.816222429275513 seconds
Then, training+dataloading take 6.8377180099487305 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07241630554199219
Time for copying to cuda: 0.08514881134033203
Time for forward pass: 0.24777555465698242
Time for backpropagation: 0.0027091503143310547
GPU memory for training: 4.73736572265625                          

One training iteration takes: 0.4225447177886963 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 19, 4']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 21.29736638069153
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 22.72813320159912
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 24.158894062042236
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 25.589486837387085
Length of received data: 401455121
Future took 6.291207313537598 seconds
Pickle took 0.19517922401428223 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 6.486563444137573 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.23483610153198242 seconds
Streaming imagenet data took 6.721453666687012 seconds
Then, training+dataloading take 6.743350028991699 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.17221713066101074
Memory occupied: [4952.0, 5390.0] Time: 27.291133165359497
Time for copying to cuda: 0.0852193832397461
Time for forward pass: 0.2469642162322998
Time for backpropagation: 0.0027060508728027344
GPU memory for training: 4.73736572265625                          

One training iteration takes: 0.5218193531036377 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 28.72126579284668
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 30.153113842010498
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 31.580249309539795
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 33.01851296424866
Length of received data: 401455121
Future took 6.4360597133636475 seconds
Pickle took 0.1947333812713623 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 6.630937576293945 seconds
Dataloader took 0.1423652172088623 seconds
Streaming imagenet data took 6.773348331451416 seconds
Then, training+dataloading take 6.796900510787964 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07159423828125
Time for copying to cuda: 0.08480119705200195
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 15, 1']
Time for forward pass: 0.29596590995788574
Time for backpropagation: 0.0038971900939941406
GPU memory for training: 4.73736572265625                          

One training iteration takes: 0.4628560543060303 seconds
Index: 4
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 85, 22']
Memory occupied: [4952.0, 5390.0] Time: 34.484066009521484
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 35.90737009048462
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 37.333475828170776
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 38.76610994338989
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 401455121
Memory occupied: [4952.0, 5390.0] Time: 40.34860277175903
Future took 6.504689693450928 seconds
Pickle took 0.2031247615814209 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 6.70794939994812 seconds
Dataloader took 0.14209771156311035 seconds
Streaming imagenet data took 6.850093126296997 seconds
Then, training+dataloading take 6.873878717422485 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0718238353729248
Time for copying to cuda: 0.08491015434265137
Time for forward pass: 0.2678103446960449
Time for backpropagation: 0.0027570724487304688
GPU memory for training: 4.73736572265625                          

One training iteration takes: 0.441852331161499 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 41.97935676574707
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 43.4027533531189
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 44.83047151565552
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 46.25757193565369
Length of received data: 401455121
Future took 6.321583986282349 seconds
Pickle took 0.20293664932250977 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 6.524664640426636 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.23703527450561523 seconds
Streaming imagenet data took 6.7617716789245605 seconds
Then, training+dataloading take 6.777942895889282 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.11537837982177734
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.14247703552246094
Memory occupied: [4952.0, 5390.0] Time: 47.7767014503479
Time for forward pass: 0.25138044357299805
Time for backpropagation: 0.0027551651000976562
GPU memory for training: 4.73736572265625                          

One training iteration takes: 0.5251410007476807 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 49.22945261001587
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 50.6853232383728
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 52.13599610328674
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4952.0, 5390.0] Time: 53.59935665130615
Length of received data: 401455121
Future took 6.437186002731323 seconds
Pickle took 0.17339348793029785 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 6.610723972320557 seconds
Dataloader took 0.1420433521270752 seconds
Streaming imagenet data took 6.752814054489136 seconds
Then, training+dataloading take 6.776559829711914 seconds

Epoch: 0
Time of next(dataloader) is: 0.07101678848266602
Time for copying to cuda: 0.0847165584564209
Time for forward pass: 0.24866604804992676
Time for backpropagation: 0.003547191619873047
GPU memory for training: 4.73736572265625                          

Last train takes: 0.4144127368927002 seconds
Total time for streaming and training: 54.68659472465515
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 96, 45']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 63, 14']
Memory occupied: [4952.0, 5390.0] Time: 55.04582691192627
Finish gpu thread time: 1.360262155532837
The whole process took 63.88770937919617 seconds
