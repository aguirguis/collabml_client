Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=16, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1624886989593506
Time to prepare transforms: 0.0002639293670654297
Time to download labels: 0.06461858749389648
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10450.486705519328 Mbps
Get bandwitdh took 1.234548807144165
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1369766193.4658294 1369766193.4658294
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 16 20
Intermediate:  0.765625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 6690.34375 6885.56982421875 12623.9375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.92560601234436
Using split index: 16
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015816688537597656
Time for model prep: 0.004549980163574219
Time for model and splitting algorithm: 4.931761026382446
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.32854223251342773
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6579556465148926
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 2.987823963165283
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 4.320039987564087
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 5.790913105010986
Length of received data: 802863121
Future took 5.943211078643799 seconds
Pickle took 0.4148552417755127 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.358227968215942 seconds
Dataloader took 0.28548169136047363 seconds
Streaming imagenet data took 6.643749475479126 seconds
First stream takes: 6.688476800918579 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.14315080642700195
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.2408769130706787
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2084.0, 22.0] Time: 7.212988615036011
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 1, 0']
Memory occupied: [2084.0, 972.0] Time: 8.658723831176758
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2084.0, 1510.0] Time: 10.130595207214355
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 88, 59']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 58, 42']
Memory occupied: [4560.0, 4154.0] Time: 11.608819961547852
Time for forward pass: 4.670071601867676
Time for backpropagation: 0.06685614585876465
GPU memory for training: 6.010191917419434                          

One training iteration takes: 5.149272203445435 seconds
Index: 0
Length of received data: 802863121
Future took 6.066080093383789 seconds
Pickle took 0.4237358570098877 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.490113258361816 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4594.0, 4186.0] Time: 13.610445737838745
Dataloader took 0.46465110778808594 seconds
Streaming imagenet data took 6.954812049865723 seconds
Then, training+dataloading take 6.9902496337890625 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09639167785644531
Time for copying to cuda: 0.16883540153503418
Time for forward pass: 0.20686960220336914
Time for backpropagation: 0.010474205017089844
GPU memory for training: 1.8623547554016113                          

One training iteration takes: 0.5090980529785156 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 15.042932271957397
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 16.47534489631653
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 17.910458087921143
Length of received data: 802863121
Future took 5.730066299438477 seconds
Pickle took 0.4173128604888916 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.147625207901001 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.5218431949615479 seconds
Streaming imagenet data took 6.6695451736450195 seconds
Then, training+dataloading take 6.689454555511475 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [4610.0, 4202.0] Time: 20.4556884765625
Time of next(dataloader) is: 0.10216617584228516
Time for copying to cuda: 0.16919541358947754
Time for forward pass: 0.17921185493469238
Time for backpropagation: 0.010284662246704102
GPU memory for training: 1.8623547554016113                          

One training iteration takes: 0.487699031829834 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 21.92886519432068
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 23.406039237976074
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 24.865938186645508
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 802863121
Future took 5.901828765869141 seconds
Pickle took 0.378007173538208 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.2800133228302 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 26.788182497024536
Dataloader took 0.33275532722473145 seconds
Streaming imagenet data took 6.612826347351074 seconds
Then, training+dataloading take 6.651769161224365 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09449601173400879
Time for copying to cuda: 0.16865324974060059
Time for forward pass: 0.1791534423828125
Time for backpropagation: 0.010441064834594727
GPU memory for training: 1.8623547554016113                          

One training iteration takes: 0.47841835021972656 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 28.249940156936646
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 29.714260578155518
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 31.172818660736084
Length of received data: 802863121
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Future took 5.7923595905303955 seconds
Pickle took 0.3818325996398926 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.1743669509887695 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 33.60927891731262
Dataloader took 0.44994187355041504 seconds
Streaming imagenet data took 6.624353885650635 seconds
Then, training+dataloading take 6.662450313568115 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0950314998626709
Time for copying to cuda: 0.16875338554382324
Time for forward pass: 0.17917943000793457
Time for backpropagation: 0.010349273681640625
GPU memory for training: 1.8623547554016113                          

One training iteration takes: 0.4788804054260254 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 35.06751775741577
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 36.52770638465881
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 37.988417863845825
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 802863121
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Future took 5.8861658573150635 seconds
Pickle took 0.3817625045776367 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.268138408660889 seconds
Memory occupied: [4610.0, 4202.0] Time: 40.090301513671875
Dataloader took 0.3377707004547119 seconds
Streaming imagenet data took 6.605949640274048 seconds
Then, training+dataloading take 6.6445324420928955 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09493112564086914
Time for copying to cuda: 0.16876006126403809
Time for forward pass: 0.17940306663513184
Time for backpropagation: 0.010465145111083984
GPU memory for training: 1.8623547554016113                          

One training iteration takes: 0.4792788028717041 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 41.55297327041626
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 43.012813329696655
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 44.4753851890564
Length of received data: 802863121
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Future took 5.773721218109131 seconds
Pickle took 0.3822903633117676 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.156202793121338 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 46.896135330200195
Dataloader took 0.4481050968170166 seconds
Streaming imagenet data took 6.604350566864014 seconds
Then, training+dataloading take 6.64185357093811 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09498190879821777
Time for copying to cuda: 0.1691761016845703
Time for forward pass: 0.17925167083740234
Time for backpropagation: 0.010446786880493164
GPU memory for training: 1.8623547554016113                          

One training iteration takes: 0.47959327697753906 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 48.359087228775024
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 49.82149362564087
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 51.281999826431274
Length of received data: 802863121
Future took 5.810624599456787 seconds
Pickle took 0.4062838554382324 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.2172160148620605 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [4610.0, 4202.0] Time: 53.5996994972229
Dataloader took 0.4454965591430664 seconds
Streaming imagenet data took 6.662757635116577 seconds
Then, training+dataloading take 6.700618505477905 seconds

Epoch: 0
Time of next(dataloader) is: 0.09450364112854004
Time for copying to cuda: 0.16876554489135742
Time for forward pass: 0.17927026748657227
Time for backpropagation: 0.010428190231323242
GPU memory for training: 1.8623547554016113                          

Last train takes: 0.4781494140625 seconds
Total time for streaming and training: 54.14780783653259
Finish gpu thread time: 0.45292162895202637
The whole process took 60.76025128364563 seconds
