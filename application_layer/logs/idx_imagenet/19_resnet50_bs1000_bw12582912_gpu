Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=19, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1610748767852783
Time to prepare transforms: 0.00024437904357910156
Time to download labels: 0.047037601470947266
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10073.89348036852 Mbps
Get bandwitdh took 1.2314300537109375
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1320405366.2588627 1320405366.2588627
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 19 21
Intermediate:  0.3828125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 1253.794921875 1458.71044921875 7570.201171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Time for splitting algorithm: 5.114073038101196
Using split index: 19
Freezing the lower layers of the model (myresnet50) till index 21
Time to freeze model: 0.0007171630859375
Time for model prep: 0.002301931381225586
Time for model and splitting algorithm: 5.1171112060546875
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 0.3248579502105713
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 1.6521356105804443
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 2.982294797897339
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 4.369658946990967
Length of received data: 401455121
Future took 4.7812371253967285 seconds
Pickle took 0.20730972290039062 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.988716125488281 seconds
Dataloader took 0.14226365089416504 seconds
Streaming imagenet data took 5.131020545959473 seconds
First stream takes: 5.154648542404175 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06529664993286133
Time for copying to cuda: 0.08446121215820312
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 17, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1794.0, 384.0] Time: 5.7557151317596436
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1794.0, 850.0] Time: 7.1734724044799805
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1794.0, 1386.0] Time: 8.615920066833496
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 97, 36']
Length of received data: 401455121
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 92, 76']
Future took 4.866536378860474 seconds
Pickle took 0.21073460578918457 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 5.0775980949401855 seconds
Time for forward pass: 4.9902184009552
Memory occupied: [6384.0, 4844.0] Time: 10.361092567443848
Time for backpropagation: 0.06587600708007812
GPU memory for training: 9.752721309661865                          

One training iteration takes: 5.2204508781433105 seconds
Index: 0
Dataloader took 0.21891069412231445 seconds
Streaming imagenet data took 5.296556711196899 seconds
Then, training+dataloading take 5.315408945083618 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06402134895324707
Time for copying to cuda: 0.08407092094421387
Time for forward pass: 0.06406044960021973
Time for backpropagation: 0.005660057067871094
GPU memory for training: 1.5917716026306152                          

One training iteration takes: 0.23257064819335938 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 11.787564754486084
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 13.215392827987671
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 14.641380548477173
Length of received data: 401455121
Future took 4.7214179039001465 seconds
Pickle took 0.18655085563659668 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.908124685287476 seconds
Dataloader took 0.1425948143005371 seconds
Streaming imagenet data took 5.0507652759552 seconds
Then, training+dataloading take 5.069561719894409 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06461119651794434
Time for copying to cuda: 0.1231241226196289
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 4, 0']
Time for forward pass: 0.09732341766357422
Time for backpropagation: 0.006821393966674805
GPU memory for training: 1.5917716026306152                          

One training iteration takes: 0.2995028495788574 seconds
Index: 2
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 37, 16']
Memory occupied: [6372.0, 4852.0] Time: 16.098144054412842
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 17.525779485702515
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 18.951533555984497
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 401455121
Future took 4.861654996871948 seconds
Pickle took 0.19822907447814941 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 5.060173273086548 seconds
Memory occupied: [6372.0, 4852.0] Time: 20.60039782524109
Dataloader took 0.14295458793640137 seconds
Streaming imagenet data took 5.203174114227295 seconds
Then, training+dataloading take 5.222482681274414 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0644078254699707
Time for copying to cuda: 0.08412647247314453
Time for forward pass: 0.09483528137207031
Time for backpropagation: 0.006115913391113281
GPU memory for training: 1.5917716026306152                          

One training iteration takes: 0.26407861709594727 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 22.031649827957153
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 23.46286368370056
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 24.8928542137146
Length of received data: 401455121
Future took 4.741302251815796 seconds
Pickle took 0.18724966049194336 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.928717374801636 seconds
Dataloader took 0.1413874626159668 seconds
Streaming imagenet data took 5.0701587200164795 seconds
Then, training+dataloading take 5.088953733444214 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10920834541320801
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.12498259544372559
Time for forward pass: 0.09729909896850586
Time for backpropagation: 0.006856441497802734
GPU memory for training: 1.5917716026306152                          

One training iteration takes: 0.345869779586792 seconds
Index: 4
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 40, 18']
Memory occupied: [6372.0, 4852.0] Time: 26.367645740509033
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 27.798094987869263
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 29.229777812957764
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 401455121
Future took 4.8176305294036865 seconds
Pickle took 0.187363862991333 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 5.005203485488892 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.2343599796295166 seconds
Streaming imagenet data took 5.239624738693237 seconds
Then, training+dataloading take 5.259308099746704 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000

Memory occupied: [6372.0, 4852.0] Time: 31.11104154586792

Epoch: 0
Time of next(dataloader) is: 0.1096036434173584
Time for copying to cuda: 0.08400225639343262
Time for forward pass: 0.09473705291748047
Time for backpropagation: 0.005807161331176758
GPU memory for training: 1.5917716026306152                          

One training iteration takes: 0.3088562488555908 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 32.54190254211426
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 33.96893358230591
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 35.40575671195984
Length of received data: 401455121
Future took 4.808420419692993 seconds
Pickle took 0.18717265129089355 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 4.9957451820373535 seconds
Dataloader took 0.14139556884765625 seconds
Streaming imagenet data took 5.1371893882751465 seconds
Then, training+dataloading take 5.156535625457764 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06460213661193848
Time for copying to cuda: 0.12149620056152344
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 46, 8']
Time for forward pass: 0.11661744117736816
Time for backpropagation: 0.009087085723876953
GPU memory for training: 1.5917716026306152                          

One training iteration takes: 0.3194146156311035 seconds
Index: 6
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 40, 18']
Memory occupied: [6372.0, 4852.0] Time: 36.865087270736694
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 38.29622173309326
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6372.0, 4852.0] Time: 39.723414182662964
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 401455121
Future took 4.8536601066589355 seconds
Pickle took 0.1861875057220459 seconds
Read 382.8574380874634 MBs for this batch
Executing all posts took 5.0400145053863525 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.23496150970458984 seconds
Streaming imagenet data took 5.2750279903411865 seconds
Then, training+dataloading take 5.295050144195557 seconds

Epoch: 0
Memory occupied: [6372.0, 4852.0] Time: 41.56286883354187
Time of next(dataloader) is: 0.0645589828491211
Time for copying to cuda: 0.08398056030273438
Time for forward pass: 0.09506607055664062
Time for backpropagation: 0.006035566329956055
GPU memory for training: 1.5917716026306152                          

Last train takes: 0.26363134384155273 seconds
Total time for streaming and training: 41.82579255104065
Finish gpu thread time: 0.7381525039672852
The whole process took 48.889772176742554 seconds
