Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=17, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1613924503326416
Time to prepare transforms: 0.00024247169494628906
Time to download labels: 0.0643002986907959
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10529.447375788366 Mbps
Get bandwitdh took 1.2372734546661377
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1380115726.4393327 1380115726.4393327
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 17 21
Intermediate:  0.765625
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 2019.419921875 2224.33544921875 7953.013671875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Time for splitting algorithm: 5.132472276687622
Using split index: 17
Freezing the lower layers of the model (myresnet50) till index 21
Time to freeze model: 0.000698089599609375
Time for model prep: 0.00229644775390625
Time for model and splitting algorithm: 5.135486841201782
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 0.33033251762390137
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 1.6652858257293701
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 2.9965410232543945
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 4.328174591064453
Length of received data: 802863121
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Future took 5.623158931732178 seconds
Pickle took 0.4189949035644531 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.042365312576294 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 6.384226322174072
Dataloader took 0.4189474582672119 seconds
Streaming imagenet data took 6.461349725723267 seconds
First stream takes: 6.507131099700928 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10324883460998535
Time for copying to cuda: 0.17027711868286133
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2176.0, 788.0] Time: 7.8170270919799805
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2176.0, 1274.0] Time: 9.279127836227417
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 92, 28']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 88, 50']
Memory occupied: [4656.0, 5368.0] Time: 10.74530553817749
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 96, 42']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 75, 30']
Memory occupied: [9190.0, 6692.0] Time: 12.321113348007202
Length of received data: 802863121
Future took 5.895060300827026 seconds
Pickle took 0.41368770599365234 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.308951377868652 seconds
Time for forward pass: 6.097285985946655
Time for backpropagation: 0.07598161697387695
GPU memory for training: 10.687978267669678                          

One training iteration takes: 6.473324537277222 seconds
Index: 0
Dataloader took 0.3239419460296631 seconds
Streaming imagenet data took 6.632935285568237 seconds
Then, training+dataloading take 6.667982816696167 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09793901443481445
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 13, 1']
Time for copying to cuda: 0.2631237506866455
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for forward pass: 0.23298048973083496
Time for backpropagation: 0.0070247650146484375
GPU memory for training: 2.5271735191345215                          

One training iteration takes: 0.6138176918029785 seconds
Index: 1
Memory occupied: [3316.0, 6724.0] Time: 13.838317632675171
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 15.269503831863403
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 16.698830604553223
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 18.141372442245483
Length of received data: 802863121
Future took 6.316501140594482 seconds
Pickle took 0.4181637763977051 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.788196802139282 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4437391757965088 seconds
Streaming imagenet data took 7.232040166854858 seconds
Then, training+dataloading take 7.25327205657959 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [3316.0, 6724.0] Time: 20.494024753570557
Time of next(dataloader) is: 0.10726189613342285
Time for copying to cuda: 0.16926169395446777
Time for forward pass: 0.30666208267211914
Time for backpropagation: 0.006110429763793945
GPU memory for training: 2.5271735191345215                          

One training iteration takes: 0.6167604923248291 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 21.93343234062195
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 23.37004518508911
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 24.80818796157837
Length of received data: 802863121
Future took 5.83610987663269 seconds
Pickle took 0.4101877212524414 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.246467351913452 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4957304000854492 seconds
Streaming imagenet data took 6.742278814315796 seconds
Then, training+dataloading take 6.763376951217651 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occupied: [3316.0, 6724.0] Time: 27.261974573135376
Time of next(dataloader) is: 0.10745930671691895
Time for copying to cuda: 0.1690359115600586
Time for forward pass: 0.3270871639251709
Time for backpropagation: 0.006059885025024414
GPU memory for training: 2.5271735191345215                          

One training iteration takes: 0.6367847919464111 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 28.70169234275818
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 30.14582085609436
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 31.588590145111084
Length of received data: 802863121
Future took 5.858958959579468 seconds
Pickle took 0.42584228515625 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.285150766372681 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 33.891324043273926
Dataloader took 0.4420289993286133 seconds
Streaming imagenet data took 6.727236032485962 seconds
Then, training+dataloading take 6.77348256111145 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10239434242248535
Time for copying to cuda: 0.1692187786102295
Time for forward pass: 0.2898595333099365
Time for backpropagation: 0.0060503482818603516
GPU memory for training: 2.5271735191345215                          

One training iteration takes: 0.5938973426818848 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 35.336119413375854
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 36.782413959503174
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 38.2245352268219
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 802863121
Future took 6.006052494049072 seconds
Pickle took 0.41071271896362305 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.417040824890137 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 40.522743940353394
Dataloader took 0.33731508255004883 seconds
Streaming imagenet data took 6.754399061203003 seconds
Then, training+dataloading take 6.8023011684417725 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.1443336009979248
Time for copying to cuda: 0.16905879974365234
Time for forward pass: 0.29027581214904785
Time for backpropagation: 0.0060503482818603516
GPU memory for training: 2.5271735191345215                          

One training iteration takes: 0.6367390155792236 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 31, 24']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 41.96249723434448
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 43.40269470214844
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 44.84547519683838
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 46.502793073654175
Length of received data: 802863121
Future took 6.07166314125061 seconds
Pickle took 0.410780668258667 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.48259162902832 seconds
Dataloader took 0.3396775722503662 seconds
Streaming imagenet data took 6.822338104248047 seconds
Then, training+dataloading take 6.843697547912598 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.15067601203918457
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.26039981842041016
Memory occupied: [3316.0, 6724.0] Time: 48.09598994255066
Time for forward pass: 0.3072848320007324
Time for backpropagation: 0.006140470504760742
GPU memory for training: 2.5271735191345215                          

One training iteration takes: 0.7526237964630127 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 49.53875494003296
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 50.97999978065491
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 52.42495512962341
Length of received data: 802863121
Future took 5.923384189605713 seconds
Pickle took 0.42708754539489746 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.350796937942505 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3316.0, 6724.0] Time: 54.37859058380127
Dataloader took 0.4407029151916504 seconds
Streaming imagenet data took 6.791549921035767 seconds
Then, training+dataloading take 6.8380043506622314 seconds

Epoch: 0
Time of next(dataloader) is: 0.09623217582702637
Time for copying to cuda: 0.16804099082946777
Time for forward pass: 0.29094576835632324
Time for backpropagation: 0.0061206817626953125
GPU memory for training: 2.5271735191345215                          

Last train takes: 0.5873785018920898 seconds
Total time for streaming and training: 55.03687906265259
Finish gpu thread time: 0.34273481369018555
The whole process took 61.74142050743103 seconds
