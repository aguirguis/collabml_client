Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1620936393737793
Time to prepare transforms: 0.0002548694610595703
Time to download labels: 0.06348800659179688
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10036.201695360334 Mbps
Get bandwitdh took 1.2260282039642334
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03
 3.07200e+03 3.07200e+03 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1315465028.6142697 1315465028.6142697
All candidates indexes:  (array([17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 17
Intermediate:  0.0
1.1484375
Total layers size  104.47354125976562
Server, client, server+client, vanilla  357.7919921875 17669.89013671875 18027.68212890625 19392.54638671875
Fixed, scale_with_bsz  0 1.72265625
Mem usage  1654.0 3.0
Time for splitting algorithm: 5.953022718429565
Using split index: 5
Freezing the lower layers of the model (myvit) till index 17
Time to freeze model: 0.0008685588836669922
Time for model prep: 0.0023021697998046875
Time for model and splitting algorithm: 5.956213474273682
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 11, 2']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 0.3191351890563965
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 1.6429591178894043
Length of received data: 605229121
Future took 2.7207581996917725 seconds
Pickle took 0.31754255294799805 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.038585662841797 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 3.361952304840088
Dataloader took 0.33289551734924316 seconds
Streaming imagenet data took 3.3715217113494873 seconds
First stream takes: 3.4102559089660645 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08205175399780273
Time for copying to cuda: 0.12741851806640625
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2232.0, 766.0] Time: 4.782057523727417
Length of received data: 605229121
Future took 2.723708391189575 seconds
Pickle took 0.33794355392456055 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0622341632843018 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Dataloader took 0.4004690647125244 seconds
Streaming imagenet data took 3.462789535522461 seconds
Memory occupied: [2232.0, 1470.0] Time: 6.8946146965026855
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 43']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8390.0, 8012.0] Time: 8.376859188079834
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 37']
Memory occupied: [8390.0, 8012.0] Time: 9.856141805648804
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 38']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8390.0, 8012.0] Time: 11.33508563041687
Time for forward pass: 8.776722192764282
Time for backpropagation: 0.05566716194152832
GPU memory for training: 8.35290813446045                          

One training iteration takes: 9.065390586853027 seconds
Index: 0
Then, training+dataloading take 9.066747903823853 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 89, 33']

Epoch: 0
Time of next(dataloader) is: 0.1753215789794922
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 54, 23']
Time for copying to cuda: 0.16852974891662598
Memory occupied: [8390.0, 8012.0] Time: 12.834854125976562
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 25']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 14.314412117004395
Length of received data: 605229121
Future took 2.7786457538604736 seconds
Pickle took 0.3138241767883301 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.0926718711853027 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
Dataloader took 0.37662553787231445 seconds
Streaming imagenet data took 3.469412326812744 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8398.0, 8020.0] Time: 16.131040573120117
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 17.650223970413208
Time for forward pass: 5.315343141555786
Time for backpropagation: 0.00782465934753418
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.691676616668701 seconds
Index: 1
Then, training+dataloading take 5.6931750774383545 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08759260177612305
Time for copying to cuda: 0.12635254859924316
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 52']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 41']
Memory occupied: [8398.0, 8020.0] Time: 19.169682025909424
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 30']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 32']
Memory occupied: [8398.0, 8020.0] Time: 20.835023641586304
Length of received data: 605229121
Future took 2.866184949874878 seconds
Pickle took 0.3163118362426758 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.1826553344726562 seconds
Dataloader took 0.21499848365783691 seconds
Streaming imagenet data took 3.3976986408233643 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 34']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 22.37179970741272
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
Time for forward pass: 5.3602988719940186
Time for backpropagation: 0.008880376815795898
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.614529609680176 seconds
Index: 2
Then, training+dataloading take 5.6309802532196045 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 41']
Time of next(dataloader) is: 0.1260998249053955
Memory occupied: [8398.0, 8020.0] Time: 23.940988540649414
Time for copying to cuda: 0.12633943557739258
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 25.444814205169678
Length of received data: 605229121
Future took 2.7025797367095947 seconds
Pickle took 0.3168067932128906 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.076488494873047 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 48']
Dataloader took 0.3307366371154785 seconds
Streaming imagenet data took 3.407440423965454 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Memory occupied: [8398.0, 8020.0] Time: 27.404688358306885
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 28.946484327316284
Time for forward pass: 5.365938425064087
Time for backpropagation: 0.007765531539916992
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.65060567855835 seconds
Index: 3
Then, training+dataloading take 5.652025938034058 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08285212516784668
Time for copying to cuda: 0.12643837928771973
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 30.48715853691101
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 32']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 32.21019625663757
Length of received data: 605229121
Future took 2.886458158493042 seconds
Pickle took 0.31403183937072754 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.200644016265869 seconds
Dataloader took 0.21088242530822754 seconds
Streaming imagenet data took 3.4115819931030273 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 45']
Memory occupied: [8398.0, 8020.0] Time: 33.76274585723877
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 45']
Time for forward pass: 5.432715654373169
Time for backpropagation: 0.008724689483642578
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.662198305130005 seconds
Index: 4
Then, training+dataloading take 5.6624596118927 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 49, 20']
Time of next(dataloader) is: 0.1442127227783203
Memory occupied: [8398.0, 8020.0] Time: 35.33841347694397
Time for copying to cuda: 0.12718653678894043
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 31']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 36.89144968986511
Length of received data: 605229121
Future took 2.66402530670166 seconds
Pickle took 0.24895930290222168 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 2.913189649581909 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
Dataloader took 0.39168334007263184 seconds
Streaming imagenet data took 3.3049826622009277 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 45']
Memory occupied: [8398.0, 8020.0] Time: 38.62174725532532
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 45']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 40.17001938819885
Time for forward pass: 5.4150519371032715
Time for backpropagation: 0.007907629013061523
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.718979120254517 seconds
Index: 5
Then, training+dataloading take 5.722166299819946 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09145712852478027
Time for copying to cuda: 0.1280045509338379
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 55']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 41.70463967323303
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 41']
Memory occupied: [8398.0, 8020.0] Time: 43.30549693107605
Length of received data: 605229121
Future took 2.8690457344055176 seconds
Pickle took 0.3164680004119873 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 3.185656785964966 seconds
Dataloader took 0.21908283233642578 seconds
Streaming imagenet data took 3.404783010482788 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 33']
Memory occupied: [8398.0, 8020.0] Time: 44.861923694610596
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 41']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 46.41941165924072
Time for forward pass: 5.474268913269043
Time for backpropagation: 0.007764577865600586
GPU memory for training: 8.37738037109375                          

One training iteration takes: 5.7318549156188965 seconds
Index: 6
Then, training+dataloading take 5.733259677886963 seconds

Epoch: 0
Time of next(dataloader) is: 0.08313870429992676
Time for copying to cuda: 0.128129243850708
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 45']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8398.0, 8020.0] Time: 47.997233867645264
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 40']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 46']
Memory occupied: [8398.0, 8020.0] Time: 49.58003783226013
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 44']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8398.0, 8020.0] Time: 51.16425275802612
Time for forward pass: 5.4991724491119385
Time for backpropagation: 0.008309364318847656
GPU memory for training: 8.37738037109375                          

Last train takes: 5.742861270904541 seconds
Total time for streaming and training: 52.31413149833679
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 34']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8398.0, 8020.0] Time: 52.708932399749756
Finish gpu thread time: 1.3958871364593506
The whole process took 60.892579317092896 seconds
