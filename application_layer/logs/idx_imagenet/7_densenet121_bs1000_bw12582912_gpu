Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10115.575048199902 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1325868652.7176576 1325868652.7176576
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 20
Intermediate:  3.0625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 12049.71875 12244.94482421875 15686.4375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 7
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.365495920181274 seconds
Memory occpied: (1318.0, 3.0)
Streaming imagenet data took 15.566266298294067 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Time of next(dataloader) is: 2.0678558349609375
Memory occpied: (4382.0, 3.0)
Time for copying to cuda: 0.8367881774902344
Memory occpied: (4382.0, 1962.0)
Memory occpied: (4382.0, 2376.0)
Memory occpied: (10338.0, 8778.0)
Memory occpied: (10334.0, 8778.0)
Memory occpied: (10334.0, 8778.0)
Memory occpied: (6522.0, 5542.0)
Memory occpied: (9308.0, 5896.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.516860008239746 seconds
Memory occpied: (6816.0, 4512.0)
Time for forward pass: 12.308849096298218
Time for backpropagation: 0.07868432998657227
GPU memory for training: 16.164183616638184                          

One training iteration takes: 15.67028522491455 seconds
Index: 0
Memory occpied: (6232.0, 3438.0)
Streaming imagenet data took 16.224477291107178 seconds
Then, training+dataloading take 16.350581407546997 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (6232.0, 3438.0)
Time of next(dataloader) is: 2.1300394535064697
Memory occpied: (6232.0, 3438.0)
Time for copying to cuda: 0.8161017894744873
Memory occpied: (9794.0, 11602.0)
Time for forward pass: 1.0846316814422607
Time for backpropagation: 0.011682748794555664
GPU memory for training: 9.142155170440674                          

One training iteration takes: 4.443688154220581 seconds
Index: 1
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.441684246063232 seconds
Memory occpied: (9794.0, 11602.0)
Streaming imagenet data took 15.67842721939087 seconds
Then, training+dataloading take 15.804146528244019 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2551724910736084
Time for copying to cuda: 0.7685301303863525
Time for forward pass: 1.060271978378296
Time for backpropagation: 0.011370658874511719
GPU memory for training: 9.142735004425049                          

Memory occpied: (9794.0, 11602.0)
One training iteration takes: 4.57545804977417 seconds
Index: 2
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.412861824035645 seconds
Memory occpied: (9794.0, 11602.0)
Streaming imagenet data took 15.63321328163147 seconds
Then, training+dataloading take 15.794010162353516 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3219902515411377
Time for copying to cuda: 0.768657922744751
Time for forward pass: 1.080399990081787
Time for backpropagation: 0.011074066162109375
GPU memory for training: 9.142735004425049                          

Memory occpied: (9794.0, 11602.0)
One training iteration takes: 4.59611439704895 seconds
Index: 3
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.354978084564209 seconds
Memory occpied: (9794.0, 11602.0)
Streaming imagenet data took 15.661536931991577 seconds
Then, training+dataloading take 15.794196605682373 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2899343967437744
Time for copying to cuda: 0.7667732238769531
Time for forward pass: 1.0583715438842773
Time for backpropagation: 0.011182785034179688
GPU memory for training: 9.142735004425049                          

One training iteration takes: 4.590900659561157 seconds
Index: 4
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.96048092842102 seconds
Memory occpied: (9794.0, 11602.0)
Streaming imagenet data took 16.26410698890686 seconds
Then, training+dataloading take 16.39282488822937 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.302178382873535
Time for copying to cuda: 0.7670555114746094
Time for forward pass: 1.0748836994171143
Time for backpropagation: 0.011058330535888672
GPU memory for training: 9.142735004425049                          

One training iteration takes: 4.616501808166504 seconds
Index: 5
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.161558628082275 seconds
Memory occpied: (9794.0, 11602.0)
Streaming imagenet data took 15.363388538360596 seconds
Then, training+dataloading take 15.493843078613281 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.35471248626709
Time for copying to cuda: 0.7684814929962158
Time for forward pass: 1.0548248291015625
Time for backpropagation: 0.011032581329345703
GPU memory for training: 9.142735004425049                          

Memory occpied: (9794.0, 11602.0)
One training iteration takes: 4.607857704162598 seconds
Index: 6
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Memory occpied: (9794.0, 11602.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.46307635307312 seconds
Memory occpied: (9794.0, 11602.0)
Streaming imagenet data took 15.680014610290527 seconds
Then, training+dataloading take 15.809386968612671 seconds

Epoch: 0
Time of next(dataloader) is: 2.2902066707611084
Time for copying to cuda: 0.7687594890594482
Time for forward pass: 1.0699419975280762
Time for backpropagation: 0.011362791061401367
GPU memory for training: 9.142735004425049                          

Memory occpied: (9794.0, 11602.0)
The whole process took 138.93076300621033 seconds
