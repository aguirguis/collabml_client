Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=10, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1624655723571777
Time to prepare transforms: 0.00023818016052246094
Time to download labels: 0.04872870445251465
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.1120000469258 Mbps
Get bandwitdh took 1.2369072437286377
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119028056.07015066 119028056.07015066
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 10 11
Intermediate:  0.19140625
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 726.14794921875 878.02587890625 7233.96044921875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Time for splitting algorithm: 4.935694456100464
Using split index: 10
Freezing the lower layers of the model (myresnet18) till index 11
Time to freeze model: 0.00035071372985839844
Time for model prep: 0.0013225078582763672
Time for model and splitting algorithm: 4.937385559082031
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 3, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 0.3324589729309082
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 1.6645288467407227
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 3.012073516845703
Length of received data: 200751121
Future took 3.589564800262451 seconds
Pickle took 0.10616040229797363 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.6958861351013184 seconds
Dataloader took 0.07101750373840332 seconds
Streaming imagenet data took 3.7669432163238525 seconds
First stream takes: 3.779348850250244 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.057245492935180664
Time for copying to cuda: 0.042473793029785156
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 8, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1528.0, 312.0] Time: 4.3882715702056885
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1528.0, 776.0] Time: 5.79901647567749
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1528.0, 1280.0] Time: 7.254723310470581
Length of received data: 200751121
Future took 3.6419386863708496 seconds
Pickle took 0.10213327407836914 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.7442007064819336 seconds
Dataloader took 0.07103252410888672 seconds
Streaming imagenet data took 3.815274715423584 seconds
Time for forward pass: 4.241419553756714
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 93, 55']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 95, 29']
Memory occupied: [6942.0, 6800.0] Time: 8.69977593421936
Time for backpropagation: 0.8026459217071533
GPU memory for training: 7.0020527839660645                          

One training iteration takes: 5.151447534561157 seconds
Index: 0
Then, training+dataloading take 5.152005910873413 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.057381391525268555
Time for copying to cuda: 0.04183554649353027
Time for forward pass: 0.05590701103210449
Time for backpropagation: 0.0035958290100097656
GPU memory for training: 1.46870756149292                          

One training iteration takes: 0.16626548767089844 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 10.126455068588257
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 11.55784010887146
Length of received data: 200751121
Future took 3.622633934020996 seconds
Pickle took 0.10487151145935059 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.7276618480682373 seconds
Dataloader took 0.11551165580749512 seconds
Streaming imagenet data took 3.8432188034057617 seconds
Then, training+dataloading take 3.8514821529388428 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']

Epoch: 0
Time of next(dataloader) is: 0.10032963752746582
Time for copying to cuda: 0.08322930335998535
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for forward pass: 0.09842348098754883
Time for backpropagation: 0.005316495895385742
GPU memory for training: 1.46870756149292                          

One training iteration takes: 0.29227471351623535 seconds
Index: 2
Memory occupied: [3748.0, 3602.0] Time: 13.138248920440674
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 14.573605298995972
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 16.022201776504517
Length of received data: 200751121
Future took 3.648442506790161 seconds
Pickle took 0.09994196891784668 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.748547077178955 seconds
Dataloader took 0.07211041450500488 seconds
Streaming imagenet data took 3.82071590423584 seconds
Then, training+dataloading take 3.828396797180176 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05637764930725098
Time for copying to cuda: 0.04213094711303711
Time for forward pass: 0.09450864791870117
Time for backpropagation: 0.0040357112884521484
GPU memory for training: 1.46870756149292                          

One training iteration takes: 0.20470476150512695 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 27, 9']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 17.455787658691406
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 18.904009342193604
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 20.36579704284668
Length of received data: 200751121
Future took 3.7616541385650635 seconds
Pickle took 0.10098695755004883 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.862783432006836 seconds
Dataloader took 0.07092523574829102 seconds
Streaming imagenet data took 3.933753490447998 seconds
Then, training+dataloading take 3.9472179412841797 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05679917335510254
Time for copying to cuda: 0.04184150695800781
Time for forward pass: 0.09450936317443848
Time for backpropagation: 0.0038688182830810547
GPU memory for training: 1.46870756149292                          

One training iteration takes: 0.20489287376403809 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 21.801544904708862
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 23.247196912765503
Length of received data: 200751121
Future took 3.5913264751434326 seconds
Pickle took 0.1050722599029541 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.6965479850769043 seconds
Dataloader took 0.1164999008178711 seconds
Streaming imagenet data took 3.813095808029175 seconds
Then, training+dataloading take 3.8247838020324707 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0997624397277832
Time for copying to cuda: 0.08351349830627441
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 1']
Time for forward pass: 0.10314035415649414
Time for backpropagation: 0.00526738166809082
GPU memory for training: 1.46870756149292                          

One training iteration takes: 0.29661035537719727 seconds
Index: 5
Memory occupied: [3748.0, 3602.0] Time: 24.744226932525635
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 26.19243860244751
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 27.70366644859314
Length of received data: 200751121
Future took 3.675717353820801 seconds
Pickle took 0.09711480140686035 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.7729873657226562 seconds
Dataloader took 0.07063865661621094 seconds
Streaming imagenet data took 3.843672275543213 seconds
Then, training+dataloading take 3.857111692428589 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05670809745788574
Time for copying to cuda: 0.041974544525146484
Time for forward pass: 0.09453558921813965
Time for backpropagation: 0.003911733627319336
GPU memory for training: 1.46870756149292                          

One training iteration takes: 0.20509719848632812 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 16, 5']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 29.145034313201904
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3748.0, 3602.0] Time: 30.594695806503296
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 200751121
Future took 3.76977276802063 seconds
Pickle took 0.10553932189941406 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.875648260116577 seconds
Memory occupied: [3748.0, 3602.0] Time: 32.11668157577515
Dataloader took 0.07216978073120117 seconds
Streaming imagenet data took 3.9478633403778076 seconds
Then, training+dataloading take 3.9592063426971436 seconds

Epoch: 0
Time of next(dataloader) is: 0.05662822723388672
Time for copying to cuda: 0.042321205139160156
Time for forward pass: 0.09439754486083984
Time for backpropagation: 0.0038309097290039062
GPU memory for training: 1.46870756149292                          

Last train takes: 0.20459771156311035 seconds
Total time for streaming and training: 32.40434002876282
Finish gpu thread time: 0.7133498191833496
The whole process took 39.266929388046265 seconds
