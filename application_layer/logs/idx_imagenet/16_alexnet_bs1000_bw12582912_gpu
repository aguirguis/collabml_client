Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=16, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1611461639404297
Time to prepare transforms: 0.00024247169494628906
Time to download labels: 0.05107283592224121
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10131.960821640705 Mbps
Get bandwitdh took 1.2303833961486816
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1328016368.8140905 1328016368.8140905
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 16 17
Intermediate:  0.015625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 381.71142578125 647.98876953125 2417.35595703125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.212244272232056
Using split index: 16
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.00022125244140625
Time for model prep: 0.000789642333984375
Time for model and splitting algorithm: 5.213273525238037
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.3194468021392822
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 16420362
Future took 1.5489511489868164 seconds
Pickle took 0.010439634323120117 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.559560775756836 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.037818193435668945 seconds
Streaming imagenet data took 1.5974338054656982 seconds
First stream takes: 1.6006014347076416 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.012387514114379883
Time for copying to cuda: 0.00406336784362793
Memory occupied: [1514.0, 15.0] Time: 1.6559243202209473
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Length of received data: 16420362
Future took 1.4108426570892334 seconds
Pickle took 0.013664722442626953 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.4246764183044434 seconds
Dataloader took 0.007659196853637695 seconds
Streaming imagenet data took 1.432387351989746 seconds
Memory occupied: [1530.0, 590.0] Time: 3.0346415042877197
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1530.0, 1092.0] Time: 4.4434826374053955
Time for forward pass: 3.2949533462524414
Time for backpropagation: 0.0492243766784668
GPU memory for training: 0.9570660591125488                          

One training iteration takes: 3.362032175064087 seconds
Index: 0
Then, training+dataloading take 3.362088203430176 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.006017923355102539
Time for copying to cuda: 0.018980979919433594
Time for forward pass: 0.031194686889648438
Time for backpropagation: 0.0026488304138183594
GPU memory for training: 1.1122322082519531                          

One training iteration takes: 0.05986833572387695 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 5.857525587081909
Length of received data: 16420362
Future took 1.502467393875122 seconds
Pickle took 0.009735107421875 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.5123119354248047 seconds
Dataloader took 0.006250619888305664 seconds
Streaming imagenet data took 1.518611192703247 seconds
Then, training+dataloading take 1.5191302299499512 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007382869720458984
Time for copying to cuda: 0.003683328628540039
Time for forward pass: 0.030792713165283203
Time for backpropagation: 0.0021402835845947266
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.045053720474243164 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 7.276244163513184
Length of received data: 16420362
Future took 1.404876708984375 seconds
Pickle took 0.0078089237213134766 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.4128074645996094 seconds
Dataloader took 0.006410121917724609 seconds
Streaming imagenet data took 1.4192559719085693 seconds
Then, training+dataloading take 1.4198155403137207 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007409572601318359
Time for copying to cuda: 0.003676891326904297
Time for forward pass: 0.03091573715209961
Time for backpropagation: 0.0021233558654785156
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.04521369934082031 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 8.691703796386719
Length of received data: 16420362
Future took 1.4093751907348633 seconds
Pickle took 0.007930994033813477 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.4174275398254395 seconds
Dataloader took 0.004212379455566406 seconds
Streaming imagenet data took 1.4216814041137695 seconds
Then, training+dataloading take 1.4222261905670166 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007613182067871094
Time for copying to cuda: 0.0036656856536865234
Time for forward pass: 0.030901670455932617
Time for backpropagation: 0.002402782440185547
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.045671701431274414 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 10.11127781867981
Length of received data: 16420362
Future took 1.4023032188415527 seconds
Pickle took 0.007973194122314453 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.410398006439209 seconds
Dataloader took 0.004160404205322266 seconds
Streaming imagenet data took 1.4145958423614502 seconds
Then, training+dataloading take 1.4151654243469238 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007369041442871094
Time for copying to cuda: 0.003655672073364258
Time for forward pass: 0.03087306022644043
Time for backpropagation: 0.0021364688873291016
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.045133352279663086 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 11.531980276107788
Length of received data: 16420362
Future took 1.3856406211853027 seconds
Pickle took 0.007837295532226562 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.393601417541504 seconds
Dataloader took 0.006907463073730469 seconds
Streaming imagenet data took 1.400547742843628 seconds
Then, training+dataloading take 1.40110445022583 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007627010345458984
Time for copying to cuda: 0.0036437511444091797
Time for forward pass: 0.030953645706176758
Time for backpropagation: 0.002191305160522461
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.04546499252319336 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 12.951188325881958
Length of received data: 16420362
Future took 1.3976304531097412 seconds
Pickle took 0.007950544357299805 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.4057040214538574 seconds
Dataloader took 0.004150867462158203 seconds
Streaming imagenet data took 1.4098927974700928 seconds
Then, training+dataloading take 1.4106662273406982 seconds

Epoch: 0
Time of next(dataloader) is: 0.007395744323730469
Time for copying to cuda: 0.0036940574645996094
Time for forward pass: 0.030921459197998047
Time for backpropagation: 0.0022003650665283203
GPU memory for training: 1.1125984191894531                          

Last train takes: 0.04488992691040039 seconds
Total time for streaming and training: 13.595851182937622
Finish gpu thread time: 0.35636234283447266
The whole process took 20.378352642059326 seconds
