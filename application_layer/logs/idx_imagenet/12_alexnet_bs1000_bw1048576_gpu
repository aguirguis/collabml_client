Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=12, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1606972217559814
Time to prepare transforms: 0.00023984909057617188
Time to download labels: 0.04917430877685547
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6506054163809 Mbps
Get bandwitdh took 1.2344074249267578
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119098652.15313588 119098652.15313588
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 12 17
Intermediate:  0.1650390625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 700.07080078125 966.34814453125 2586.30126953125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.217355728149414
Using split index: 12
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.0002167224884033203
Time for model prep: 0.0007870197296142578
Time for model and splitting algorithm: 5.21837854385376
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.3271925449371338
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.657486915588379
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 3.015791177749634
Length of received data: 173103121
Future took 3.0944294929504395 seconds
Pickle took 0.09180927276611328 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.186392068862915 seconds
Dataloader took 0.061255455017089844 seconds
Streaming imagenet data took 3.2476859092712402 seconds
First stream takes: 3.258911371231079 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0539705753326416
Time for copying to cuda: 0.03717613220214844
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1680.0, 534.0] Time: 4.422526121139526
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1680.0, 1006.0] Time: 5.875988483428955
Length of received data: 173103121
Future took 3.302553176879883 seconds
Pickle took 0.09893631935119629 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.401643991470337 seconds
Dataloader took 0.06393933296203613 seconds
Streaming imagenet data took 3.4656245708465576 seconds
Time for forward pass: 3.425513744354248
Time for backpropagation: 0.049698829650878906
GPU memory for training: 1.2120437622070312                          

One training iteration takes: 3.57473087310791 seconds
Index: 0
Then, training+dataloading take 3.5752038955688477 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09776878356933594
Time for copying to cuda: 0.0368344783782959
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 45, 9']
Time for forward pass: 0.061739444732666016
Time for backpropagation: 0.004379749298095703
GPU memory for training: 1.367194652557373                          

One training iteration takes: 0.2048637866973877 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 18, 4']
Memory occupied: [2420.0, 1642.0] Time: 7.311503171920776
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 8.727304697036743
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 10.168875694274902
Length of received data: 173103121
Future took 3.369105100631714 seconds
Pickle took 0.09104299545288086 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.4602911472320557 seconds
Dataloader took 0.062097787857055664 seconds
Streaming imagenet data took 3.5224337577819824 seconds
Then, training+dataloading take 3.5304324626922607 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05392909049987793
Time for copying to cuda: 0.036570072174072266
Time for forward pass: 0.05523562431335449
Time for backpropagation: 0.002150297164916992
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.15585732460021973 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 11.605194091796875
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 13.05112099647522
Length of received data: 173103121
Future took 3.3013076782226562 seconds
Pickle took 0.07142782211303711 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.3728721141815186 seconds
Dataloader took 0.06190824508666992 seconds
Streaming imagenet data took 3.4348268508911133 seconds
Then, training+dataloading take 3.445849657058716 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.053795814514160156
Time for copying to cuda: 0.03664588928222656
Time for forward pass: 0.05539655685424805
Time for backpropagation: 0.0024607181549072266
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.1562938690185547 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 42, 9']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 14.486193418502808
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 15.938409805297852
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 173103121
Future took 3.4182636737823486 seconds
Pickle took 0.09694743156433105 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.515495777130127 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.10492229461669922 seconds
Streaming imagenet data took 3.6204705238342285 seconds
Then, training+dataloading take 3.6304097175598145 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occupied: [2420.0, 1642.0] Time: 17.4420428276062
Time of next(dataloader) is: 0.05392765998840332
Time for copying to cuda: 0.03693270683288574
Time for forward pass: 0.05534696578979492
Time for backpropagation: 0.002254486083984375
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.15653300285339355 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 18.87112331390381
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 20.31177020072937
Length of received data: 173103121
Future took 3.334524393081665 seconds
Pickle took 0.08355283737182617 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.4182145595550537 seconds
Dataloader took 0.061693429946899414 seconds
Streaming imagenet data took 3.479951858520508 seconds
Then, training+dataloading take 3.491147041320801 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05408167839050293
Time for copying to cuda: 0.036672115325927734
Time for forward pass: 0.055291175842285156
Time for backpropagation: 0.002164602279663086
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.15628457069396973 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 21.743077278137207
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 23.201448917388916
Length of received data: 173103121
Future took 3.3434808254241943 seconds
Pickle took 0.08897280693054199 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.4327239990234375 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.10573792457580566 seconds
Streaming imagenet data took 3.538513422012329 seconds
Then, training+dataloading take 3.54854679107666 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09579682350158691
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.07784509658813477
Time for forward pass: 0.055831193923950195
Time for backpropagation: 0.0022792816162109375
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.24001169204711914 seconds
Index: 6
Memory occupied: [2420.0, 1642.0] Time: 24.720963716506958
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 26.15268874168396
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 27.600086212158203
Length of received data: 173103121
Future took 3.377593994140625 seconds
Pickle took 0.08343696594238281 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.4611668586730957 seconds
Dataloader took 0.06172633171081543 seconds
Streaming imagenet data took 3.522937774658203 seconds
Then, training+dataloading take 3.5341522693634033 seconds

Epoch: 0
Time of next(dataloader) is: 0.05393242835998535
Time for copying to cuda: 0.036779165267944336
Time for forward pass: 0.05539059638977051
Time for backpropagation: 0.0022881031036376953
GPU memory for training: 1.367560863494873                          

Last train takes: 0.15604448318481445 seconds
Total time for streaming and training: 28.170892238616943
Finish gpu thread time: 0.43024587631225586
The whole process took 35.03002715110779 seconds
