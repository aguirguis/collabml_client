Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=32, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9942.464604452925 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1303178720.6348538 1303178720.6348538
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 32 36
Intermediate:  0.3828125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 2274.80224609375 3224.41259765625 26966.20849609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 32
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 12.57336711883545 seconds
Streaming imagenet data took 12.753236055374146 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Time of next(dataloader) is: 0.5420162677764893
Time for copying to cuda: 0.0982828140258789
Memory occpied: (2278.0, 528.0)
Memory occpied: (2278.0, 978.0)
Memory occpied: (2278.0, 1424.0)
Memory occpied: (5858.0, 5418.0)
Time for forward pass: 4.463110446929932
Time for backpropagation: 0.0551450252532959
GPU memory for training: 8.285820960998535                          

One training iteration takes: 5.272254705429077 seconds
Index: 0
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 12.870505332946777 seconds
Streaming imagenet data took 13.013316631317139 seconds
Then, training+dataloading take 13.038063049316406 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6466944217681885
Time for copying to cuda: 0.09829950332641602
Time for forward pass: 0.27352046966552734
Time for backpropagation: 0.0041391849517822266
GPU memory for training: 5.584290504455566                          

Memory occpied: (3824.0, 5426.0)
One training iteration takes: 1.1621687412261963 seconds
Index: 1
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 12.69365382194519 seconds
Streaming imagenet data took 12.834241151809692 seconds
Then, training+dataloading take 12.857693672180176 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5848326683044434
Time for copying to cuda: 0.09837126731872559
Time for forward pass: 0.2736649513244629
Time for backpropagation: 0.004061460494995117
GPU memory for training: 5.584290504455566                          

One training iteration takes: 1.0899572372436523 seconds
Index: 2
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 12.719804286956787 seconds
Streaming imagenet data took 12.860497951507568 seconds
Then, training+dataloading take 12.883854389190674 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5821571350097656
Time for copying to cuda: 0.09823012351989746
Time for forward pass: 0.27396535873413086
Time for backpropagation: 0.004137516021728516
GPU memory for training: 5.584290504455566                          

One training iteration takes: 1.0851716995239258 seconds
Index: 3
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 12.78986644744873 seconds
Streaming imagenet data took 12.933666944503784 seconds
Then, training+dataloading take 12.957107067108154 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5921845436096191
Time for copying to cuda: 0.09888863563537598
Time for forward pass: 0.2530088424682617
Time for backpropagation: 0.004040241241455078
GPU memory for training: 5.584290504455566                          

One training iteration takes: 1.0748956203460693 seconds
Index: 4
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 12.830393314361572 seconds
Streaming imagenet data took 13.01704740524292 seconds
Then, training+dataloading take 13.026384592056274 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6254298686981201
Time for copying to cuda: 0.09819579124450684
Time for forward pass: 0.2544097900390625
Time for backpropagation: 0.004065275192260742
GPU memory for training: 5.584290504455566                          

Memory occpied: (5422.0, 5434.0)
One training iteration takes: 1.0956816673278809 seconds
Index: 5
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 12.801563501358032 seconds
Streaming imagenet data took 12.942631006240845 seconds
Then, training+dataloading take 12.958154916763306 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (5422.0, 5434.0)
Time of next(dataloader) is: 0.6412906646728516
Time for copying to cuda: 0.09762120246887207
Time for forward pass: 0.2727184295654297
Time for backpropagation: 0.004059791564941406
GPU memory for training: 5.584290504455566                          

One training iteration takes: 1.1517703533172607 seconds
Index: 6
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Memory occpied: (5422.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 12.958455801010132 seconds
Streaming imagenet data took 13.100665092468262 seconds
Then, training+dataloading take 13.124338626861572 seconds

Epoch: 0
Time of next(dataloader) is: 0.5509607791900635
Memory occpied: (5422.0, 5434.0)
Time for copying to cuda: 0.09860014915466309
Time for forward pass: 0.2739593982696533
Time for backpropagation: 0.004033803939819336
GPU memory for training: 5.584290504455566                          

The whole process took 113.13136696815491 seconds
