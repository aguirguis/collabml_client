Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9870.238635693393 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1293711918.4576044 1293711918.4576044
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 11
Intermediate:  0.3828125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 1396.06982421875 1547.94775390625 7712.47607421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 7
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 2.464491128921509 seconds
Memory occpied: (1336.0, 3.0)
Streaming imagenet data took 2.679403305053711 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5133397579193115
Time for copying to cuda: 0.09862756729125977
Memory occpied: (1720.0, 444.0)
Length of received data: 401454121
Memory occpied: (1720.0, 846.0)
Read 382.856484413147 MBs for this batch
Executing all posts took 2.6193158626556396 seconds
Streaming imagenet data took 2.7656524181365967 seconds
Memory occpied: (1720.0, 1408.0)
Memory occpied: (6854.0, 8788.0)
Time for forward pass: 4.709192991256714
Time for backpropagation: 0.7928726673126221
GPU memory for training: 7.353196620941162                          

One training iteration takes: 6.205954313278198 seconds
Index: 0
Then, training+dataloading take 6.206225872039795 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (1930.0, 4902.0)
Time of next(dataloader) is: 0.5472819805145264
Time for copying to cuda: 0.09776496887207031
Time for forward pass: 0.1676497459411621
Time for backpropagation: 0.004660367965698242
GPU memory for training: 2.951697826385498                          

One training iteration takes: 0.9392640590667725 seconds
Index: 1
Memory occpied: (3474.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 2.3765861988067627 seconds
Streaming imagenet data took 2.6129493713378906 seconds
Then, training+dataloading take 2.637754440307617 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000

Memory occpied: (3474.0, 4918.0)

Epoch: 0
Time of next(dataloader) is: 0.5667457580566406
Time for copying to cuda: 0.09782266616821289
Time for forward pass: 0.23453140258789062
Time for backpropagation: 0.00463557243347168
GPU memory for training: 2.951697826385498                          

One training iteration takes: 1.0088269710540771 seconds
Index: 2
Memory occpied: (3474.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 2.512636661529541 seconds
Streaming imagenet data took 2.7057299613952637 seconds
Memory occpied: (3474.0, 4918.0)
Then, training+dataloading take 2.7309370040893555 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5526657104492188
Time for copying to cuda: 0.0974893569946289
Time for forward pass: 0.24151062965393066
Time for backpropagation: 0.004554271697998047
GPU memory for training: 2.951697826385498                          

One training iteration takes: 1.0136656761169434 seconds
Index: 3
Memory occpied: (3474.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 2.5178587436676025 seconds
Streaming imagenet data took 2.7095065116882324 seconds
Memory occpied: (3474.0, 4918.0)
Then, training+dataloading take 2.734494209289551 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5605762004852295
Time for copying to cuda: 0.09705185890197754
Time for forward pass: 0.24535441398620605
Time for backpropagation: 0.004685640335083008
GPU memory for training: 2.951697826385498                          

One training iteration takes: 1.0250320434570312 seconds
Index: 4
Memory occpied: (3474.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 2.5299036502838135 seconds
Streaming imagenet data took 2.7185585498809814 seconds
Memory occpied: (3474.0, 4918.0)
Then, training+dataloading take 2.743323564529419 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5528779029846191
Time for copying to cuda: 0.09786176681518555
Time for forward pass: 0.2484281063079834
Time for backpropagation: 0.004682779312133789
GPU memory for training: 2.951697826385498                          

One training iteration takes: 1.0109477043151855 seconds
Index: 5
Memory occpied: (3474.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 2.4702632427215576 seconds
Streaming imagenet data took 2.7065298557281494 seconds
Memory occpied: (3474.0, 4918.0)
Then, training+dataloading take 2.731415033340454 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5676126480102539
Time for copying to cuda: 0.09756159782409668
Time for forward pass: 0.24512410163879395
Time for backpropagation: 0.004698753356933594
GPU memory for training: 2.951697826385498                          

One training iteration takes: 1.025172233581543 seconds
Index: 6
Memory occpied: (3474.0, 4918.0)
Length of received data: 401454121
Read 382.856484413147 MBs for this batch
Executing all posts took 2.5281898975372314 seconds
Memory occpied: (3474.0, 4918.0)
Streaming imagenet data took 2.7173917293548584 seconds
Then, training+dataloading take 2.741419792175293 seconds

Epoch: 0
Time of next(dataloader) is: 0.5582060813903809
Time for copying to cuda: 0.0985100269317627
Time for forward pass: 0.23186349868774414
Time for backpropagation: 0.004641532897949219
GPU memory for training: 2.951697826385498                          

Memory occpied: (3474.0, 4918.0)
The whole process took 33.519423484802246 seconds
