Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=8, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5068820685453 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119079814.04648837 119079814.04648837
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 8 25
Intermediate:  3.0625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 9796.08837890625 10704.48486328125 31807.80712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 8
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 38.074432611465454 seconds
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 39.26231384277344 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.1620678901672363
Time for copying to cuda: 0.7770528793334961
Time for forward pass: 11.362056255340576
Time for backpropagation: 0.06998705863952637
GPU memory for training: 22.27123260498047                          

Memory occpied: (1840.0, 3.0)
One training iteration takes: 14.799960851669312 seconds
Index: 0
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 38.27349090576172 seconds
Memory occpied: (6396.0, 11914.0)
Streaming imagenet data took 39.59324264526367 seconds
Then, training+dataloading take 39.73797130584717 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (6396.0, 11914.0)
Memory occpied: (6396.0, 11914.0)
Time of next(dataloader) is: 2.216653823852539
Memory occpied: (6396.0, 11914.0)
Time for copying to cuda: 0.8659839630126953
Time for forward pass: 0.9031615257263184
Time for backpropagation: 0.003688812255859375
GPU memory for training: 15.245147705078125                          

Memory occpied: (11148.0, 11922.0)
One training iteration takes: 4.484320878982544 seconds
Index: 1
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 39.07797312736511 seconds
Memory occpied: (11148.0, 11922.0)
Streaming imagenet data took 40.390822410583496 seconds
Then, training+dataloading take 40.5856499671936 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.199345111846924
Time for copying to cuda: 0.7757489681243896
Time for forward pass: 0.8249807357788086
Time for backpropagation: 0.003105640411376953
GPU memory for training: 15.245147705078125                          

One training iteration takes: 4.250120162963867 seconds
Index: 2
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 38.514283418655396 seconds
Memory occpied: (11148.0, 11922.0)
Streaming imagenet data took 39.81469249725342 seconds
Then, training+dataloading take 39.99439787864685 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Time of next(dataloader) is: 2.1939258575439453
Memory occpied: (11148.0, 11922.0)
Time for copying to cuda: 0.856419563293457
Time for forward pass: 0.8836541175842285
Time for backpropagation: 0.003721952438354492
GPU memory for training: 15.245147705078125                          

Memory occpied: (11148.0, 11922.0)
One training iteration takes: 4.362639427185059 seconds
Index: 3
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 38.627169132232666 seconds
Memory occpied: (11148.0, 11922.0)
Streaming imagenet data took 39.923901081085205 seconds
Then, training+dataloading take 39.99067449569702 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.207010269165039
Time for copying to cuda: 0.776108980178833
Time for forward pass: 0.8422155380249023
Time for backpropagation: 0.0031707286834716797
GPU memory for training: 15.245147705078125                          

Memory occpied: (11148.0, 11922.0)
One training iteration takes: 4.24584698677063 seconds
Index: 4
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 38.72158980369568 seconds
Memory occpied: (11148.0, 11922.0)
Streaming imagenet data took 40.038411140441895 seconds
Then, training+dataloading take 40.192140340805054 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2113912105560303
Time for copying to cuda: 0.777987003326416
Time for forward pass: 0.8401751518249512
Time for backpropagation: 0.0031883716583251953
GPU memory for training: 15.245147705078125                          

Memory occpied: (11148.0, 11922.0)
One training iteration takes: 4.2969183921813965 seconds
Index: 5
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 38.719215869903564 seconds
Memory occpied: (11148.0, 11922.0)
Streaming imagenet data took 40.01569437980652 seconds
Then, training+dataloading take 40.166380167007446 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Time of next(dataloader) is: 2.203326463699341
Memory occpied: (11148.0, 11922.0)
Time for copying to cuda: 0.874107837677002
Time for forward pass: 0.8424010276794434
Time for backpropagation: 0.003719329833984375
GPU memory for training: 15.245147705078125                          

One training iteration takes: 4.414304256439209 seconds
Index: 6
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Memory occpied: (11148.0, 11922.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 38.68013882637024 seconds
Memory occpied: (11148.0, 11922.0)
Streaming imagenet data took 39.98360228538513 seconds
Then, training+dataloading take 40.14338493347168 seconds

Epoch: 0
Time of next(dataloader) is: 2.235948324203491
Time for copying to cuda: 0.7707605361938477
Time for forward pass: 0.8463516235351562
Time for backpropagation: 0.003197908401489258
GPU memory for training: 15.245147705078125                          

Memory occpied: (11148.0, 11922.0)
The whole process took 332.9729619026184 seconds
