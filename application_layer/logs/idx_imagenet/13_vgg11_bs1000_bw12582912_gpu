Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=13, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9924.095419005795 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1300771034.7599275 1300771034.7599275
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 13 25
Intermediate:  1.53125
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 5202.33837890625 6110.73486328125 28745.30712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 13
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 10.016638994216919 seconds
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 10.689280271530151 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1840.0, 3.0)
Time of next(dataloader) is: 1.1375350952148438
Time for copying to cuda: 0.3886241912841797
Memory occpied: (3372.0, 942.0)
Memory occpied: (3372.0, 1358.0)
Memory occpied: (3372.0, 1818.0)
Memory occpied: (11432.0, 10200.0)
Memory occpied: (11432.0, 10200.0)
Memory occpied: (10980.0, 10200.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 10.004921674728394 seconds
Time for forward pass: 8.570920944213867
Time for backpropagation: 0.054750919342041016
GPU memory for training: 18.18993377685547                          

One training iteration takes: 10.2841317653656 seconds
Index: 0
Memory occpied: (10990.0, 10208.0)
Streaming imagenet data took 10.763810396194458 seconds
Then, training+dataloading take 10.810325860977173 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (10990.0, 10208.0)
Time of next(dataloader) is: 1.3042991161346436
Time for copying to cuda: 0.38964104652404785
Memory occpied: (10998.0, 10216.0)
Time for forward pass: 0.4595522880554199
Time for backpropagation: 0.0033423900604248047
GPU memory for training: 11.505035400390625                          

One training iteration takes: 2.426800489425659 seconds
Index: 1
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 9.524457931518555 seconds
Memory occpied: (10998.0, 10216.0)
Streaming imagenet data took 10.217355251312256 seconds
Then, training+dataloading take 10.312430143356323 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (10998.0, 10216.0)
Time of next(dataloader) is: 1.2027373313903809
Time for copying to cuda: 0.3914320468902588
Memory occpied: (10998.0, 10216.0)
Time for forward pass: 0.45088982582092285
Time for backpropagation: 0.0033025741577148438
GPU memory for training: 11.505035400390625                          

One training iteration takes: 2.2935545444488525 seconds
Index: 2
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 10.044921875 seconds
Memory occpied: (10998.0, 10216.0)
Streaming imagenet data took 10.73012661933899 seconds
Then, training+dataloading take 10.783133506774902 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (10998.0, 10216.0)
Time of next(dataloader) is: 1.2909634113311768
Time for copying to cuda: 0.3856782913208008
Memory occpied: (10998.0, 10216.0)
Time for forward pass: 0.4517223834991455
Time for backpropagation: 0.00327301025390625
GPU memory for training: 11.505035400390625                          

One training iteration takes: 2.396090269088745 seconds
Index: 3
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 9.867666721343994 seconds
Memory occpied: (10998.0, 10216.0)
Streaming imagenet data took 10.491709470748901 seconds
Then, training+dataloading take 10.552443981170654 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (10998.0, 10216.0)
Time of next(dataloader) is: 1.2477035522460938
Time for copying to cuda: 0.38616251945495605
Memory occpied: (10998.0, 10216.0)
Time for forward pass: 0.4870951175689697
Time for backpropagation: 0.0033130645751953125
GPU memory for training: 11.505035400390625                          

One training iteration takes: 2.3854384422302246 seconds
Index: 4
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 9.896859884262085 seconds
Memory occpied: (10998.0, 10216.0)
Streaming imagenet data took 10.580299854278564 seconds
Then, training+dataloading take 10.628619194030762 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (10998.0, 10216.0)
Time of next(dataloader) is: 1.2949776649475098
Time for copying to cuda: 0.386568546295166
Memory occpied: (10998.0, 10216.0)
Time for forward pass: 0.47364139556884766
Time for backpropagation: 0.003254413604736328
GPU memory for training: 11.505035400390625                          

One training iteration takes: 2.4210004806518555 seconds
Index: 5
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 9.898145914077759 seconds
Memory occpied: (10998.0, 10216.0)
Streaming imagenet data took 10.588759899139404 seconds
Then, training+dataloading take 10.668817281723022 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (10998.0, 10216.0)
Time of next(dataloader) is: 1.241896390914917
Time for copying to cuda: 0.3886904716491699
Memory occpied: (10998.0, 10216.0)
Time for forward pass: 0.4827280044555664
Time for backpropagation: 0.0033376216888427734
GPU memory for training: 11.505035400390625                          

One training iteration takes: 2.3546698093414307 seconds
Index: 6
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Memory occpied: (10998.0, 10216.0)
Length of received data: 1605679121
Read 1531.2949380874634 MBs for this batch
Executing all posts took 9.914484024047852 seconds
Memory occpied: (10998.0, 10216.0)
Streaming imagenet data took 10.596758365631104 seconds
Then, training+dataloading take 10.643831968307495 seconds

Epoch: 0
Memory occpied: (10998.0, 10216.0)
Time of next(dataloader) is: 1.287062644958496
Time for copying to cuda: 0.38393282890319824
Memory occpied: (10998.0, 10216.0)
Time for forward pass: 0.46915125846862793
Time for backpropagation: 0.0032041072845458984
GPU memory for training: 11.505035400390625                          

The whole process took 96.07526874542236 seconds
