Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=15, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1611382961273193
Time to prepare transforms: 0.00024819374084472656
Time to download labels: 0.06241893768310547
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9999.604732698397 Mbps
Get bandwitdh took 1.234168529510498
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1310668191.5242443 1310668191.5242443
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 15 20
Intermediate:  0.765625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 6690.34375 6885.56982421875 12623.9375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.933149576187134
Using split index: 15
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015454292297363281
Time for model prep: 0.00455021858215332
Time for model and splitting algorithm: 4.9392828941345215
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.3317413330078125
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6635401248931885
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 2.9980406761169434
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 4.328777551651001
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 802863121
Future took 5.982378244400024 seconds
Pickle took 0.4200766086578369 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.40266489982605 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 6.6322855949401855
Dataloader took 0.3734476566314697 seconds
Streaming imagenet data took 6.776150226593018 seconds
First stream takes: 6.821573972702026 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10134482383728027
Time for copying to cuda: 0.16944050788879395
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2084.0, 772.0] Time: 8.06707763671875
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2084.0, 1306.0] Time: 9.526587963104248
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 73, 17']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 89, 28']
Memory occupied: [4948.0, 4538.0] Time: 10.997700214385986
Time for forward pass: 4.5365891456604
Time for backpropagation: 0.07802772521972656
GPU memory for training: 6.757872581481934                          

One training iteration takes: 4.913547515869141 seconds
Index: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 802863121
Future took 6.089087963104248 seconds
Memory occupied: [2698.0, 4570.0] Time: 13.327985525131226
Pickle took 0.416989803314209 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.506224155426025 seconds
Dataloader took 0.2804105281829834 seconds
Streaming imagenet data took 6.786684513092041 seconds
Then, training+dataloading take 6.819735288619995 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09917640686035156
Time for copying to cuda: 0.16834235191345215
Time for forward pass: 0.22055959701538086
Time for backpropagation: 0.010515451431274414
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 0.5249602794647217 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 14.75706958770752
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 16.186765670776367
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 17.61812925338745
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 19.226978063583374
Length of received data: 802863121
Future took 6.093753337860107 seconds
Pickle took 0.4167215824127197 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.510634899139404 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.44214391708374023 seconds
Streaming imagenet data took 6.952852725982666 seconds
Then, training+dataloading take 6.971189260482788 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.1682577133178711
Memory occupied: [2906.0, 4586.0] Time: 20.875867128372192
Time for copying to cuda: 0.17489171028137207
Time for forward pass: 0.18572497367858887
Time for backpropagation: 0.010796070098876953
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 0.5666611194610596 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 22.329742670059204
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 23.7842116355896
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 25.2404522895813
Length of received data: 802863121
Future took 5.939037322998047 seconds
Pickle took 0.405963659286499 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.345326662063599 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 27.365614891052246
Dataloader took 0.43982577323913574 seconds
Streaming imagenet data took 6.785205125808716 seconds
Then, training+dataloading take 6.823074817657471 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10449337959289551
Time for copying to cuda: 0.16892552375793457
Time for forward pass: 0.185699462890625
Time for backpropagation: 0.01047658920288086
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 0.4952361583709717 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 28.8227219581604
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 30.27797555923462
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 31.73384380340576
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 802863121
Future took 6.000810623168945 seconds
Pickle took 0.380932092666626 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.381953954696655 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 34.09049344062805
Dataloader took 0.38738584518432617 seconds
Streaming imagenet data took 6.769383192062378 seconds
Then, training+dataloading take 6.807240962982178 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10368824005126953
Time for copying to cuda: 0.16904377937316895
Time for forward pass: 0.1857452392578125
Time for backpropagation: 0.010534286499023438
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 0.4947052001953125 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 35.54502773284912
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 37.00303101539612
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 38.45785093307495
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 802863121
Memory occupied: [2906.0, 4586.0] Time: 40.32627511024475
Future took 6.083191156387329 seconds
Pickle took 0.3810451030731201 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.464371919631958 seconds
Dataloader took 0.285172700881958 seconds
Streaming imagenet data took 6.749590873718262 seconds
Then, training+dataloading take 6.786766529083252 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09504938125610352
Time for copying to cuda: 0.16921710968017578
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 32, 2']
Time for forward pass: 0.20729923248291016
Time for backpropagation: 0.011727333068847656
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 0.4952239990234375 seconds
Index: 5
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 31, 23']
Memory occupied: [2906.0, 4586.0] Time: 41.809751749038696
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 43.246349573135376
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 44.683260917663574
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 46.12950015068054
Length of received data: 802863121
Future took 6.078736782073975 seconds
Pickle took 0.4100360870361328 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.488937139511108 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4968719482421875 seconds
Streaming imagenet data took 6.985887765884399 seconds
Then, training+dataloading take 7.007184267044067 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10419106483459473
Memory occupied: [2906.0, 4586.0] Time: 48.143752098083496
Time for copying to cuda: 0.16941094398498535
Time for forward pass: 0.1891634464263916
Time for backpropagation: 0.010518312454223633
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 0.5007326602935791 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 49.58337736129761
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 51.02060627937317
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2906.0, 4586.0] Time: 52.45934176445007
Length of received data: 802863121
Future took 5.923121213912964 seconds
Pickle took 0.4099564552307129 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.387057542800903 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4397737979888916 seconds
Streaming imagenet data took 6.826960802078247 seconds
Then, training+dataloading take 6.8451087474823 seconds

Epoch: 0
Time of next(dataloader) is: 0.10396194458007812
Memory occupied: [2906.0, 4586.0] Time: 54.99105358123779
Time for copying to cuda: 0.16931891441345215
Time for forward pass: 0.18920540809631348
Time for backpropagation: 0.01045680046081543
GPU memory for training: 2.3231425285339355                          

Last train takes: 0.4989902973175049 seconds
Total time for streaming and training: 55.38110661506653
Finish gpu thread time: 0.6109893321990967
The whole process took 62.15558838844299 seconds
