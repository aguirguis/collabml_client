Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=6, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1617984771728516
Time to prepare transforms: 0.00024127960205078125
Time to download labels: 0.04653668403625488
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9779.947566333174 Mbps
Get bandwitdh took 1.239027500152588
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1281877287.4144218 1281877287.4144218
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 6 11
Intermediate:  0.765625
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 2161.69482421875 2313.57275390625 8095.28857421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Time for splitting algorithm: 4.9174888134002686
Using split index: 6
Freezing the lower layers of the model (myresnet18) till index 11
Time to freeze model: 0.00034499168395996094
Time for model prep: 0.001341104507446289
Time for model and splitting algorithm: 4.919193267822266
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 3, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 0.33440685272216797
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 1.6642463207244873
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 3.031419515609741
Length of received data: 802862121
Future took 3.716426134109497 seconds
Pickle took 0.4129161834716797 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 4.12955117225647 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 4.583952903747559
Dataloader took 0.4553656578063965 seconds
Streaming imagenet data took 4.5849504470825195 seconds
First stream takes: 4.615391969680786 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10173892974853516
Time for copying to cuda: 0.1686553955078125
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 1, 0']
Memory occupied: [2102.0, 856.0] Time: 6.055180788040161
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 4, 0']
Memory occupied: [2102.0, 1482.0] Time: 7.89756178855896
Length of received data: 802862121
Future took 3.4907896518707275 seconds
Pickle took 0.41931796073913574 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.910259246826172 seconds
Dataloader took 0.28755688667297363 seconds
Streaming imagenet data took 4.197863340377808 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 78, 29']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 77, 52']
Memory occupied: [4694.0, 3910.0] Time: 9.393733978271484
Time for forward pass: 5.322119474411011
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 62']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 97, 66']
Memory occupied: [6122.0, 5764.0] Time: 10.887711763381958
Time for backpropagation: 0.787879228591919
GPU memory for training: 7.913743495941162                          

One training iteration takes: 6.405777454376221 seconds
Index: 0
Then, training+dataloading take 6.407508850097656 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09608864784240723
Time for copying to cuda: 0.16738128662109375
Time for forward pass: 0.22465872764587402
Time for backpropagation: 0.0038216114044189453
GPU memory for training: 3.818366527557373                          

One training iteration takes: 0.5173537731170654 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 12.319808959960938
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 13.785957098007202
Length of received data: 802862121
Future took 3.4560511112213135 seconds
Pickle took 0.4194929599761963 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.875706195831299 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.5021975040435791 seconds
Streaming imagenet data took 4.377972602844238 seconds
Then, training+dataloading take 4.398919105529785 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [6142.0, 3432.0] Time: 15.511548519134521
Time of next(dataloader) is: 0.10345768928527832
Time for copying to cuda: 0.16756534576416016
Time for forward pass: 0.3074653148651123
Time for backpropagation: 0.004111289978027344
GPU memory for training: 3.818366527557373                          

One training iteration takes: 0.608698844909668 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 16.950173377990723
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 18.59800958633423
Length of received data: 802862121
Future took 3.4824159145355225 seconds
Pickle took 0.40974950790405273 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.8923051357269287 seconds
Dataloader took 0.33946704864501953 seconds
Streaming imagenet data took 4.2318596839904785 seconds
Then, training+dataloading take 4.252694845199585 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10364413261413574
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.259049654006958
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 20.211498737335205
Time for forward pass: 0.29152750968933105
Time for backpropagation: 0.004747152328491211
GPU memory for training: 3.818366527557373                          

One training iteration takes: 0.6843154430389404 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 21.654102087020874
Length of received data: 802862121
Future took 3.469508409500122 seconds
Pickle took 0.41023898124694824 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.934157133102417 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4410369396209717 seconds
Streaming imagenet data took 4.375315189361572 seconds
Then, training+dataloading take 4.396672964096069 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occupied: [6142.0, 3432.0] Time: 24.145309686660767
Time of next(dataloader) is: 0.1074986457824707
Time for copying to cuda: 0.1690235137939453
Time for forward pass: 0.3026754856109619
Time for backpropagation: 0.004049777984619141
GPU memory for training: 3.818366527557373                          

One training iteration takes: 0.6094415187835693 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 25.589919567108154
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 802862121
Memory occupied: [6142.0, 3432.0] Time: 27.468201637268066
Future took 3.3965585231781006 seconds
Pickle took 0.41392946243286133 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.810614824295044 seconds
Dataloader took 0.2891824245452881 seconds
Streaming imagenet data took 4.099856853485107 seconds
Then, training+dataloading take 4.145910978317261 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10033106803894043
Time for copying to cuda: 0.16865158081054688
Time for forward pass: 0.2884485721588135
Time for backpropagation: 0.004211902618408203
GPU memory for training: 3.818366527557373                          

One training iteration takes: 0.5870828628540039 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 62, 37']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 29.324281454086304
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 30.782042503356934
Length of received data: 802862121
Future took 3.430347204208374 seconds
Pickle took 0.4127767086029053 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.8433034420013428 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.50113844871521 seconds
Streaming imagenet data took 4.344509601593018 seconds
Then, training+dataloading take 4.365216016769409 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occupied: [6142.0, 3432.0] Time: 32.67584419250488
Time of next(dataloader) is: 0.10290837287902832
Time for copying to cuda: 0.16886281967163086
Time for forward pass: 0.2786555290222168
Time for backpropagation: 0.004058122634887695
GPU memory for training: 3.818366527557373                          

One training iteration takes: 0.5807263851165771 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 34.11727046966553
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [6142.0, 3432.0] Time: 35.60538339614868
Length of received data: 802862121
Future took 3.561235189437866 seconds
Pickle took 0.40947699546813965 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.9708590507507324 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.44582200050354004 seconds
Streaming imagenet data took 4.416763067245483 seconds
Then, training+dataloading take 4.462696075439453 seconds

Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.1425778865814209
Memory occupied: [6142.0, 3432.0] Time: 37.19956588745117
Time for copying to cuda: 0.16890859603881836
Time for forward pass: 0.3174765110015869
Time for backpropagation: 0.004374980926513672
GPU memory for training: 3.818366527557373                          

Last train takes: 0.658165454864502 seconds
Total time for streaming and training: 37.703408002853394
Finish gpu thread time: 0.4971599578857422
The whole process took 44.328736543655396 seconds
