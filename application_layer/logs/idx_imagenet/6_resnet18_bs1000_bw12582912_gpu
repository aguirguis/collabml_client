Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=6, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10001.724392095557 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1310946019.5207489 1310946019.5207489
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 6 11
Intermediate:  0.765625
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 2161.69482421875 2313.57275390625 8095.28857421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 6
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.77069091796875 seconds
Memory occpied: (1336.0, 3.0)
Streaming imagenet data took 4.133113384246826 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7377595901489258
Time for copying to cuda: 0.2585418224334717
Memory occpied: (2102.0, 3.0)
Memory occpied: (2102.0, 894.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.7438151836395264 seconds
Memory occpied: (2102.0, 1522.0)
Streaming imagenet data took 4.15157151222229 seconds
Memory occpied: (4302.0, 4842.0)
Time for forward pass: 4.9422607421875
Memory occpied: (6190.0, 5094.0)
Time for backpropagation: 0.7759394645690918
GPU memory for training: 7.913743495941162                          

One training iteration takes: 6.865084409713745 seconds
Index: 0
Then, training+dataloading take 6.866831302642822 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7690246105194092
Memory occpied: (2312.0, 5094.0)
Time for copying to cuda: 0.19356679916381836
Time for forward pass: 0.22272539138793945
Time for backpropagation: 0.004673957824707031
GPU memory for training: 3.675300121307373                          

One training iteration takes: 1.3532335758209229 seconds
Index: 1
Memory occpied: (4048.0, 5110.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.7264716625213623 seconds
Memory occpied: (4048.0, 5110.0)
Streaming imagenet data took 4.062909364700317 seconds
Then, training+dataloading take 4.10803747177124 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7748186588287354
Time for copying to cuda: 0.2730424404144287
Memory occpied: (4048.0, 5110.0)
Time for forward pass: 0.2916867733001709
Time for backpropagation: 0.004562854766845703
GPU memory for training: 3.675300121307373                          

One training iteration takes: 1.5001380443572998 seconds
Index: 2
Memory occpied: (4048.0, 5110.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.7696516513824463 seconds
Memory occpied: (4048.0, 5110.0)
Streaming imagenet data took 4.1071367263793945 seconds
Then, training+dataloading take 4.1435792446136475 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7932555675506592
Time for copying to cuda: 0.2791707515716553
Memory occpied: (4048.0, 5110.0)
Time for forward pass: 0.300492525100708
Time for backpropagation: 0.004775285720825195
GPU memory for training: 3.675300121307373                          

One training iteration takes: 1.5368068218231201 seconds
Index: 3
Memory occpied: (4048.0, 5110.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.8473243713378906 seconds
Memory occpied: (4048.0, 5110.0)
Streaming imagenet data took 4.186185836791992 seconds
Then, training+dataloading take 4.227736234664917 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7981913089752197
Time for copying to cuda: 0.27831077575683594
Memory occpied: (4048.0, 5110.0)
Time for forward pass: 0.296703577041626
Time for backpropagation: 0.004773855209350586
GPU memory for training: 3.675300121307373                          

One training iteration takes: 1.5476861000061035 seconds
Index: 4
Memory occpied: (4048.0, 5110.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.7429885864257812 seconds
Memory occpied: (4048.0, 5110.0)
Streaming imagenet data took 4.13856840133667 seconds
Then, training+dataloading take 4.17087459564209 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8159096240997314
Time for copying to cuda: 0.2823951244354248
Memory occpied: (4048.0, 5110.0)
Time for forward pass: 0.3040800094604492
Time for backpropagation: 0.004594326019287109
GPU memory for training: 3.675300121307373                          

One training iteration takes: 1.5729460716247559 seconds
Index: 5
Memory occpied: (4048.0, 5110.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.7136783599853516 seconds
Memory occpied: (4048.0, 5110.0)
Streaming imagenet data took 4.113178014755249 seconds
Then, training+dataloading take 4.152639150619507 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8213937282562256
Memory occpied: (4048.0, 5110.0)
Time for copying to cuda: 0.2826690673828125
Time for forward pass: 0.32389235496520996
Time for backpropagation: 0.004639148712158203
GPU memory for training: 3.675300121307373                          

One training iteration takes: 1.599135398864746 seconds
Index: 6
Memory occpied: (4048.0, 5110.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 3.7314062118530273 seconds
Memory occpied: (4048.0, 5110.0)
Streaming imagenet data took 4.141391754150391 seconds
Then, training+dataloading take 4.183870792388916 seconds

Epoch: 0
Time of next(dataloader) is: 0.8155193328857422
Memory occpied: (4048.0, 5110.0)
Time for copying to cuda: 0.28287482261657715
Time for forward pass: 0.2948646545410156
Time for backpropagation: 0.004730939865112305
GPU memory for training: 3.675300121307373                          

The whole process took 44.23132824897766 seconds
