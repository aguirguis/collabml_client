Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=15, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9953.945257709996 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1304683512.8185647 1304683512.8185647
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 15 36
Intermediate:  3.0625
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 10313.86474609375 11263.47509765625 32325.58349609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 15
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 18.89117956161499 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 20.15923261642456 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Time of next(dataloader) is: 2.186718225479126
Memory occpied: (4958.0, 3.0)
Time for copying to cuda: 0.8555479049682617
Memory occpied: (4958.0, 1946.0)
Memory occpied: (4958.0, 2374.0)
Memory occpied: (13966.0, 11950.0)
Memory occpied: (13966.0, 11950.0)
Memory occpied: (13966.0, 11950.0)
Memory occpied: (13512.0, 11950.0)
Memory occpied: (13512.0, 11950.0)
Memory occpied: (13512.0, 11950.0)
Memory occpied: (13512.0, 11950.0)
Time for forward pass: 12.216963052749634
Time for backpropagation: 0.04865312576293945
GPU memory for training: 22.35250186920166                          

One training iteration takes: 15.742160558700562 seconds
Index: 0
Memory occpied: (7646.0, 11958.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 19.137549877166748 seconds
Memory occpied: (7646.0, 11958.0)
Streaming imagenet data took 20.437244415283203 seconds
Then, training+dataloading take 20.487786293029785 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.262765645980835
Time for copying to cuda: 0.7706873416900635
Time for forward pass: 3.2741682529449463
Time for backpropagation: 0.004770040512084961
GPU memory for training: 16.09207248687744                          

Memory occpied: (7646.0, 11958.0)
One training iteration takes: 6.714496374130249 seconds
Index: 1
Memory occpied: (12398.0, 4900.0)
Memory occpied: (12398.0, 4900.0)
Memory occpied: (12398.0, 4900.0)
Memory occpied: (12398.0, 4900.0)
Memory occpied: (12398.0, 4900.0)
Memory occpied: (12398.0, 4900.0)
Memory occpied: (12398.0, 4900.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 18.749826431274414 seconds
Memory occpied: (12398.0, 4900.0)
Streaming imagenet data took 19.967097997665405 seconds
Then, training+dataloading take 20.150516748428345 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.290117025375366
Time for copying to cuda: 0.7793025970458984
Time for forward pass: 1.2188029289245605
Time for backpropagation: 0.004135847091674805
GPU memory for training: 16.09207248687744                          

Memory occpied: (12398.0, 4900.0)
One training iteration takes: 4.709508657455444 seconds
Index: 2
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 18.509745597839355 seconds
Memory occpied: (12398.0, 13526.0)
Streaming imagenet data took 19.721233367919922 seconds
Then, training+dataloading take 19.86418604850769 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.234701156616211
Time for copying to cuda: 0.7787442207336426
Time for forward pass: 1.2225522994995117
Time for backpropagation: 0.0044438838958740234
GPU memory for training: 16.09207248687744                          

Memory occpied: (12398.0, 13526.0)
One training iteration takes: 4.714230537414551 seconds
Index: 3
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 18.47226095199585 seconds
Memory occpied: (12398.0, 13526.0)
Streaming imagenet data took 19.689636945724487 seconds
Then, training+dataloading take 19.87749195098877 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.234313726425171
Time for copying to cuda: 0.7780976295471191
Time for forward pass: 1.229172945022583
Time for backpropagation: 0.004464626312255859
GPU memory for training: 16.09207248687744                          

Memory occpied: (12398.0, 13526.0)
One training iteration takes: 4.704735994338989 seconds
Index: 4
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 18.541786909103394 seconds
Memory occpied: (12398.0, 13526.0)
Streaming imagenet data took 19.754300832748413 seconds
Then, training+dataloading take 19.94636297225952 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.234276294708252
Time for copying to cuda: 0.7789862155914307
Time for forward pass: 1.2350075244903564
Time for backpropagation: 0.00411534309387207
GPU memory for training: 16.09207248687744                          

Memory occpied: (12398.0, 13526.0)
One training iteration takes: 4.725556135177612 seconds
Index: 5
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 18.348480939865112 seconds
Memory occpied: (12398.0, 13526.0)
Streaming imagenet data took 19.560675859451294 seconds
Then, training+dataloading take 19.70694088935852 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Time of next(dataloader) is: 2.221764326095581
Memory occpied: (12398.0, 13526.0)
Time for copying to cuda: 0.8750293254852295
Memory occpied: (12398.0, 13526.0)
Time for forward pass: 1.2623822689056396
Time for backpropagation: 0.0042803287506103516
GPU memory for training: 16.09207248687744                          

One training iteration takes: 4.771246671676636 seconds
Index: 6
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Memory occpied: (12398.0, 13526.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 19.198392152786255 seconds
Memory occpied: (12398.0, 13526.0)
Streaming imagenet data took 20.49788236618042 seconds
Then, training+dataloading take 20.63639998435974 seconds

Epoch: 0
Time of next(dataloader) is: 2.2417948246002197
Time for copying to cuda: 0.777796745300293
Time for forward pass: 1.2288107872009277
Time for backpropagation: 0.004166841506958008
GPU memory for training: 16.09207248687744                          

Memory occpied: (12398.0, 13526.0)
The whole process took 174.65496373176575 seconds
