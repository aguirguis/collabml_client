Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=8, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1655049324035645
Time to prepare transforms: 0.00024390220642089844
Time to download labels: 0.06374263763427734
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9982.894221264374 Mbps
Get bandwitdh took 1.2299609184265137
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03
 3.07200e+03 3.07200e+03 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1308477911.369564 1308477911.369564
All candidates indexes:  (array([17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 8 17
Intermediate:  8.6572265625
17.314453125
Total layers size  104.47354125976562
Server, client, server+client, vanilla  616.4482421875 26327.11669921875 26943.56494140625 35558.56201171875
Fixed, scale_with_bsz  0 17.888671875
Mem usage  1654.0 3.0
Time for splitting algorithm: 5.981642007827759
Using split index: 8
Freezing the lower layers of the model (myvit) till index 17
Time to freeze model: 0.0008800029754638672
Time for model prep: 0.002282857894897461
Time for model and splitting algorithm: 5.984825611114502
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 0.32140302658081055
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 1.6439945697784424
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 2.9668757915496826
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1654.0, 3.0] Time: 4.28954553604126
Length of received data: 605229121
Future took 5.197954893112183 seconds
Pickle took 0.322251558303833 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 5.520381927490234 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.38086986541748047 seconds
Streaming imagenet data took 5.901310205459595 seconds
First stream takes: 5.9135003089904785 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occupied: [1654.0, 3.0] Time: 5.993004560470581
Time of next(dataloader) is: 0.09171462059020996
Time for copying to cuda: 0.12871599197387695
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2232.0, 824.0] Time: 7.423620939254761
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2232.0, 1308.0] Time: 8.86985731124878
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 38']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 34']
Memory occupied: [8390.0, 8012.0] Time: 10.350978374481201
Length of received data: 605229121
Future took 5.144607305526733 seconds
Pickle took 0.3145108222961426 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 5.4592859745025635 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 34']
Dataloader took 0.36814379692077637 seconds
Streaming imagenet data took 5.827547311782837 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 35']
Memory occupied: [8390.0, 8012.0] Time: 11.893692016601562
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 36']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8390.0, 8012.0] Time: 13.366949319839478
Time for forward pass: 7.237108945846558
Time for backpropagation: 0.05254983901977539
GPU memory for training: 8.35290813446045                          

One training iteration takes: 7.531636953353882 seconds
Index: 0
Then, training+dataloading take 7.532999038696289 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08127045631408691
Time for copying to cuda: 0.12780451774597168
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 48']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 43']
Memory occupied: [8398.0, 8020.0] Time: 14.836712121963501
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 49']
Memory occupied: [8398.0, 8020.0] Time: 16.30732250213623
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
Time for forward pass: 3.88407039642334
Time for backpropagation: 0.05480146408081055
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.157804250717163 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 32']
Memory occupied: [8398.0, 8020.0] Time: 17.78352642059326
Length of received data: 605229121
Future took 5.135786533355713 seconds
Pickle took 0.31485605239868164 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 5.450827121734619 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.3618934154510498 seconds
Streaming imagenet data took 5.8127899169921875 seconds
Then, training+dataloading take 5.834035873413086 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.13461971282958984
Memory occupied: [8398.0, 8020.0] Time: 19.42993450164795
Time for copying to cuda: 0.12601137161254883
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Memory occupied: [8398.0, 8020.0] Time: 20.9375
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 34']
Memory occupied: [8398.0, 8020.0] Time: 22.444440364837646
Time for forward pass: 3.9616379737854004
Time for backpropagation: 0.008558034896850586
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.239784479141235 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8398.0, 8020.0] Time: 23.958950519561768
Length of received data: 605229121
Future took 5.346767902374268 seconds
Pickle took 0.24705958366394043 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 5.593976736068726 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.3110466003417969 seconds
Streaming imagenet data took 5.90510106086731 seconds
Then, training+dataloading take 5.921431303024292 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.13327288627624512
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8398.0, 8020.0] Time: 25.483309745788574
Time for copying to cuda: 0.16083931922912598
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 37']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 34']
Memory occupied: [8398.0, 8020.0] Time: 26.967089414596558
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 37']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 37']
Memory occupied: [8398.0, 8020.0] Time: 28.444225311279297
Time for forward pass: 3.9954049587249756
Time for backpropagation: 0.010974407196044922
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.310893535614014 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 66, 25']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 33, 17']
Memory occupied: [8398.0, 8020.0] Time: 29.914214611053467
Length of received data: 605229121
Future took 5.392369508743286 seconds
Pickle took 0.3089027404785156 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 5.701417684555054 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.36324572563171387 seconds
Streaming imagenet data took 6.064748764038086 seconds
Then, training+dataloading take 6.094064712524414 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.13356733322143555
Memory occupied: [8398.0, 8020.0] Time: 31.43917155265808
Time for copying to cuda: 0.12605071067810059
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 37']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 45']
Memory occupied: [8398.0, 8020.0] Time: 32.91769814491272
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 37']
Memory occupied: [8398.0, 8020.0] Time: 34.39597177505493
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 50']
Time for forward pass: 4.007065534591675
Time for backpropagation: 0.010990619659423828
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.287876129150391 seconds
Index: 4
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 50, 22']
Memory occupied: [8398.0, 8020.0] Time: 35.87201642990112
Length of received data: 605229121
Future took 5.349050998687744 seconds
Pickle took 0.3071589469909668 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 5.656354904174805 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.36451244354248047 seconds
Streaming imagenet data took 6.020953893661499 seconds
Then, training+dataloading take 6.043123006820679 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8398.0, 8020.0] Time: 37.4717001914978
Time of next(dataloader) is: 0.13457369804382324
Time for copying to cuda: 0.12618732452392578
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 37']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 38.982836961746216
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 47']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 37']
Memory occupied: [8398.0, 8020.0] Time: 40.493940591812134
Time for forward pass: 3.9979946613311768
Time for backpropagation: 0.008423805236816406
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.286860227584839 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 74, 32']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 52, 24']
Memory occupied: [8398.0, 8020.0] Time: 41.991297245025635
Length of received data: 605229121
Future took 5.311667203903198 seconds
Pickle took 0.24870944023132324 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 5.560532331466675 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.3145897388458252 seconds
Streaming imagenet data took 5.87519907951355 seconds
Then, training+dataloading take 5.887678384780884 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.1420910358428955
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8398.0, 8020.0] Time: 43.5246376991272
Time for copying to cuda: 0.16074323654174805
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 44']
Memory occupied: [8398.0, 8020.0] Time: 45.03051829338074
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 47']
Memory occupied: [8398.0, 8020.0] Time: 46.53357648849487
Time for forward pass: 3.9891321659088135
Time for backpropagation: 0.007955551147460938
GPU memory for training: 8.37738037109375                          

One training iteration takes: 4.320710182189941 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 35, 18']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8398.0, 8020.0] Time: 48.03164839744568
Length of received data: 605229121
Future took 5.371368885040283 seconds
Pickle took 0.26364922523498535 seconds
Read 577.1914682388306 MBs for this batch
Executing all posts took 5.635159254074097 seconds
Dataloader took 0.2629427909851074 seconds
Streaming imagenet data took 5.8981850147247314 seconds
Then, training+dataloading take 5.916776180267334 seconds

Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.14600563049316406
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.21103787422180176
Memory occupied: [8398.0, 8020.0] Time: 49.57149124145508
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 44']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 34']
Memory occupied: [8398.0, 8020.0] Time: 51.05339741706848
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 40']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 36']
Memory occupied: [8398.0, 8020.0] Time: 52.535523414611816
Time for forward pass: 4.082069635391235
Time for backpropagation: 0.009191513061523438
GPU memory for training: 8.37738037109375                          

Last train takes: 4.458925008773804 seconds
Total time for streaming and training: 53.602818965911865
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 91, 34']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8398.0, 8020.0] Time: 53.99528908729553
Finish gpu thread time: 1.3935284614562988
The whole process took 62.21117401123047 seconds
