Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=4, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2735734608432 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119049233.82065964 119049233.82065964
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 4 11
Intermediate:  0.765625
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 2544.50732421875 2696.38525390625 8478.10107421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 4
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 9.009184122085571 seconds
Streaming imagenet data took 9.292143821716309 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7563531398773193
Time for copying to cuda: 0.19432997703552246
Time for forward pass: 5.001250743865967
Time for backpropagation: 0.763308048248291
GPU memory for training: 8.687753200531006                          

One training iteration takes: 6.845787763595581 seconds
Index: 0
Memory occpied: (1336.0, 5134.0)
Memory occpied: (5566.0, 5134.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 8.767901420593262 seconds
Streaming imagenet data took 9.04920482635498 seconds
Then, training+dataloading take 9.087921142578125 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8691990375518799
Time for copying to cuda: 0.194413423538208
Time for forward pass: 0.4432036876678467
Time for backpropagation: 0.004603385925292969
GPU memory for training: 4.047797679901123                          

Memory occpied: (5566.0, 5134.0)
One training iteration takes: 1.6776630878448486 seconds
Index: 1
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 9.036370038986206 seconds
Memory occpied: (5582.0, 5150.0)
Streaming imagenet data took 9.421387195587158 seconds
Then, training+dataloading take 9.472686052322388 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7714331150054932
Time for copying to cuda: 0.27298879623413086
Memory occpied: (5582.0, 5150.0)
Time for forward pass: 0.43915772438049316
Time for backpropagation: 0.004914522171020508
GPU memory for training: 4.047797679901123                          

One training iteration takes: 1.6553223133087158 seconds
Index: 2
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 9.06239128112793 seconds
Streaming imagenet data took 9.35151219367981 seconds
Then, training+dataloading take 9.39361310005188 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8300309181213379
Time for copying to cuda: 0.1933422088623047
Time for forward pass: 0.438732385635376
Time for backpropagation: 0.004660129547119141
GPU memory for training: 4.047797679901123                          

One training iteration takes: 1.600008249282837 seconds
Index: 3
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 9.012821674346924 seconds
Memory occpied: (5582.0, 5150.0)
Streaming imagenet data took 9.393544673919678 seconds
Then, training+dataloading take 9.436144590377808 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7848567962646484
Memory occpied: (5582.0, 5150.0)
Time for copying to cuda: 0.27189040184020996
Time for forward pass: 0.45041608810424805
Time for backpropagation: 0.004930734634399414
GPU memory for training: 4.047797679901123                          

One training iteration takes: 1.6788573265075684 seconds
Index: 4
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 9.136356115341187 seconds
Streaming imagenet data took 9.419311761856079 seconds
Then, training+dataloading take 9.450434684753418 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8942117691040039
Time for copying to cuda: 0.1933743953704834
Time for forward pass: 0.4407482147216797
Time for backpropagation: 0.004603147506713867
GPU memory for training: 4.047797679901123                          

Memory occpied: (5582.0, 5150.0)
One training iteration takes: 1.6888141632080078 seconds
Index: 5
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 8.966938734054565 seconds
Memory occpied: (5582.0, 5150.0)
Streaming imagenet data took 9.348741054534912 seconds
Then, training+dataloading take 9.378859996795654 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.791205883026123
Time for copying to cuda: 0.2777988910675049
Memory occpied: (5582.0, 5150.0)
Time for forward pass: 0.4361398220062256
Time for backpropagation: 0.004665374755859375
GPU memory for training: 4.047797679901123                          

One training iteration takes: 1.6739754676818848 seconds
Index: 6
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Memory occpied: (5582.0, 5150.0)
Length of received data: 802862121
Read 765.668984413147 MBs for this batch
Executing all posts took 9.020599126815796 seconds
Streaming imagenet data took 9.300324201583862 seconds
Then, training+dataloading take 9.333450078964233 seconds

Epoch: 0
Memory occpied: (5582.0, 5150.0)
Time of next(dataloader) is: 0.834341287612915
Time for copying to cuda: 0.19419431686401367
Time for forward pass: 0.4465663433074951
Time for backpropagation: 0.0045812129974365234
GPU memory for training: 4.047797679901123                          

Memory occpied: (5582.0, 5150.0)
The whole process took 83.83174586296082 seconds
