Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=25, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.163010835647583
Time to prepare transforms: 0.0002465248107910156
Time to download labels: 0.06319856643676758
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10566.875071074915 Mbps
Get bandwitdh took 1.224827527999878
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1385021449.3159313 1385021449.3159313
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 25 25
Intermediate:  0.015625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 624.21337890625 1532.60986328125 25682.80712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Time for splitting algorithm: 6.592382192611694
Using split index: 25
Freezing the lower layers of the model (myvgg11) till index 25
Time to freeze model: 0.0002493858337402344
Time for model prep: 0.0008590221405029297
Time for model and splitting algorithm: 6.593508243560791
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 0.3185546398162842
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 1.6334319114685059
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 2.9500856399536133
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 4.264252424240112
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 5.581428527832031
Length of received data: 16420362
Future took 6.132689714431763 seconds
Pickle took 0.01024317741394043 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.143072843551636 seconds
Dataloader took 0.00692296028137207 seconds
Streaming imagenet data took 6.1500279903411865 seconds
First stream takes: 6.150329113006592 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.011091232299804688
Time for copying to cuda: 0.0036339759826660156
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1840.0, 344.0] Time: 6.938270807266235
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1840.0, 820.0] Time: 8.32564377784729
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Time for forward pass: 3.518484115600586
Time for backpropagation: 0.053055763244628906
GPU memory for training: 2.029374599456787                          

One training iteration takes: 3.5873773097991943 seconds
Index: 0
Memory occupied: [1840.0, 1814.0] Time: 9.745077133178711
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3026.0, 1814.0] Time: 11.155124187469482
Length of received data: 16420362
Future took 6.07145619392395 seconds
Pickle took 0.013763666152954102 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.085460662841797 seconds
Dataloader took 0.011837244033813477 seconds
Streaming imagenet data took 6.097363471984863 seconds
Then, training+dataloading take 6.098026514053345 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.01045846939086914
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.04201006889343262
Time for forward pass: 0.0565185546875
Time for backpropagation: 0.002949237823486328
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.1139523983001709 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 34, 7']
Memory occupied: [3428.0, 1822.0] Time: 12.577741146087646
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 13.992130517959595
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 15.40992522239685
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 16.826249599456787
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 18.240304708480835
Length of received data: 16420362
Future took 6.053503036499023 seconds
Pickle took 0.008101701736450195 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.061773777008057 seconds
Dataloader took 0.0065860748291015625 seconds
Streaming imagenet data took 6.068403959274292 seconds
Then, training+dataloading take 6.069024562835693 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0076596736907958984
Time for copying to cuda: 0.0037004947662353516
Time for forward pass: 0.05603790283203125
Time for backpropagation: 0.002805471420288086
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.07140779495239258 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 19.655256509780884
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 21.07313585281372
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 22.491917371749878
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 23.90804958343506
Length of received data: 16420362
Future took 6.061256647109985 seconds
Pickle took 0.007938623428344727 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.06933069229126 seconds
Dataloader took 0.007078647613525391 seconds
Streaming imagenet data took 6.076448678970337 seconds
Then, training+dataloading take 6.077001571655273 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007958173751831055
Time for copying to cuda: 0.003713846206665039
Time for forward pass: 0.05594229698181152
Time for backpropagation: 0.0027892589569091797
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.07156825065612793 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 25.32662534713745
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 26.740840673446655
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 28.160741090774536
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 29.57815170288086
Length of received data: 16420362
Future took 6.0772669315338135 seconds
Pickle took 0.008051872253417969 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.085457801818848 seconds
Dataloader took 0.004133701324462891 seconds
Streaming imagenet data took 6.089630365371704 seconds
Then, training+dataloading take 6.0901899337768555 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007636547088623047
Time for copying to cuda: 0.0037031173706054688
Time for forward pass: 0.0559544563293457
Time for backpropagation: 0.0026674270629882812
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.07115650177001953 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 46, 9']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 34, 5']
Memory occupied: [3428.0, 1822.0] Time: 30.994338274002075
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 32.41452169418335
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 33.83426284790039
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 35.25255250930786
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 16420362
Future took 6.151907682418823 seconds
Pickle took 0.012632369995117188 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.164791107177734 seconds
Dataloader took 0.010748147964477539 seconds
Streaming imagenet data took 6.175605535507202 seconds
Then, training+dataloading take 6.176299571990967 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.008185863494873047
Memory occupied: [3428.0, 1822.0] Time: 36.67318367958069
Time for copying to cuda: 0.003713369369506836
Time for forward pass: 0.05594062805175781
Time for backpropagation: 0.0027031898498535156
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.0718834400177002 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 38.08959436416626
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 39.507588624954224
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 40.92568397521973
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 42.34368300437927
Length of received data: 16420362
Future took 6.105734586715698 seconds
Pickle took 0.008001327514648438 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.113853693008423 seconds
Dataloader took 0.0040171146392822266 seconds
Streaming imagenet data took 6.117916822433472 seconds
Then, training+dataloading take 6.118498802185059 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007979154586791992
Time for copying to cuda: 0.003728151321411133
Time for forward pass: 0.05593061447143555
Time for backpropagation: 0.0027854442596435547
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.07152056694030762 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 43.76831841468811
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 45.18482732772827
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 46.604533433914185
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 48.02576494216919
Length of received data: 16420362
Future took 6.1411497592926025 seconds
Pickle took 0.008100748062133789 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.14938759803772 seconds
Dataloader took 0.006192922592163086 seconds
Streaming imagenet data took 6.155617713928223 seconds
Then, training+dataloading take 6.156175136566162 seconds

Epoch: 0
Time of next(dataloader) is: 0.0077362060546875
Time for copying to cuda: 0.003698110580444336
Time for forward pass: 0.05588388442993164
Time for backpropagation: 0.0027081966400146484
GPU memory for training: 2.1846070289611816                          

Last train takes: 0.07070708274841309 seconds
Total time for streaming and training: 49.006407022476196
Finish gpu thread time: 0.020327329635620117
The whole process took 56.847095251083374 seconds
