Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=16, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1624960899353027
Time to prepare transforms: 0.00024318695068359375
Time to download labels: 0.04951620101928711
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7381951408674 Mbps
Get bandwitdh took 1.2290449142456055
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119110132.71350378 119110132.71350378
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 16 17
Intermediate:  0.015625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 381.71142578125 647.98876953125 2417.35595703125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.221980333328247
Using split index: 16
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.00021147727966308594
Time for model prep: 0.0008139610290527344
Time for model and splitting algorithm: 5.223024845123291
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.32523059844970703
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6510882377624512
Length of received data: 16420362
Future took 1.804382562637329 seconds
Pickle took 0.010221719741821289 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.8147432804107666 seconds
Dataloader took 0.006544589996337891 seconds
Streaming imagenet data took 1.821319580078125 seconds
First stream takes: 1.8215992450714111 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.011087894439697266
Time for copying to cuda: 0.004022836685180664
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1530.0, 512.0] Time: 3.030745506286621
Length of received data: 16420362
Future took 1.6746795177459717 seconds
Pickle took 0.008226871490478516 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6830403804779053 seconds
Dataloader took 0.007499217987060547 seconds
Streaming imagenet data took 1.6905827522277832 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1530.0, 994.0] Time: 4.437136173248291
Time for forward pass: 3.292874813079834
Time for backpropagation: 0.04842066764831543
GPU memory for training: 0.9570660591125488                          

One training iteration takes: 3.3574752807617188 seconds
Index: 0
Then, training+dataloading take 3.357534885406494 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.009431600570678711
Time for copying to cuda: 0.015672683715820312
Time for forward pass: 0.03126049041748047
Time for backpropagation: 0.002676725387573242
GPU memory for training: 1.1122322082519531                          

One training iteration takes: 0.06006884574890137 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 5, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 5.855496883392334
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 16420362
Future took 1.8816640377044678 seconds
Pickle took 0.010272741317749023 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.8921620845794678 seconds
Dataloader took 0.00661015510559082 seconds
Streaming imagenet data took 1.8988420963287354 seconds
Then, training+dataloading take 1.8995187282562256 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.006310939788818359
Time for copying to cuda: 0.0037178993225097656
Time for forward pass: 0.046941518783569336
Time for backpropagation: 0.003224611282348633
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.061826467514038086 seconds
Index: 2
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 7.307136058807373
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 8.727319717407227
Length of received data: 16420362
Future took 1.704491376876831 seconds
Pickle took 0.008011341094970703 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.7126104831695557 seconds
Dataloader took 0.006582975387573242 seconds
Streaming imagenet data took 1.7192411422729492 seconds
Then, training+dataloading take 1.7198567390441895 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005638837814331055
Time for copying to cuda: 0.0037202835083007812
Time for forward pass: 0.030951738357543945
Time for backpropagation: 0.0023069381713867188
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.043768882751464844 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 10.15240740776062
Length of received data: 16420362
Future took 1.6703135967254639 seconds
Pickle took 0.00803375244140625 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6784706115722656 seconds
Dataloader took 0.004169464111328125 seconds
Streaming imagenet data took 1.682680368423462 seconds
Then, training+dataloading take 1.6832435131072998 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0057795047760009766
Time for copying to cuda: 0.0036859512329101562
Time for forward pass: 0.03096461296081543
Time for backpropagation: 0.002248048782348633
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.043750762939453125 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 11.578377485275269
Length of received data: 16420362
Future took 1.66813063621521 seconds
Pickle took 0.008042097091674805 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6762959957122803 seconds
Dataloader took 0.004166603088378906 seconds
Streaming imagenet data took 1.6805012226104736 seconds
Then, training+dataloading take 1.681072473526001 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005856513977050781
Time for copying to cuda: 0.0036995410919189453
Time for forward pass: 0.030893564224243164
Time for backpropagation: 0.002290010452270508
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.04380178451538086 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 13.001729726791382
Length of received data: 16420362
Future took 1.6720161437988281 seconds
Pickle took 0.008006811141967773 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6801352500915527 seconds
Dataloader took 0.004077911376953125 seconds
Streaming imagenet data took 1.6842517852783203 seconds
Then, training+dataloading take 1.6848199367523193 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0057713985443115234
Time for copying to cuda: 0.0036728382110595703
Time for forward pass: 0.03093123435974121
Time for backpropagation: 0.0021915435791015625
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.04362177848815918 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 25, 5']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2270.0, 1688.0] Time: 14.424779653549194
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 16420362
Future took 1.7448339462280273 seconds
Pickle took 0.01274871826171875 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.7577848434448242 seconds
Dataloader took 0.00830388069152832 seconds
Streaming imagenet data took 1.7661573886871338 seconds
Then, training+dataloading take 1.7668213844299316 seconds

Epoch: 0
Time of next(dataloader) is: 0.009855985641479492
Time for copying to cuda: 0.0035250186920166016
Time for forward pass: 0.06550836563110352
Time for backpropagation: 0.0032842159271240234
GPU memory for training: 1.1125984191894531                          

Last train takes: 0.0832223892211914 seconds
Total time for streaming and training: 15.69790244102478
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 1']
Memory occupied: [2270.0, 1688.0] Time: 15.866283655166626
Finish gpu thread time: 1.169426679611206
The whole process took 23.30305004119873 seconds
