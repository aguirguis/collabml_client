Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=8, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1630115509033203
Time to prepare transforms: 0.00025272369384765625
Time to download labels: 0.06438064575195312
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.458599973189 Mbps
Get bandwitdh took 1.2349367141723633
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119073485.61568584 119073485.61568584
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 8 11
Intermediate:  0.3828125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 1204.66357421875 1356.54150390625 7521.06982421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Time for splitting algorithm: 4.910520315170288
Using split index: 8
Freezing the lower layers of the model (myresnet18) till index 11
Time to freeze model: 0.0003559589385986328
Time for model prep: 0.0013186931610107422
Time for model and splitting algorithm: 4.912213087081909
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 3, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 0.32285571098327637
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 1.6545615196228027
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 3.0149283409118652
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 4.384512901306152
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 401454121
Future took 5.521809339523315 seconds
Pickle took 0.21001839637756348 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.732119798660278 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 5.938092231750488
Dataloader took 0.21747469902038574 seconds
Streaming imagenet data took 5.949631929397583 seconds
First stream takes: 5.967349290847778 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0649116039276123
Time for copying to cuda: 0.08529043197631836
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1720.0, 720.0] Time: 7.349352121353149
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1720.0, 1170.0] Time: 8.797824144363403
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 99, 18']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 55, 32']
Memory occupied: [2754.0, 7806.0] Time: 10.271910429000854
Time for forward pass: 4.597877740859985
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 79, 55']
Time for backpropagation: 0.7923159599304199
GPU memory for training: 7.352616786956787                          

One training iteration takes: 5.554459095001221 seconds
Index: 0
Length of received data: 401454121
Future took 5.673478603363037 seconds
Pickle took 0.20736289024353027 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.88102650642395 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 73, 32']
Memory occupied: [5886.0, 2410.0] Time: 11.970173358917236
Dataloader took 0.1906876564025879 seconds
Streaming imagenet data took 6.071759939193726 seconds
Then, training+dataloading take 6.09432315826416 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0641624927520752
Time for copying to cuda: 0.08448171615600586
Time for forward pass: 0.12740778923034668
Time for backpropagation: 0.003961086273193359
GPU memory for training: 2.083289623260498                          

One training iteration takes: 0.2942392826080322 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 13.392819166183472
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 14.844592094421387
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 16.310062170028687
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 401454121
Future took 5.665733814239502 seconds
Pickle took 0.21338987350463867 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.879417419433594 seconds
Memory occupied: [5902.0, 2426.0] Time: 17.94178056716919
Dataloader took 0.1422865390777588 seconds
Streaming imagenet data took 6.021752119064331 seconds
Then, training+dataloading take 6.04408860206604 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06435871124267578
Time for copying to cuda: 0.08448386192321777
Time for forward pass: 0.19458341598510742
Time for backpropagation: 0.004026889801025391
GPU memory for training: 2.083289623260498                          

One training iteration takes: 0.3617537021636963 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 19.365907430648804
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 20.79825234413147
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 22.24772882461548
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 23.71432089805603
Length of received data: 401454121
Future took 5.6916139125823975 seconds
Pickle took 0.19589900970458984 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.887667179107666 seconds
Dataloader took 0.1447618007659912 seconds
Streaming imagenet data took 6.032475233078003 seconds
Then, training+dataloading take 6.054860353469849 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06435251235961914
Time for copying to cuda: 0.08466458320617676
Time for forward pass: 0.19756460189819336
Time for backpropagation: 0.00400543212890625
GPU memory for training: 2.083289623260498                          

One training iteration takes: 0.36497044563293457 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 48, 25']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 25.151039838790894
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 26.634684324264526
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 28.111591815948486
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 29.631938457489014
Length of received data: 401454121
Future took 5.711422920227051 seconds
Pickle took 0.1958169937133789 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.907391548156738 seconds
Dataloader took 0.14537787437438965 seconds
Streaming imagenet data took 6.052827596664429 seconds
Then, training+dataloading take 6.075407266616821 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06430983543395996
Time for copying to cuda: 0.08461523056030273
Time for forward pass: 0.19740605354309082
Time for backpropagation: 0.003918647766113281
GPU memory for training: 2.083289623260498                          

One training iteration takes: 0.3646838665008545 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 62, 31']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 11, 6']
Memory occupied: [5902.0, 2426.0] Time: 31.06229329109192
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 32.499839067459106
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 33.9460871219635
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 35.40662598609924
Length of received data: 401454121
Future took 5.5826027393341064 seconds
Pickle took 0.19587421417236328 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.778624773025513 seconds
Dataloader took 0.14516711235046387 seconds
Streaming imagenet data took 5.92383885383606 seconds
Then, training+dataloading take 5.94622802734375 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06455135345458984
Time for copying to cuda: 0.0845189094543457
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 90, 29']
Time for forward pass: 0.23870468139648438
Time for backpropagation: 0.005248546600341797
GPU memory for training: 2.083289623260498                          

One training iteration takes: 0.4000244140625 seconds
Index: 5
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 76, 30']
Memory occupied: [5902.0, 2426.0] Time: 36.86510252952576
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 38.293883085250854
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 39.74292469024658
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 41.205766916275024
Length of received data: 401454121
Future took 5.56755518913269 seconds
Pickle took 0.1961042881011963 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.763805866241455 seconds
Dataloader took 0.14249658584594727 seconds
Streaming imagenet data took 5.906360149383545 seconds
Then, training+dataloading take 5.928720474243164 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06443214416503906
Time for copying to cuda: 0.12243437767028809
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 0.19949054718017578
Time for backpropagation: 0.005208492279052734
GPU memory for training: 2.083289623260498                          

One training iteration takes: 0.3989894390106201 seconds
Index: 6
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 68, 27']
Memory occupied: [5902.0, 2426.0] Time: 42.67671203613281
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 44.10250186920166
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 45.54738211631775
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5902.0, 2426.0] Time: 47.006427526474
Length of received data: 401454121
Future took 5.519275665283203 seconds
Pickle took 0.19554853439331055 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 5.71497917175293 seconds
Dataloader took 0.14545273780822754 seconds
Streaming imagenet data took 5.860479831695557 seconds
Then, training+dataloading take 5.882969856262207 seconds

Epoch: 0
Time of next(dataloader) is: 0.10752344131469727
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.14333486557006836
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 7, 2']
Time for forward pass: 0.19881439208984375
Time for backpropagation: 0.005298137664794922
GPU memory for training: 2.083289623260498                          

Last train takes: 0.4619596004486084 seconds
Total time for streaming and training: 48.45616793632507
Memory occupied: [5902.0, 2426.0] Time: 48.51447343826294
Finish gpu thread time: 1.0593302249908447
The whole process took 55.65575098991394 seconds
