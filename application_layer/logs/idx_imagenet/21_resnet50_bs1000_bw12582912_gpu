Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=21, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1635360717773438
Time to prepare transforms: 0.000240325927734375
Time to download labels: 0.04685211181640625
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10038.119809343745 Mbps
Get bandwitdh took 1.2343623638153076
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1315716439.6503034 1315716439.6503034
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 21 21
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 113.169921875 318.08544921875 6804.576171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Time for splitting algorithm: 5.129762649536133
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
Time to freeze model: 0.0007488727569580078
Time for model prep: 0.002290010452270508
Time for model and splitting algorithm: 5.132822513580322
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 0.33968448638916016
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 1.6822869777679443
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 3.017815351486206
Length of received data: 8231237
Future took 4.072049379348755 seconds
Pickle took 0.005265712738037109 seconds
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.077568054199219 seconds
Dataloader took 0.004781007766723633 seconds
Streaming imagenet data took 4.082434177398682 seconds
First stream takes: 4.082783222198486 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.008614301681518555
Time for copying to cuda: 0.0019941329956054688
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 4, 0']
Memory occupied: [1410.0, 174.0] Time: 4.397660732269287
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 4, 0']
Memory occupied: [1410.0, 658.0] Time: 5.781529903411865
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1410.0, 1164.0] Time: 7.195630788803101
Time for forward pass: 3.382206916809082
Time for backpropagation: 0.06357073783874512
GPU memory for training: 0.4265751838684082                          

One training iteration takes: 3.4581074714660645 seconds
Index: 0
Length of received data: 8231237
Future took 3.9675981998443604 seconds
Pickle took 0.004553556442260742 seconds
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.972257614135742 seconds
Dataloader took 0.004159688949584961 seconds
Streaming imagenet data took 3.976454257965088 seconds
Then, training+dataloading take 3.9769742488861084 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00417017936706543
Time for copying to cuda: 0.0019500255584716797
Time for forward pass: 0.012580156326293945
Time for backpropagation: 0.006473064422607422
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.0264437198638916 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 12, 2']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 8.60603141784668
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 10.019587755203247
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 11.438331604003906
Length of received data: 8231237
Future took 3.946483850479126 seconds
Pickle took 0.004662036895751953 seconds
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.9512598514556885 seconds
Dataloader took 0.0036437511444091797 seconds
Streaming imagenet data took 3.9549386501312256 seconds
Then, training+dataloading take 3.9554145336151123 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.004853248596191406
Time for copying to cuda: 0.0019881725311279297
Time for forward pass: 0.01285099983215332
Time for backpropagation: 0.00590968132019043
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.02699732780456543 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 12.85887861251831
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 14.277008533477783
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 15.696599006652832
Length of received data: 8231237
Future took 3.9476699829101562 seconds
Pickle took 0.004673480987548828 seconds
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.952463150024414 seconds
Dataloader took 0.0038330554962158203 seconds
Streaming imagenet data took 3.956332206726074 seconds
Then, training+dataloading take 3.956834554672241 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005510807037353516
Time for copying to cuda: 0.002017974853515625
Time for forward pass: 0.013060569763183594
Time for backpropagation: 0.005957603454589844
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.0279541015625 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 17.113945484161377
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 18.535532474517822
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 8231237
Future took 3.9696834087371826 seconds
Pickle took 0.00477910041809082 seconds
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.9747302532196045 seconds
Dataloader took 0.0025463104248046875 seconds
Streaming imagenet data took 3.9773144721984863 seconds
Then, training+dataloading take 3.9778120517730713 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occupied: [1660.0, 1416.0] Time: 19.955562829971313
Time of next(dataloader) is: 0.005316257476806641
Time for copying to cuda: 0.001985311508178711
Time for forward pass: 0.012893438339233398
Time for backpropagation: 0.005873441696166992
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.027573108673095703 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 21.365955352783203
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 22.77660632133484
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 8231237
Future took 3.9865176677703857 seconds
Pickle took 0.007516145706176758 seconds
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.9942450523376465 seconds
Dataloader took 0.003823995590209961 seconds
Streaming imagenet data took 3.9981307983398438 seconds
Then, training+dataloading take 3.9987542629241943 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10219264030456543
Time for copying to cuda: 0.0019903182983398438
Time for forward pass: 0.013527631759643555
Time for backpropagation: 0.006502389907836914
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.12619638442993164 seconds
Index: 5
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 24.215152740478516
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 25.630049228668213
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 27.04613709449768
Length of received data: 8231237
Future took 4.034044027328491 seconds
Pickle took 0.0048635005950927734 seconds
Read 7.849919319152832 MBs for this batch
Executing all posts took 4.0390236377716064 seconds
Dataloader took 0.0038819313049316406 seconds
Streaming imagenet data took 4.0429465770721436 seconds
Then, training+dataloading take 4.043476343154907 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0057408809661865234
Time for copying to cuda: 0.0019519329071044922
Time for forward pass: 0.012897014617919922
Time for backpropagation: 0.005949258804321289
GPU memory for training: 0.4421114921569824                          

One training iteration takes: 0.02795553207397461 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 12, 2']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 6, 2']
Memory occupied: [1660.0, 1416.0] Time: 28.460837841033936
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 29.869985103607178
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1660.0, 1416.0] Time: 31.28303074836731
Length of received data: 8231237
Future took 3.989360809326172 seconds
Pickle took 0.004619121551513672 seconds
Read 7.849919319152832 MBs for this batch
Executing all posts took 3.994093894958496 seconds
Dataloader took 0.002561330795288086 seconds
Streaming imagenet data took 3.9966917037963867 seconds
Then, training+dataloading take 3.9972050189971924 seconds

Epoch: 0
Time of next(dataloader) is: 0.005471944808959961
Time for copying to cuda: 0.001997232437133789
Time for forward pass: 0.012902259826660156
Time for backpropagation: 0.005883932113647461
GPU memory for training: 0.4421114921569824                          

Last train takes: 0.027327537536621094 seconds
Total time for streaming and training: 32.0167441368103
Finish gpu thread time: 0.2673609256744385
The whole process took 38.62791109085083 seconds
