Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=14, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1636338233947754
Time to prepare transforms: 0.0002429485321044922
Time to download labels: 0.048053741455078125
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10291.276652870129 Mbps
Get bandwitdh took 1.2377541065216064
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1348898213.4449935 1348898213.4449935
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 14 20
Intermediate:  0.19140625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 6116.125 6311.35107421875 12623.9375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.960988283157349
Using split index: 14
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0016264915466308594
Time for model prep: 0.004548549652099609
Time for model and splitting algorithm: 4.967186689376831
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.3329050540924072
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.669908046722412
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 3.0024302005767822
Length of received data: 200751121
Future took 3.52229642868042 seconds
Pickle took 0.10482120513916016 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.62727952003479 seconds
Dataloader took 0.07303810119628906 seconds
Streaming imagenet data took 3.7003533840179443 seconds
First stream takes: 3.7104220390319824 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.057912588119506836
Time for copying to cuda: 0.0431523323059082
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 8, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1510.0, 332.0] Time: 4.377670049667358
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1510.0, 848.0] Time: 5.780306816101074
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Length of received data: 200751121
Memory occupied: [1510.0, 1304.0] Time: 7.307116746902466
Future took 3.59641432762146 seconds
Pickle took 0.10599422454833984 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.702538013458252 seconds
Dataloader took 0.08615231513977051 seconds
Streaming imagenet data took 3.788729429244995 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 92, 74']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 76, 57']
Memory occupied: [3738.0, 5782.0] Time: 8.859148740768433
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 74, 55']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 90, 52']
Memory occupied: [2708.0, 3870.0] Time: 10.306525468826294
Time for forward pass: 7.011669158935547
Time for backpropagation: 0.07011938095092773
GPU memory for training: 5.916075706481934                          

One training iteration takes: 7.191254138946533 seconds
Index: 0
Then, training+dataloading take 7.191835641860962 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.056783437728881836
Time for copying to cuda: 0.04260087013244629
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 100']
Time for forward pass: 0.5141787528991699
Time for backpropagation: 0.0533602237701416
GPU memory for training: 2.436349391937256                          

One training iteration takes: 0.6725258827209473 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 98, 85']
Memory occupied: [11202.0, 3388.0] Time: 11.74464201927185
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 13.164146661758423
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 200751121
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Future took 3.6818203926086426 seconds
Pickle took 0.10569500923156738 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.7876994609832764 seconds
Memory occupied: [11202.0, 3388.0] Time: 14.805452346801758
Dataloader took 0.11553192138671875 seconds
Streaming imagenet data took 3.9032704830169678 seconds
Then, training+dataloading take 3.911093235015869 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05709505081176758
Time for copying to cuda: 0.04273033142089844
Time for forward pass: 0.5168883800506592
Time for backpropagation: 0.010534048080444336
GPU memory for training: 2.4368205070495605                          

One training iteration takes: 0.6358358860015869 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 16.231956481933594
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 17.664247512817383
Length of received data: 200751121
Future took 3.342198371887207 seconds
Pickle took 0.10263299942016602 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.4449799060821533 seconds
Dataloader took 0.0713810920715332 seconds
Streaming imagenet data took 3.5164132118225098 seconds
Then, training+dataloading take 3.5233588218688965 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05686807632446289
Time for copying to cuda: 0.04267239570617676
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 86, 64']
Time for forward pass: 0.5198931694030762
Time for backpropagation: 0.011846303939819336
GPU memory for training: 2.4368205070495605                          

One training iteration takes: 0.6367001533508301 seconds
Index: 3
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 86']
Memory occupied: [11202.0, 3388.0] Time: 19.1130154132843
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 20.544039487838745
Length of received data: 200751121
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Future took 3.4248578548431396 seconds
Pickle took 0.10420346260070801 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.5292584896087646 seconds
Dataloader took 0.1271653175354004 seconds
Streaming imagenet data took 3.6564831733703613 seconds
Then, training+dataloading take 3.6697795391082764 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10733509063720703
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.07840943336486816
Memory occupied: [11202.0, 3388.0] Time: 22.232717990875244
Time for forward pass: 0.5096409320831299
Time for backpropagation: 0.010561466217041016
GPU memory for training: 2.4368205070495605                          

One training iteration takes: 0.7151889801025391 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 23.66646695137024
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 25.10218858718872
Length of received data: 200751121
Future took 3.332751989364624 seconds
Pickle took 0.10496664047241211 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.4378554821014404 seconds
Dataloader took 0.07088398933410645 seconds
Streaming imagenet data took 3.5087807178497314 seconds
Then, training+dataloading take 3.5191826820373535 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06556320190429688
Time for copying to cuda: 0.04262518882751465
Time for forward pass: 0.5282769203186035
Time for backpropagation: 0.011748075485229492
GPU memory for training: 2.4368205070495605                          

One training iteration takes: 0.6536777019500732 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 98']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 26.56121850013733
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 27.9961895942688
Length of received data: 200751121
Future took 3.3048222064971924 seconds
Pickle took 0.0971837043762207 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.40216326713562 seconds
Dataloader took 0.11582803726196289 seconds
Streaming imagenet data took 3.5180633068084717 seconds
Then, training+dataloading take 3.5264511108398438 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06696343421936035
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.07848930358886719
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 29.463290214538574
Time for forward pass: 0.5202078819274902
Time for backpropagation: 0.010613679885864258
GPU memory for training: 2.4368205070495605                          

One training iteration takes: 0.6862373352050781 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 30.89628028869629
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 32.33044767379761
Length of received data: 200751121
Future took 3.536069393157959 seconds
Pickle took 0.10505890846252441 seconds
Read 191.45118808746338 MBs for this batch
Executing all posts took 3.6412644386291504 seconds
Dataloader took 0.07161760330200195 seconds
Streaming imagenet data took 3.7129316329956055 seconds
Then, training+dataloading take 3.723126173019409 seconds

Epoch: 0
Time of next(dataloader) is: 0.0653829574584961
Time for copying to cuda: 0.04269909858703613
Time for forward pass: 0.5084929466247559
Time for backpropagation: 0.012013912200927734
GPU memory for training: 2.4368205070495605                          

Last train takes: 0.6334836483001709 seconds
Total time for streaming and training: 33.40898370742798
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 98']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [11202.0, 3388.0] Time: 33.780821561813354
Finish gpu thread time: 1.3729121685028076
The whole process took 40.96142768859863 seconds
