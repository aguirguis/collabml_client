Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=15, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1611371040344238
Time to prepare transforms: 0.00025081634521484375
Time to download labels: 0.04868149757385254
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.9679671754473 Mbps
Get bandwitdh took 1.228538990020752
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119009177.39362022 119009177.39362022
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 15 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 420.77392578125 687.05126953125 2436.88720703125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.211942672729492
Using split index: 15
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.00021219253540039062
Time for model prep: 0.0007953643798828125
Time for model and splitting algorithm: 5.212968111038208
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.3214538097381592
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6485614776611328
Length of received data: 36906612
Future took 1.8724818229675293 seconds
Pickle took 0.021050691604614258 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.8936831951141357 seconds
Dataloader took 0.013666152954101562 seconds
Streaming imagenet data took 1.9073851108551025 seconds
First stream takes: 1.9092507362365723 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.021041154861450195
Time for copying to cuda: 0.008355855941772461
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1550.0, 430.0] Time: 3.025283098220825
Length of received data: 36906612
Future took 1.7933824062347412 seconds
Pickle took 0.016809940338134766 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.810330867767334 seconds
Dataloader took 0.014044523239135742 seconds
Streaming imagenet data took 1.8244192600250244 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1550.0, 942.0] Time: 4.435835599899292
Time for forward pass: 3.293966770172119
Time for backpropagation: 0.049423933029174805
GPU memory for training: 0.9865460395812988                          

One training iteration takes: 3.375450611114502 seconds
Index: 0
Then, training+dataloading take 3.37565541267395 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.02037835121154785
Time for copying to cuda: 0.007911920547485352
Time for forward pass: 0.0451047420501709
Time for backpropagation: 0.0027272701263427734
GPU memory for training: 1.1416969299316406                          

One training iteration takes: 0.07865500450134277 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 55, 12']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1686.0] Time: 5.856842994689941
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1686.0] Time: 7.288025856018066
Length of received data: 36906612
Future took 2.044530153274536 seconds
Pickle took 0.020754098892211914 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 2.065411329269409 seconds
Dataloader took 0.01407766342163086 seconds
Streaming imagenet data took 2.0795304775238037 seconds
Then, training+dataloading take 2.081533908843994 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.019711017608642578
Time for copying to cuda: 0.007870197296142578
Time for forward pass: 0.045110464096069336
Time for backpropagation: 0.0021500587463378906
GPU memory for training: 1.1420631408691406                          

One training iteration takes: 0.07720804214477539 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1686.0] Time: 8.718242168426514
Length of received data: 36906612
Future took 1.7683990001678467 seconds
Pickle took 0.016242265701293945 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.784771203994751 seconds
Dataloader took 0.01387333869934082 seconds
Streaming imagenet data took 1.7986845970153809 seconds
Then, training+dataloading take 1.8007025718688965 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.01977825164794922
Time for copying to cuda: 0.007841110229492188
Time for forward pass: 0.04509282112121582
Time for backpropagation: 0.002160310745239258
GPU memory for training: 1.1420631408691406                          

One training iteration takes: 0.07718896865844727 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1686.0] Time: 10.14904499053955
Length of received data: 36906612
Future took 1.7821412086486816 seconds
Pickle took 0.016238927841186523 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7985122203826904 seconds
Dataloader took 0.013694047927856445 seconds
Streaming imagenet data took 1.8122453689575195 seconds
Then, training+dataloading take 1.8142406940460205 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.019675016403198242
Time for copying to cuda: 0.007857084274291992
Time for forward pass: 0.04502439498901367
Time for backpropagation: 0.0023360252380371094
GPU memory for training: 1.1420631408691406                          

One training iteration takes: 0.07720661163330078 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 41, 9']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1686.0] Time: 11.57776427268982
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 36906612
Future took 1.873748779296875 seconds
Pickle took 0.02630615234375 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.9003088474273682 seconds
Dataloader took 0.014033079147338867 seconds
Streaming imagenet data took 1.9144043922424316 seconds
Then, training+dataloading take 1.9164164066314697 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.06102108955383301
Time for copying to cuda: 0.008040428161621094
Time for forward pass: 0.045653343200683594
Time for backpropagation: 0.002279996871948242
GPU memory for training: 1.1420631408691406                          

One training iteration takes: 0.11977028846740723 seconds
Index: 5
Memory occupied: [2290.0, 1686.0] Time: 13.017944812774658
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1686.0] Time: 14.45744252204895
Length of received data: 36906612
Future took 1.7800393104553223 seconds
Pickle took 0.016216754913330078 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7963812351226807 seconds
Dataloader took 0.013654232025146484 seconds
Streaming imagenet data took 1.8100769519805908 seconds
Then, training+dataloading take 1.8121278285980225 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.01968860626220703
Time for copying to cuda: 0.00786447525024414
Time for forward pass: 0.04509878158569336
Time for backpropagation: 0.002268075942993164
GPU memory for training: 1.1420631408691406                          

One training iteration takes: 0.07729625701904297 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1686.0] Time: 15.88847279548645
Length of received data: 36906612
Future took 1.7746930122375488 seconds
Pickle took 0.016268491744995117 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.7910895347595215 seconds
Dataloader took 0.0136871337890625 seconds
Streaming imagenet data took 1.8048293590545654 seconds
Then, training+dataloading take 1.806852102279663 seconds

Epoch: 0
Time of next(dataloader) is: 0.019606828689575195
Time for copying to cuda: 0.008021354675292969
Time for forward pass: 0.04508471488952637
Time for backpropagation: 0.0021767616271972656
GPU memory for training: 1.1420631408691406                          

Last train takes: 0.07688546180725098 seconds
Total time for streaming and training: 16.593860626220703
Finish gpu thread time: 0.29567956924438477
The whole process took 23.312943935394287 seconds
