Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=25, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1623568534851074
Time to prepare transforms: 0.0002429485321044922
Time to download labels: 0.065155029296875
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2813018038179 Mbps
Get bandwitdh took 1.229475498199463
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119050246.79003002 119050246.79003002
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 25 25
Intermediate:  0.015625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 624.21337890625 1532.60986328125 25682.80712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Time for splitting algorithm: 6.590088129043579
Using split index: 25
Freezing the lower layers of the model (myvgg11) till index 25
Time to freeze model: 0.0002429485321044922
Time for model prep: 0.0008544921875
Time for model and splitting algorithm: 6.591202974319458
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 0.31685566902160645
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 1.6368799209594727
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 2.9601986408233643
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 4.281533241271973
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 5.608360528945923
Length of received data: 16420362
Future took 6.044930696487427 seconds
Pickle took 0.009560823440551758 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.054616928100586 seconds
Dataloader took 0.0063228607177734375 seconds
Streaming imagenet data took 6.060968637466431 seconds
First stream takes: 6.061259508132935 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.011175394058227539
Time for copying to cuda: 0.0035665035247802734
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1840.0, 406.0] Time: 6.968112468719482
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 1, 0']
Memory occupied: [1840.0, 910.0] Time: 8.371399164199829
Time for forward pass: 3.338407516479492
Time for backpropagation: 0.05199551582336426
GPU memory for training: 2.029374599456787                          

One training iteration takes: 3.406290054321289 seconds
Index: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 25, 1']
Memory occupied: [3026.0, 1814.0] Time: 9.79136347770691
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3026.0, 1814.0] Time: 11.206546783447266
Length of received data: 16420362
Future took 5.967881441116333 seconds
Pickle took 0.008082151412963867 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.976083993911743 seconds
Dataloader took 0.007460355758666992 seconds
Streaming imagenet data took 5.983582258224487 seconds
Then, training+dataloading take 5.984110116958618 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0058209896087646484
Time for copying to cuda: 0.003692150115966797
Time for forward pass: 0.055849313735961914
Time for backpropagation: 0.0026090145111083984
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.06913256645202637 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 29, 6']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 12.621171712875366
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 14.039097785949707
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 15.458275556564331
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 16.879899263381958
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 16420362
Future took 6.044987440109253 seconds
Pickle took 0.008694887161254883 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.053847551345825 seconds
Dataloader took 0.049668073654174805 seconds
Streaming imagenet data took 6.103574991226196 seconds
Then, training+dataloading take 6.107077360153198 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.011043548583984375
Time for copying to cuda: 0.0035965442657470703
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for forward pass: 0.08401346206665039
Time for backpropagation: 0.003590106964111328
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.10409784317016602 seconds
Index: 2
Memory occupied: [3428.0, 1822.0] Time: 18.319872617721558
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 19.751845121383667
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 21.177501916885376
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 22.60198712348938
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 24.020615339279175
Length of received data: 16420362
Future took 6.030907869338989 seconds
Pickle took 0.008252382278442383 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.03926944732666 seconds
Dataloader took 0.007220745086669922 seconds
Streaming imagenet data took 6.0465381145477295 seconds
Then, training+dataloading take 6.047183513641357 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005716085433959961
Time for copying to cuda: 0.0037145614624023438
Time for forward pass: 0.05594944953918457
Time for backpropagation: 0.0025773048400878906
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.06904745101928711 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 25.43843650817871
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 26.857316970825195
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 28.27620267868042
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 29.691941499710083
Length of received data: 16420362
Future took 6.033228158950806 seconds
Pickle took 0.008252620697021484 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.041608095169067 seconds
Dataloader took 0.004622220993041992 seconds
Streaming imagenet data took 6.04626989364624 seconds
Then, training+dataloading take 6.0468409061431885 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005852460861206055
Time for copying to cuda: 0.0037126541137695312
Time for forward pass: 0.05595755577087402
Time for backpropagation: 0.002617359161376953
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.06921267509460449 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 31.10821509361267
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 32.52611780166626
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 33.94276022911072
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 35.36045551300049
Length of received data: 16420362
Future took 6.058637857437134 seconds
Pickle took 0.008225202560424805 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.066987037658691 seconds
Dataloader took 0.007094860076904297 seconds
Streaming imagenet data took 6.0741190910339355 seconds
Then, training+dataloading take 6.074646234512329 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005783796310424805
Time for copying to cuda: 0.0036733150482177734
Time for forward pass: 0.07101225852966309
Time for backpropagation: 0.0039174556732177734
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.08569622039794922 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 34, 7']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 34, 6']
Memory occupied: [3428.0, 1822.0] Time: 36.778656244277954
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 38.199928522109985
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 39.61873006820679
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 41.037996768951416
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 16420362
Future took 6.135101556777954 seconds
Pickle took 0.008225679397583008 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.143486261367798 seconds
Memory occupied: [3428.0, 1822.0] Time: 42.46516275405884
Dataloader took 0.004670619964599609 seconds
Streaming imagenet data took 6.1481993198394775 seconds
Then, training+dataloading take 6.148752689361572 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0057642459869384766
Time for copying to cuda: 0.0036973953247070312
Time for forward pass: 0.055886268615722656
Time for backpropagation: 0.002535581588745117
GPU memory for training: 2.1846070289611816                          

One training iteration takes: 0.06897592544555664 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 43.88218450546265
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 45.30114507675171
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 46.72300148010254
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 48.13923907279968
Length of received data: 16420362
Future took 6.095250844955444 seconds
Pickle took 0.008215188980102539 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.10358452796936 seconds
Dataloader took 0.00719761848449707 seconds
Streaming imagenet data took 6.11082124710083 seconds
Then, training+dataloading take 6.111359357833862 seconds

Epoch: 0
Time of next(dataloader) is: 0.005852222442626953
Time for copying to cuda: 0.003694772720336914
Time for forward pass: 0.05587625503540039
Time for backpropagation: 0.002557516098022461
GPU memory for training: 2.1846070289611816                          

Last train takes: 0.06867480278015137 seconds
Total time for streaming and training: 48.6500608921051
Finish gpu thread time: 0.49019670486450195
The whole process took 56.95960330963135 seconds
