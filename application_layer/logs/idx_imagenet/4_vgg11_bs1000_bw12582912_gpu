Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=4, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9895.400499178699 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1297009934.2283504 1297009934.2283504
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 4 25
Intermediate:  6.125
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 18983.58837890625 19891.98486328125 37932.80712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 4
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 21.606292724609375 seconds
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 24.13651967048645 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.141416072845459
Time for copying to cuda: 1.5441257953643799
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 21.096292734146118 seconds
Time for forward pass: 16.47081971168518
Time for backpropagation: 0.05817723274230957
GPU memory for training: 25.21141815185547                          

One training iteration takes: 23.139267206192017 seconds
Index: 0
Memory occpied: (1840.0, 13272.0)
Streaming imagenet data took 24.31251049041748 seconds
Then, training+dataloading take 24.404236316680908 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.21960973739624
Time for copying to cuda: 1.5287106037139893
Time for forward pass: 3.1271679401397705
Time for backpropagation: 0.0035178661346435547
GPU memory for training: 22.170318603515625                          

Memory occpied: (9458.0, 13272.0)
One training iteration takes: 10.447528600692749 seconds
Index: 1
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 23.006736993789673 seconds
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Streaming imagenet data took 25.664930820465088 seconds
Then, training+dataloading take 26.006261825561523 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.18677830696106
Time for copying to cuda: 1.5368304252624512
Time for forward pass: 1.1795809268951416
Time for backpropagation: 0.0031080245971679688
GPU memory for training: 22.171051025390625                          

One training iteration takes: 7.720215797424316 seconds
Index: 2
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.172083139419556 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 25.032947301864624 seconds
Then, training+dataloading take 25.345422744750977 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Time of next(dataloader) is: 4.296832084655762
Memory occpied: (14210.0, 13218.0)
Time for copying to cuda: 1.6984257698059082
Memory occpied: (14210.0, 13218.0)
Time for forward pass: 1.1919267177581787
Time for backpropagation: 0.0032737255096435547
GPU memory for training: 22.171051025390625                          

One training iteration takes: 7.978740215301514 seconds
Index: 3
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Memory occpied: (14210.0, 13218.0)
Read 6125.043984413147 MBs for this batch
Executing all posts took 23.424551963806152 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 26.251649141311646 seconds
Then, training+dataloading take 26.568840980529785 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.206997632980347
Time for copying to cuda: 1.548628568649292
Time for forward pass: 1.1918411254882812
Time for backpropagation: 0.003382444381713867
GPU memory for training: 22.171051025390625                          

One training iteration takes: 7.768853425979614 seconds
Index: 4
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.76821804046631 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 25.498459339141846 seconds
Then, training+dataloading take 25.81192898750305 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.197765827178955
Time for copying to cuda: 1.5255002975463867
Time for forward pass: 1.1895432472229004
Time for backpropagation: 0.0031714439392089844
GPU memory for training: 22.171051025390625                          

One training iteration takes: 7.7325921058654785 seconds
Index: 5
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.952157020568848 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 25.593708992004395 seconds
Then, training+dataloading take 25.907132387161255 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.223263740539551
Time for copying to cuda: 1.54825758934021
Time for forward pass: 1.180060863494873
Time for backpropagation: 0.0030858516693115234
GPU memory for training: 22.171051025390625                          

One training iteration takes: 7.770702123641968 seconds
Index: 6
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 23.686328649520874 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 26.41191291809082 seconds
Then, training+dataloading take 26.724750757217407 seconds

Epoch: 0
Time of next(dataloader) is: 4.218055248260498
Time for copying to cuda: 1.5469815731048584
Time for forward pass: 1.17864990234375
Time for backpropagation: 0.0031108856201171875
GPU memory for training: 22.171051025390625                          

Memory occpied: (14210.0, 13218.0)
The whole process took 221.62518405914307 seconds
