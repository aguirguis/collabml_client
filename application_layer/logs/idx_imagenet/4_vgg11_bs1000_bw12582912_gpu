Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=4, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9985.585755505273 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1308830696.1455872 1308830696.1455872
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 4 25
Intermediate:  6.125
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 18983.58837890625 19891.98486328125 37932.80712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 4
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.567530632019043 seconds
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 25.093581438064575 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Time of next(dataloader) is: 4.14180064201355
Memory occpied: (7966.0, 3.0)
Time for copying to cuda: 1.665130615234375
Memory occpied: (7966.0, 3248.0)
Memory occpied: (7966.0, 3728.0)
Memory occpied: (7966.0, 4114.0)
Memory occpied: (14794.0, 14030.0)
Memory occpied: (14144.0, 14030.0)
Memory occpied: (14144.0, 14030.0)
Memory occpied: (13378.0, 13264.0)
Memory occpied: (15060.0, 13264.0)
Memory occpied: (12662.0, 13264.0)
Time for forward pass: 13.060041189193726
Time for backpropagation: 0.04994606971740723
GPU memory for training: 25.21141815185547                          

One training iteration takes: 20.345377206802368 seconds
Index: 0
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 23.800546646118164 seconds
Memory occpied: (9458.0, 13272.0)
Memory occpied: (9458.0, 13272.0)
Streaming imagenet data took 26.46143364906311 seconds
Then, training+dataloading take 26.703083276748657 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.283771276473999
Time for copying to cuda: 1.5324909687042236
Time for forward pass: 3.1268389225006104
Time for backpropagation: 0.0036468505859375
GPU memory for training: 22.170318603515625                          

One training iteration takes: 10.091245412826538 seconds
Index: 1
Memory occpied: (9458.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 24.242778778076172 seconds
Memory occpied: (14210.0, 6388.0)
Memory occpied: (14210.0, 6388.0)
Streaming imagenet data took 27.06055212020874 seconds
Then, training+dataloading take 27.388427257537842 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.182775259017944
Time for copying to cuda: 1.5435795783996582
Time for forward pass: 1.2141218185424805
Time for backpropagation: 0.0031218528747558594
GPU memory for training: 22.171051025390625                          

One training iteration takes: 7.783346652984619 seconds
Index: 2
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 23.22944402694702 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 25.92590308189392 seconds
Then, training+dataloading take 26.181647062301636 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.322190046310425
Time for copying to cuda: 1.5328545570373535
Time for forward pass: 1.1785807609558105
Time for backpropagation: 0.0031816959381103516
GPU memory for training: 22.171051025390625                          

One training iteration takes: 7.916530609130859 seconds
Index: 3
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.276900053024292 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 25.114177942276 seconds
Then, training+dataloading take 25.46041703224182 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.27703070640564
Time for copying to cuda: 1.541135549545288
Time for forward pass: 1.1855335235595703
Time for backpropagation: 0.003238201141357422
GPU memory for training: 22.171051025390625                          

One training iteration takes: 7.849503755569458 seconds
Index: 4
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 23.08271336555481 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 25.776654481887817 seconds
Then, training+dataloading take 26.099334478378296 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.313830137252808
Time for copying to cuda: 1.5536472797393799
Time for forward pass: 1.1994445323944092
Time for backpropagation: 0.0031223297119140625
GPU memory for training: 22.171051025390625                          

Memory occpied: (14210.0, 13218.0)
One training iteration takes: 7.832533597946167 seconds
Index: 5
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.172476291656494 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 25.070194959640503 seconds
Then, training+dataloading take 25.389522314071655 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.265778303146362
Time for copying to cuda: 1.5468692779541016
Time for forward pass: 1.1812019348144531
Time for backpropagation: 0.0031812191009521484
GPU memory for training: 22.171051025390625                          

One training iteration takes: 7.879095554351807 seconds
Index: 6
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.986377716064453 seconds
Memory occpied: (14210.0, 13218.0)
Memory occpied: (14210.0, 13218.0)
Streaming imagenet data took 25.82616877555847 seconds
Then, training+dataloading take 26.15130376815796 seconds

Epoch: 0
Time of next(dataloader) is: 4.224498987197876
Time for copying to cuda: 1.5328288078308105
Time for forward pass: 1.1926345825195312
Time for backpropagation: 0.0031828880310058594
GPU memory for training: 22.171051025390625                          

Memory occpied: (14210.0, 13218.0)
The whole process took 225.21544480323792 seconds
