Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=16, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1611976623535156
Time to prepare transforms: 0.00023889541625976562
Time to download labels: 0.06319165229797363
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10046.294413195736 Mbps
Get bandwitdh took 1.2311670780181885
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1316787901.3263915 1316787901.3263915
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 16 21
Intermediate:  0.765625
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 2402.232421875 2607.14794921875 8335.826171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Time for splitting algorithm: 5.120332956314087
Using split index: 16
Freezing the lower layers of the model (myresnet50) till index 21
Time to freeze model: 0.0006997585296630859
Time for model prep: 0.002309560775756836
Time for model and splitting algorithm: 5.123376131057739
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 0.33312201499938965
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 1.6649644374847412
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 2.994206666946411
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 4.360714912414551
Length of received data: 802863121
Future took 5.448375225067139 seconds
Pickle took 0.4142262935638428 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.862804651260376 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4538919925689697 seconds
Streaming imagenet data took 6.316746473312378 seconds
First stream takes: 6.362921714782715 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000

Memory occupied: [1410.0, 3.0] Time: 6.36365270614624

Epoch: 0
Time of next(dataloader) is: 0.10288810729980469
Time for copying to cuda: 0.16845035552978516
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2176.0, 856.0] Time: 7.802740812301636
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2176.0, 1350.0] Time: 9.265829086303711
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 77, 33']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 86, 35']
Memory occupied: [3958.0, 6660.0] Time: 10.740348100662231
Length of received data: 802863121
Future took 5.507382154464722 seconds
Pickle took 0.42025017738342285 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.928119421005249 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 95, 80']
Memory occupied: [6734.0, 5958.0] Time: 12.72591781616211
Dataloader took 0.4541895389556885 seconds
Streaming imagenet data took 6.382352828979492 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 7.268110036849976
Time for backpropagation: 0.12457108497619629
GPU memory for training: 10.686818599700928                          

One training iteration takes: 7.676234245300293 seconds
Index: 0
Then, training+dataloading take 7.676611423492432 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10405230522155762
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 5, 1']
Memory occupied: [2288.0, 7668.0] Time: 14.28476595878601
Time for copying to cuda: 0.2133476734161377
Time for forward pass: 0.2920238971710205
Time for backpropagation: 0.006246089935302734
GPU memory for training: 3.2022528648376465                          

One training iteration takes: 0.644235372543335 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 15.709569692611694
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 17.13335108757019
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 18.572412490844727
Length of received data: 802863121
Future took 5.581331253051758 seconds
Pickle took 0.42061471939086914 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.0550806522369385 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.44892239570617676 seconds
Streaming imagenet data took 6.504119396209717 seconds
Then, training+dataloading take 6.527202129364014 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [3612.0, 7676.0] Time: 20.62087893486023
Time of next(dataloader) is: 0.10598969459533691
Time for copying to cuda: 0.16735219955444336
Time for forward pass: 0.37574076652526855
Time for backpropagation: 0.006242513656616211
GPU memory for training: 3.2022528648376465                          

One training iteration takes: 0.6826069355010986 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 22.056371688842773
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 23.493109703063965
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 24.929269313812256
Length of received data: 802863121
Future took 5.542720556259155 seconds
Pickle took 0.40979456901550293 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.005803346633911 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4390552043914795 seconds
Streaming imagenet data took 6.444965600967407 seconds
Then, training+dataloading take 6.467787027359009 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occupied: [3612.0, 7676.0] Time: 27.128705263137817
Time of next(dataloader) is: 0.10275006294250488
Time for copying to cuda: 0.16736268997192383
Time for forward pass: 0.3788168430328369
Time for backpropagation: 0.006505727767944336
GPU memory for training: 3.2022528648376465                          

One training iteration takes: 0.6823961734771729 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 28.56401801109314
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 29.99932098388672
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 31.443838119506836
Length of received data: 802863121
Future took 5.536546468734741 seconds
Pickle took 0.41010069847106934 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.000172853469849 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.44181180000305176 seconds
Streaming imagenet data took 6.442097902297974 seconds
Then, training+dataloading take 6.4653613567352295 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occupied: [3612.0, 7676.0] Time: 33.59370541572571
Time of next(dataloader) is: 0.09924077987670898
Time for copying to cuda: 0.16762018203735352
Time for forward pass: 0.37308764457702637
Time for backpropagation: 0.006118059158325195
GPU memory for training: 3.2022528648376465                          

One training iteration takes: 0.6732654571533203 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 35.029624700546265
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 36.46597242355347
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 37.90412211418152
Length of received data: 802863121
Future took 5.593766450881958 seconds
Pickle took 0.4305288791656494 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.024659872055054 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 39.942156076431274
Dataloader took 0.44458746910095215 seconds
Streaming imagenet data took 6.469306945800781 seconds
Then, training+dataloading take 6.516932487487793 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.1474475860595703
Time for copying to cuda: 0.16779685020446777
Time for forward pass: 0.3803422451019287
Time for backpropagation: 0.006159305572509766
GPU memory for training: 3.2022528648376465                          

One training iteration takes: 0.7281284332275391 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 41.376845359802246
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 42.8154296875
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 44.25219392776489
Length of received data: 802863121
Future took 5.6447975635528564 seconds
Pickle took 0.41048240661621094 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.108642578125 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4386253356933594 seconds
Streaming imagenet data took 6.5473785400390625 seconds
Then, training+dataloading take 6.5685906410217285 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10361385345458984
Memory occupied: [3612.0, 7676.0] Time: 46.69099020957947
Time for copying to cuda: 0.1675574779510498
Time for forward pass: 0.3651251792907715
Time for backpropagation: 0.00651240348815918
GPU memory for training: 3.2022528648376465                          

One training iteration takes: 0.669750452041626 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 48.13085079193115
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 49.566529273986816
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3612.0, 7676.0] Time: 51.00398015975952
Length of received data: 802863121
Future took 5.548605442047119 seconds
Pickle took 0.41103553771972656 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.0131614208221436 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.44333314895629883 seconds
Streaming imagenet data took 6.456613063812256 seconds
Then, training+dataloading take 6.478240728378296 seconds

Epoch: 0
Memory occupied: [3612.0, 7676.0] Time: 53.13285684585571
Time of next(dataloader) is: 0.10775065422058105
Time for copying to cuda: 0.16736078262329102
Time for forward pass: 0.34393930435180664
Time for backpropagation: 0.006081342697143555
GPU memory for training: 3.2022528648376465                          

Last train takes: 0.652031660079956 seconds
Total time for streaming and training: 53.7159218788147
Finish gpu thread time: 0.4179539680480957
The whole process took 60.48227620124817 seconds
