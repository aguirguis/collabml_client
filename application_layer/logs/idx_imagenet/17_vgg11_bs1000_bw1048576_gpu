Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=17, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.4150388457607 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119067775.97159155 119067775.97159155
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 17 25
Intermediate:  0.3828125
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 1757.02587890625 2665.42236328125 26448.43212890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 17
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.506985902786255 seconds
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 9.723924398422241 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5193803310394287
Time for copying to cuda: 0.0994253158569336
Memory occpied: (2224.0, 444.0)
Memory occpied: (2224.0, 870.0)
Memory occpied: (2224.0, 1328.0)
Memory occpied: (5840.0, 5374.0)
Time for forward pass: 4.273120164871216
Time for backpropagation: 0.05312800407409668
GPU memory for training: 8.204551696777344                          

One training iteration takes: 5.072237730026245 seconds
Index: 0
Memory occpied: (3362.0, 5382.0)
Memory occpied: (3362.0, 5382.0)
Memory occpied: (3362.0, 5382.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.507920503616333 seconds
Streaming imagenet data took 9.741957187652588 seconds
Then, training+dataloading take 9.768366813659668 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (3362.0, 5382.0)
Time of next(dataloader) is: 0.563765287399292
Time for copying to cuda: 0.09872913360595703
Time for forward pass: 0.1976945400238037
Time for backpropagation: 0.0032041072845458984
GPU memory for training: 4.324462890625                          

One training iteration takes: 0.9909236431121826 seconds
Index: 1
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.373055219650269 seconds
Streaming imagenet data took 9.560240983963013 seconds
Then, training+dataloading take 9.585842847824097 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (4912.0, 5390.0)
Time of next(dataloader) is: 0.6057920455932617
Time for copying to cuda: 0.09866595268249512
Time for forward pass: 0.1998000144958496
Time for backpropagation: 0.0031251907348632812
GPU memory for training: 4.324462890625                          

One training iteration takes: 1.0506820678710938 seconds
Index: 2
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.538309812545776 seconds
Streaming imagenet data took 9.725918292999268 seconds
Then, training+dataloading take 9.753058433532715 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (4912.0, 5390.0)
Time of next(dataloader) is: 0.5963327884674072
Time for copying to cuda: 0.0991063117980957
Time for forward pass: 0.20025897026062012
Time for backpropagation: 0.003151416778564453
GPU memory for training: 4.324462890625                          

One training iteration takes: 1.03684401512146 seconds
Index: 3
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.53795838356018 seconds
Streaming imagenet data took 9.727784633636475 seconds
Then, training+dataloading take 9.75826907157898 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5899229049682617
Time for copying to cuda: 0.1001284122467041
Time for forward pass: 0.19823002815246582
Time for backpropagation: 0.0031478404998779297
GPU memory for training: 4.324462890625                          

Memory occpied: (4912.0, 5390.0)
One training iteration takes: 1.0235557556152344 seconds
Index: 4
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.605617761611938 seconds
Memory occpied: (4912.0, 5390.0)
Streaming imagenet data took 9.746738910675049 seconds
Then, training+dataloading take 9.775649547576904 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5464553833007812
Time for copying to cuda: 0.09925675392150879
Time for forward pass: 0.2247462272644043
Time for backpropagation: 0.0038123130798339844
GPU memory for training: 4.324462890625                          

One training iteration takes: 0.9946944713592529 seconds
Index: 5
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.565519571304321 seconds
Memory occpied: (4912.0, 5390.0)
Streaming imagenet data took 9.751304149627686 seconds
Then, training+dataloading take 9.779652118682861 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5453789234161377
Time for copying to cuda: 0.09955358505249023
Time for forward pass: 0.20034360885620117
Time for backpropagation: 0.0031232833862304688
GPU memory for training: 4.324462890625                          

One training iteration takes: 0.9614217281341553 seconds
Index: 6
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Memory occpied: (4912.0, 5390.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 9.511887788772583 seconds
Streaming imagenet data took 9.742486238479614 seconds
Then, training+dataloading take 9.770821332931519 seconds

Epoch: 0
Memory occpied: (4912.0, 5390.0)
Time of next(dataloader) is: 0.5627071857452393
Time for copying to cuda: 0.09904360771179199
Time for forward pass: 0.20027875900268555
Time for backpropagation: 0.0031473636627197266
GPU memory for training: 4.324462890625                          

The whole process took 86.75372505187988 seconds
