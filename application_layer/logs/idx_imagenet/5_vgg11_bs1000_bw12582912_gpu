Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10260.09218413448 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1344810802.7588747 1344810802.7588747
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 25
Intermediate:  6.125
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 14389.83837890625 15298.23486328125 33339.05712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Using split index: 5
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.382074117660522 seconds
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Streaming imagenet data took 25.0202157497406 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.108886957168579
Time for copying to cuda: 1.535095453262329
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 21.557292461395264 seconds
Time for forward pass: 16.04279851913452
Time for backpropagation: 0.056363582611083984
GPU memory for training: 25.21141815185547                          

One training iteration takes: 22.67785382270813 seconds
Index: 0
Memory occpied: (1840.0, 13272.0)
Memory occpied: (10224.0, 13272.0)
Streaming imagenet data took 24.843702793121338 seconds
Then, training+dataloading take 25.079421997070312 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.235148668289185
Time for copying to cuda: 1.5290992259979248
Time for forward pass: 1.3067941665649414
Time for backpropagation: 0.003244161605834961
GPU memory for training: 22.869537353515625                          

One training iteration takes: 7.859774351119995 seconds
Index: 1
Memory occpied: (10224.0, 13280.0)
Memory occpied: (13794.0, 13280.0)
Memory occpied: (13794.0, 13280.0)
Memory occpied: (13794.0, 13280.0)
Memory occpied: (13794.0, 13280.0)
Memory occpied: (13794.0, 13280.0)
Memory occpied: (13794.0, 13280.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.77029061317444 seconds
Memory occpied: (13794.0, 13280.0)
Memory occpied: (13794.0, 13280.0)
Streaming imagenet data took 25.609408140182495 seconds
Then, training+dataloading take 25.926562786102295 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.20708441734314
Time for copying to cuda: 1.5293481349945068
Time for forward pass: 2.952099084854126
Time for backpropagation: 0.004160404205322266
GPU memory for training: 22.512115478515625                          

One training iteration takes: 9.602682113647461 seconds
Index: 2
Memory occpied: (13794.0, 6388.0)
Memory occpied: (13794.0, 6388.0)
Memory occpied: (13794.0, 6388.0)
Memory occpied: (13794.0, 6388.0)
Memory occpied: (13794.0, 6388.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.822736024856567 seconds
Memory occpied: (13794.0, 6388.0)
Memory occpied: (13794.0, 6388.0)
Streaming imagenet data took 25.48909831047058 seconds
Then, training+dataloading take 25.832019805908203 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occpied: (13794.0, 6388.0)
Memory occpied: (13794.0, 6388.0)
Memory occpied: (13794.0, 6388.0)
Time of next(dataloader) is: 4.1759254932403564
Memory occpied: (13794.0, 6388.0)
Time for copying to cuda: 1.6970384120941162
Memory occpied: (13794.0, 13218.0)
Time for forward pass: 1.1597297191619873
Time for backpropagation: 0.0036346912384033203
GPU memory for training: 22.512847900390625                          

One training iteration takes: 7.790939807891846 seconds
Index: 3
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.636073112487793 seconds
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Streaming imagenet data took 25.355395793914795 seconds
Then, training+dataloading take 25.673930406570435 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.183424472808838
Time for copying to cuda: 1.549999713897705
Time for forward pass: 1.15403151512146
Time for backpropagation: 0.0031960010528564453
GPU memory for training: 22.512847900390625                          

One training iteration takes: 7.718201398849487 seconds
Index: 4
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 22.43455481529236 seconds
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Streaming imagenet data took 25.29261088371277 seconds
Then, training+dataloading take 25.60652732849121 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Time of next(dataloader) is: 4.2937092781066895
Memory occpied: (13794.0, 13218.0)
Time for copying to cuda: 1.7729244232177734
Memory occpied: (13794.0, 13218.0)
Time for forward pass: 1.1535003185272217
Time for backpropagation: 0.003269672393798828
GPU memory for training: 22.512847900390625                          

One training iteration takes: 8.04439663887024 seconds
Index: 5
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 21.985544204711914 seconds
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Streaming imagenet data took 24.674126863479614 seconds
Then, training+dataloading take 24.995859622955322 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 4.163904428482056
Time for copying to cuda: 1.5501065254211426
Time for forward pass: 1.1630990505218506
Time for backpropagation: 0.003607034683227539
GPU memory for training: 22.512847900390625                          

One training iteration takes: 7.725931882858276 seconds
Index: 6
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Length of received data: 6422574121
Read 6125.043984413147 MBs for this batch
Executing all posts took 23.409873247146606 seconds
Memory occpied: (13794.0, 13218.0)
Memory occpied: (13794.0, 13218.0)
Streaming imagenet data took 26.139296531677246 seconds
Then, training+dataloading take 26.45390486717224 seconds

Epoch: 0
Time of next(dataloader) is: 4.198125123977661
Time for copying to cuda: 1.5418171882629395
Time for forward pass: 1.1824092864990234
Time for backpropagation: 0.003187894821166992
GPU memory for training: 22.512847900390625                          

Memory occpied: (13794.0, 13218.0)
The whole process took 221.30657958984375 seconds
