Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=13, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1616384983062744
Time to prepare transforms: 0.0002460479736328125
Time to download labels: 0.04625654220581055
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10110.612604914832 Mbps
Get bandwitdh took 1.2277979850769043
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1325218215.3513968 1325218215.3513968
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 13 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 440.30517578125 706.58251953125 2456.41845703125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.218157768249512
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.00021409988403320312
Time for model prep: 0.0007863044738769531
Time for model and splitting algorithm: 5.219175100326538
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.32335972785949707
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 36906612
Future took 1.5713098049163818 seconds
Pickle took 0.021018028259277344 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5925180912017822 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.04569244384765625 seconds
Streaming imagenet data took 1.6382653713226318 seconds
First stream takes: 1.6419930458068848 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.021906375885009766
Time for copying to cuda: 0.008467435836791992
Memory occupied: [1514.0, 13.0] Time: 1.698279619216919
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 36906612
Future took 1.4488279819488525 seconds
Memory occupied: [1550.0, 584.0] Time: 3.1086084842681885
Pickle took 0.017405271530151367 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4663634300231934 seconds
Dataloader took 0.013979434967041016 seconds
Streaming imagenet data took 1.4803950786590576 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1550.0, 1104.0] Time: 4.523828983306885
Time for forward pass: 3.3018696308135986
Time for backpropagation: 0.04889225959777832
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.384152889251709 seconds
Index: 0
Then, training+dataloading take 3.3843648433685303 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.020387649536132812
Time for copying to cuda: 0.007900238037109375
Time for forward pass: 0.04908299446105957
Time for backpropagation: 0.0028052330017089844
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.08279561996459961 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1578.0] Time: 5.938682556152344
Length of received data: 36906612
Future took 1.509711742401123 seconds
Pickle took 0.02057647705078125 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5304172039031982 seconds
Dataloader took 0.013608694076538086 seconds
Streaming imagenet data took 1.5440654754638672 seconds
Then, training+dataloading take 1.5459468364715576 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.019423723220825195
Time for copying to cuda: 0.007895231246948242
Time for forward pass: 0.04908442497253418
Time for backpropagation: 0.002201557159423828
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.0809774398803711 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 5, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1578.0] Time: 7.3618199825286865
Length of received data: 36906612
Future took 1.4106123447418213 seconds
Pickle took 0.016410350799560547 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4271533489227295 seconds
Dataloader took 0.013825654983520508 seconds
Streaming imagenet data took 1.4410204887390137 seconds
Then, training+dataloading take 1.442856788635254 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.019298553466796875
Time for copying to cuda: 0.007863044738769531
Time for forward pass: 0.04920697212219238
Time for backpropagation: 0.0022020339965820312
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.08085155487060547 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 22, 6']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1578.0] Time: 8.787411451339722
Length of received data: 36906612
Future took 1.400942087173462 seconds
Pickle took 0.016324758529663086 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4174036979675293 seconds
Dataloader took 0.013757944107055664 seconds
Streaming imagenet data took 1.431213140487671 seconds
Then, training+dataloading take 1.4331040382385254 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.019408702850341797
Time for copying to cuda: 0.007822275161743164
Time for forward pass: 0.04911541938781738
Time for backpropagation: 0.002148151397705078
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.0808725357055664 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1578.0] Time: 10.215461015701294
Length of received data: 36906612
Future took 1.4037318229675293 seconds
Pickle took 0.01627206802368164 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4201290607452393 seconds
Dataloader took 0.0136566162109375 seconds
Streaming imagenet data took 1.4338250160217285 seconds
Then, training+dataloading take 1.435697317123413 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.01947951316833496
Time for copying to cuda: 0.007829904556274414
Time for forward pass: 0.04915952682495117
Time for backpropagation: 0.0021626949310302734
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.08093094825744629 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1578.0] Time: 11.641731023788452
Length of received data: 36906612
Future took 1.4059619903564453 seconds
Pickle took 0.016288280487060547 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4223835468292236 seconds
Dataloader took 0.013832569122314453 seconds
Streaming imagenet data took 1.4362578392028809 seconds
Then, training+dataloading take 1.4381160736083984 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.019459009170532227
Time for copying to cuda: 0.007966041564941406
Time for forward pass: 0.04910683631896973
Time for backpropagation: 0.0022192001342773438
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.08107686042785645 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2290.0, 1578.0] Time: 13.072389125823975
Length of received data: 36906612
Future took 1.4142701625823975 seconds
Pickle took 0.016321897506713867 seconds
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4307243824005127 seconds
Dataloader took 0.013607263565063477 seconds
Streaming imagenet data took 1.4443721771240234 seconds
Then, training+dataloading take 1.4462699890136719 seconds

Epoch: 0
Time of next(dataloader) is: 0.019358158111572266
Time for copying to cuda: 0.007828712463378906
Time for forward pass: 0.0492556095123291
Time for backpropagation: 0.0022881031036376953
GPU memory for training: 1.1639018058776855                          

Last train takes: 0.08065152168273926 seconds
Total time for streaming and training: 13.849178552627563
Finish gpu thread time: 0.2242274284362793
The whole process took 20.501131296157837 seconds
