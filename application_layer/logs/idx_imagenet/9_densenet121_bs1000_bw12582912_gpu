Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=9, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1612248420715332
Time to prepare transforms: 0.00023651123046875
Time to download labels: 0.046769142150878906
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10153.735433128686 Mbps
Get bandwitdh took 1.2368292808532715
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1330870410.6910431 1330870410.6910431
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 9 20
Intermediate:  0.3828125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 7838.78125 8034.00732421875 14155.1875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.931026458740234
Using split index: 9
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015702247619628906
Time for model prep: 0.004454374313354492
Time for model and splitting algorithm: 4.93707537651062
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.334197998046875
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.668830156326294
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 401454121
Future took 3.177220344543457 seconds
Memory occupied: [1318.0, 3.0] Time: 3.3865177631378174
Pickle took 0.2091672420501709 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 3.386536121368408 seconds
Dataloader took 0.14078688621520996 seconds
Streaming imagenet data took 3.5273590087890625 seconds
First stream takes: 3.5506091117858887 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06505846977233887
Time for copying to cuda: 0.08490681648254395
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1702.0, 650.0] Time: 4.790285587310791
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1702.0, 1122.0] Time: 6.223098993301392
Length of received data: 401454121
Future took 3.1350467205047607 seconds
Pickle took 0.21230292320251465 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 3.3474955558776855 seconds
Dataloader took 0.15872955322265625 seconds
Streaming imagenet data took 3.506269693374634 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 68, 26']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 76, 42']
Memory occupied: [3814.0, 4766.0] Time: 7.675657272338867
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 71, 56']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 94, 69']
Memory occupied: [7240.0, 10238.0] Time: 9.13304328918457
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 79, 58']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 65, 52']
Memory occupied: [4172.0, 3956.0] Time: 10.582635164260864
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 51']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 60']
Memory occupied: [4782.0, 3126.0] Time: 12.036819458007812
Time for forward pass: 8.955963134765625
Time for backpropagation: 0.07643389701843262
GPU memory for training: 9.715926170349121                          

One training iteration takes: 9.196732997894287 seconds
Index: 0
Then, training+dataloading take 9.197715997695923 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06421089172363281
Time for copying to cuda: 0.08372640609741211
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 54, 35']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 100']
Memory occupied: [5310.0, 11314.0] Time: 13.496485471725464
Time for forward pass: 0.9260275363922119
Time for backpropagation: 0.010642528533935547
GPU memory for training: 4.842838764190674                          

One training iteration takes: 1.0991735458374023 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11314.0] Time: 14.91872787475586
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 401454121
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Future took 3.5673298835754395 seconds
Pickle took 0.21048283576965332 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 3.7779927253723145 seconds
Memory occupied: [5310.0, 11314.0] Time: 16.649137496948242
Dataloader took 0.1914992332458496 seconds
Streaming imagenet data took 3.969531774520874 seconds
Then, training+dataloading take 3.983416795730591 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0649569034576416
Time for copying to cuda: 0.08374476432800293
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 94']
Time for forward pass: 0.9369440078735352
Time for backpropagation: 0.012046575546264648
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.1051888465881348 seconds
Index: 2
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 7, 6']
Memory occupied: [5310.0, 11314.0] Time: 18.124472856521606
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11314.0] Time: 19.58219885826111
Length of received data: 401454121
Future took 3.1922998428344727 seconds
Pickle took 0.16391491889953613 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 3.356363534927368 seconds
Dataloader took 0.14111924171447754 seconds
Streaming imagenet data took 3.4975287914276123 seconds
Then, training+dataloading take 3.5108256340026855 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06441068649291992
Time for copying to cuda: 0.08406567573547363
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 95']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 100']
Memory occupied: [5310.0, 11314.0] Time: 21.066179037094116
Time for forward pass: 0.9180710315704346
Time for backpropagation: 0.01071929931640625
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.091855764389038 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11314.0] Time: 22.517298460006714
Length of received data: 401454121
Future took 3.025810718536377 seconds
Pickle took 0.1640758514404297 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 3.1900408267974854 seconds
Dataloader took 0.18996620178222656 seconds
Streaming imagenet data took 3.380079984664917 seconds
Then, training+dataloading take 3.3936872482299805 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.10928583145141602
Time for copying to cuda: 0.12737536430358887
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11314.0] Time: 24.0195894241333
Time for forward pass: 0.94846510887146
Time for backpropagation: 0.011101245880126953
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.2111072540283203 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11314.0] Time: 25.470642566680908
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 401454121
Future took 3.1139912605285645 seconds
Pickle took 0.16321587562561035 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 3.277362585067749 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.23378562927246094 seconds
Streaming imagenet data took 3.5112035274505615 seconds
Then, training+dataloading take 3.5326766967773438 seconds
Memory occupied: [5310.0, 11314.0] Time: 27.16939067840576
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06502938270568848
Time for copying to cuda: 0.08388710021972656
Time for forward pass: 0.9143986701965332
Time for backpropagation: 0.011801958084106445
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.0828721523284912 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 94']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11314.0] Time: 28.622436046600342
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11314.0] Time: 30.07264995574951
Length of received data: 401454121
Future took 3.2080841064453125 seconds
Pickle took 0.19483017921447754 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 3.4030580520629883 seconds
Dataloader took 0.1413874626159668 seconds
Streaming imagenet data took 3.5444908142089844 seconds
Then, training+dataloading take 3.557239532470703 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06450271606445312
Time for copying to cuda: 0.0838773250579834
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 92']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 100']
Memory occupied: [5310.0, 11314.0] Time: 31.556206941604614
Time for forward pass: 0.9133200645446777
Time for backpropagation: 0.010838031768798828
GPU memory for training: 4.842915058135986                          

One training iteration takes: 1.0866491794586182 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11314.0] Time: 33.0104923248291
Length of received data: 401454121
Future took 3.0382745265960693 seconds
Pickle took 0.16457271575927734 seconds
Read 382.856484413147 MBs for this batch
Executing all posts took 3.2030043601989746 seconds
Dataloader took 0.19084882736206055 seconds
Streaming imagenet data took 3.3939242362976074 seconds
Then, training+dataloading take 3.4079430103302 seconds

Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.10972070693969727
Time for copying to cuda: 0.1258401870727539
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5310.0, 11314.0] Time: 34.52094626426697
Time for forward pass: 0.9186990261077881
Time for backpropagation: 0.01080775260925293
GPU memory for training: 4.842915058135986                          

Last train takes: 1.178985357284546 seconds
Total time for streaming and training: 35.313313722610474
Finish gpu thread time: 0.20862960815429688
The whole process took 41.66765737533569 seconds
