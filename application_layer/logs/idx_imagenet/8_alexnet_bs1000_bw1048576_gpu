Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=8, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.160247564315796
Time to prepare transforms: 0.0002620220184326172
Time to download labels: 0.04917597770690918
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.942247984143 Mbps
Get bandwitdh took 1.2310564517974854
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119005806.3277776 119005806.3277776
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 8 17
Intermediate:  0.24755859375
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 994.99267578125 1261.27001953125 2798.70361328125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.2353515625
Using split index: 8
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.0002143383026123047
Time for model prep: 0.0007998943328857422
Time for model and splitting algorithm: 5.236382246017456
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.33539652824401855
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6706957817077637
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 3.0205976963043213
Length of received data: 259631121
Future took 3.7767786979675293 seconds
Pickle took 0.1357741355895996 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 3.9127063751220703 seconds
Dataloader took 0.09234619140625 seconds
Streaming imagenet data took 4.005089998245239 seconds
First stream takes: 4.0172200202941895 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.11317825317382812
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for copying to cuda: 0.08884525299072266
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1762.0, 258.0] Time: 4.446166276931763
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1762.0, 748.0] Time: 5.85773229598999
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1762.0, 1250.0] Time: 7.31243371963501
Length of received data: 259631121
Future took 3.883654832839966 seconds
Pickle took 0.13496756553649902 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.018771171569824 seconds
Dataloader took 0.09343719482421875 seconds
Streaming imagenet data took 4.112252712249756 seconds
Time for forward pass: 4.091907501220703
Time for backpropagation: 0.09870123863220215
GPU memory for training: 4.371849060058594                          

One training iteration takes: 4.404060125350952 seconds
Index: 0
Then, training+dataloading take 4.404806852340698 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 93, 32']
Time of next(dataloader) is: 0.12447452545166016
Time for copying to cuda: 0.09423327445983887
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 11, 1']
Time for forward pass: 0.07686352729797363
Time for backpropagation: 0.0033931732177734375
GPU memory for training: 2.390429973602295                          

One training iteration takes: 0.3047811985015869 seconds
Index: 1
Memory occupied: [3672.0, 2364.0] Time: 8.794094800949097
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 10.280298709869385
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 11.778190851211548
Length of received data: 259631121
Future took 3.882794141769409 seconds
Pickle took 0.13485217094421387 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.017792463302612 seconds
Dataloader took 0.0920720100402832 seconds
Streaming imagenet data took 4.10991096496582 seconds
Then, training+dataloading take 4.122772455215454 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08222770690917969
Time for copying to cuda: 0.054376840591430664
Time for forward pass: 0.1426842212677002
Time for backpropagation: 0.003138303756713867
GPU memory for training: 2.390429973602295                          

One training iteration takes: 0.28765296936035156 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 71, 18']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 16, 2']
Memory occupied: [3680.0, 2364.0] Time: 13.220850229263306
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 14.684051275253296
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 16.140642166137695
Length of received data: 259631121
Future took 3.919346332550049 seconds
Pickle took 0.12956547737121582 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.049063682556152 seconds
Dataloader took 0.09157943725585938 seconds
Streaming imagenet data took 4.140688896179199 seconds
Then, training+dataloading take 4.153357982635498 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07131791114807129
Time for copying to cuda: 0.05445384979248047
Time for forward pass: 0.11220359802246094
Time for backpropagation: 0.0021924972534179688
GPU memory for training: 2.390429973602295                          

One training iteration takes: 0.25089287757873535 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 30, 9']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 17.576603174209595
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 19.022878408432007
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 20.484550714492798
Length of received data: 259631121
Future took 3.943047046661377 seconds
Pickle took 0.12970709800720215 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.072907447814941 seconds
Dataloader took 0.0926809310913086 seconds
Streaming imagenet data took 4.165645599365234 seconds
Then, training+dataloading take 4.17844033241272 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07189202308654785
Time for copying to cuda: 0.05434298515319824
Time for forward pass: 0.11238813400268555
Time for backpropagation: 0.0022788047790527344
GPU memory for training: 2.390429973602295                          

One training iteration takes: 0.25180721282958984 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 21.92442226409912
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 23.381420135498047
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 259631121
Future took 3.9061124324798584 seconds
Pickle took 0.14584994316101074 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.052232980728149 seconds
Memory occupied: [3680.0, 2364.0] Time: 24.929510354995728
Dataloader took 0.0916907787322998 seconds
Streaming imagenet data took 4.143970489501953 seconds
Then, training+dataloading take 4.158618450164795 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07152485847473145
Time for copying to cuda: 0.05416512489318848
Time for forward pass: 0.11238455772399902
Time for backpropagation: 0.002247333526611328
GPU memory for training: 2.390429973602295                          

One training iteration takes: 0.2511138916015625 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 26.370015859603882
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 27.824440717697144
Length of received data: 259631121
Future took 3.7489376068115234 seconds
Pickle took 0.13257050514221191 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 3.8816559314727783 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.18456745147705078 seconds
Streaming imagenet data took 4.066287279129028 seconds
Then, training+dataloading take 4.074836254119873 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.11909174919128418
Time for copying to cuda: 0.054472923278808594
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for forward pass: 0.11276578903198242
Time for backpropagation: 0.00252532958984375
GPU memory for training: 2.390429973602295                          

One training iteration takes: 0.29947781562805176 seconds
Index: 6
Memory occupied: [3680.0, 2364.0] Time: 29.409996032714844
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 30.8558406829834
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 2364.0] Time: 32.32087588310242
Length of received data: 259631121
Future took 3.817725658416748 seconds
Pickle took 0.1311054229736328 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 3.9489688873291016 seconds
Dataloader took 0.09231758117675781 seconds
Streaming imagenet data took 4.04134464263916 seconds
Then, training+dataloading take 4.059678792953491 seconds

Epoch: 0
Time of next(dataloader) is: 0.07180619239807129
Time for copying to cuda: 0.05418086051940918
Time for forward pass: 0.11306881904602051
Time for backpropagation: 0.0035545825958251953
GPU memory for training: 2.390429973602295                          

Last train takes: 0.24750351905822754 seconds
Total time for streaming and training: 33.41749572753906
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 50, 9']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 53, 14']
Memory occupied: [3680.0, 2364.0] Time: 33.775020360946655
Finish gpu thread time: 1.358579158782959
The whole process took 41.222588539123535 seconds
