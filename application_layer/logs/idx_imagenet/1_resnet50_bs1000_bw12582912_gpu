Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=1, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9945.343898086498 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1303556115.4099934 1303556115.4099934
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 1 21
Intermediate:  3.0625
3.63671875
Total layers size  110.74014282226562
Server, client, server+client, vanilla  165.10302734375 9292.857421875 9457.96044921875 10441.294921875
Fixed, scale_with_bsz  0 4.2109375
Mem usage  1410.0 3.0
Using split index: 1
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.617451667785645 seconds
Memory occpied: (1410.0, 3.0)
Streaming imagenet data took 14.79799485206604 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.114046573638916
Time for copying to cuda: 0.7760879993438721
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.06232500076294 seconds
Streaming imagenet data took 14.223205089569092 seconds
Time for forward pass: 12.08025336265564
Time for backpropagation: 0.06732678413391113
GPU memory for training: 17.227513790130615                          

Memory occpied: (1410.0, 3.0)
One training iteration takes: 15.410537242889404 seconds
Index: 0
Then, training+dataloading take 15.41725492477417 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (12490.0, 6368.0)
Memory occpied: (12490.0, 6368.0)
Time of next(dataloader) is: 2.1481356620788574
Time for copying to cuda: 0.7776248455047607
Memory occpied: (12498.0, 9440.0)
Time for forward pass: 1.5932252407073975
Time for backpropagation: 0.00704646110534668
GPU memory for training: 14.418626308441162                          

Memory occpied: (12498.0, 9440.0)
One training iteration takes: 4.949009418487549 seconds
Index: 1
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.33162546157837 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 14.563407897949219 seconds
Then, training+dataloading take 14.694203615188599 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3152236938476562
Time for copying to cuda: 0.768195390701294
Time for forward pass: 1.5773963928222656
Time for backpropagation: 0.006638526916503906
GPU memory for training: 14.417954921722412                          

Memory occpied: (12498.0, 9440.0)
One training iteration takes: 5.065175771713257 seconds
Index: 2
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.3543701171875 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 14.677425146102905 seconds
Then, training+dataloading take 14.839805603027344 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.314549446105957
Time for copying to cuda: 0.7668802738189697
Time for forward pass: 1.59075927734375
Time for backpropagation: 0.006544828414916992
GPU memory for training: 14.417954921722412                          

Memory occpied: (12498.0, 9440.0)
One training iteration takes: 5.087190628051758 seconds
Index: 3
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.887397527694702 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 15.195788383483887 seconds
Then, training+dataloading take 15.259732484817505 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Time of next(dataloader) is: 2.164489984512329
Memory occpied: (12498.0, 9440.0)
Time for copying to cuda: 0.8808043003082275
Memory occpied: (12498.0, 9440.0)
Time for forward pass: 1.6044378280639648
Time for backpropagation: 0.0066492557525634766
GPU memory for training: 14.417954921722412                          

One training iteration takes: 5.07860803604126 seconds
Index: 4
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.144146203994751 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 14.448265075683594 seconds
Then, training+dataloading take 14.572104454040527 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2913522720336914
Time for copying to cuda: 0.7635223865509033
Time for forward pass: 1.5804283618927002
Time for backpropagation: 0.006545543670654297
GPU memory for training: 14.417954921722412                          

One training iteration takes: 5.114092588424683 seconds
Index: 5
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 13.858411073684692 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 15.068078756332397 seconds
Then, training+dataloading take 15.243457078933716 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3304498195648193
Time for copying to cuda: 0.7694237232208252
Time for forward pass: 1.5862584114074707
Time for backpropagation: 0.00661778450012207
GPU memory for training: 14.417954921722412                          

Memory occpied: (12498.0, 9440.0)
One training iteration takes: 5.112213134765625 seconds
Index: 6
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Length of received data: 3211310121
Read 3062.543984413147 MBs for this batch
Executing all posts took 12.93179726600647 seconds
Memory occpied: (12498.0, 9440.0)
Streaming imagenet data took 14.242445468902588 seconds
Then, training+dataloading take 14.406131029129028 seconds

Epoch: 0
Memory occpied: (12498.0, 9440.0)
Memory occpied: (12498.0, 9440.0)
Time of next(dataloader) is: 2.288621425628662
Memory occpied: (12498.0, 9440.0)
Time for copying to cuda: 0.8685579299926758
Memory occpied: (12498.0, 9440.0)
Time for forward pass: 1.5814571380615234
Time for backpropagation: 0.0067636966705322266
GPU memory for training: 14.417954921722412                          

The whole process took 131.014967918396 seconds
