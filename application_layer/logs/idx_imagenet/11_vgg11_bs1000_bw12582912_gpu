Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=11, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1606440544128418
Time to prepare transforms: 0.0002410411834716797
Time to download labels: 0.0622713565826416
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10104.518712873263 Mbps
Get bandwitdh took 1.2241287231445312
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1324419476.7337244 1324419476.7337244
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 11 25
Intermediate:  0.765625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 4436.71337890625 5345.10986328125 28745.30712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Time for splitting algorithm: 6.5706870555877686
Using split index: 11
Freezing the lower layers of the model (myvgg11) till index 25
Time to freeze model: 0.000240325927734375
Time for model prep: 0.0008912086486816406
Time for model and splitting algorithm: 6.571838140487671
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 5, 2']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 0.32195425033569336
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 1.6390588283538818
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 2.961705446243286
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 4.28551721572876
Length of received data: 802863121
Future took 5.6049110889434814 seconds
Pickle took 0.42357611656188965 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.028681516647339 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4628183841705322 seconds
Streaming imagenet data took 6.491542100906372 seconds
First stream takes: 6.541522979736328 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occupied: [1840.0, 3.0] Time: 6.542766809463501
Time of next(dataloader) is: 0.10647344589233398
Time for copying to cuda: 0.16837120056152344
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2606.0, 850.0] Time: 7.97887110710144
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 1, 0']
Memory occupied: [2606.0, 1358.0] Time: 9.459681510925293
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 9']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 79, 7']
Memory occupied: [7220.0, 6372.0] Time: 10.943841457366943
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 38']
Length of received data: 802863121
Future took 5.748450040817261 seconds
Pickle took 0.4154086112976074 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.164026260375977 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 7']
Memory occupied: [13660.0, 13264.0] Time: 12.998426914215088
Dataloader took 0.3935816287994385 seconds
Streaming imagenet data took 6.5576536655426025 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 39']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 94, 31']
Memory occupied: [13660.0, 13264.0] Time: 14.496545553207397
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 96, 34']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 81, 38']
Memory occupied: [6776.0, 6372.0] Time: 15.995211362838745
Time for forward pass: 9.313456296920776
Time for backpropagation: 0.05043172836303711
GPU memory for training: 18.56304168701172                          

One training iteration takes: 9.670124292373657 seconds
Index: 0
Then, training+dataloading take 9.671905755996704 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09765744209289551
Time for copying to cuda: 0.16745710372924805
Time for forward pass: 0.44336843490600586
Time for backpropagation: 0.0028192996978759766
GPU memory for training: 11.537689208984375                          

One training iteration takes: 0.7426884174346924 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 97, 43']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 26, 4']
Memory occupied: [10376.0, 9602.0] Time: 17.418781042099
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 18.837226390838623
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 20.253949403762817
Length of received data: 802863121
Future took 5.63093638420105 seconds
Pickle took 0.42351460456848145 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.054625988006592 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 22.681796550750732
Dataloader took 0.44501662254333496 seconds
Streaming imagenet data took 6.4996888637542725 seconds
Then, training+dataloading take 6.544634103775024 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09815835952758789
Time for copying to cuda: 0.16762804985046387
Time for forward pass: 0.5313470363616943
Time for backpropagation: 0.0027227401733398438
GPU memory for training: 11.536712646484375                          

One training iteration takes: 0.8301999568939209 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 75, 28']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 24.107977628707886
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 25.53234028816223
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 26.957793951034546
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 28.8908634185791
Length of received data: 802863121
Future took 6.1351704597473145 seconds
Pickle took 0.4215996265411377 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.556915998458862 seconds
Dataloader took 0.2820878028869629 seconds
Streaming imagenet data took 6.839050531387329 seconds
Then, training+dataloading take 6.882540702819824 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09780097007751465
Time for copying to cuda: 0.2275829315185547
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 21, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 59, 44']
Memory occupied: [10376.0, 9602.0] Time: 30.417183876037598
Time for forward pass: 0.5170989036560059
Time for backpropagation: 0.0027861595153808594
GPU memory for training: 11.536712646484375                          

One training iteration takes: 0.8751876354217529 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 31.84877109527588
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 33.284889936447144
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 34.73912167549133
Length of received data: 802863121
Future took 6.115844249725342 seconds
Pickle took 0.4214339256286621 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.5924952030181885 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.47692227363586426 seconds
Streaming imagenet data took 7.069528579711914 seconds
Then, training+dataloading take 7.087376594543457 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occupied: [10376.0, 9602.0] Time: 36.83275008201599
Time of next(dataloader) is: 0.10575222969055176
Time for copying to cuda: 0.1674659252166748
Time for forward pass: 0.5160796642303467
Time for backpropagation: 0.0027456283569335938
GPU memory for training: 11.536712646484375                          

One training iteration takes: 0.8188848495483398 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 38.30045461654663
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 39.76823973655701
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 41.23832726478577
Length of received data: 802863121
Future took 5.60755729675293 seconds
Pickle took 0.38289904594421387 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.045354843139648 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.44480276107788086 seconds
Streaming imagenet data took 6.490295648574829 seconds
Then, training+dataloading take 6.5129780769348145 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occupied: [10376.0, 9602.0] Time: 43.313469648361206
Time of next(dataloader) is: 0.10687398910522461
Time for copying to cuda: 0.16730761528015137
Time for forward pass: 0.5307517051696777
Time for backpropagation: 0.0026657581329345703
GPU memory for training: 11.536712646484375                          

One training iteration takes: 0.8380546569824219 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 44.75090980529785
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 46.186421394348145
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 47.62459874153137
Length of received data: 802863121
Future took 5.810871362686157 seconds
Pickle took 0.422802209854126 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.233952045440674 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 49.898120403289795
Dataloader took 0.449169397354126 seconds
Streaming imagenet data took 6.6831769943237305 seconds
Then, training+dataloading take 6.722784996032715 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.1044151782989502
Time for copying to cuda: 0.16774797439575195
Time for forward pass: 0.4988443851470947
Time for backpropagation: 0.0026955604553222656
GPU memory for training: 11.536712646484375                          

One training iteration takes: 0.7993006706237793 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 25, 5']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 51.3654899597168
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 52.834490060806274
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [10376.0, 9602.0] Time: 54.303417921066284
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 802863121
Future took 6.064452648162842 seconds
Memory occupied: [10376.0, 9602.0] Time: 56.412277698516846
Pickle took 0.3836681842803955 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 6.44827127456665 seconds
Dataloader took 0.28188228607177734 seconds
Streaming imagenet data took 6.730214595794678 seconds
Then, training+dataloading take 6.768600940704346 seconds

Epoch: 0
Time of next(dataloader) is: 0.10089778900146484
Time for copying to cuda: 0.16792821884155273
Time for forward pass: 0.5165455341339111
Time for backpropagation: 0.0034339427947998047
GPU memory for training: 11.536712646484375                          

Last train takes: 0.8135862350463867 seconds
Total time for streaming and training: 57.54617214202881
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 55']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 37, 8']
Memory occupied: [10376.0, 9602.0] Time: 57.897892475128174
Finish gpu thread time: 1.352785348892212
The whole process took 66.69433236122131 seconds
