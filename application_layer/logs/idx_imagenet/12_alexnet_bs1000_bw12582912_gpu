Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=12, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1624712944030762
Time to prepare transforms: 0.00024175643920898438
Time to download labels: 0.047010183334350586
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10507.738448621441 Mbps
Get bandwitdh took 1.2266573905944824
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1377270293.9377096 1377270293.9377096
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 12 17
Intermediate:  0.1650390625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 700.07080078125 966.34814453125 2586.30126953125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.2293572425842285
Using split index: 12
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.000240325927734375
Time for model prep: 0.0007724761962890625
Time for model and splitting algorithm: 5.230390310287476
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.32633233070373535
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6544075012207031
Length of received data: 173103121
Future took 1.9472706317901611 seconds
Pickle took 0.09286069869995117 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.040287494659424 seconds
Dataloader took 0.0619654655456543 seconds
Streaming imagenet data took 2.1022884845733643 seconds
First stream takes: 2.1083757877349854 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.050876617431640625
Time for copying to cuda: 0.03719925880432129
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 4, 0']
Memory occupied: [1680.0, 430.0] Time: 3.039076328277588
Length of received data: 173103121
Future took 2.032613515853882 seconds
Pickle took 0.13966941833496094 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.173269033432007 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.11238741874694824 seconds
Streaming imagenet data took 2.2857987880706787 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 1, 0']
Memory occupied: [1680.0, 1016.0] Time: 4.683990240097046
Time for forward pass: 3.309518814086914
Time for backpropagation: 0.04975271224975586
GPU memory for training: 1.2120437622070312                          

One training iteration takes: 3.4546384811401367 seconds
Index: 0
Then, training+dataloading take 3.455200672149658 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05046558380126953
Time for copying to cuda: 0.03659415245056152
Time for forward pass: 0.07890033721923828
Time for backpropagation: 0.004431009292602539
GPU memory for training: 1.367194652557373                          

One training iteration takes: 0.17408156394958496 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 52, 9']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 6.116769552230835
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 173103121
Future took 2.0388295650482178 seconds
Memory occupied: [2420.0, 1642.0] Time: 7.694703578948975
Pickle took 0.09198546409606934 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.130950689315796 seconds
Dataloader took 0.062188148498535156 seconds
Streaming imagenet data took 2.1931843757629395 seconds
Then, training+dataloading take 2.199317455291748 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04973554611206055
Time for copying to cuda: 0.03657817840576172
Time for forward pass: 0.05531907081604004
Time for backpropagation: 0.0022318363189697266
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.15015721321105957 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 9.126698017120361
Length of received data: 173103121
Future took 1.8253486156463623 seconds
Pickle took 0.07237625122070312 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8978674411773682 seconds
Dataloader took 0.06210446357727051 seconds
Streaming imagenet data took 1.9600145816802979 seconds
Then, training+dataloading take 1.9689977169036865 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.049439191818237305
Time for copying to cuda: 0.03669595718383789
Time for forward pass: 0.05530667304992676
Time for backpropagation: 0.0021827220916748047
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.15008926391601562 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 14, 4']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 10.549469709396362
Length of received data: 173103121
Future took 1.9338040351867676 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Pickle took 0.08506178855895996 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.019010305404663 seconds
Dataloader took 0.1040811538696289 seconds
Streaming imagenet data took 2.1231396198272705 seconds
Then, training+dataloading take 2.1328532695770264 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09997296333312988
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.06978273391723633
Time for forward pass: 0.05580782890319824
Time for backpropagation: 0.0023279190063476562
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.23462128639221191 seconds
Index: 4
Memory occupied: [2420.0, 1642.0] Time: 12.099795818328857
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 13.551981210708618
Length of received data: 173103121
Future took 1.8595480918884277 seconds
Pickle took 0.08586263656616211 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.9455556869506836 seconds
Dataloader took 0.06325554847717285 seconds
Streaming imagenet data took 2.0088534355163574 seconds
Then, training+dataloading take 2.016566753387451 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05293989181518555
Time for copying to cuda: 0.0366973876953125
Time for forward pass: 0.05542945861816406
Time for backpropagation: 0.0022971630096435547
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.15369820594787598 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 14.981082916259766
Length of received data: 173103121
Future took 1.8200256824493408 seconds
Pickle took 0.08071446418762207 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.9008898735046387 seconds
Dataloader took 0.06217145919799805 seconds
Streaming imagenet data took 1.9631142616271973 seconds
Then, training+dataloading take 1.970940113067627 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05299639701843262
Time for copying to cuda: 0.03654670715332031
Time for forward pass: 0.08290624618530273
Time for backpropagation: 0.003129243850708008
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.17896771430969238 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 1, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 8, 0']
Memory occupied: [2420.0, 1642.0] Time: 16.416486740112305
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 173103121
Future took 1.9496963024139404 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Pickle took 0.08551359176635742 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.035351037979126 seconds
Dataloader took 0.10657382011413574 seconds
Streaming imagenet data took 2.1419737339019775 seconds
Then, training+dataloading take 2.1520650386810303 seconds

Epoch: 0
Memory occupied: [2420.0, 1642.0] Time: 18.005091667175293
Time of next(dataloader) is: 0.05330991744995117
Time for copying to cuda: 0.03645777702331543
Time for forward pass: 0.0553433895111084
Time for backpropagation: 0.002235889434814453
GPU memory for training: 1.367560863494873                          

Last train takes: 0.15350818634033203 seconds
Total time for streaming and training: 18.158015251159668
Finish gpu thread time: 0.8481340408325195
The whole process took 25.44666886329651 seconds
