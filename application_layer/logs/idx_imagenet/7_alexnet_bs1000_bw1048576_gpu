Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=7, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.162095546722412
Time to prepare transforms: 0.0002541542053222656
Time to download labels: 0.048938751220703125
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7528734790998 Mbps
Get bandwitdh took 1.2336256504058838
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119112056.63265257 119112056.63265257
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 7 17
Intermediate:  0.24755859375
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 1077.51220703125 1343.78955078125 2881.22314453125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.255223512649536
Using split index: 7
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.00021505355834960938
Time for model prep: 0.0007894039154052734
Time for model and splitting algorithm: 5.256246328353882
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 1, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.3208317756652832
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6446759700775146
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 3.0056211948394775
Length of received data: 259631121
Future took 3.9347569942474365 seconds
Pickle took 0.1380448341369629 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.072994947433472 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.1759936809539795 seconds
Streaming imagenet data took 4.249048948287964 seconds
First stream takes: 4.256717681884766 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.11393952369689941
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for copying to cuda: 0.0818328857421875
Memory occupied: [1514.0, 15.0] Time: 4.4864442348480225
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1762.0, 698.0] Time: 5.891287088394165
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1762.0, 1190.0] Time: 7.339941024780273
Length of received data: 259631121
Future took 3.8961470127105713 seconds
Pickle took 0.12923622131347656 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.025559902191162 seconds
Dataloader took 0.13877606391906738 seconds
Streaming imagenet data took 4.1644086837768555 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 64, 21']
Time for forward pass: 4.09610390663147
Time for backpropagation: 0.0958709716796875
GPU memory for training: 4.371849060058594                          

One training iteration takes: 4.393819093704224 seconds
Index: 0
Then, training+dataloading take 4.394068241119385 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 69, 33']
Time of next(dataloader) is: 0.12440896034240723
Memory occupied: [3672.0, 3134.0] Time: 8.815535068511963
Time for copying to cuda: 0.055216312408447266
Time for forward pass: 0.07701396942138672
Time for backpropagation: 0.0022552013397216797
GPU memory for training: 2.389697551727295                          

One training iteration takes: 0.2706484794616699 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 10.235107421875
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 11.676637887954712
Length of received data: 259631121
Future took 3.8861758708953857 seconds
Pickle took 0.1350994110107422 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.021421432495117 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.1832261085510254 seconds
Streaming imagenet data took 4.204730272293091 seconds
Then, training+dataloading take 4.2131431102752686 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07911872863769531
Time for copying to cuda: 0.09619545936584473
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for forward pass: 0.11463069915771484
Time for backpropagation: 0.00299835205078125
GPU memory for training: 2.389697551727295                          

One training iteration takes: 0.3040769100189209 seconds
Index: 2
Memory occupied: [3680.0, 3142.0] Time: 13.176024913787842
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 14.604267120361328
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 16.071183681488037
Length of received data: 259631121
Future took 3.9127542972564697 seconds
Pickle took 0.12938451766967773 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.0422682762146 seconds
Dataloader took 0.0915062427520752 seconds
Streaming imagenet data took 4.133837699890137 seconds
Then, training+dataloading take 4.146471261978149 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.11649489402770996
Time for copying to cuda: 0.05446600914001465
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 0.11423778533935547
Time for backpropagation: 0.0026366710662841797
GPU memory for training: 2.389697551727295                          

One training iteration takes: 0.29790210723876953 seconds
Index: 3
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 3']
Memory occupied: [3680.0, 3142.0] Time: 17.52698302268982
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 18.965461015701294
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 20.420940160751343
Length of received data: 259631121
Future took 3.9880216121673584 seconds
Pickle took 0.13182520866394043 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.119991064071655 seconds
Dataloader took 0.09224867820739746 seconds
Streaming imagenet data took 4.212287187576294 seconds
Then, training+dataloading take 4.224375486373901 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07130885124206543
Time for copying to cuda: 0.05436444282531738
Time for forward pass: 0.11468100547790527
Time for backpropagation: 0.003243684768676758
GPU memory for training: 2.389697551727295                          

One training iteration takes: 0.24859404563903809 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 82, 17']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 32, 6']
Memory occupied: [3680.0, 3142.0] Time: 21.878137350082397
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 23.325061082839966
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 24.789247512817383
Length of received data: 259631121
Future took 4.045258283615112 seconds
Pickle took 0.12807416915893555 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.173484563827515 seconds
Dataloader took 0.09138226509094238 seconds
Streaming imagenet data took 4.264911890029907 seconds
Then, training+dataloading take 4.278936386108398 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07103538513183594
Time for copying to cuda: 0.05442404747009277
Time for forward pass: 0.11335325241088867
Time for backpropagation: 0.002388477325439453
GPU memory for training: 2.389697551727295                          

One training iteration takes: 0.25533628463745117 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 51, 10']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 26.22561264038086
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 27.671927213668823
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 29.12889313697815
Length of received data: 259631121
Future took 4.133481025695801 seconds
Pickle took 0.13063716888427734 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.264265060424805 seconds
Dataloader took 0.09122443199157715 seconds
Streaming imagenet data took 4.355535507202148 seconds
Then, training+dataloading take 4.36762547492981 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.07142829895019531
Time for copying to cuda: 0.05442309379577637
Time for forward pass: 0.11340856552124023
Time for backpropagation: 0.0023908615112304688
GPU memory for training: 2.389697551727295                          

One training iteration takes: 0.2516748905181885 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 78, 16']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 37, 7']
Memory occupied: [3680.0, 3142.0] Time: 30.577478647232056
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 32.02298617362976
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3680.0, 3142.0] Time: 33.485995292663574
Length of received data: 259631121
Future took 4.109296798706055 seconds
Pickle took 0.12840819358825684 seconds
Read 247.60353183746338 MBs for this batch
Executing all posts took 4.2378504276275635 seconds
Dataloader took 0.09276223182678223 seconds
Streaming imagenet data took 4.330661058425903 seconds
Then, training+dataloading take 4.344743728637695 seconds

Epoch: 0
Time of next(dataloader) is: 0.0707862377166748
Time for copying to cuda: 0.05437612533569336
Time for forward pass: 0.1134033203125
Time for backpropagation: 0.002295970916748047
GPU memory for training: 2.389697551727295                          

Last train takes: 0.25038981437683105 seconds
Total time for streaming and training: 34.476677656173706
Finish gpu thread time: 0.010287284851074219
The whole process took 40.95488953590393 seconds
