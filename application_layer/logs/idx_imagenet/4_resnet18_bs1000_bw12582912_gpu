Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=4, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1623194217681885
Time to prepare transforms: 0.0002384185791015625
Time to download labels: 0.04828000068664551
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10508.091989704493 Mbps
Get bandwitdh took 1.2369601726531982
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1377316633.2745473 1377316633.2745473
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 4 11
Intermediate:  0.765625
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  151.8779296875 2544.50732421875 2696.38525390625 8478.10107421875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Time for splitting algorithm: 4.925414800643921
Using split index: 4
Freezing the lower layers of the model (myresnet18) till index 11
Time to freeze model: 0.0003669261932373047
Time for model prep: 0.001383066177368164
Time for model and splitting algorithm: 4.927183628082275
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 3, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 0.33305788040161133
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 1.6699516773223877
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1336.0, 3.0] Time: 3.3311145305633545
Length of received data: 802862121
Future took 3.629122734069824 seconds
Pickle took 0.41794490814208984 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 4.047229528427124 seconds
Dataloader took 0.2839221954345703 seconds
Streaming imagenet data took 4.331199645996094 seconds
First stream takes: 4.375946044921875 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time of next(dataloader) is: 0.1890277862548828
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2102.0, 3.0] Time: 4.78187370300293
Time for copying to cuda: 0.24038243293762207
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2102.0, 978.0] Time: 6.225262641906738
Length of received data: 802862121
Future took 3.3317978382110596 seconds
Pickle took 0.41934680938720703 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.7513489723205566 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 3, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 78, 8']
Dataloader took 0.5124237537384033 seconds
Streaming imagenet data took 4.263844728469849 seconds
Memory occupied: [5974.0, 5542.0] Time: 8.729054927825928
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 87, 31']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 84, 26']
Memory occupied: [8766.0, 8372.0] Time: 10.226936340332031
Time for forward pass: 5.586107015609741
Time for backpropagation: 0.7592177391052246
GPU memory for training: 8.687753200531006                          

One training iteration takes: 6.800881385803223 seconds
Index: 0
Then, training+dataloading take 6.802626609802246 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.1498258113861084
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 29, 21']
Time for copying to cuda: 0.24859046936035156
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5566.0, 5150.0] Time: 11.725538730621338
Time for forward pass: 0.34464573860168457
Time for backpropagation: 0.004300117492675781
GPU memory for training: 4.047797679901123                          

One training iteration takes: 0.7734692096710205 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 13.154512643814087
Length of received data: 802862121
Future took 3.319129467010498 seconds
Pickle took 0.4177415370941162 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.790193796157837 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4416539669036865 seconds
Streaming imagenet data took 4.23195743560791 seconds
Then, training+dataloading take 4.25528883934021 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occupied: [5582.0, 5150.0] Time: 15.529197931289673
Time of next(dataloader) is: 0.10413479804992676
Time for copying to cuda: 0.16762495040893555
Time for forward pass: 0.43431615829467773
Time for backpropagation: 0.004033803939819336
GPU memory for training: 4.047797679901123                          

One training iteration takes: 0.736875057220459 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 16.965981245040894
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 18.59201693534851
Length of received data: 802862121
Future took 3.545238733291626 seconds
Pickle took 0.4102632999420166 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.9556469917297363 seconds
Dataloader took 0.33530473709106445 seconds
Streaming imagenet data took 4.291011333465576 seconds
Then, training+dataloading take 4.337955713272095 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.19583415985107422
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 20.150351762771606
Time for copying to cuda: 0.21245455741882324
Time for forward pass: 0.42044878005981445
Time for backpropagation: 0.0040645599365234375
GPU memory for training: 4.047797679901123                          

One training iteration takes: 0.8588974475860596 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 21.59185004234314
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 802862121
Future took 3.398253917694092 seconds
Pickle took 0.4107494354248047 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.8092103004455566 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 23.997877836227417
Dataloader took 0.44440174102783203 seconds
Streaming imagenet data took 4.253653049468994 seconds
Then, training+dataloading take 4.301496505737305 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10576796531677246
Time for copying to cuda: 0.16742658615112305
Time for forward pass: 0.4370734691619873
Time for backpropagation: 0.004088163375854492
GPU memory for training: 4.047797679901123                          

One training iteration takes: 0.7402310371398926 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 25.437098503112793
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 26.909237146377563
Length of received data: 802862121
Future took 3.5345911979675293 seconds
Pickle took 0.41089963912963867 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.945650339126587 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.49681520462036133 seconds
Streaming imagenet data took 4.442538261413574 seconds
Then, training+dataloading take 4.464403390884399 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occupied: [5582.0, 5150.0] Time: 28.610832452774048
Time of next(dataloader) is: 0.1087186336517334
Time for copying to cuda: 0.1681535243988037
Time for forward pass: 0.4195740222930908
Time for backpropagation: 0.004235267639160156
GPU memory for training: 4.047797679901123                          

One training iteration takes: 0.7276127338409424 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 30.0513813495636
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 31.581705331802368
Length of received data: 802862121
Future took 3.480743646621704 seconds
Pickle took 0.41160082817077637 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.892498254776001 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.38669371604919434 seconds
Streaming imagenet data took 4.2792792320251465 seconds
Then, training+dataloading take 4.302503824234009 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.15358996391296387
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 33.139892578125
Time for copying to cuda: 0.21555519104003906
Time for forward pass: 0.425095796585083
Time for backpropagation: 0.004495382308959961
GPU memory for training: 4.047797679901123                          

One training iteration takes: 0.8258323669433594 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 34.58004641532898
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 802862121
Memory occupied: [5582.0, 5150.0] Time: 36.3119158744812
Future took 3.4711835384368896 seconds
Pickle took 0.411668062210083 seconds
Read 765.668984413147 MBs for this batch
Executing all posts took 3.882997512817383 seconds
Dataloader took 0.2850923538208008 seconds
Streaming imagenet data took 4.168144941329956 seconds
Then, training+dataloading take 4.2140583992004395 seconds

Epoch: 0
Time of next(dataloader) is: 0.103179931640625
Time for copying to cuda: 0.16905641555786133
Time for forward pass: 0.4486215114593506
Time for backpropagation: 0.00572657585144043
GPU memory for training: 4.047797679901123                          

Last train takes: 0.7437558174133301 seconds
Total time for streaming and training: 37.79834246635437
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 100, 70']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [5582.0, 5150.0] Time: 38.20059370994568
Finish gpu thread time: 1.4033024311065674
The whole process took 45.340073108673096 seconds
