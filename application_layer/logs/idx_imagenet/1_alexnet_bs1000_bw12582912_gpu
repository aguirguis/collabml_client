Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=1, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1620500087738037
Time to prepare transforms: 0.0002536773681640625
Time to download labels: 0.04673027992248535
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10109.799598355117 Mbps
Get bandwitdh took 1.2308399677276611
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1325111652.955602 1325111652.955602
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 1 17
Intermediate:  0.738525390625
1.312744140625
Total layers size  4.189361572265625
Server, client, server+client, vanilla  263.6484375 2550.41259765625 2814.06103515625 3698.85009765625
Fixed, scale_with_bsz  0 1.886962890625
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.198719501495361
Using split index: 1
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.00020265579223632812
Time for model prep: 0.0007932186126708984
Time for model and splitting algorithm: 5.199732065200806
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.3151519298553467
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6397678852081299
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 3.2533648014068604
Length of received data: 774446121
Future took 3.7423954010009766 seconds
Pickle took 0.4008631706237793 seconds
Read 738.569375038147 MBs for this batch
Executing all posts took 4.143416881561279 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.4006626605987549 seconds
Streaming imagenet data took 4.544142723083496 seconds
First stream takes: 4.565399169921875 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.14670634269714355
Memory occupied: [1514.0, 3.0] Time: 4.724783182144165
Time for copying to cuda: 0.1625669002532959
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 4, 0']
Memory occupied: [2254.0, 854.0] Time: 6.1654157638549805
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [2254.0, 1370.0] Time: 7.652351140975952
Length of received data: 774446121
Future took 3.783918619155884 seconds
Pickle took 0.4032318592071533 seconds
Read 738.569375038147 MBs for this batch
Executing all posts took 4.187316179275513 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 100, 3']
Dataloader took 0.5013210773468018 seconds
Streaming imagenet data took 4.688723564147949 seconds
Memory occupied: [5088.0, 4498.0] Time: 9.344168186187744
Time for forward pass: 5.26046347618103
Time for backpropagation: 0.04611968994140625
GPU memory for training: 6.579479217529297                          

One training iteration takes: 5.643805742263794 seconds
Index: 0
Then, training+dataloading take 5.645406484603882 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09407520294189453
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 18, 4']
Time for copying to cuda: 0.24706530570983887
Time for forward pass: 0.14166808128356934
Time for backpropagation: 0.0030448436737060547
GPU memory for training: 3.8906803131103516                          

One training iteration takes: 0.512946367263794 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 24, 24']
Memory occupied: [3884.0, 3440.0] Time: 10.829055547714233
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 12.245702266693115
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 774446121
Memory occupied: [3884.0, 3440.0] Time: 13.970457792282104
Future took 3.7593493461608887 seconds
Pickle took 0.4016077518463135 seconds
Read 738.569375038147 MBs for this batch
Executing all posts took 4.1610918045043945 seconds
Dataloader took 0.2732076644897461 seconds
Streaming imagenet data took 4.4343438148498535 seconds
Then, training+dataloading take 4.461384296417236 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09212207794189453
Time for copying to cuda: 0.16117310523986816
Time for forward pass: 0.18957018852233887
Time for backpropagation: 0.002482175827026367
GPU memory for training: 3.8906803131103516                          

One training iteration takes: 0.47118473052978516 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 4']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 15.842679977416992
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 17.332233905792236
Length of received data: 774446121
Future took 3.6155025959014893 seconds
Pickle took 0.3510169982910156 seconds
Read 738.569375038147 MBs for this batch
Executing all posts took 3.966700553894043 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4765293598175049 seconds
Streaming imagenet data took 4.443305015563965 seconds
Then, training+dataloading take 4.46332859992981 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occupied: [3884.0, 3440.0] Time: 19.206271648406982
Time of next(dataloader) is: 0.11001706123352051
Time for copying to cuda: 0.16140270233154297
Time for forward pass: 0.18939542770385742
Time for backpropagation: 0.002312898635864258
GPU memory for training: 3.8906803131103516                          

One training iteration takes: 0.49097180366516113 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 20.63731050491333
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 22.082868814468384
Length of received data: 774446121
Future took 3.816763162612915 seconds
Pickle took 0.3952615261077881 seconds
Read 738.569375038147 MBs for this batch
Executing all posts took 4.21219801902771 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4830939769744873 seconds
Streaming imagenet data took 4.6953675746917725 seconds
Then, training+dataloading take 4.7164998054504395 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occupied: [3884.0, 3440.0] Time: 23.92509150505066
Time of next(dataloader) is: 0.11022162437438965
Time for copying to cuda: 0.16156291961669922
Time for forward pass: 0.18960285186767578
Time for backpropagation: 0.0023272037506103516
GPU memory for training: 3.8906803131103516                          

One training iteration takes: 0.4909200668334961 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 25.35450577735901
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 26.804362297058105
Length of received data: 774446121
Future took 3.802419424057007 seconds
Pickle took 0.3961508274078369 seconds
Read 738.569375038147 MBs for this batch
Executing all posts took 4.198739290237427 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.47972869873046875 seconds
Streaming imagenet data took 4.678542375564575 seconds
Then, training+dataloading take 4.699522256851196 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occupied: [3884.0, 3440.0] Time: 28.627687215805054
Time of next(dataloader) is: 0.10990571975708008
Time for copying to cuda: 0.16150712966918945
Time for forward pass: 0.18967032432556152
Time for backpropagation: 0.0023517608642578125
GPU memory for training: 3.8906803131103516                          

One training iteration takes: 0.49062633514404297 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 30.05790638923645
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 31.508445501327515
Length of received data: 774446121
Future took 3.7705259323120117 seconds
Pickle took 0.3973968029022217 seconds
Read 738.569375038147 MBs for this batch
Executing all posts took 4.168051242828369 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4854104518890381 seconds
Streaming imagenet data took 4.653541088104248 seconds
Then, training+dataloading take 4.665811061859131 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occupied: [3884.0, 3440.0] Time: 33.286577224731445
Time of next(dataloader) is: 0.10269355773925781
Time for copying to cuda: 0.16140365600585938
Time for forward pass: 0.18948817253112793
Time for backpropagation: 0.002326488494873047
GPU memory for training: 3.8906803131103516                          

One training iteration takes: 0.47994136810302734 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 34.77185130119324
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3884.0, 3440.0] Time: 36.271645069122314
Length of received data: 774446121
Future took 3.7763671875 seconds
Pickle took 0.3503568172454834 seconds
Read 738.569375038147 MBs for this batch
Executing all posts took 4.126860618591309 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4818401336669922 seconds
Streaming imagenet data took 4.608773469924927 seconds
Then, training+dataloading take 4.629624843597412 seconds

Epoch: 0
Memory occupied: [3884.0, 3440.0] Time: 37.925668478012085
Time of next(dataloader) is: 0.10932397842407227
Time for copying to cuda: 0.1613330841064453
Time for forward pass: 0.1893930435180664
Time for backpropagation: 0.0024666786193847656
GPU memory for training: 3.8906803131103516                          

Last train takes: 0.4892549514770508 seconds
Total time for streaming and training: 38.33647298812866
Finish gpu thread time: 0.5902130603790283
The whole process took 45.335853099823 seconds
