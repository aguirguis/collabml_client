Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=1, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 9991.342744978958 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1309585276.269882 1309585276.269882
All candidates indexes:  (array([ 5, 12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 1 17
Intermediate:  0.738525390625
1.312744140625
Total layers size  4.189361572265625
Server, client, server+client, vanilla  263.6484375 2550.41259765625 2814.06103515625 3698.85009765625
Fixed, scale_with_bsz  0 1.886962890625
Mem usage  1514.0 3.0
Using split index: 1
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 3.4368488788604736 seconds
Streaming imagenet data took 3.7917306423187256 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)

Epoch: 0
Time of next(dataloader) is: 0.7244539260864258
Time for copying to cuda: 0.18795084953308105
Memory occpied: (2254.0, 518.0)
Memory occpied: (2254.0, 932.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 3.6429293155670166 seconds
Memory occpied: (2254.0, 1416.0)
Streaming imagenet data took 4.023391008377075 seconds
Memory occpied: (4910.0, 4452.0)
Time for forward pass: 4.904211759567261
Time for backpropagation: 0.05265545845031738
GPU memory for training: 6.579479217529297                          

One training iteration takes: 6.017013072967529 seconds
Index: 0
Then, training+dataloading take 6.018667936325073 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7942180633544922
Time for copying to cuda: 0.18842649459838867
Time for forward pass: 0.1406557559967041
Time for backpropagation: 0.002848386764526367
GPU memory for training: 3.738168716430664                          

One training iteration takes: 1.2771100997924805 seconds
Index: 1
Memory occpied: (2764.0, 4468.0)
Memory occpied: (4266.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 3.647742509841919 seconds
Memory occpied: (4266.0, 4468.0)
Streaming imagenet data took 4.028843879699707 seconds
Then, training+dataloading take 4.071173429489136 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7606053352355957
Time for copying to cuda: 0.26476168632507324
Memory occpied: (4266.0, 4468.0)
Time for forward pass: 0.19210147857666016
Time for backpropagation: 0.0027000904083251953
GPU memory for training: 3.738168716430664                          

One training iteration takes: 1.3810994625091553 seconds
Index: 2
Memory occpied: (4266.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 3.372149705886841 seconds
Memory occpied: (4266.0, 4468.0)
Streaming imagenet data took 3.745145559310913 seconds
Then, training+dataloading take 3.7850329875946045 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7593135833740234
Time for copying to cuda: 0.2656064033508301
Memory occpied: (4266.0, 4468.0)
Time for forward pass: 0.1922616958618164
Time for backpropagation: 0.0027065277099609375
GPU memory for training: 3.738168716430664                          

One training iteration takes: 1.3724842071533203 seconds
Index: 3
Memory occpied: (4266.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 3.379328489303589 seconds
Memory occpied: (4266.0, 4468.0)
Streaming imagenet data took 3.753396511077881 seconds
Then, training+dataloading take 3.794208526611328 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7541196346282959
Time for copying to cuda: 0.2650911808013916
Memory occpied: (4266.0, 4468.0)
Time for forward pass: 0.19193601608276367
Time for backpropagation: 0.002786874771118164
GPU memory for training: 3.738168716430664                          

One training iteration takes: 1.3745396137237549 seconds
Index: 4
Memory occpied: (4266.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 3.4273386001586914 seconds
Memory occpied: (4266.0, 4468.0)
Streaming imagenet data took 3.80018949508667 seconds
Then, training+dataloading take 3.844993829727173 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7550914287567139
Time for copying to cuda: 0.26542234420776367
Memory occpied: (4266.0, 4468.0)
Time for forward pass: 0.1922752857208252
Time for backpropagation: 0.0027480125427246094
GPU memory for training: 3.738168716430664                          

One training iteration takes: 1.373744249343872 seconds
Index: 5
Memory occpied: (4266.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 3.6160709857940674 seconds
Memory occpied: (4266.0, 4468.0)
Streaming imagenet data took 3.9416897296905518 seconds
Then, training+dataloading take 3.9863522052764893 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7558355331420898
Time for copying to cuda: 0.26552367210388184
Memory occpied: (4266.0, 4468.0)
Time for forward pass: 0.19190502166748047
Time for backpropagation: 0.002760648727416992
GPU memory for training: 3.738168716430664                          

One training iteration takes: 1.3785748481750488 seconds
Index: 6
Memory occpied: (4266.0, 4468.0)
Length of received data: 774446121
Read 738.569375038147 MBs for this batch
Executing all posts took 3.4334585666656494 seconds
Memory occpied: (4266.0, 4468.0)
Streaming imagenet data took 3.806234359741211 seconds
Then, training+dataloading take 3.8498592376708984 seconds

Epoch: 0
Time of next(dataloader) is: 0.7526423931121826
Time for copying to cuda: 0.2656126022338867
Memory occpied: (4266.0, 4468.0)
Time for forward pass: 0.1923966407775879
Time for backpropagation: 0.002729654312133789
GPU memory for training: 3.738168716430664                          

The whole process took 41.643834352493286 seconds
