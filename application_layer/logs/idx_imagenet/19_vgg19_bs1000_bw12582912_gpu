Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=19, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10065.731785859956 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1319335596.6362362 1319335596.6362362
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 19 36
Intermediate:  0.765625
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 4954.48974609375 5904.10009765625 29263.08349609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 19
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 10.172492980957031 seconds
Streaming imagenet data took 10.452338457107544 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1894.0, 3.0)
Time of next(dataloader) is: 0.8212440013885498
Time for copying to cuda: 0.19496679306030273
Memory occpied: (2660.0, 644.0)
Memory occpied: (2660.0, 1086.0)
Memory occpied: (2660.0, 1506.0)
Memory occpied: (7282.0, 6416.0)
Memory occpied: (13720.0, 13308.0)
Memory occpied: (13720.0, 13308.0)
Memory occpied: (13720.0, 13308.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 9.820113182067871 seconds
Streaming imagenet data took 10.194386959075928 seconds
Memory occpied: (6828.0, 13308.0)
Time for forward pass: 10.193065166473389
Time for backpropagation: 0.10677003860473633
GPU memory for training: 18.64431095123291                          

One training iteration takes: 11.437309503555298 seconds
Index: 0
Then, training+dataloading take 11.437668323516846 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (4178.0, 6424.0)
Time of next(dataloader) is: 0.7625269889831543
Time for copying to cuda: 0.19500517845153809
Memory occpied: (11180.0, 9646.0)
Time for forward pass: 0.8448777198791504
Time for backpropagation: 0.004171133041381836
GPU memory for training: 12.726410865783691                          

One training iteration takes: 1.9800081253051758 seconds
Index: 1
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 9.923982620239258 seconds
Memory occpied: (11180.0, 9646.0)
Streaming imagenet data took 10.312726020812988 seconds
Then, training+dataloading take 10.353705644607544 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7792618274688721
Time for copying to cuda: 0.27408385276794434
Memory occpied: (11180.0, 9646.0)
Time for forward pass: 0.9035971164703369
Time for backpropagation: 0.00410151481628418
GPU memory for training: 12.725434303283691                          

One training iteration takes: 2.129873275756836 seconds
Index: 2
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 10.510594367980957 seconds
Streaming imagenet data took 10.8536958694458 seconds
Then, training+dataloading take 10.87382435798645 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8463001251220703
Time for copying to cuda: 0.19574236869812012
Time for forward pass: 0.9037246704101562
Time for backpropagation: 0.004099845886230469
GPU memory for training: 12.725434303283691                          

Memory occpied: (11180.0, 9646.0)
One training iteration takes: 2.1320462226867676 seconds
Index: 3
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 9.779728174209595 seconds
Memory occpied: (11180.0, 9646.0)
Streaming imagenet data took 10.122827768325806 seconds
Then, training+dataloading take 10.172853231430054 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7885451316833496
Memory occpied: (11180.0, 9646.0)
Time for copying to cuda: 0.23609232902526855
Time for forward pass: 0.9835212230682373
Time for backpropagation: 0.004639863967895508
GPU memory for training: 12.725434303283691                          

One training iteration takes: 2.178307056427002 seconds
Index: 4
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 10.153292655944824 seconds
Memory occpied: (11180.0, 9646.0)
Streaming imagenet data took 10.491295576095581 seconds
Then, training+dataloading take 10.541574716567993 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7948458194732666
Memory occpied: (11180.0, 9646.0)
Time for copying to cuda: 0.23568964004516602
Time for forward pass: 0.9048366546630859
Time for backpropagation: 0.00426936149597168
GPU memory for training: 12.725434303283691                          

One training iteration takes: 2.1345672607421875 seconds
Index: 5
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 10.050851345062256 seconds
Memory occpied: (11180.0, 9646.0)
Streaming imagenet data took 10.438494682312012 seconds
Then, training+dataloading take 10.488206386566162 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7815966606140137
Time for copying to cuda: 0.2748539447784424
Memory occpied: (11180.0, 9646.0)
Time for forward pass: 0.9547281265258789
Time for backpropagation: 0.004169464111328125
GPU memory for training: 12.725434303283691                          

One training iteration takes: 2.1391594409942627 seconds
Index: 6
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Memory occpied: (11180.0, 9646.0)
Length of received data: 802863121
Read 765.6699380874634 MBs for this batch
Executing all posts took 9.954549312591553 seconds
Memory occpied: (11180.0, 9646.0)
Streaming imagenet data took 10.291795253753662 seconds
Then, training+dataloading take 10.341951847076416 seconds

Epoch: 0
Time of next(dataloader) is: 0.784705638885498
Memory occpied: (11180.0, 9646.0)
Time for copying to cuda: 0.2749645709991455
Time for forward pass: 0.9129483699798584
Time for backpropagation: 0.004253864288330078
GPU memory for training: 12.725434303283691                          

Memory occpied: (11180.0, 9646.0)
The whole process took 96.00733852386475 seconds
