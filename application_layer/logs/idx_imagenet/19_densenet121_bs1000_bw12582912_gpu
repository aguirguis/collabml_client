Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=19, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.160294532775879
Time to prepare transforms: 0.00024628639221191406
Time to download labels: 0.047827959060668945
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10158.126658961935 Mbps
Get bandwitdh took 1.2356350421905518
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1331445977.4434588 1331445977.4434588
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 19 20
Intermediate:  0.095703125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 4776.28125 4971.50732421875 11379.796875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Time for splitting algorithm: 4.932113409042358
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
Time to freeze model: 0.0015501976013183594
Time for model prep: 0.00455021858215332
Time for model and splitting algorithm: 4.938237428665161
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 9, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 0.33550310134887695
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 1.6687648296356201
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1318.0, 3.0] Time: 3.000251293182373
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 100399121
Future took 4.245630502700806 seconds
Pickle took 0.05346798896789551 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.299378395080566 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.06921267509460449 seconds
Streaming imagenet data took 4.368647813796997 seconds
First stream takes: 4.373459339141846 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occupied: [1318.0, 3.0] Time: 4.393023729324341
Time of next(dataloader) is: 0.048926353454589844
Time for copying to cuda: 0.021686792373657227
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 6, 0']
Memory occupied: [1414.0, 568.0] Time: 5.781712532043457
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1414.0, 1078.0] Time: 7.2005455493927
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 97, 58']
Length of received data: 100399121
Future took 4.133008241653442 seconds
Pickle took 0.06303024291992188 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.196396589279175 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 70, 42']
Dataloader took 0.08128571510314941 seconds
Streaming imagenet data took 4.277763366699219 seconds
Memory occupied: [4606.0, 3428.0] Time: 8.683434009552002
Time for forward pass: 4.369351148605347
Time for backpropagation: 0.06957411766052246
GPU memory for training: 3.349872589111328                          

One training iteration takes: 4.515403985977173 seconds
Index: 0
Then, training+dataloading take 4.5157434940338135 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04737734794616699
Time for copying to cuda: 0.02099132537841797
Time for forward pass: 0.1471116542816162
Time for backpropagation: 0.01012563705444336
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.23081016540527344 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 10.103338718414307
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 11.527920722961426
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 12.977795839309692
Length of received data: 100399121
Future took 4.094940662384033 seconds
Pickle took 0.05403923988342285 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.14912486076355 seconds
Dataloader took 0.03641676902770996 seconds
Streaming imagenet data took 4.1855854988098145 seconds
Then, training+dataloading take 4.189621925354004 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.047818660736083984
Time for copying to cuda: 0.021110057830810547
Time for forward pass: 0.12293052673339844
Time for backpropagation: 0.010484933853149414
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.20776128768920898 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 14.404696464538574
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 15.83253026008606
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 100399121
Future took 4.1005613803863525 seconds
Pickle took 0.04214048385620117 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.142878532409668 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.07759666442871094 seconds
Streaming imagenet data took 4.2205469608306885 seconds
Then, training+dataloading take 4.225393533706665 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occupied: [3594.0, 3520.0] Time: 17.33559226989746
Time of next(dataloader) is: 0.049021005630493164
Time for copying to cuda: 0.02120232582092285
Time for forward pass: 0.12258028984069824
Time for backpropagation: 0.010300159454345703
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.2092573642730713 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 18.778220415115356
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 20.21271324157715
Length of received data: 100399121
Future took 4.067578554153442 seconds
Pickle took 0.04254341125488281 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.110275983810425 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Dataloader took 0.07831072807312012 seconds
Streaming imagenet data took 4.188665390014648 seconds
Then, training+dataloading take 4.194014310836792 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09646773338317871
Time for copying to cuda: 0.021326780319213867
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for forward pass: 0.1358966827392578
Memory occupied: [3594.0, 3520.0] Time: 21.75484323501587
Time for backpropagation: 0.01056671142578125
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.27042412757873535 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 23.19088649749756
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 24.62160873413086
Length of received data: 100399121
Future took 4.03335976600647 seconds
Pickle took 0.04691886901855469 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.0804150104522705 seconds
Dataloader took 0.03637409210205078 seconds
Streaming imagenet data took 4.116852283477783 seconds
Then, training+dataloading take 4.1208600997924805 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.08904480934143066
Time for copying to cuda: 0.02137279510498047
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Time for forward pass: 0.1779031753540039
Time for backpropagation: 0.011728286743164062
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.30389881134033203 seconds
Index: 5
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 26.078800439834595
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 27.510775089263916
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 28.94500970840454
Length of received data: 100399121
Future took 4.014670372009277 seconds
Pickle took 0.04266190528869629 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.057473659515381 seconds
Dataloader took 0.036403656005859375 seconds
Streaming imagenet data took 4.093921899795532 seconds
Then, training+dataloading take 4.098008155822754 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.047985076904296875
Time for copying to cuda: 0.0213015079498291
Time for forward pass: 0.12266206741333008
Time for backpropagation: 0.010265350341796875
GPU memory for training: 0.907660961151123                          

One training iteration takes: 0.20772814750671387 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 37, 22']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 30.3874671459198
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 31.830507278442383
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3594.0, 3520.0] Time: 33.26597213745117
Length of received data: 100399121
Future took 4.052471876144409 seconds
Pickle took 0.04291176795959473 seconds
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.095523834228516 seconds
Dataloader took 0.036550283432006836 seconds
Streaming imagenet data took 4.132117986679077 seconds
Then, training+dataloading take 4.136167049407959 seconds

Epoch: 0
Time of next(dataloader) is: 0.04810690879821777
Time for copying to cuda: 0.021102428436279297
Time for forward pass: 0.12299203872680664
Time for backpropagation: 0.010563850402832031
GPU memory for training: 0.907660961151123                          

Last train takes: 0.20782113075256348 seconds
Total time for streaming and training: 34.061277627944946
Finish gpu thread time: 0.20574569702148438
The whole process took 40.41399526596069 seconds
