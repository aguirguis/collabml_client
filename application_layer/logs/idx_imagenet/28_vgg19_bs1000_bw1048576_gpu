Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=28, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3203268906027 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119055361.88620508 119055361.88620508
All candidates indexes:  (array([36, 37, 38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 28 36
Intermediate:  0.3828125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  949.6103515625 2274.80224609375 3224.41259765625 26966.20849609375
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 14.992609739303589 seconds
Streaming imagenet data took 15.208430051803589 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Time of next(dataloader) is: 0.5088927745819092
Time for copying to cuda: 0.09966468811035156
Memory occpied: (2278.0, 490.0)
Memory occpied: (2278.0, 934.0)
Memory occpied: (2278.0, 1380.0)
Memory occpied: (5850.0, 5418.0)
Time for forward pass: 4.5544984340667725
Time for backpropagation: 0.05631279945373535
GPU memory for training: 8.285820960998535                          

One training iteration takes: 5.318589687347412 seconds
Index: 0
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Memory occpied: (3824.0, 5426.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 14.964176654815674 seconds
Streaming imagenet data took 15.106940507888794 seconds
Then, training+dataloading take 15.132200002670288 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Memory occpied: (3824.0, 5426.0)
Time of next(dataloader) is: 0.5463299751281738
Time for copying to cuda: 0.0987691879272461
Time for forward pass: 0.3677513599395752
Time for backpropagation: 0.0044307708740234375
GPU memory for training: 5.584778785705566                          

One training iteration takes: 1.1603362560272217 seconds
Index: 1
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 15.070419311523438 seconds
Memory occpied: (5382.0, 5434.0)
Streaming imagenet data took 15.257285118103027 seconds
Then, training+dataloading take 15.283358097076416 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5445115566253662
Time for copying to cuda: 0.09960007667541504
Time for forward pass: 0.41202569007873535
Time for backpropagation: 0.00480961799621582
GPU memory for training: 5.584778785705566                          

One training iteration takes: 1.1790697574615479 seconds
Index: 2
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 15.115327596664429 seconds
Streaming imagenet data took 15.257810115814209 seconds
Then, training+dataloading take 15.282998323440552 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5887837409973145
Time for copying to cuda: 0.09959030151367188
Time for forward pass: 0.3544950485229492
Time for backpropagation: 0.004315853118896484
GPU memory for training: 5.584778785705566                          

One training iteration takes: 1.191697120666504 seconds
Index: 3
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 15.178398370742798 seconds
Streaming imagenet data took 15.323551893234253 seconds
Then, training+dataloading take 15.348968505859375 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5828337669372559
Time for copying to cuda: 0.09921574592590332
Time for forward pass: 0.33134984970092773
Time for backpropagation: 0.004311800003051758
GPU memory for training: 5.584778785705566                          

One training iteration takes: 1.1515090465545654 seconds
Index: 4
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 15.201794147491455 seconds
Streaming imagenet data took 15.344070434570312 seconds
Then, training+dataloading take 15.363831758499146 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.594465970993042
Time for copying to cuda: 0.09938907623291016
Time for forward pass: 0.35715627670288086
Time for backpropagation: 0.004364967346191406
GPU memory for training: 5.584778785705566                          

One training iteration takes: 1.1767430305480957 seconds
Index: 5
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 15.168741703033447 seconds
Streaming imagenet data took 15.309330701828003 seconds
Then, training+dataloading take 15.339157342910767 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5770001411437988
Time for copying to cuda: 0.09958481788635254
Time for forward pass: 0.33897972106933594
Time for backpropagation: 0.004277706146240234
GPU memory for training: 5.584778785705566                          

One training iteration takes: 1.149531602859497 seconds
Index: 6
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Memory occpied: (5382.0, 5434.0)
Length of received data: 401455121
Read 382.8574380874634 MBs for this batch
Executing all posts took 15.199402809143066 seconds
Streaming imagenet data took 15.341954469680786 seconds
Then, training+dataloading take 15.3670175075531 seconds

Epoch: 0
Time of next(dataloader) is: 0.5839893817901611
Time for copying to cuda: 0.09914588928222656
Time for forward pass: 0.364670991897583
Time for backpropagation: 0.004398822784423828
GPU memory for training: 5.584778785705566                          

Memory occpied: (5382.0, 5434.0)
The whole process took 132.57904505729675 seconds
