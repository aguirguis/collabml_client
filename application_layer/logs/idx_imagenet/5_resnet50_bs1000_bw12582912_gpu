Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10543.578325272749 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1381967898.2501497 1381967898.2501497
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 21
Intermediate:  3.0625
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 9292.857421875 9497.77294921875 12929.576171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Using split index: 5
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 13.822504997253418 seconds
Memory occpied: (1410.0, 3.0)
Streaming imagenet data took 15.004770517349243 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.117333173751831
Time for copying to cuda: 0.7725026607513428
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 13.461958169937134 seconds
Time for forward pass: 11.070579528808594
Time for backpropagation: 0.11558985710144043
GPU memory for training: 16.479100704193115                          

Memory occpied: (1410.0, 3.0)
One training iteration takes: 14.477859020233154 seconds
Index: 0
Streaming imagenet data took 14.931963205337524 seconds
Then, training+dataloading take 15.056854009628296 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.172041893005371
Time for copying to cuda: 0.772435188293457
Time for forward pass: 1.3992817401885986
Time for backpropagation: 0.006820201873779297
GPU memory for training: 13.672471523284912                          

One training iteration takes: 4.792796850204468 seconds
Index: 1
Memory occpied: (4706.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 13.82623028755188 seconds
Memory occpied: (10078.0, 8588.0)
Streaming imagenet data took 15.020055770874023 seconds
Then, training+dataloading take 15.15254259109497 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.244141101837158
Time for copying to cuda: 0.7689259052276611
Time for forward pass: 1.3831820487976074
Time for backpropagation: 0.006587028503417969
GPU memory for training: 13.672471523284912                          

One training iteration takes: 4.8642942905426025 seconds
Index: 2
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 13.793830633163452 seconds
Memory occpied: (10078.0, 8588.0)
Streaming imagenet data took 15.090894222259521 seconds
Then, training+dataloading take 15.266194343566895 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3193981647491455
Time for copying to cuda: 0.7723374366760254
Time for forward pass: 1.4006965160369873
Time for backpropagation: 0.006695747375488281
GPU memory for training: 13.672471523284912                          

Memory occpied: (10078.0, 8588.0)
One training iteration takes: 4.903051137924194 seconds
Index: 3
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 13.635623216629028 seconds
Memory occpied: (10078.0, 8588.0)
Streaming imagenet data took 14.950640678405762 seconds
Then, training+dataloading take 15.11937141418457 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.2646210193634033
Time for copying to cuda: 0.7739346027374268
Time for forward pass: 1.404890775680542
Time for backpropagation: 0.006724834442138672
GPU memory for training: 13.672471523284912                          

Memory occpied: (10078.0, 8588.0)
One training iteration takes: 4.853450059890747 seconds
Index: 4
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Length of received data: 3211311121
Memory occpied: (10078.0, 8588.0)
Read 3062.5449380874634 MBs for this batch
Executing all posts took 13.89112138748169 seconds
Streaming imagenet data took 15.19572114944458 seconds
Then, training+dataloading take 15.255725622177124 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Time of next(dataloader) is: 2.2204885482788086
Memory occpied: (10078.0, 8588.0)
Time for copying to cuda: 0.8789434432983398
Memory occpied: (10078.0, 8588.0)
Time for forward pass: 1.414271354675293
Time for backpropagation: 0.006753206253051758
GPU memory for training: 13.672471523284912                          

One training iteration takes: 4.921998977661133 seconds
Index: 5
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 14.455502271652222 seconds
Memory occpied: (10078.0, 8588.0)
Streaming imagenet data took 15.75826120376587 seconds
Then, training+dataloading take 15.895386219024658 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3143467903137207
Time for copying to cuda: 0.7781145572662354
Time for forward pass: 1.4112083911895752
Time for backpropagation: 0.006662130355834961
GPU memory for training: 13.672471523284912                          

Memory occpied: (10078.0, 8588.0)
One training iteration takes: 4.92502236366272 seconds
Index: 6
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Memory occpied: (10078.0, 8588.0)
Length of received data: 3211311121
Read 3062.5449380874634 MBs for this batch
Executing all posts took 13.792213916778564 seconds
Memory occpied: (10078.0, 8588.0)
Streaming imagenet data took 15.110953330993652 seconds
Then, training+dataloading take 15.169255495071411 seconds

Epoch: 0
Time of next(dataloader) is: 2.2633864879608154
Time for copying to cuda: 0.7676196098327637
Time for forward pass: 1.390204668045044
Time for backpropagation: 0.0066835880279541016
GPU memory for training: 13.672471523284912                          

Memory occpied: (10078.0, 8588.0)
The whole process took 133.9340534210205 seconds
