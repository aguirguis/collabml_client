Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=24, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.16031813621521
Time to prepare transforms: 0.0002429485321044922
Time to download labels: 0.06500005722045898
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.4649236277337 Mbps
Get bandwitdh took 1.230257511138916
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119074314.46973431 119074314.46973431
All candidates indexes:  (array([20, 21, 22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 24 25
Intermediate:  0.015625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  908.396484375 655.46337890625 1563.85986328125 25714.05712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1840.0 3.0
Time for splitting algorithm: 6.6012489795684814
Using split index: 24
Freezing the lower layers of the model (myvgg11) till index 25
Time to freeze model: 0.0002562999725341797
Time for model prep: 0.0008554458618164062
Time for model and splitting algorithm: 6.602378606796265
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 0.32227039337158203
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 1.6477241516113281
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 2.9696149826049805
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 4.298374176025391
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1840.0, 3.0] Time: 5.628673553466797
Length of received data: 16420362
Future took 6.272926330566406 seconds
Pickle took 0.010357141494750977 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.283412933349609 seconds
Dataloader took 0.0064084529876708984 seconds
Streaming imagenet data took 6.28985333442688 seconds
First stream takes: 6.290127515792847 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.01123189926147461
Time for copying to cuda: 0.0035555362701416016
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 4, 0']
Memory occupied: [1840.0, 254.0] Time: 6.988450527191162
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1840.0, 760.0] Time: 8.382361650466919
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [1840.0, 1268.0] Time: 9.803404808044434
Time for forward pass: 3.557835102081299
Time for backpropagation: 0.049004316329956055
GPU memory for training: 2.037003993988037                          

One training iteration takes: 3.622800350189209 seconds
Index: 0
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3026.0, 1814.0] Time: 11.216936111450195
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 16420362
Future took 6.237307071685791 seconds
Pickle took 0.008095741271972656 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.245587587356567 seconds
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.0522916316986084 seconds
Streaming imagenet data took 6.29794716835022 seconds
Then, training+dataloading take 6.301485300064087 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.014609098434448242
Time for copying to cuda: 0.0036950111389160156
Memory occupied: [3026.0, 1822.0] Time: 12.646728992462158
Time for forward pass: 0.056266069412231445
Time for backpropagation: 0.002683877944946289
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.07886004447937012 seconds
Index: 1
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 14.072397232055664
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 15.499784708023071
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 16.920855045318604
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 18.34463667869568
Length of received data: 16420362
Future took 6.199914216995239 seconds
Pickle took 0.008233785629272461 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.208263397216797 seconds
Dataloader took 0.00698089599609375 seconds
Streaming imagenet data took 6.21529483795166 seconds
Then, training+dataloading take 6.215986251831055 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00783681869506836
Time for copying to cuda: 0.0036537647247314453
Time for forward pass: 0.05600452423095703
Time for backpropagation: 0.0026199817657470703
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.07118749618530273 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 19.767667293548584
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 21.193917274475098
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 22.616729259490967
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 24.04159140586853
Length of received data: 16420362
Future took 6.198353052139282 seconds
Pickle took 0.008301258087158203 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.2067790031433105 seconds
Dataloader took 0.0065538883209228516 seconds
Streaming imagenet data took 6.2133708000183105 seconds
Then, training+dataloading take 6.21388840675354 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007840394973754883
Time for copying to cuda: 0.003671884536743164
Time for forward pass: 0.05726909637451172
Time for backpropagation: 0.0035028457641601562
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.07358717918395996 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 30, 3']
Memory occupied: [3428.0, 1822.0] Time: 25.47396945953369
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 26.89700984954834
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 28.31837797164917
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 29.73855948448181
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 31.167187213897705
Length of received data: 16420362
Future took 6.211082458496094 seconds
Pickle took 0.008137941360473633 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.21934700012207 seconds
Dataloader took 0.004526376724243164 seconds
Streaming imagenet data took 6.2239086627960205 seconds
Then, training+dataloading take 6.224445104598999 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00790548324584961
Time for copying to cuda: 0.003637075424194336
Time for forward pass: 0.05605292320251465
Time for backpropagation: 0.0026264190673828125
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.07146072387695312 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 32.592233657836914
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 34.01713728904724
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 35.44024991989136
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 36.862316846847534
Length of received data: 16420362
Future took 6.221388101577759 seconds
Pickle took 0.008254528045654297 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.229769468307495 seconds
Dataloader took 0.006577491760253906 seconds
Streaming imagenet data took 6.236386299133301 seconds
Then, training+dataloading take 6.236917734146118 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007632732391357422
Time for copying to cuda: 0.0036487579345703125
Time for forward pass: 0.05595254898071289
Time for backpropagation: 0.0025300979614257812
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.07092523574829102 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 4, 3']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 38.28336811065674
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 39.706040382385254
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 41.128273725509644
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 42.55181431770325
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 16420362
Future took 6.3232667446136475 seconds
Pickle took 0.013833284378051758 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.337327241897583 seconds
Dataloader took 0.008765935897827148 seconds
Streaming imagenet data took 6.346161127090454 seconds
Then, training+dataloading take 6.346834182739258 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.017386913299560547
Time for copying to cuda: 0.0041010379791259766
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time for forward pass: 0.08115720748901367
Time for backpropagation: 0.0037369728088378906
GPU memory for training: 2.192574977874756                          

One training iteration takes: 0.10842633247375488 seconds
Index: 6
Memory occupied: [3428.0, 1822.0] Time: 44.002277851104736
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 45.42750787734985
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 46.85116243362427
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 48.27532958984375
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [3428.0, 1822.0] Time: 49.70391368865967
Length of received data: 16420362
Future took 6.26236367225647 seconds
Pickle took 0.007992982864379883 seconds
Read 15.659677505493164 MBs for this batch
Executing all posts took 6.270474195480347 seconds
Dataloader took 0.006501674652099609 seconds
Streaming imagenet data took 6.2770209312438965 seconds
Then, training+dataloading take 6.277661323547363 seconds

Epoch: 0
Time of next(dataloader) is: 0.0076296329498291016
Time for copying to cuda: 0.0036783218383789062
Time for forward pass: 0.055989742279052734
Time for backpropagation: 0.002524852752685547
GPU memory for training: 2.192574977874756                          

Last train takes: 0.07051420211791992 seconds
Total time for streaming and training: 50.17801761627197
Finish gpu thread time: 0.5269153118133545
The whole process took 58.533276081085205 seconds
