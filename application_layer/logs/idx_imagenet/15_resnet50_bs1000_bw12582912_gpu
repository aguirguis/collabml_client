Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=15, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.163151741027832
Time to prepare transforms: 0.0002448558807373047
Time to download labels: 0.06269454956054688
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 10135.415745700579 Mbps
Get bandwitdh took 1.2359950542449951
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 1328469212.6204662 1328469212.6204662
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 15 21
Intermediate:  0.765625
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  204.91552734375 2402.232421875 2607.14794921875 8335.826171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1410.0 3.0
Time for splitting algorithm: 5.142580032348633
Using split index: 15
Freezing the lower layers of the model (myresnet50) till index 21
Time to freeze model: 0.000701904296875
Time for model prep: 0.00226593017578125
Time for model and splitting algorithm: 5.145568370819092
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 6, 1']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 0.32719945907592773
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 1.6585562229156494
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 2.991997241973877
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 4.361622095108032
Length of received data: 802863121
Future took 5.252923250198364 seconds
Pickle took 0.41741299629211426 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.670549154281616 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1410.0, 3.0] Time: 6.132172346115112
Dataloader took 0.46340155601501465 seconds
Streaming imagenet data took 6.133984565734863 seconds
First stream takes: 6.180114507675171 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10404157638549805
Time for copying to cuda: 0.17044734954833984
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 3, 0']
Memory occupied: [2176.0, 842.0] Time: 7.570888042449951
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 5, 0']
Memory occupied: [2176.0, 1334.0] Time: 9.046912431716919
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 96, 41']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 75, 23']
Memory occupied: [3958.0, 3452.0] Time: 10.635537385940552
Length of received data: 802863121
Future took 5.343781232833862 seconds
Pickle took 0.41722989082336426 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.818531274795532 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 84, 61']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 69, 38']
Dataloader took 0.4540994167327881 seconds
Streaming imagenet data took 6.272789478302002 seconds
Memory occupied: [8420.0, 8010.0] Time: 12.539170503616333
Time for forward pass: 6.664572715759277
Time for backpropagation: 0.06737875938415527
GPU memory for training: 10.686818599700928                          

One training iteration takes: 7.033139705657959 seconds
Index: 0
Then, training+dataloading take 7.034884452819824 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09646844863891602
Time for copying to cuda: 0.16907286643981934
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 71, 31']
Time for forward pass: 0.3554654121398926
Time for backpropagation: 0.007070302963256836
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.6401662826538086 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 97, 72']
Memory occupied: [8456.0, 3484.0] Time: 14.034411430358887
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 15.460704803466797
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 16.890039443969727
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 802863121
Future took 5.531035900115967 seconds
Pickle took 0.4178447723388672 seconds
Memory occupied: [8456.0, 3484.0] Time: 19.16441011428833
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.949133634567261 seconds
Dataloader took 0.28188252449035645 seconds
Streaming imagenet data took 6.231064081192017 seconds
Then, training+dataloading take 6.275117635726929 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10028314590454102
Time for copying to cuda: 0.1671900749206543
Time for forward pass: 0.40526723861694336
Time for backpropagation: 0.05622291564941406
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.7411444187164307 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 61, 46']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 10, 6']
Memory occupied: [8456.0, 3484.0] Time: 20.63142466545105
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 22.06645178794861
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 23.500621795654297
Length of received data: 802863121
Future took 5.093721389770508 seconds
Pickle took 0.41405296325683594 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.5615386962890625 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4414525032043457 seconds
Streaming imagenet data took 6.003100872039795 seconds
Then, training+dataloading take 6.025622844696045 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Memory occupied: [8456.0, 3484.0] Time: 25.613644123077393
Time of next(dataloader) is: 0.10427260398864746
Time for copying to cuda: 0.16706371307373047
Time for forward pass: 0.4012129306793213
Time for backpropagation: 0.006181240081787109
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.7055017948150635 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 27.05513572692871
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 28.499223470687866
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 29.96206045150757
Length of received data: 802863121
Future took 5.526181936264038 seconds
Pickle took 0.4256865978240967 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.952147960662842 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 31.882949113845825
Dataloader took 0.43943190574645996 seconds
Streaming imagenet data took 6.391636610031128 seconds
Then, training+dataloading take 6.437986135482788 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09636664390563965
Time for copying to cuda: 0.1676638126373291
Time for forward pass: 0.40206217765808105
Time for backpropagation: 0.00612640380859375
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.6984598636627197 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 33.32519030570984
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 34.76867961883545
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 36.211633920669556
Length of received data: 802863121
Future took 5.403613567352295 seconds
Pickle took 0.4278538227081299 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.831768989562988 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 38.20282506942749
Dataloader took 0.4419693946838379 seconds
Streaming imagenet data took 6.27378249168396 seconds
Then, training+dataloading take 6.320916652679443 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.1400456428527832
Time for copying to cuda: 0.16699838638305664
Time for forward pass: 0.42248058319091797
Time for backpropagation: 0.006063222885131836
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.7618265151977539 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 39.64408040046692
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 41.08837556838989
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 42.52990460395813
Length of received data: 802863121
Future took 5.479678153991699 seconds
Pickle took 0.4108126163482666 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.89065957069397 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.4952707290649414 seconds
Streaming imagenet data took 6.3860023021698 seconds
Then, training+dataloading take 6.40719747543335 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occupied: [8456.0, 3484.0] Time: 44.7560772895813
Time of next(dataloader) is: 0.10173368453979492
Time for copying to cuda: 0.16726279258728027
Time for forward pass: 0.4418666362762451
Time for backpropagation: 0.006118297576904297
GPU memory for training: 3.575498104095459                          

One training iteration takes: 0.7442007064819336 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 46.198853969573975
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 47.64466834068298
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [8456.0, 3484.0] Time: 49.113091230392456
Length of received data: 802863121
Future took 5.363226413726807 seconds
Pickle took 0.40907835960388184 seconds
Read 765.6699380874634 MBs for this batch
Executing all posts took 5.772481441497803 seconds
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Dataloader took 0.494640588760376 seconds
Streaming imagenet data took 6.26719856262207 seconds
Then, training+dataloading take 6.288277864456177 seconds

Epoch: 0
Memory occupied: [8456.0, 3484.0] Time: 51.04462814331055
Time of next(dataloader) is: 0.10189580917358398
Time for copying to cuda: 0.16699790954589844
Time for forward pass: 0.41890573501586914
Time for backpropagation: 0.006075620651245117
GPU memory for training: 3.575498104095459                          

Last train takes: 0.7200267314910889 seconds
Total time for streaming and training: 51.69041609764099
Finish gpu thread time: 0.35521912574768066
The whole process took 58.41767883300781 seconds
