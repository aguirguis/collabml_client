Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=11, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
Initialize time: 1.1609625816345215
Time to prepare transforms: 0.00024247169494628906
Time to download labels: 0.04850125312805176
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6536176277738 Mbps
Get bandwitdh took 1.2330963611602783
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119099046.96970756 119099046.96970756
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 11 17
Intermediate:  0.1650390625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  266.27734375 829.95361328125 1096.23095703125 2716.18408203125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Time for splitting algorithm: 5.205401420593262
Using split index: 11
Freezing the lower layers of the model (myalexnet) till index 17
Time to freeze model: 0.00023746490478515625
Time for model prep: 0.0007863044738769531
Time for model and splitting algorithm: 5.206442832946777
The mode is:  split
Start 0, end 1000, post_step 1000

GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 0.32321715354919434
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 1.6525945663452148
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1514.0, 3.0] Time: 3.006986618041992
Length of received data: 173103121
Future took 3.1419262886047363 seconds
Pickle took 0.0911564826965332 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.233248233795166 seconds
Dataloader took 0.061563968658447266 seconds
Streaming imagenet data took 3.294849395751953 seconds
First stream takes: 3.3060519695281982 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05131101608276367
Time for copying to cuda: 0.03684735298156738
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [1680.0, 486.0] Time: 4.398362874984741
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 2, 0']
Memory occupied: [1680.0, 1002.0] Time: 5.8595428466796875
Length of received data: 173103121
Future took 3.3636512756347656 seconds
Pickle took 0.08864355087280273 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.4523935317993164 seconds
Time for forward pass: 3.3669183254241943
Time for backpropagation: 0.05451655387878418
GPU memory for training: 1.2120437622070312                          

One training iteration takes: 3.518139600753784 seconds
Index: 0
Dataloader took 0.07248282432556152 seconds
Streaming imagenet data took 3.5249133110046387 seconds
Then, training+dataloading take 3.5330779552459717 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09386038780212402
Time for copying to cuda: 0.03645825386047363
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 29, 6']
Time for forward pass: 0.05727124214172363
Time for backpropagation: 0.004490375518798828
GPU memory for training: 1.367194652557373                          

One training iteration takes: 0.1961345672607422 seconds
Index: 1
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 18, 5']
Memory occupied: [2420.0, 1642.0] Time: 7.299431324005127
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 8.71694564819336
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 10.159704685211182
Length of received data: 173103121
Future took 3.387112855911255 seconds
Pickle took 0.09158921241760254 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.4788544178009033 seconds
Dataloader took 0.06320595741271973 seconds
Streaming imagenet data took 3.542107105255127 seconds
Then, training+dataloading take 3.5532331466674805 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.050687551498413086
Time for copying to cuda: 0.0363001823425293
Time for forward pass: 0.05592823028564453
Time for backpropagation: 0.0022819042205810547
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.15315580368041992 seconds
Index: 2
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 11.588056087493896
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 13.024545669555664
Length of received data: 173103121
Future took 3.389977216720581 seconds
Pickle took 0.08340835571289062 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.473536252975464 seconds
Dataloader took 0.06258463859558105 seconds
Streaming imagenet data took 3.5361664295196533 seconds
Then, training+dataloading take 3.5472333431243896 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05052447319030762
Time for copying to cuda: 0.07755804061889648
Time for forward pass: 0.056671142578125
Time for backpropagation: 0.002577066421508789
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.19545888900756836 seconds
Index: 3
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 34, 6']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 30, 6']
Memory occupied: [2420.0, 1642.0] Time: 14.458555459976196
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 15.887899160385132
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Length of received data: 173103121
Future took 3.3811182975769043 seconds
Pickle took 0.08407473564147949 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.465467929840088 seconds
Memory occupied: [2420.0, 1642.0] Time: 17.40574622154236
Dataloader took 0.06202220916748047 seconds
Streaming imagenet data took 3.527538537979126 seconds
Then, training+dataloading take 3.5388262271881104 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05065727233886719
Time for copying to cuda: 0.03614044189453125
Time for forward pass: 0.05594587326049805
Time for backpropagation: 0.002182483673095703
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.15298914909362793 seconds
Index: 4
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 18.835179567337036
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 20.278951406478882
Length of received data: 173103121
Future took 3.323216438293457 seconds
Pickle took 0.08368968963623047 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.4070541858673096 seconds
Dataloader took 0.062192678451538086 seconds
Streaming imagenet data took 3.469292163848877 seconds
Then, training+dataloading take 3.4806039333343506 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05069923400878906
Time for copying to cuda: 0.03638958930969238
Time for forward pass: 0.05599474906921387
Time for backpropagation: 0.0021805763244628906
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.15337753295898438 seconds
Index: 5
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 21.708613634109497
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 23.143043756484985
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
Length of received data: 173103121
Future took 3.376765489578247 seconds
Pickle took 0.08917403221130371 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.466212511062622 seconds
Dataloader took 0.10548663139343262 seconds
Streaming imagenet data took 3.5717532634735107 seconds
Then, training+dataloading take 3.58354115486145 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Time of next(dataloader) is: 0.09300732612609863
Memory occupied: [2420.0, 1642.0] Time: 24.670412063598633
Time for copying to cuda: 0.03642773628234863
Time for forward pass: 0.056046485900878906
Time for backpropagation: 0.0024535655975341797
GPU memory for training: 1.367560863494873                          

One training iteration takes: 0.19605040550231934 seconds
Index: 6
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 26.1024911403656
GPU ID:  0  uuid,utilization.gpu,utilization.memory:  ['GPU-be601ad8-2c65-26d5-b2a8-47f20f99e389, 0, 0']
GPU ID:  1  uuid,utilization.gpu,utilization.memory:  ['GPU-938738c2-611e-c1d4-d629-2d6173de0c19, 0, 0']
Memory occupied: [2420.0, 1642.0] Time: 27.542707920074463
Length of received data: 173103121
Future took 3.39274525642395 seconds
Pickle took 0.08367657661437988 seconds
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.4765608310699463 seconds
Dataloader took 0.062052011489868164 seconds
Streaming imagenet data took 3.538658380508423 seconds
Then, training+dataloading take 3.549589157104492 seconds

Epoch: 0
Time of next(dataloader) is: 0.05055594444274902
Time for copying to cuda: 0.036525726318359375
Time for forward pass: 0.05603218078613281
Time for backpropagation: 0.0023615360260009766
GPU memory for training: 1.367560863494873                          

Last train takes: 0.1531202793121338 seconds
Total time for streaming and training: 28.245469093322754
Finish gpu thread time: 0.2982935905456543
The whole process took 34.9603157043457 seconds
