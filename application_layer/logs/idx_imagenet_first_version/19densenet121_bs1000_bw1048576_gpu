Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=19, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7489003172348 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119111535.8623806 119111535.8623806
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 19 20
Intermediate:  0.095703125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 4776.28125 4971.50732421875 11379.796875
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.656574010848999 seconds
Streaming imagenet data took 4.724307298660278 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3713080883026123
Time for copying to cuda: 0.025204896926879883
Time for forward pass: 3.7177493572235107
Time for backpropagation: 0.08327913284301758
GPU memory for training: 3.349872589111328                          

Memory occpied: (1318.0, 3.0)
One training iteration takes: 4.264607906341553 seconds
Index: 0
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.604220151901245 seconds
Streaming imagenet data took 4.640751361846924 seconds
Then, training+dataloading take 4.646592140197754 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3749852180480957
Time for copying to cuda: 0.024765491485595703
Time for forward pass: 0.10524463653564453
Time for backpropagation: 0.011041879653930664
GPU memory for training: 0.907996654510498                          

One training iteration takes: 0.5996744632720947 seconds
Index: 1
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.609670639038086 seconds
Streaming imagenet data took 4.645805358886719 seconds
Then, training+dataloading take 4.650773286819458 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3804914951324463
Time for copying to cuda: 0.024794578552246094
Time for forward pass: 0.12443947792053223
Time for backpropagation: 0.010920524597167969
GPU memory for training: 0.907996654510498                          

One training iteration takes: 0.6279692649841309 seconds
Index: 2
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.630797624588013 seconds
Streaming imagenet data took 4.667278051376343 seconds
Then, training+dataloading take 4.672483921051025 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3755810260772705
Time for copying to cuda: 0.02481675148010254
Time for forward pass: 0.12460899353027344
Time for backpropagation: 0.011019229888916016
GPU memory for training: 0.907996654510498                          

One training iteration takes: 0.6278285980224609 seconds
Index: 3
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.679802417755127 seconds
Memory occpied: (2176.0, 3520.0)
Streaming imagenet data took 4.716368913650513 seconds
Then, training+dataloading take 4.721534729003906 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37278223037719727
Time for copying to cuda: 0.025086164474487305
Time for forward pass: 0.12485289573669434
Time for backpropagation: 0.010843276977539062
GPU memory for training: 0.907996654510498                          

One training iteration takes: 0.6232116222381592 seconds
Index: 4
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.550063848495483 seconds
Streaming imagenet data took 4.625802278518677 seconds
Then, training+dataloading take 4.631487846374512 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4084045886993408
Time for copying to cuda: 0.02512502670288086
Time for forward pass: 0.12538909912109375
Time for backpropagation: 0.011483192443847656
GPU memory for training: 0.907996654510498                          

Memory occpied: (2176.0, 3520.0)
One training iteration takes: 0.669903039932251 seconds
Index: 5
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.663422346115112 seconds
Streaming imagenet data took 4.700429677963257 seconds
Then, training+dataloading take 4.706094741821289 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3730952739715576
Time for copying to cuda: 0.02519536018371582
Time for forward pass: 0.2015063762664795
Time for backpropagation: 0.011749267578125
GPU memory for training: 0.907996654510498                          

One training iteration takes: 0.7135951519012451 seconds
Index: 6
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Memory occpied: (2176.0, 3520.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 4.663578510284424 seconds
Streaming imagenet data took 4.7007155418396 seconds
Then, training+dataloading take 4.706479549407959 seconds

Epoch: 0
Time of next(dataloader) is: 0.36662840843200684
Time for copying to cuda: 0.025526046752929688
Time for forward pass: 0.12538838386535645
Time for backpropagation: 0.011198282241821289
GPU memory for training: 0.907996654510498                          

The whole process took 44.26165294647217 seconds
