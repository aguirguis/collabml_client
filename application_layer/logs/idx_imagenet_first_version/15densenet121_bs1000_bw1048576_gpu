Cached  True
Transformed  True
All in COS  False
No adaptation  False
Namespace(all_in_cos=False, batch_size=1000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', no_adaptation=False, num_epochs=1, sequential=False, split_choice='manual', split_idx=15, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.563157984516 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
224483624004266.66 119087190.24334648 119087190.24334648
All candidates indexes:  (array([18, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 15 20
Intermediate:  0.765625
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  195.22607421875 6690.34375 6885.56982421875 12623.9375
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 15
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.467154264450073 seconds
Streaming imagenet data took 12.749917268753052 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7973809242248535
Time for copying to cuda: 0.19396471977233887
Time for forward pass: 4.071797132492065
Time for backpropagation: 0.07788777351379395
GPU memory for training: 6.757872581481934                          

Memory occpied: (1318.0, 3.0)
One training iteration takes: 5.287027597427368 seconds
Index: 0
Memory occpied: (2698.0, 4570.0)
Memory occpied: (2698.0, 4570.0)
Memory occpied: (2698.0, 4570.0)
Memory occpied: (2698.0, 4570.0)
Memory occpied: (2698.0, 4570.0)
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.459811925888062 seconds
Memory occpied: (2698.0, 4570.0)
Streaming imagenet data took 12.849207878112793 seconds
Then, training+dataloading take 12.885160684585571 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7599344253540039
Time for copying to cuda: 0.26893019676208496
Memory occpied: (2698.0, 4570.0)
Time for forward pass: 0.18632006645202637
Time for backpropagation: 0.011111736297607422
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 1.3873670101165771 seconds
Index: 1
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.594367265701294 seconds
Streaming imagenet data took 12.876800298690796 seconds
Then, training+dataloading take 12.92509126663208 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8005678653717041
Time for copying to cuda: 0.19397687911987305
Time for forward pass: 0.18622803688049316
Time for backpropagation: 0.011148691177368164
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 1.390899658203125 seconds
Index: 2
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.458703756332397 seconds
Memory occpied: (2906.0, 4586.0)
Streaming imagenet data took 12.84330701828003 seconds
Then, training+dataloading take 12.883780717849731 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7597897052764893
Time for copying to cuda: 0.2804863452911377
Memory occpied: (2906.0, 4586.0)
Time for forward pass: 0.18469691276550293
Time for backpropagation: 0.011064767837524414
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 1.3851637840270996 seconds
Index: 3
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.51950478553772 seconds
Streaming imagenet data took 12.79938268661499 seconds
Then, training+dataloading take 12.839350700378418 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8124101161956787
Time for copying to cuda: 0.19258761405944824
Time for forward pass: 0.18624496459960938
Time for backpropagation: 0.011031389236450195
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 1.3313705921173096 seconds
Index: 4
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.432931661605835 seconds
Memory occpied: (2906.0, 4586.0)
Streaming imagenet data took 12.81168794631958 seconds
Then, training+dataloading take 12.841359615325928 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7954230308532715
Memory occpied: (2906.0, 4586.0)
Time for copying to cuda: 0.2743821144104004
Time for forward pass: 0.1823434829711914
Time for backpropagation: 0.011069059371948242
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 1.4103355407714844 seconds
Index: 5
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.525158882141113 seconds
Streaming imagenet data took 12.810642004013062 seconds
Then, training+dataloading take 12.850903034210205 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (2906.0, 4586.0)
Time of next(dataloader) is: 0.766916036605835
Time for copying to cuda: 0.19471287727355957
Time for forward pass: 0.21945881843566895
Time for backpropagation: 0.010985374450683594
GPU memory for training: 2.3231425285339355                          

One training iteration takes: 1.354175090789795 seconds
Index: 6
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Memory occpied: (2906.0, 4586.0)
Read 765.6699380874634 MBs for this batch
Executing all posts took 12.480905055999756 seconds
Memory occpied: (2906.0, 4586.0)
Streaming imagenet data took 12.861009120941162 seconds
Then, training+dataloading take 12.90224289894104 seconds

Epoch: 0
Time of next(dataloader) is: 0.7657701969146729
Time for copying to cuda: 0.26967382431030273
Memory occpied: (2906.0, 4586.0)
Time for forward pass: 0.18210411071777344
Time for backpropagation: 0.011460304260253906
GPU memory for training: 2.3231425285339355                          

The whole process took 111.16049456596375 seconds
