Namespace(all_in_cos=False, batch_size=8000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='densenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=False, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (densenet121) till index 20
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Decompress data took 0.09372830390930176 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.7759757041931152 seconds
Decompress data took 0.08473443984985352 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.687690019607544 seconds
Decompress data took 0.09203815460205078 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.79089617729187 seconds
Decompress data took 0.08095574378967285 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.5809803009033203 seconds
Decompress data took 0.08478236198425293 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.762209892272949 seconds
Decompress data took 0.08237290382385254 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.766737222671509 seconds
Decompress data took 0.0907590389251709 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.910994529724121 seconds
Decompress data took 0.08064150810241699 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.530797243118286 seconds
Read 988.8015155792236 MBs for this batch
Streaming imagenet data took 39.13301062583923 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Decompress data took 0.08298468589782715 seconds
Total decompress data took 3.3654990196228027 seconds
Decompress data took 0.08573102951049805 seconds
Total decompress data took 3.5288143157958984 seconds
Decompress data took 0.08619332313537598 seconds
Total decompress data took 3.489943504333496 seconds
Decompress data took 0.08401751518249512 seconds
Total decompress data took 3.28861927986145 seconds
Decompress data took 0.0901186466217041 seconds
Time of next(dataloader) is: 24.82933282852173
Time for copying to cuda: 1.1559932231903076
Total decompress data took 3.6879284381866455 seconds
Decompress data took 0.09267234802246094 seconds
Memory occpied: (1294.0, 3584.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/densenet.py", line 215, in forward
    features = self.features(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 11.96 GiB (GPU 0; 14.76 GiB total capacity; 4.52 GiB already allocated; 9.01 GiB free; 4.53 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

Total decompress data took 4.2737696170806885 seconds
Decompress data took 0.09494948387145996 seconds
The whole process took 74.88344693183899 seconds
Total decompress data took 3.565098285675049 seconds
Decompress data took 0.08748602867126465 seconds
Total decompress data took 3.399357795715332 seconds
Read 1024.4528188705444 MBs for this batch
Streaming imagenet data took 37.51055431365967 seconds
