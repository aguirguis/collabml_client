Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2182038460511 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119041976.41450961 119041976.41450961
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  65.640625 413.6962890625 479.3369140625 4445.9228515625
Candidate split  13
Server, client, server+client, vanilla  65.640625 413.6962890625 479.3369140625 4445.9228515625
Model size  0.0
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  65.640625 413.6962890625 479.3369140625 4445.9228515625
Fixed, scale_with_bsz  0.0 2.05126953125
Mem usage  1250.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.012491226196289 seconds
Streaming imagenet data took 2.040403127670288 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34508609771728516
Time for copying to cuda: 6.4373016357421875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.47549891471862793
Time for backpropagation: 0.1726093292236328
One training iteration takes: 1.0553946495056152 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9395899772644043 seconds
Streaming imagenet data took 1.9679336547851562 seconds
Then, training+dataloading take 1.9744327068328857 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34596872329711914
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.34042882919311523
Time for backpropagation: 0.27175021171569824
One training iteration takes: 1.0711886882781982 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8538861274719238 seconds
Streaming imagenet data took 1.8813066482543945 seconds
Then, training+dataloading take 1.8840255737304688 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38530874252319336
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3711700439453125
Time for backpropagation: 0.24973630905151367
One training iteration takes: 1.1536376476287842 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8908872604370117 seconds
Streaming imagenet data took 1.9188005924224854 seconds
Then, training+dataloading take 1.9231185913085938 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35385966300964355
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.44336581230163574
Time for backpropagation: 0.2639641761779785
One training iteration takes: 1.1856622695922852 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9418282508850098 seconds
Streaming imagenet data took 1.9689359664916992 seconds
Then, training+dataloading take 1.9728243350982666 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35173940658569336
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.45691823959350586
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.3343081474304199
One training iteration takes: 1.2482011318206787 seconds
Index: 4
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8642187118530273 seconds
Streaming imagenet data took 1.8918452262878418 seconds
Then, training+dataloading take 1.8962304592132568 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3845791816711426
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.363753080368042
Time for backpropagation: 0.27230143547058105
One training iteration takes: 1.1579415798187256 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8945550918579102 seconds
Streaming imagenet data took 1.9214270114898682 seconds
Then, training+dataloading take 1.9254875183105469 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38600802421569824
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.37910962104797363
Time for backpropagation: 0.22673702239990234
One training iteration takes: 1.162935733795166 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9402260780334473 seconds
Streaming imagenet data took 1.96781325340271 seconds
Then, training+dataloading take 1.9717433452606201 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3405153751373291
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.3399505615234375
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.3954782485961914
One training iteration takes: 1.195739507675171 seconds
Index: 7
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8768908977508545 seconds
Streaming imagenet data took 1.9042482376098633 seconds
Then, training+dataloading take 1.9083364009857178 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4265098571777344
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.35359978675842285
Time for backpropagation: 0.2588663101196289
One training iteration takes: 1.1623005867004395 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9414258003234863 seconds
Streaming imagenet data took 1.9687085151672363 seconds
Then, training+dataloading take 1.972658395767212 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3424088954925537
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.47428345680236816
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2533292770385742
One training iteration takes: 1.1905508041381836 seconds
Index: 9
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.900285243988037 seconds
Streaming imagenet data took 1.927912712097168 seconds
Then, training+dataloading take 1.9321677684783936 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39732933044433594
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.38811755180358887
Time for backpropagation: 0.25972580909729004
One training iteration takes: 1.1791698932647705 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8530502319335938 seconds
Streaming imagenet data took 1.8812994956970215 seconds
Then, training+dataloading take 1.8854401111602783 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3481771945953369
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.4777567386627197
Time for backpropagation: 0.22906136512756348
One training iteration takes: 1.22153639793396 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9853780269622803 seconds
Streaming imagenet data took 2.012843132019043 seconds
Then, training+dataloading take 2.0170540809631348 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3558073043823242
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.36069512367248535
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.40184831619262695
One training iteration takes: 1.237884521484375 seconds
Index: 12
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.831622838973999 seconds
Streaming imagenet data took 1.8593053817749023 seconds
Then, training+dataloading take 1.8621528148651123 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3885931968688965
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.355623722076416
Time for backpropagation: 0.23118281364440918
One training iteration takes: 1.0973258018493652 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.9522149562835693 seconds
Streaming imagenet data took 1.9792475700378418 seconds
Then, training+dataloading take 1.9820890426635742 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.343120813369751
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.39932799339294434
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.33431553840637207
One training iteration takes: 1.2043309211730957 seconds
Index: 14
Read 70.3937759399414 MBs for this batch
Executing all posts took 1.8664629459381104 seconds
Streaming imagenet data took 1.8942720890045166 seconds
Then, training+dataloading take 1.8985095024108887 seconds

Epoch: 0
Time of next(dataloader) is: 0.4279334545135498
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.33963704109191895
Time for backpropagation: 0.26407790184020996
Memory occpied: (1250.0, 3.0)
The whole process took 39.41668248176575 seconds
