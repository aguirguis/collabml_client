Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.3534164768954 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118928627.00445963 118928627.00445963
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  1350.7978515625 4001.181640625 5351.9794921875 53383.994140625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.506762981414795 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 18.878408432006836 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7333412170410156
Time for copying to cuda: 0.2242579460144043
Memory occpied: (2660.0, 36.0)
Memory occpied: (2660.0, 924.0)
Memory occpied: (2660.0, 1400.0)
Memory occpied: (8408.0, 7926.0)
Memory occpied: (8408.0, 7926.0)
Time for forward pass: 5.7612340450286865
Time for backpropagation: 0.06403732299804688
GPU memory for training: 13.368073463439941                          

One training iteration takes: 6.941460609436035 seconds
Index: 0
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.802490234375 seconds
Streaming imagenet data took 19.13945984840393 seconds
Then, training+dataloading take 19.15977931022644 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8708164691925049
Time for copying to cuda: 0.1947929859161377
Time for forward pass: 0.5873725414276123
Time for backpropagation: 0.004182100296020508
GPU memory for training: 8.531105995178223                          

Memory occpied: (4206.0, 7934.0)
One training iteration takes: 1.839714527130127 seconds
Index: 1
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.674422025680542 seconds
Streaming imagenet data took 19.06281352043152 seconds
Then, training+dataloading take 19.100497245788574 seconds
Memory occpied: (6920.0, 7942.0)
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8017895221710205
Time for copying to cuda: 0.1952507495880127
Memory occpied: (6920.0, 7942.0)
Time for forward pass: 0.561887264251709
Time for backpropagation: 0.004254817962646484
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.7344868183135986 seconds
Index: 2
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.84180784225464 seconds
Streaming imagenet data took 19.122326374053955 seconds
Then, training+dataloading take 19.16149592399597 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (6920.0, 7942.0)
Time of next(dataloader) is: 0.7943751811981201
Time for copying to cuda: 0.1972336769104004
Time for forward pass: 0.5672931671142578
Time for backpropagation: 0.004228830337524414
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.727689504623413 seconds
Index: 3
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.58629012107849 seconds
Streaming imagenet data took 18.87521481513977 seconds
Then, training+dataloading take 18.92369246482849 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8143730163574219
Time for copying to cuda: 0.19625353813171387
Time for forward pass: 0.5599997043609619
Time for backpropagation: 0.00414586067199707
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.7116553783416748 seconds
Index: 4
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.590899229049683 seconds
Memory occpied: (6920.0, 7942.0)
Streaming imagenet data took 18.99173355102539 seconds
Then, training+dataloading take 19.044409036636353 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7682359218597412
Time for copying to cuda: 0.26760029792785645
Memory occpied: (6920.0, 7942.0)
Time for forward pass: 0.5615067481994629
Time for backpropagation: 0.004239082336425781
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.7562167644500732 seconds
Index: 5
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.86673069000244 seconds
Streaming imagenet data took 19.252419471740723 seconds
Memory occpied: (6920.0, 7942.0)
Then, training+dataloading take 19.305920600891113 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7632734775543213
Time for copying to cuda: 0.19680571556091309
Memory occpied: (6920.0, 7942.0)
Time for forward pass: 0.5685057640075684
Time for backpropagation: 0.004261493682861328
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.709228277206421 seconds
Index: 6
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.670931339263916 seconds
Streaming imagenet data took 18.96078848838806 seconds
Then, training+dataloading take 19.014398097991943 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (6920.0, 7942.0)
Time of next(dataloader) is: 0.8084962368011475
Time for copying to cuda: 0.19687604904174805
Time for forward pass: 0.6160893440246582
Time for backpropagation: 0.004620790481567383
GPU memory for training: 8.531105995178223                          

Memory occpied: (6920.0, 7942.0)
One training iteration takes: 1.7983074188232422 seconds
Index: 7
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.664530038833618 seconds
Memory occpied: (6920.0, 7942.0)
Streaming imagenet data took 19.058385848999023 seconds
Then, training+dataloading take 19.09929847717285 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7948453426361084
Memory occpied: (6920.0, 7942.0)
Time for copying to cuda: 0.27675318717956543
Time for forward pass: 0.5789198875427246
Time for backpropagation: 0.004191160202026367
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.8218584060668945 seconds
Index: 8
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.615319967269897 seconds
Memory occpied: (6920.0, 7942.0)
Streaming imagenet data took 18.899101495742798 seconds
Then, training+dataloading take 18.952698707580566 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.80361008644104
Memory occpied: (6920.0, 7942.0)
Time for copying to cuda: 0.19704627990722656
Time for forward pass: 0.5928053855895996
Time for backpropagation: 0.004174709320068359
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.7680928707122803 seconds
Index: 9
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.64193105697632 seconds
Streaming imagenet data took 19.02937388420105 seconds
Then, training+dataloading take 19.05106472969055 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Time of next(dataloader) is: 0.814093828201294
Time for copying to cuda: 0.19643926620483398
Memory occpied: (6920.0, 7942.0)
Time for forward pass: 0.5855438709259033
Time for backpropagation: 0.004235267639160156
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.7800300121307373 seconds
Index: 10
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.896153450012207 seconds
Streaming imagenet data took 19.179935216903687 seconds
Then, training+dataloading take 19.214638471603394 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8389439582824707
Memory occpied: (6920.0, 7942.0)
Time for copying to cuda: 0.196685791015625
Time for forward pass: 0.5662610530853271
Time for backpropagation: 0.004117250442504883
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.7704505920410156 seconds
Index: 11
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.774188995361328 seconds
Streaming imagenet data took 19.05865502357483 seconds
Then, training+dataloading take 19.11299228668213 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (6920.0, 7942.0)
Time of next(dataloader) is: 0.8439514636993408
Time for copying to cuda: 0.19635677337646484
Time for forward pass: 0.5973196029663086
Time for backpropagation: 0.00454401969909668
GPU memory for training: 8.531105995178223                          

Memory occpied: (6920.0, 7942.0)
One training iteration takes: 1.8076846599578857 seconds
Index: 12
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.66828989982605 seconds
Memory occpied: (6920.0, 7942.0)
Streaming imagenet data took 19.057157278060913 seconds
Then, training+dataloading take 19.09847402572632 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7960755825042725
Memory occpied: (6920.0, 7942.0)
Time for copying to cuda: 0.29105329513549805
Time for forward pass: 0.56722092628479
Time for backpropagation: 0.004169464111328125
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.8308801651000977 seconds
Index: 13
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.66327214241028 seconds
Streaming imagenet data took 18.94718599319458 seconds
Then, training+dataloading take 19.00208592414856 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (6920.0, 7942.0)
Time of next(dataloader) is: 0.7845566272735596
Time for copying to cuda: 0.19690632820129395
Time for forward pass: 0.5848300457000732
Time for backpropagation: 0.0046367645263671875
GPU memory for training: 8.531105995178223                          

One training iteration takes: 1.7072179317474365 seconds
Index: 14
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Memory occpied: (6920.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.59708547592163 seconds
Memory occpied: (6920.0, 7942.0)
Streaming imagenet data took 18.987205028533936 seconds
Then, training+dataloading take 19.04245686531067 seconds

Epoch: 0
Time of next(dataloader) is: 0.7739264965057373
Memory occpied: (6920.0, 7942.0)
Time for copying to cuda: 0.2687962055206299
Time for forward pass: 0.5759804248809814
Time for backpropagation: 0.004141330718994141
GPU memory for training: 8.531105995178223                          

The whole process took 315.28339409828186 seconds
