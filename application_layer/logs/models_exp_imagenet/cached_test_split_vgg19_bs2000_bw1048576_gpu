Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2711651749026 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119048918.16180484 119048918.16180484
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.34365844726562
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 28.57585835456848 seconds
Memory occpied: (1894.0, 3.0)
Streaming imagenet data took 28.858744144439697 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7033970355987549
Memory occpied: (2660.0, 3.0)
Time for copying to cuda: 0.2178049087524414
Memory occpied: (2660.0, 842.0)
Memory occpied: (2660.0, 1284.0)
Memory occpied: (8408.0, 7926.0)
Memory occpied: (8408.0, 7926.0)
Memory occpied: (3026.0, 7934.0)
Time for forward pass: 5.712290287017822
Time for backpropagation: 0.06420063972473145
GPU memory for training: 13.368073463439941                          

One training iteration takes: 6.8378586769104 seconds
Index: 0
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Memory occpied: (4206.0, 7934.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.251230478286743 seconds
Memory occpied: (4206.0, 7934.0)
Streaming imagenet data took 18.613670110702515 seconds
Then, training+dataloading take 18.64649772644043 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7203853130340576
Time for copying to cuda: 0.25583958625793457
Memory occpied: (4206.0, 7942.0)
Time for forward pass: 0.593191385269165
Time for backpropagation: 0.00416111946105957
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7277851104736328 seconds
Index: 1
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 29.0654513835907 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 29.43326163291931 seconds
Then, training+dataloading take 29.467678546905518 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7234594821929932
Time for copying to cuda: 0.22436118125915527
Memory occpied: (6326.0, 7942.0)
Time for forward pass: 0.5443663597106934
Time for backpropagation: 0.0041964054107666016
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.6454930305480957 seconds
Index: 2
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.438436269760132 seconds
Streaming imagenet data took 18.80203866958618 seconds
Then, training+dataloading take 18.821314573287964 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Time of next(dataloader) is: 0.716435432434082
Time for copying to cuda: 0.19520950317382812
Memory occpied: (6326.0, 7942.0)
Time for forward pass: 0.5840222835540771
Time for backpropagation: 0.004239797592163086
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.6353604793548584 seconds
Index: 3
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 28.791424989700317 seconds
Streaming imagenet data took 29.082523822784424 seconds
Then, training+dataloading take 29.129326105117798 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (6326.0, 7942.0)
Time of next(dataloader) is: 0.6978082656860352
Time for copying to cuda: 0.19248557090759277
Time for forward pass: 0.5818634033203125
Time for backpropagation: 0.004090309143066406
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.5660068988800049 seconds
Index: 4
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.198646783828735 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 18.51929998397827 seconds
Then, training+dataloading take 18.55404305458069 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7224607467651367
Memory occpied: (6326.0, 7942.0)
Time for copying to cuda: 0.25859761238098145
Time for forward pass: 0.5955250263214111
Time for backpropagation: 0.004075527191162109
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.73264741897583 seconds
Index: 5
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 29.576353311538696 seconds
Streaming imagenet data took 29.86189293861389 seconds
Then, training+dataloading take 29.908578395843506 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (6326.0, 7942.0)
Time of next(dataloader) is: 0.7047080993652344
Time for copying to cuda: 0.19433856010437012
Time for forward pass: 0.5469200611114502
Time for backpropagation: 0.004133462905883789
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.5943450927734375 seconds
Index: 6
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.370388746261597 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 18.73314666748047 seconds
Then, training+dataloading take 18.781222820281982 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.693504810333252
Time for copying to cuda: 0.25145912170410156
Memory occpied: (6326.0, 7942.0)
Time for forward pass: 0.5664606094360352
Time for backpropagation: 0.004132509231567383
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.6633813381195068 seconds
Index: 7
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 28.4814350605011 seconds
Streaming imagenet data took 28.763091564178467 seconds
Then, training+dataloading take 28.81054449081421 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7312095165252686
Time for copying to cuda: 0.19366979598999023
Time for forward pass: 0.5686919689178467
Time for backpropagation: 0.004137992858886719
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.6227240562438965 seconds
Index: 8
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.272986888885498 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 18.557765245437622 seconds
Then, training+dataloading take 18.605154752731323 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7003376483917236
Memory occpied: (6326.0, 7942.0)
Time for copying to cuda: 0.2225341796875
Time for forward pass: 0.5560669898986816
Time for backpropagation: 0.004327535629272461
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.6352035999298096 seconds
Index: 9
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 29.11517596244812 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 29.47957134246826 seconds
Then, training+dataloading take 29.511341094970703 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7260229587554932
Time for copying to cuda: 0.2598133087158203
Memory occpied: (6326.0, 7942.0)
Time for forward pass: 0.5693490505218506
Time for backpropagation: 0.004137516021728516
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.714686393737793 seconds
Index: 10
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.525882244110107 seconds
Memory occpied: (6326.0, 7942.0)
Streaming imagenet data took 18.89588236808777 seconds
Then, training+dataloading take 18.931647777557373 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7172834873199463
Time for copying to cuda: 0.1946420669555664
Memory occpied: (6326.0, 7942.0)
Time for forward pass: 0.556807279586792
Time for backpropagation: 0.0041730403900146484
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.62404203414917 seconds
Index: 11
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Memory occpied: (6326.0, 7942.0)
Read 122.51445865631104 MBs for this batch
Executing all posts took 4.910365581512451 seconds
Streaming imagenet data took 4.956620693206787 seconds
Then, training+dataloading take 4.978044748306274 seconds

Epoch: 0
Time of next(dataloader) is: 0.3240180015563965
Time for copying to cuda: 0.032151222229003906
Time for forward pass: 0.48644185066223145
Time for backpropagation: 0.003990888595581055
GPU memory for training: 5.746119976043701                          

Memory occpied: (5214.0, 7558.0)
The whole process took 302.7735118865967 seconds
