Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='resnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet18) till index 11
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Decompress data took 0.0997612476348877 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.879446506500244 seconds
Decompress data took 0.10448479652404785 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.829286575317383 seconds
Read 308.89431381225586 MBs for this batch
Streaming imagenet data took 10.522008657455444 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1312.0, 3.0)
Time of next(dataloader) is: 1.035747766494751
Time for copying to cuda: 0.300701379776001
Memory occpied: (2462.0, 688.0)
Memory occpied: (2462.0, 1148.0)
Decompress data took 0.10223889350891113 seconds
Memory occpied: (2462.0, 1552.0)
Memory occpied: (12608.0, 12004.0)
Total decompress data took 2.870922088623047 seconds
Decompress data took 0.10497474670410156 seconds
Memory occpied: (12574.0, 12004.0)
Memory occpied: (6738.0, 8414.0)
Total decompress data took 2.8909740447998047 seconds
Read 306.5873851776123 MBs for this batch
Memory occpied: (9012.0, 7546.0)
Streaming imagenet data took 9.302078008651733 seconds
Time for forward pass: 8.61782169342041
Memory occpied: (9020.0, 9054.0)
Memory occpied: (9020.0, 8418.0)
Time for backpropagation: 1.4907677173614502
GPU memory for training: 21.49008321762085                          

One training iteration takes: 11.626449584960938 seconds
Index: 0
Then, training+dataloading take 11.629069089889526 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (3686.0, 8418.0)
Time of next(dataloader) is: 1.0042834281921387
Time for copying to cuda: 0.3048977851867676
Time for forward pass: 0.04737210273742676
Time for backpropagation: 0.005579948425292969
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.560441017150879 seconds
Index: 1
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10303115844726562 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.9586732387542725 seconds
Decompress data took 0.10512161254882812 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.949448347091675 seconds
Read 309.1082601547241 MBs for this batch
Streaming imagenet data took 9.291001796722412 seconds
Then, training+dataloading take 9.344384908676147 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0817630290985107
Time for copying to cuda: 0.3024864196777344
Time for forward pass: 0.03040313720703125
Time for backpropagation: 0.005098104476928711
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.5916178226470947 seconds
Index: 2
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10096597671508789 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8627374172210693 seconds
Decompress data took 0.10582375526428223 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.9705405235290527 seconds
Read 306.72785568237305 MBs for this batch
Streaming imagenet data took 8.546128988265991 seconds
Then, training+dataloading take 8.600576162338257 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.015334129333496
Time for copying to cuda: 0.30361199378967285
Time for forward pass: 0.03014850616455078
Time for backpropagation: 0.005078792572021484
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.567141056060791 seconds
Index: 3
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10181093215942383 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.962606430053711 seconds
Decompress data took 0.10401296615600586 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.896759510040283 seconds
Read 308.3348731994629 MBs for this batch
Streaming imagenet data took 9.095386505126953 seconds
Then, training+dataloading take 9.14908242225647 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0587246417999268
Time for copying to cuda: 0.3038749694824219
Time for forward pass: 0.029715299606323242
Time for backpropagation: 0.005522012710571289
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.566528558731079 seconds
Index: 4
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10796093940734863 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8446810245513916 seconds
Decompress data took 0.1051328182220459 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8608829975128174 seconds
Read 308.5798740386963 MBs for this batch
Memory occpied: (9830.0, 11498.0)
Streaming imagenet data took 9.367152214050293 seconds
Then, training+dataloading take 9.421310186386108 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.0261106491088867
Time for copying to cuda: 0.29983019828796387
Time for forward pass: 0.029418230056762695
Time for backpropagation: 0.005383968353271484
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.562300443649292 seconds
Index: 5
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10239911079406738 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.9510793685913086 seconds
Decompress data took 0.10441040992736816 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.886805295944214 seconds
Read 308.1223955154419 MBs for this batch
Streaming imagenet data took 9.462974786758423 seconds
Then, training+dataloading take 9.517119646072388 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1424674987792969
Time for copying to cuda: 0.30062341690063477
Time for forward pass: 0.06427001953125
Time for backpropagation: 0.005397796630859375
GPU memory for training: 13.771409511566162                          

Memory occpied: (9830.0, 11498.0)
One training iteration takes: 1.715003252029419 seconds
Index: 6
Decompress data took 0.11012458801269531 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8957605361938477 seconds
Decompress data took 0.1052408218383789 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8818039894104004 seconds
Read 308.8825988769531 MBs for this batch
Streaming imagenet data took 9.02273964881897 seconds
Then, training+dataloading take 9.072622299194336 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.0913727283477783
Memory occpied: (9830.0, 11498.0)
Time for copying to cuda: 0.38542819023132324
Time for forward pass: 0.03016209602355957
Time for backpropagation: 0.005207538604736328
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.7231450080871582 seconds
Index: 7
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10066652297973633 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8864667415618896 seconds
Decompress data took 0.1045677661895752 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 3.016021966934204 seconds
Read 306.2924919128418 MBs for this batch
Streaming imagenet data took 9.45042109489441 seconds
Then, training+dataloading take 9.504457950592041 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.0114939212799072
Time for copying to cuda: 0.3040151596069336
Time for forward pass: 0.029358386993408203
Time for backpropagation: 0.005456447601318359
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.5744025707244873 seconds
Index: 8
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10206842422485352 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8545620441436768 seconds
Decompress data took 0.10593271255493164 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8997750282287598 seconds
Read 308.42155838012695 MBs for this batch
Memory occpied: (9830.0, 11498.0)
Streaming imagenet data took 9.597503900527954 seconds
Then, training+dataloading take 9.651904344558716 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0243630409240723
Memory occpied: (9830.0, 11498.0)
Time for copying to cuda: 0.30397844314575195
Time for forward pass: 0.029794931411743164
Time for backpropagation: 0.005629777908325195
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.572188377380371 seconds
Index: 9
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10705280303955078 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.9617490768432617 seconds
Decompress data took 0.10512948036193848 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8936221599578857 seconds
Read 304.9983148574829 MBs for this batch
Streaming imagenet data took 9.45897388458252 seconds
Then, training+dataloading take 9.513108253479004 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1164915561676025
Time for copying to cuda: 0.30207228660583496
Time for forward pass: 0.029278278350830078
Time for backpropagation: 0.005125761032104492
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.608255386352539 seconds
Index: 10
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10021209716796875 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.883744239807129 seconds
Decompress data took 0.10513448715209961 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.9079973697662354 seconds
Read 308.9240474700928 MBs for this batch
Memory occpied: (9830.0, 11498.0)
Streaming imagenet data took 9.47568130493164 seconds
Then, training+dataloading take 9.53011965751648 seconds
The mode is:  vanilla
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.0222928524017334
Time for copying to cuda: 0.31196045875549316
Time for forward pass: 0.029819011688232422
Time for backpropagation: 0.005306720733642578
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.5740602016448975 seconds
Index: 11
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10100507736206055 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.9079668521881104 seconds
Decompress data took 0.10485672950744629 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.887176275253296 seconds
Read 307.7045421600342 MBs for this batch
Streaming imagenet data took 9.433039903640747 seconds
Then, training+dataloading take 9.487562417984009 seconds
The mode is:  vanilla
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.1449928283691406
Time for copying to cuda: 0.39115142822265625
Memory occpied: (9830.0, 11498.0)
Time for forward pass: 0.030860185623168945
Time for backpropagation: 0.005572319030761719
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.7813103199005127 seconds
Index: 12
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10038614273071289 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.854102373123169 seconds
Decompress data took 0.10528564453125 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.9952750205993652 seconds
Read 309.3461971282959 MBs for this batch
Streaming imagenet data took 9.569721698760986 seconds
Then, training+dataloading take 9.623802900314331 seconds
The mode is:  vanilla
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.048459529876709
Time for copying to cuda: 0.3214750289916992
Time for forward pass: 0.030049562454223633
Time for backpropagation: 0.005232334136962891
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.6353464126586914 seconds
Index: 13
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10810613632202148 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8629040718078613 seconds
Decompress data took 0.10486888885498047 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.8846116065979004 seconds
Read 307.6575117111206 MBs for this batch
Memory occpied: (9830.0, 11498.0)
Streaming imagenet data took 9.488857507705688 seconds
Then, training+dataloading take 9.543347120285034 seconds
The mode is:  vanilla
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.1075983047485352
Time for copying to cuda: 0.3038442134857178
Time for forward pass: 0.030900239944458008
Time for backpropagation: 0.005107402801513672
GPU memory for training: 13.771409511566162                          

One training iteration takes: 1.6914567947387695 seconds
Index: 14
Memory occpied: (9830.0, 11498.0)
Decompress data took 0.10799336433410645 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.983367443084717 seconds
Decompress data took 0.10551095008850098 seconds
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Total decompress data took 2.9486148357391357 seconds
Read 307.58412647247314 MBs for this batch
Streaming imagenet data took 9.280768156051636 seconds
Then, training+dataloading take 9.335464477539062 seconds

Epoch: 0
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.002974271774292
Time for copying to cuda: 0.2929880619049072
Time for forward pass: 0.027339935302734375
Time for backpropagation: 0.004514455795288086
GPU memory for training: 13.771409511566162                          

The whole process took 159.74692392349243 seconds
