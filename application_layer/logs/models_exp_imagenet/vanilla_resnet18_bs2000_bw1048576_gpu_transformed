Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='resnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet18) till index 11
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Decompress data took 0.09875893592834473 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.8006064891815186 seconds
Decompress data took 0.10250520706176758 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.7981576919555664 seconds
Read 308.89431381225586 MBs for this batch
Memory occpied: (1312.0, 3.0)
Streaming imagenet data took 8.60582709312439 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9263315200805664
Memory occpied: (2462.0, 3.0)
Time for copying to cuda: 0.34067392349243164
Memory occpied: (2462.0, 964.0)
Decompress data took 0.10214066505432129 seconds
Memory occpied: (2462.0, 1332.0)
Memory occpied: (2462.0, 1774.0)
Total decompress data took 2.8927743434906006 seconds
Decompress data took 0.10255098342895508 seconds
Memory occpied: (12574.0, 12004.0)
Memory occpied: (5538.0, 4968.0)
Memory occpied: (6738.0, 6168.0)
Total decompress data took 2.9420981407165527 seconds
Read 306.5873851776123 MBs for this batch
Streaming imagenet data took 8.96886396408081 seconds
Memory occpied: (9012.0, 12174.0)
Time for forward pass: 8.574637651443481
Memory occpied: (9020.0, 8416.0)
Time for backpropagation: 1.5665030479431152
GPU memory for training: 21.49008321762085                          

One training iteration takes: 11.581728458404541 seconds
Index: 0
Then, training+dataloading take 11.584325075149536 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (9024.0, 2484.0)
Time of next(dataloader) is: 1.0300102233886719
Time for copying to cuda: 0.29987621307373047
Time for forward pass: 0.04843473434448242
Time for backpropagation: 0.005261898040771484
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.5306940078735352 seconds
Index: 1
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10001516342163086 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.87797212600708 seconds
Decompress data took 0.10415935516357422 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.937664270401001 seconds
Read 309.1082601547241 MBs for this batch
Memory occpied: (12104.0, 8628.0)
Streaming imagenet data took 9.293012619018555 seconds
Then, training+dataloading take 9.345455408096313 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9930160045623779
Memory occpied: (12104.0, 8628.0)
Time for copying to cuda: 0.30071330070495605
Time for forward pass: 0.029564857482910156
Time for backpropagation: 0.004946470260620117
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.529353141784668 seconds
Index: 2
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10023260116577148 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.888740301132202 seconds
Decompress data took 0.10454726219177246 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.8092689514160156 seconds
Read 306.72785568237305 MBs for this batch
Streaming imagenet data took 9.096621990203857 seconds
Then, training+dataloading take 9.11979341506958 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 8628.0)
Time of next(dataloader) is: 1.0565483570098877
Time for copying to cuda: 0.30046701431274414
Time for forward pass: 0.029488801956176758
Time for backpropagation: 0.005568742752075195
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.600576639175415 seconds
Index: 3
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.1016845703125 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.776679039001465 seconds
Decompress data took 0.10412931442260742 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.773319959640503 seconds
Read 308.3348731994629 MBs for this batch
Memory occpied: (12104.0, 8628.0)
Streaming imagenet data took 9.40663480758667 seconds
Then, training+dataloading take 9.435527801513672 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.045285940170288
Memory occpied: (12104.0, 8628.0)
Time for copying to cuda: 0.3585243225097656
Time for forward pass: 0.03144645690917969
Time for backpropagation: 0.005249738693237305
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.6647462844848633 seconds
Index: 4
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.11015152931213379 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.8317461013793945 seconds
Decompress data took 0.10543680191040039 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.8468754291534424 seconds
Read 308.5798740386963 MBs for this batch
Streaming imagenet data took 9.25407600402832 seconds
Then, training+dataloading take 9.275589227676392 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 8628.0)
Time of next(dataloader) is: 1.0878164768218994
Time for copying to cuda: 0.30019307136535645
Time for forward pass: 0.02954411506652832
Time for backpropagation: 0.004948616027832031
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.6311559677124023 seconds
Index: 5
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10003471374511719 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.7659997940063477 seconds
Decompress data took 0.10376095771789551 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.7677807807922363 seconds
Read 308.1223955154419 MBs for this batch
Streaming imagenet data took 9.143850088119507 seconds
Then, training+dataloading take 9.167252540588379 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1058735847473145
Time for copying to cuda: 0.29856395721435547
Time for forward pass: 0.030884742736816406
Time for backpropagation: 0.005005359649658203
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.6277234554290771 seconds
Index: 6
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.11021828651428223 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.924297332763672 seconds
Decompress data took 0.10563468933105469 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.783348321914673 seconds
Read 308.8825988769531 MBs for this batch
Streaming imagenet data took 8.6619713306427 seconds
Then, training+dataloading take 8.683215856552124 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 8628.0)
Time of next(dataloader) is: 1.0719311237335205
Time for copying to cuda: 0.29956650733947754
Time for forward pass: 0.030809879302978516
Time for backpropagation: 0.005048274993896484
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.6043879985809326 seconds
Index: 7
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.09998941421508789 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.792365074157715 seconds
Decompress data took 0.10342860221862793 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.76240611076355 seconds
Read 306.2924919128418 MBs for this batch
Streaming imagenet data took 9.429094791412354 seconds
Then, training+dataloading take 9.46049427986145 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 8628.0)
Time of next(dataloader) is: 1.0545945167541504
Memory occpied: (12104.0, 8628.0)
Time for copying to cuda: 0.34252190589904785
Time for forward pass: 0.03046417236328125
Time for backpropagation: 0.004994630813598633
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.6405470371246338 seconds
Index: 8
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10309267044067383 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.798129081726074 seconds
Decompress data took 0.15379714965820312 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.917327880859375 seconds
Read 308.42155838012695 MBs for this batch
Streaming imagenet data took 9.23253870010376 seconds
Then, training+dataloading take 9.254335403442383 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 8628.0)
Time of next(dataloader) is: 1.1073193550109863
Time for copying to cuda: 0.30080652236938477
Time for forward pass: 0.03082728385925293
Time for backpropagation: 0.005051136016845703
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.6771440505981445 seconds
Index: 9
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10870003700256348 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.800938606262207 seconds
Decompress data took 0.10497808456420898 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.769838809967041 seconds
Read 304.9983148574829 MBs for this batch
Streaming imagenet data took 9.348984241485596 seconds
Then, training+dataloading take 9.365032434463501 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1042897701263428
Time for copying to cuda: 0.32463788986206055
Time for forward pass: 0.02984762191772461
Time for backpropagation: 0.0054585933685302734
GPU memory for training: 14.172714710235596                          

Memory occpied: (12104.0, 8628.0)
One training iteration takes: 1.6762242317199707 seconds
Index: 10
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10229110717773438 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.7937517166137695 seconds
Decompress data took 0.10511898994445801 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.7961251735687256 seconds
Read 308.9240474700928 MBs for this batch
Memory occpied: (12104.0, 8628.0)
Streaming imagenet data took 9.326112985610962 seconds
Then, training+dataloading take 9.350102186203003 seconds
The mode is:  vanilla
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 8628.0)
Time of next(dataloader) is: 1.069631576538086
Time for copying to cuda: 0.30501747131347656
Time for forward pass: 0.030338048934936523
Time for backpropagation: 0.0052356719970703125
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.6463305950164795 seconds
Index: 11
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10068607330322266 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.7897322177886963 seconds
Decompress data took 0.10508894920349121 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.9032280445098877 seconds
Read 307.7045421600342 MBs for this batch
Streaming imagenet data took 9.057940006256104 seconds
Then, training+dataloading take 9.079258918762207 seconds
The mode is:  vanilla
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 8628.0)
Time of next(dataloader) is: 1.101081371307373
Time for copying to cuda: 0.30111122131347656
Time for forward pass: 0.030719995498657227
Time for backpropagation: 0.005269289016723633
GPU memory for training: 14.172714710235596                          

One training iteration takes: 1.6341087818145752 seconds
Index: 12
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10043168067932129 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.801042318344116 seconds
Decompress data took 0.10541772842407227 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.7921206951141357 seconds
Read 309.3461971282959 MBs for this batch
Streaming imagenet data took 9.44888973236084 seconds
Then, training+dataloading take 9.46478533744812 seconds
The mode is:  vanilla
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1546411514282227
Time for copying to cuda: 0.2972257137298584
Time for forward pass: 0.02951359748840332
Time for backpropagation: 0.005088329315185547
GPU memory for training: 14.172714710235596                          

Memory occpied: (12104.0, 8628.0)
One training iteration takes: 1.7073910236358643 seconds
Index: 13
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10899925231933594 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.823185443878174 seconds
Decompress data took 0.10491037368774414 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.815857410430908 seconds
Read 307.6575117111206 MBs for this batch
Streaming imagenet data took 8.990096092224121 seconds
Then, training+dataloading take 9.014142513275146 seconds
The mode is:  vanilla
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1448955535888672
Time for copying to cuda: 0.29979419708251953
Time for forward pass: 0.029160022735595703
Time for backpropagation: 0.005199909210205078
GPU memory for training: 14.172714710235596                          

Memory occpied: (12104.0, 8628.0)
One training iteration takes: 1.685777187347412 seconds
Index: 14
Memory occpied: (12104.0, 8628.0)
Decompress data took 0.10153770446777344 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.7926363945007324 seconds
Decompress data took 0.10483288764953613 seconds
Memory occpied: (12104.0, 8628.0)
Memory occpied: (12104.0, 8628.0)
Total decompress data took 2.8131046295166016 seconds
Read 307.58412647247314 MBs for this batch
Memory occpied: (12104.0, 8628.0)
Streaming imagenet data took 9.311617374420166 seconds
Then, training+dataloading take 9.334096908569336 seconds

Epoch: 0
Memory occpied: (12104.0, 8628.0)
Time of next(dataloader) is: 1.0781102180480957
Time for copying to cuda: 0.2943990230560303
Time for forward pass: 0.02737593650817871
Time for backpropagation: 0.004396677017211914
GPU memory for training: 14.172714710235596                          

The whole process took 156.37125039100647 seconds
