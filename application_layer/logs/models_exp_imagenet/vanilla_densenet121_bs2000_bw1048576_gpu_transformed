Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='densenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (densenet121) till index 20
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Decompress data took 0.10964584350585938 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.817997694015503 seconds
Decompress data took 0.10477876663208008 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.9169039726257324 seconds
Read 308.89431381225586 MBs for this batch
Memory occpied: (1294.0, 3.0)
Streaming imagenet data took 10.150307416915894 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1294.0, 3.0)
Time of next(dataloader) is: 0.9580457210540771
Time for copying to cuda: 0.30405688285827637
Memory occpied: (2444.0, 876.0)
Decompress data took 0.10451817512512207 seconds
Memory occpied: (2444.0, 1324.0)
Memory occpied: (2444.0, 1784.0)
Memory occpied: (12556.0, 11974.0)
Total decompress data took 2.9273488521575928 seconds
Decompress data took 0.10535216331481934 seconds
Memory occpied: (12556.0, 11974.0)
Memory occpied: (14472.0, 14272.0)
Total decompress data took 2.8374078273773193 seconds
Read 306.5873851776123 MBs for this batch
Streaming imagenet data took 9.28383731842041 seconds
Memory occpied: (14472.0, 15038.0)
Memory occpied: (7818.0, 8910.0)
Memory occpied: (10216.0, 11908.0)
Memory occpied: (14862.0, 11908.0)
Memory occpied: (6770.0, 4872.0)
Memory occpied: (6770.0, 6380.0)
Memory occpied: (11134.0, 8682.0)
Memory occpied: (14776.0, 9246.0)
Memory occpied: (8024.0, 8938.0)
Time for forward pass: 18.896000385284424
Time for backpropagation: 0.09994721412658691
GPU memory for training: 22.67752742767334                          

One training iteration takes: 20.45192813873291 seconds
Index: 0
Then, training+dataloading take 20.454522609710693 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1855618953704834
Time for copying to cuda: 0.3059830665588379
Time for forward pass: 0.13474035263061523
Time for backpropagation: 1.414170503616333
GPU memory for training: 20.449523448944092                          

One training iteration takes: 3.2208242416381836 seconds
Index: 1
Memory occpied: (5992.0, 13368.0)
Decompress data took 0.10380029678344727 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.887457847595215 seconds
Decompress data took 0.1060190200805664 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.9379770755767822 seconds
Read 309.1082601547241 MBs for this batch
Memory occpied: (14816.0, 13368.0)
Streaming imagenet data took 10.0910964012146 seconds
Then, training+dataloading take 10.138757944107056 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 13368.0)
Time of next(dataloader) is: 1.094062089920044
Time for copying to cuda: 0.30289411544799805
Time for forward pass: 0.06232094764709473
Time for backpropagation: 1.4984142780303955
GPU memory for training: 20.449218273162842                          

One training iteration takes: 3.1148128509521484 seconds
Index: 2
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.10044980049133301 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8078505992889404 seconds
Decompress data took 0.10528898239135742 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.809067726135254 seconds
Read 306.72785568237305 MBs for this batch
Streaming imagenet data took 10.853762865066528 seconds
Then, training+dataloading take 10.881894826889038 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 13368.0)
Time of next(dataloader) is: 1.0673174858093262
Memory occpied: (14816.0, 13368.0)
Time for copying to cuda: 0.38965868949890137
Time for forward pass: 0.06216263771057129
Time for backpropagation: 1.5260238647460938
GPU memory for training: 20.449218273162842                          

Memory occpied: (14816.0, 13368.0)
One training iteration takes: 3.2717466354370117 seconds
Index: 3
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.10124015808105469 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8123533725738525 seconds
Decompress data took 0.10498857498168945 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8381943702697754 seconds
Read 308.3348731994629 MBs for this batch
Memory occpied: (14816.0, 13368.0)
Streaming imagenet data took 10.821067810058594 seconds
Then, training+dataloading take 10.849963426589966 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1142182350158691
Memory occpied: (14816.0, 13368.0)
Time for copying to cuda: 0.3269526958465576
Time for forward pass: 0.06521391868591309
Time for backpropagation: 1.4967269897460938
GPU memory for training: 20.449218273162842                          

Memory occpied: (14816.0, 13368.0)
One training iteration takes: 3.262820243835449 seconds
Index: 4
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.10045051574707031 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.797642707824707 seconds
Decompress data took 0.10478544235229492 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8358373641967773 seconds
Read 308.5798740386963 MBs for this batch
Memory occpied: (14816.0, 13368.0)
Streaming imagenet data took 10.892491579055786 seconds
Then, training+dataloading take 10.927933692932129 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.097569227218628
Memory occpied: (14816.0, 13368.0)
Time for copying to cuda: 0.3049764633178711
Time for forward pass: 0.06465792655944824
Time for backpropagation: 1.4869701862335205
GPU memory for training: 20.449218273162842                          

One training iteration takes: 3.2348389625549316 seconds
Index: 5
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.10155296325683594 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.857316255569458 seconds
Decompress data took 0.10517501831054688 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8268706798553467 seconds
Read 308.1223955154419 MBs for this batch
Streaming imagenet data took 10.4289710521698 seconds
Then, training+dataloading take 10.451489210128784 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1555182933807373
Time for copying to cuda: 0.30516672134399414
Time for forward pass: 0.0630502700805664
Time for backpropagation: 1.496901035308838
GPU memory for training: 20.449218273162842                          

Memory occpied: (14816.0, 13368.0)
One training iteration takes: 3.231921672821045 seconds
Index: 6
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.10060596466064453 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.804199457168579 seconds
Decompress data took 0.1046745777130127 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8026061058044434 seconds
Read 308.8825988769531 MBs for this batch
Streaming imagenet data took 10.763199090957642 seconds
Then, training+dataloading take 10.778254270553589 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 13368.0)
Time of next(dataloader) is: 1.1316699981689453
Memory occpied: (14816.0, 13368.0)
Time for copying to cuda: 0.40624165534973145
Time for forward pass: 0.06208539009094238
Time for backpropagation: 1.5000741481781006
GPU memory for training: 20.449218273162842                          

One training iteration takes: 3.3423001766204834 seconds
Index: 7
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.10085821151733398 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8471548557281494 seconds
Decompress data took 0.10433125495910645 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.7976999282836914 seconds
Read 306.2924919128418 MBs for this batch
Streaming imagenet data took 10.609331607818604 seconds
Then, training+dataloading take 10.631941556930542 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1829702854156494
Time for copying to cuda: 0.312453031539917
Time for forward pass: 0.06115221977233887
Time for backpropagation: 1.5262072086334229
GPU memory for training: 20.449218273162842                          

One training iteration takes: 3.2661194801330566 seconds
Index: 8
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.10305905342102051 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8461666107177734 seconds
Decompress data took 0.10975384712219238 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.823026657104492 seconds
Read 308.42155838012695 MBs for this batch
Memory occpied: (14816.0, 13368.0)
Streaming imagenet data took 10.034682035446167 seconds
Then, training+dataloading take 10.057206153869629 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 13368.0)
Time of next(dataloader) is: 1.120042324066162
Time for copying to cuda: 0.3011014461517334
Time for forward pass: 0.06173825263977051
Time for backpropagation: 1.5137596130371094
GPU memory for training: 20.449218273162842                          

One training iteration takes: 3.1603081226348877 seconds
Index: 9
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.09873414039611816 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.7998719215393066 seconds
Decompress data took 0.10410118103027344 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8023054599761963 seconds
Read 304.9983148574829 MBs for this batch
Streaming imagenet data took 10.693100452423096 seconds
Then, training+dataloading take 10.7154221534729 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1715173721313477
Time for copying to cuda: 0.2985968589782715
Time for forward pass: 0.06348466873168945
Time for backpropagation: 1.5153777599334717
GPU memory for training: 20.449218273162842                          

One training iteration takes: 3.232665538787842 seconds
Index: 10
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.1040799617767334 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8170664310455322 seconds
Decompress data took 0.10524892807006836 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8083038330078125 seconds
Read 308.9240474700928 MBs for this batch
Streaming imagenet data took 10.62278699874878 seconds
Then, training+dataloading take 10.645411014556885 seconds
The mode is:  vanilla
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 13368.0)
Time of next(dataloader) is: 1.2372217178344727
Time for copying to cuda: 0.3024420738220215
Time for forward pass: 0.12564611434936523
Time for backpropagation: 1.439422369003296
GPU memory for training: 20.449218273162842                          

Memory occpied: (14816.0, 13368.0)
One training iteration takes: 3.351630210876465 seconds
Index: 11
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.10827779769897461 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8175432682037354 seconds
Decompress data took 0.10541534423828125 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.805114269256592 seconds
Read 307.7045421600342 MBs for this batch
Streaming imagenet data took 10.671825408935547 seconds
Then, training+dataloading take 10.686476230621338 seconds
The mode is:  vanilla
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1819679737091064
Time for copying to cuda: 0.2976341247558594
Time for forward pass: 0.062262773513793945
Time for backpropagation: 1.527684211730957
GPU memory for training: 20.449218273162842                          

Memory occpied: (14816.0, 13368.0)
One training iteration takes: 3.294084310531616 seconds
Index: 12
Decompress data took 0.10243487358093262 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8371829986572266 seconds
Decompress data took 0.10703349113464355 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.831948757171631 seconds
Read 309.3461971282959 MBs for this batch
Streaming imagenet data took 10.495590925216675 seconds
Then, training+dataloading take 10.518417596817017 seconds
The mode is:  vanilla
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1802291870117188
Time for copying to cuda: 0.29898977279663086
Time for forward pass: 0.06199193000793457
Time for backpropagation: 1.5066983699798584
GPU memory for training: 20.449218273162842                          

One training iteration takes: 3.2349281311035156 seconds
Index: 13
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.09986233711242676 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.867316722869873 seconds
Decompress data took 0.10511040687561035 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8103909492492676 seconds
Read 307.6575117111206 MBs for this batch
Streaming imagenet data took 10.58791184425354 seconds
Then, training+dataloading take 10.610773086547852 seconds
The mode is:  vanilla
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.2007055282592773
Time for copying to cuda: 0.30039525032043457
Time for forward pass: 0.06223773956298828
Time for backpropagation: 1.5259051322937012
GPU memory for training: 20.449218273162842                          

One training iteration takes: 3.2758305072784424 seconds
Index: 14
Memory occpied: (14816.0, 13368.0)
Decompress data took 0.10122418403625488 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.856964349746704 seconds
Decompress data took 0.1132364273071289 seconds
Memory occpied: (14816.0, 13368.0)
Memory occpied: (14816.0, 13368.0)
Total decompress data took 2.8192520141601562 seconds
Read 307.58412647247314 MBs for this batch
Streaming imagenet data took 10.701810598373413 seconds
Then, training+dataloading take 10.724598407745361 seconds

Epoch: 0
Time of next(dataloader) is: 1.1700727939605713
Time for copying to cuda: 0.2927703857421875
Time for forward pass: 0.05440688133239746
Time for backpropagation: 1.5268244743347168
GPU memory for training: 20.449218273162842                          

Memory occpied: (14816.0, 13368.0)
The whole process took 188.338237285614 seconds
