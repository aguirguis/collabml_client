Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='densenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (densenet121) till index 20
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Decompress data took 0.10057878494262695 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.790117025375366 seconds
Decompress data took 0.10284638404846191 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.8850009441375732 seconds
Read 308.89431381225586 MBs for this batch
Streaming imagenet data took 9.057721853256226 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1294.0, 3.0)
Time of next(dataloader) is: 0.9462294578552246
Time for copying to cuda: 0.29772162437438965
Memory occpied: (2444.0, 808.0)
Memory occpied: (2444.0, 1254.0)
Decompress data took 0.10150599479675293 seconds
Memory occpied: (2444.0, 1662.0)
Memory occpied: (12556.0, 11974.0)
Total decompress data took 2.8551454544067383 seconds
Decompress data took 0.10532069206237793 seconds
Memory occpied: (12556.0, 11974.0)
Memory occpied: (14472.0, 13890.0)
Total decompress data took 2.862611770629883 seconds
Read 306.5873851776123 MBs for this batch
Memory occpied: (14472.0, 13890.0)
Streaming imagenet data took 9.288909912109375 seconds
Memory occpied: (7818.0, 7236.0)
Memory occpied: (10216.0, 9634.0)
Memory occpied: (14862.0, 14280.0)
Memory occpied: (6770.0, 6188.0)
Memory occpied: (6770.0, 6188.0)
Memory occpied: (8912.0, 10552.0)
Memory occpied: (14776.0, 14194.0)
Memory occpied: (5960.0, 7204.0)
Time for forward pass: 18.968127727508545
Memory occpied: (8420.0, 7870.0)
Time for backpropagation: 0.08301210403442383
GPU memory for training: 22.67752742767334                          

One training iteration takes: 20.46442937850952 seconds
Index: 0
Then, training+dataloading take 20.467050790786743 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (8452.0, 7870.0)
Time of next(dataloader) is: 1.0875537395477295
Time for copying to cuda: 0.29795145988464355
Time for forward pass: 0.17656850814819336
Time for backpropagation: 1.0077307224273682
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.785231113433838 seconds
Index: 1
Decompress data took 0.10334658622741699 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8683207035064697 seconds
Decompress data took 0.11002755165100098 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.9222021102905273 seconds
Read 309.1082601547241 MBs for this batch
Streaming imagenet data took 10.119940042495728 seconds
Then, training+dataloading take 10.194293975830078 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0520648956298828
Time for copying to cuda: 0.2983686923980713
Time for forward pass: 0.06284642219543457
Time for backpropagation: 1.10504150390625
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.716295003890991 seconds
Index: 2
Decompress data took 0.0998833179473877 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8099205493927 seconds
Decompress data took 0.10397911071777344 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8399581909179688 seconds
Read 306.72785568237305 MBs for this batch
Streaming imagenet data took 9.901817083358765 seconds
Then, training+dataloading take 9.953439235687256 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1039135456085205
Time for copying to cuda: 0.30439066886901855
Time for forward pass: 0.06490421295166016
Time for backpropagation: 1.089606523513794
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.763554573059082 seconds
Index: 3
Decompress data took 0.10980510711669922 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.963563919067383 seconds
Decompress data took 0.10469937324523926 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8460798263549805 seconds
Read 308.3348731994629 MBs for this batch
Streaming imagenet data took 9.837370872497559 seconds
Then, training+dataloading take 9.864112377166748 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1729555130004883
Time for copying to cuda: 0.30017733573913574
Time for forward pass: 0.07315921783447266
Time for backpropagation: 1.1023461818695068
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.8780734539031982 seconds
Index: 4
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.10172486305236816 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8891162872314453 seconds
Decompress data took 0.10542702674865723 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.889266014099121 seconds
Read 308.5798740386963 MBs for this batch
Memory occpied: (14596.0, 14014.0)
Streaming imagenet data took 10.353278160095215 seconds
Then, training+dataloading take 10.405044317245483 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.0634050369262695
Time for copying to cuda: 0.30255866050720215
Time for forward pass: 0.06390047073364258
Time for backpropagation: 1.1102802753448486
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.754099130630493 seconds
Index: 5
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.10304808616638184 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.838193655014038 seconds
Decompress data took 0.1043245792388916 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.895498275756836 seconds
Read 308.1223955154419 MBs for this batch
Memory occpied: (14596.0, 14014.0)
Streaming imagenet data took 10.3629629611969 seconds
Then, training+dataloading take 10.414916276931763 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.028223991394043
Time for copying to cuda: 0.3198812007904053
Time for forward pass: 0.06353545188903809
Time for backpropagation: 1.0956625938415527
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.712649345397949 seconds
Index: 6
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.1108088493347168 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8833165168762207 seconds
Decompress data took 0.10540509223937988 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.9415082931518555 seconds
Read 308.8825988769531 MBs for this batch
Memory occpied: (14596.0, 14014.0)
Streaming imagenet data took 10.31318736076355 seconds
Then, training+dataloading take 10.365091323852539 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.015824556350708
Time for copying to cuda: 0.302448034286499
Time for forward pass: 0.06174516677856445
Time for backpropagation: 1.1113619804382324
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.7080564498901367 seconds
Index: 7
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.10853290557861328 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.9099459648132324 seconds
Decompress data took 0.10460567474365234 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8847768306732178 seconds
Read 306.2924919128418 MBs for this batch
Memory occpied: (14596.0, 14014.0)
Streaming imagenet data took 10.1110999584198 seconds
Then, training+dataloading take 10.162745475769043 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.022613763809204
Memory occpied: (14596.0, 14014.0)
Time for copying to cuda: 0.31681370735168457
Time for forward pass: 0.06415772438049316
Time for backpropagation: 1.0933122634887695
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.7105534076690674 seconds
Index: 8
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.10068774223327637 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.852407693862915 seconds
Decompress data took 0.10596632957458496 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.99357533454895 seconds
Read 308.42155838012695 MBs for this batch
Memory occpied: (14596.0, 14014.0)
Streaming imagenet data took 10.407317876815796 seconds
Then, training+dataloading take 10.458899736404419 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.0339984893798828
Time for copying to cuda: 0.3028287887573242
Time for forward pass: 0.0667567253112793
Time for backpropagation: 1.0891146659851074
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.702078342437744 seconds
Index: 9
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.09892010688781738 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8400981426239014 seconds
Decompress data took 0.10417675971984863 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.9466912746429443 seconds
Read 304.9983148574829 MBs for this batch
Memory occpied: (14596.0, 14014.0)
Streaming imagenet data took 10.37654423713684 seconds
Then, training+dataloading take 10.428390264511108 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.0275382995605469
Time for copying to cuda: 0.3026010990142822
Time for forward pass: 0.0629422664642334
Time for backpropagation: 1.0971243381500244
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.6990251541137695 seconds
Index: 10
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.1014251708984375 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8685059547424316 seconds
Decompress data took 0.10523819923400879 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 3.010537624359131 seconds
Read 308.9240474700928 MBs for this batch
Memory occpied: (14596.0, 14014.0)
Streaming imagenet data took 10.439709186553955 seconds
Then, training+dataloading take 10.491637706756592 seconds
The mode is:  vanilla
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.011132001876831
Time for copying to cuda: 0.3031764030456543
Time for forward pass: 0.06516075134277344
Time for backpropagation: 1.0968623161315918
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.6911706924438477 seconds
Index: 11
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.10030698776245117 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8556294441223145 seconds
Decompress data took 0.10503458976745605 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.9844284057617188 seconds
Read 307.7045421600342 MBs for this batch
Memory occpied: (14596.0, 14014.0)
Streaming imagenet data took 10.39612889289856 seconds
Then, training+dataloading take 10.449864149093628 seconds
The mode is:  vanilla
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.0317447185516357
Time for copying to cuda: 0.30209875106811523
Time for forward pass: 0.062013864517211914
Time for backpropagation: 1.1026036739349365
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.7113845348358154 seconds
Index: 12
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.10064530372619629 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.8619961738586426 seconds
Decompress data took 0.10575342178344727 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.988987922668457 seconds
Read 309.3461971282959 MBs for this batch
Streaming imagenet data took 10.44258999824524 seconds
Then, training+dataloading take 10.494848251342773 seconds
The mode is:  vanilla
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.0229432582855225
Time for copying to cuda: 0.3152201175689697
Time for forward pass: 0.0654909610748291
Time for backpropagation: 1.0963044166564941
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
One training iteration takes: 2.73832106590271 seconds
Index: 13
Decompress data took 0.10303425788879395 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.9803788661956787 seconds
Decompress data took 0.1059885025024414 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.890901565551758 seconds
Read 307.6575117111206 MBs for this batch
Streaming imagenet data took 9.921748638153076 seconds
Then, training+dataloading take 9.9767746925354 seconds
The mode is:  vanilla
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.0602893829345703
Memory occpied: (14596.0, 14014.0)
Time for copying to cuda: 0.3806338310241699
Time for forward pass: 0.06432914733886719
Time for backpropagation: 1.0942533016204834
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Decompress data took 0.10903048515319824 seconds
Memory occpied: (14596.0, 14014.0)
Memory occpied: (14596.0, 14014.0)
Total decompress data took 2.935513496398926 seconds
Decompress data took 0.1038203239440918 seconds
Memory occpied: (14596.0, 14014.0)
One training iteration takes: 7.737072944641113 seconds
Index: 14
Memory occpied: (14596.0, 14014.0)
Total decompress data took 3.097583532333374 seconds
Read 307.58412647247314 MBs for this batch
Memory occpied: (14596.0, 14014.0)
Streaming imagenet data took 10.451611518859863 seconds
Then, training+dataloading take 10.503514766693115 seconds

Epoch: 0
Memory occpied: (14596.0, 14014.0)
Time of next(dataloader) is: 1.0112223625183105
Time for copying to cuda: 0.2919492721557617
Time for forward pass: 0.055350303649902344
Time for backpropagation: 1.1231777667999268
GPU memory for training: 20.449218273162842                          

Memory occpied: (14596.0, 14014.0)
The whole process took 181.92750430107117 seconds
