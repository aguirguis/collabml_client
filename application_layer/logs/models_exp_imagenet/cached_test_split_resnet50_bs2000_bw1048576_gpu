Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.9275731369253 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119003882.86620307 119003882.86620307
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  312.10302734375 128.61181640625 440.71484375 13511.42431640625
Candidate split  21
Server, client, server+client, vanilla  312.10302734375 128.61181640625 440.71484375 13511.42431640625
Model size  97.72802734375
Fixed, scale_with_bsz  97.72802734375 6.69921875
Mem usage  1410.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.37646222114563 seconds
Streaming imagenet data took 4.383432865142822 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29952454566955566
Time for copying to cuda: 0.004393100738525391
Memory occpied: (1410.0, 126.0)
Memory occpied: (1410.0, 612.0)
Memory occpied: (1410.0, 1072.0)
Time for forward pass: 3.103935480117798
Time for backpropagation: 0.06407475471496582
GPU memory for training: 0.4387826919555664                          

One training iteration takes: 3.5290040969848633 seconds
Index: 0
Memory occpied: (1638.0, 1408.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.244181871414185 seconds
Streaming imagenet data took 4.251316070556641 seconds
Then, training+dataloading take 4.252223491668701 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3304455280303955
Time for copying to cuda: 0.004360198974609375
Time for forward pass: 0.01497960090637207
Time for backpropagation: 0.007463932037353516
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4476437568664551 seconds
Index: 1
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.277176141738892 seconds
Streaming imagenet data took 4.284349203109741 seconds
Then, training+dataloading take 4.285168409347534 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40953874588012695
Memory occpied: (1666.0, 1416.0)
Time for copying to cuda: 0.004486560821533203
Time for forward pass: 0.014235973358154297
Time for backpropagation: 0.006428718566894531
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.5154426097869873 seconds
Index: 2
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.193424701690674 seconds
Streaming imagenet data took 4.200459003448486 seconds
Then, training+dataloading take 4.20132303237915 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.328829288482666
Time for copying to cuda: 0.0044291019439697266
Time for forward pass: 0.014383316040039062
Time for backpropagation: 0.006368160247802734
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4474666118621826 seconds
Index: 3
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8500351905822754 seconds
Streaming imagenet data took 3.854686737060547 seconds
Then, training+dataloading take 3.855517864227295 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3297402858734131
Time for copying to cuda: 0.004396200180053711
Time for forward pass: 0.014426708221435547
Time for backpropagation: 0.006302595138549805
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.43201541900634766 seconds
Index: 4
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.17763352394104 seconds
Streaming imagenet data took 4.22258448600769 seconds
Then, training+dataloading take 4.2287232875823975 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (1666.0, 1416.0)
Time of next(dataloader) is: 0.36811161041259766
Time for copying to cuda: 0.004408121109008789
Time for forward pass: 0.014394998550415039
Time for backpropagation: 0.006330013275146484
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4653301239013672 seconds
Index: 5
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.265450954437256 seconds
Streaming imagenet data took 4.270456790924072 seconds
Then, training+dataloading take 4.271486759185791 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3329641819000244
Time for copying to cuda: 0.004399538040161133
Time for forward pass: 0.014389753341674805
Time for backpropagation: 0.006363630294799805
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4425647258758545 seconds
Index: 6
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.354878187179565 seconds
Streaming imagenet data took 4.36179518699646 seconds
Then, training+dataloading take 4.362755537033081 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (1666.0, 1416.0)
Time of next(dataloader) is: 0.34932732582092285
Time for copying to cuda: 0.004416942596435547
Time for forward pass: 0.014302492141723633
Time for backpropagation: 0.006343364715576172
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4459683895111084 seconds
Index: 7
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.289514541625977 seconds
Streaming imagenet data took 4.2944655418396 seconds
Then, training+dataloading take 4.295344114303589 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34337878227233887
Time for copying to cuda: 0.004414081573486328
Time for forward pass: 0.05293011665344238
Time for backpropagation: 0.006731748580932617
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.49927377700805664 seconds
Index: 8
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.3143017292022705 seconds
Streaming imagenet data took 4.3189377784729 seconds
Then, training+dataloading take 4.319778680801392 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3397552967071533
Time for copying to cuda: 0.0045130252838134766
Time for forward pass: 0.014445781707763672
Time for backpropagation: 0.0063593387603759766
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.43868017196655273 seconds
Index: 9
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.295950889587402 seconds
Streaming imagenet data took 4.300652742385864 seconds
Then, training+dataloading take 4.3014795780181885 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37096738815307617
Time for copying to cuda: 0.004471540451049805
Time for forward pass: 0.01441192626953125
Time for backpropagation: 0.0063397884368896484
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.49849367141723633 seconds
Index: 10
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.304490804672241 seconds
Streaming imagenet data took 4.30926775932312 seconds
Then, training+dataloading take 4.310102939605713 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34126782417297363
Time for copying to cuda: 0.0043833255767822266
Time for forward pass: 0.014364480972290039
Time for backpropagation: 0.006345510482788086
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4529073238372803 seconds
Index: 11
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.206164836883545 seconds
Streaming imagenet data took 4.210711479187012 seconds
Then, training+dataloading take 4.211521625518799 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38082098960876465
Time for copying to cuda: 0.04100179672241211
Time for forward pass: 0.014842987060546875
Time for backpropagation: 0.006550788879394531
GPU memory for training: 0.4546504020690918                          

Memory occpied: (1666.0, 1416.0)
One training iteration takes: 0.5313644409179688 seconds
Index: 12
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.326189279556274 seconds
Streaming imagenet data took 4.3310770988464355 seconds
Then, training+dataloading take 4.331947088241577 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3333711624145508
Time for copying to cuda: 0.004389762878417969
Time for forward pass: 0.014383792877197266
Time for backpropagation: 0.00644683837890625
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4317457675933838 seconds
Index: 13
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.293583869934082 seconds
Streaming imagenet data took 4.2984254360198975 seconds
Then, training+dataloading take 4.299281120300293 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3711531162261963
Time for copying to cuda: 0.0044744014739990234
Time for forward pass: 0.014404535293579102
Time for backpropagation: 0.0064449310302734375
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.5168309211730957 seconds
Index: 14
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.285289287567139 seconds
Streaming imagenet data took 4.2899603843688965 seconds
Then, training+dataloading take 4.2908079624176025 seconds

Epoch: 0
Time of next(dataloader) is: 0.34896183013916016
Time for copying to cuda: 0.004427909851074219
Time for forward pass: 0.014383792877197266
Time for backpropagation: 0.006413698196411133
GPU memory for training: 0.4546504020690918                          

The whole process took 75.48419523239136 seconds
