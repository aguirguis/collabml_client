Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5776914343486 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1795868992034133.2 119089095.17168294 119089095.17168294
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  955.22802734375 128.61181640625 1083.83984375 13511.42431640625
Candidate split  21
Server, client, server+client, vanilla  955.22802734375 128.61181640625 1083.83984375 13511.42431640625
Model size  97.72802734375
Fixed, scale_with_bsz  97.72802734375 6.69921875
Mem usage  1410.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Memory occpied: (1410.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.947873592376709 seconds
Streaming imagenet data took 3.954946517944336 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28058910369873047
Time for copying to cuda: 0.004412412643432617
Memory occpied: (1410.0, 282.0)
Memory occpied: (1410.0, 754.0)
Memory occpied: (1410.0, 1170.0)
Time for forward pass: 3.1923327445983887
Time for backpropagation: 0.06356120109558105
GPU memory for training: 0.4387826919555664                          

One training iteration takes: 3.6065266132354736 seconds
Index: 0
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.845153570175171 seconds
Streaming imagenet data took 3.85288405418396 seconds
Then, training+dataloading take 3.8537404537200928 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31970906257629395
Time for copying to cuda: 0.004408359527587891
Time for forward pass: 0.06001019477844238
Time for backpropagation: 0.010704755783081055
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.48600244522094727 seconds
Index: 1
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8585705757141113 seconds
Streaming imagenet data took 3.865622043609619 seconds
Then, training+dataloading take 3.8664321899414062 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3553471565246582
Time for copying to cuda: 0.004469394683837891
Time for forward pass: 0.014421463012695312
Time for backpropagation: 0.006391048431396484
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.48920106887817383 seconds
Index: 2
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.895007610321045 seconds
Streaming imagenet data took 3.900263786315918 seconds
Then, training+dataloading take 3.9011147022247314 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3495051860809326
Time for copying to cuda: 0.0044634342193603516
Time for forward pass: 0.014293432235717773
Time for backpropagation: 0.006349086761474609
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4910709857940674 seconds
Index: 3
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.839195489883423 seconds
Streaming imagenet data took 3.844115972518921 seconds
Then, training+dataloading take 3.8449556827545166 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34850215911865234
Time for copying to cuda: 0.0043070316314697266
Time for forward pass: 0.0142822265625
Time for backpropagation: 0.006327390670776367
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.49240803718566895 seconds
Index: 4
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.867948055267334 seconds
Streaming imagenet data took 3.873307466506958 seconds
Then, training+dataloading take 3.874171257019043 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.388934850692749
Time for copying to cuda: 0.004487514495849609
Time for forward pass: 0.014166831970214844
Time for backpropagation: 0.006410837173461914
GPU memory for training: 0.4546504020690918                          

Memory occpied: (1666.0, 1416.0)
One training iteration takes: 0.4976632595062256 seconds
Index: 5
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.999377727508545 seconds
Streaming imagenet data took 4.008193492889404 seconds
Then, training+dataloading take 4.011934518814087 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Time of next(dataloader) is: 0.313488245010376
Time for copying to cuda: 0.004426717758178711
Time for forward pass: 0.014604330062866211
Time for backpropagation: 0.0063266754150390625
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.41664695739746094 seconds
Index: 6
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8526039123535156 seconds
Streaming imagenet data took 3.8597640991210938 seconds
Then, training+dataloading take 3.860729217529297 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3169898986816406
Time for copying to cuda: 0.004361391067504883
Time for forward pass: 0.014272689819335938
Time for backpropagation: 0.006417989730834961
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4152698516845703 seconds
Index: 7
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.879624843597412 seconds
Streaming imagenet data took 3.8851027488708496 seconds
Then, training+dataloading take 3.8859593868255615 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31249475479125977
Time for copying to cuda: 0.004546642303466797
Time for forward pass: 0.014357328414916992
Time for backpropagation: 0.0063364505767822266
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4127495288848877 seconds
Index: 8
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.861874580383301 seconds
Streaming imagenet data took 3.8666484355926514 seconds
Then, training+dataloading take 3.8674590587615967 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36854982376098633
Time for copying to cuda: 0.00448155403137207
Time for forward pass: 0.014617443084716797
Time for backpropagation: 0.006818056106567383
GPU memory for training: 0.4546504020690918                          

Memory occpied: (1666.0, 1416.0)
One training iteration takes: 0.47168660163879395 seconds
Index: 9
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.9818406105041504 seconds
Streaming imagenet data took 3.991562604904175 seconds
Then, training+dataloading take 3.9952125549316406 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1666.0, 1416.0)
Time of next(dataloader) is: 0.31534337997436523
Time for copying to cuda: 0.004418849945068359
Time for forward pass: 0.014655828475952148
Time for backpropagation: 0.0064754486083984375
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.42264437675476074 seconds
Index: 10
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8567774295806885 seconds
Streaming imagenet data took 3.861619710922241 seconds
Then, training+dataloading take 3.862589120864868 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3125169277191162
Time for copying to cuda: 0.004443168640136719
Time for forward pass: 0.014255762100219727
Time for backpropagation: 0.006462574005126953
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4189755916595459 seconds
Index: 11
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8595097064971924 seconds
Streaming imagenet data took 3.8644027709960938 seconds
Then, training+dataloading take 3.8652961254119873 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31231164932250977
Time for copying to cuda: 0.0043697357177734375
Time for forward pass: 0.01443338394165039
Time for backpropagation: 0.006421089172363281
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4112727642059326 seconds
Index: 12
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.905913829803467 seconds
Streaming imagenet data took 3.911240577697754 seconds
Then, training+dataloading take 3.9120635986328125 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38877201080322266
Memory occpied: (1666.0, 1416.0)
Time for copying to cuda: 0.004452943801879883
Time for forward pass: 0.014143228530883789
Time for backpropagation: 0.0063588619232177734
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.47562599182128906 seconds
Index: 13
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.9821174144744873 seconds
Streaming imagenet data took 3.986835241317749 seconds
Then, training+dataloading take 3.9876255989074707 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.313152551651001
Time for copying to cuda: 0.004342794418334961
Time for forward pass: 0.01429891586303711
Time for backpropagation: 0.0063436031341552734
GPU memory for training: 0.4546504020690918                          

One training iteration takes: 0.4186522960662842 seconds
Index: 14
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Memory occpied: (1666.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8773601055145264 seconds
Streaming imagenet data took 3.8826563358306885 seconds
Then, training+dataloading take 3.883558750152588 seconds

Epoch: 0
Time of next(dataloader) is: 0.3084390163421631
Time for copying to cuda: 0.004357337951660156
Time for forward pass: 0.014172792434692383
Time for backpropagation: 0.00641632080078125
GPU memory for training: 0.4546504020690918                          

The whole process took 69.45997500419617 seconds
