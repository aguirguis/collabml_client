Namespace(all_in_cos=False, batch_size=8000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='resnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet18) till index 11
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Decompress data took 0.10885739326477051 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.8779242038726807 seconds
Decompress data took 0.10402297973632812 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.9300804138183594 seconds
Decompress data took 0.10268044471740723 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.929831027984619 seconds
Decompress data took 0.1017460823059082 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.8823487758636475 seconds
Decompress data took 0.10458254814147949 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.895526170730591 seconds
Decompress data took 0.1020963191986084 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.0040953159332275 seconds
Decompress data took 0.10460138320922852 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.9794864654541016 seconds
Decompress data took 0.10203146934509277 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.9233813285827637 seconds
Read 1231.3178148269653 MBs for this batch
Memory occpied: (1312.0, 3.0)
Streaming imagenet data took 37.72714638710022 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 3.1471357345581055
Time for copying to cuda: 1.3137621879577637
Memory occpied: (1312.0, 3.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 283, in forward
    return self._forward_impl(x)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 266, in _forward_impl
    x = self.conv1(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 11.96 GiB (GPU 0; 14.76 GiB total capacity; 4.53 GiB already allocated; 8.99 GiB free; 4.55 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

The whole process took 51.7635862827301 seconds
Decompress data took 0.10873866081237793 seconds
Total decompress data took 2.6751327514648438 seconds
Decompress data took 0.10306596755981445 seconds
Total decompress data took 2.6260900497436523 seconds
Decompress data took 0.10298895835876465 seconds
Total decompress data took 2.641329765319824 seconds
Decompress data took 0.1017155647277832 seconds
Total decompress data took 2.6593494415283203 seconds
Decompress data took 0.1032876968383789 seconds
Total decompress data took 2.6583259105682373 seconds
Decompress data took 0.1017770767211914 seconds
Total decompress data took 2.647838830947876 seconds
Decompress data took 0.10284137725830078 seconds
Total decompress data took 2.656174421310425 seconds
Decompress data took 0.10220575332641602 seconds
Total decompress data took 2.6474387645721436 seconds
Read 1233.9197416305542 MBs for this batch
Streaming imagenet data took 33.52941918373108 seconds
