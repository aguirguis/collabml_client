Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='resnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet18) till index 11
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Decompress data took 0.11014223098754883 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.8397250175476074 seconds
Decompress data took 0.10311102867126465 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.882887125015259 seconds
Decompress data took 0.10487794876098633 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.8919007778167725 seconds
Decompress data took 0.10386514663696289 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.8555359840393066 seconds
Decompress data took 0.10265207290649414 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.8699638843536377 seconds
Decompress data took 0.10213279724121094 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.97917103767395 seconds
Decompress data took 0.10412430763244629 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.9489693641662598 seconds
Decompress data took 0.1013174057006836 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 2.89265775680542 seconds
Read 1231.3178148269653 MBs for this batch
Memory occpied: (1312.0, 3.0)
Streaming imagenet data took 36.226714849472046 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Time of next(dataloader) is: 3.222351312637329
Memory occpied: (5906.0, 3.0)
Time for copying to cuda: 1.3286128044128418
Memory occpied: (5906.0, 2510.0)
Memory occpied: (5906.0, 2930.0)
Memory occpied: (5906.0, 3338.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 283, in forward
    return self._forward_impl(x)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 266, in _forward_impl
    x = self.conv1(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 11.96 GiB (GPU 0; 14.76 GiB total capacity; 4.53 GiB already allocated; 8.99 GiB free; 4.55 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

Memory occpied: (5906.0, 3614.0)
The whole process took 51.38108444213867 seconds
Decompress data took 0.10952925682067871 seconds
Total decompress data took 2.630707263946533 seconds
Decompress data took 0.10228991508483887 seconds
Total decompress data took 2.599325656890869 seconds
Decompress data took 0.10299873352050781 seconds
Total decompress data took 2.638037919998169 seconds
Decompress data took 0.10188484191894531 seconds
Total decompress data took 2.630108594894409 seconds
Decompress data took 0.10240387916564941 seconds
Total decompress data took 2.632420063018799 seconds
Decompress data took 0.10162878036499023 seconds
Total decompress data took 2.6226439476013184 seconds
Decompress data took 0.10266518592834473 seconds
Total decompress data took 2.630345344543457 seconds
Decompress data took 0.10166621208190918 seconds
Total decompress data took 2.613990068435669 seconds
Read 1233.9197416305542 MBs for this batch
Streaming imagenet data took 34.17731738090515 seconds
