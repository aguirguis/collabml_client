Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3165470915833 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1795868992034133.2 119054866.460388 119054866.460388
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  857.5 597.2900390625 1454.7900390625 13804.3212890625
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8489649295806885 seconds
Streaming imagenet data took 3.921363353729248 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3781604766845703
Time for copying to cuda: 9.059906005859375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2864949703216553
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.092940807342529 seconds
Streaming imagenet data took 4.188258171081543 seconds
Time for backpropagation: 2.8701791763305664
One training iteration takes: 4.611549615859985 seconds
Index: 0
Then, training+dataloading take 4.6120665073394775 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4197056293487549
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 1.1868195533752441
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8745343685150146 seconds
Streaming imagenet data took 3.971257209777832 seconds
Time for backpropagation: 2.5736520290374756
One training iteration takes: 4.303029298782349 seconds
Index: 1
Then, training+dataloading take 4.304262161254883 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.40732336044311523
Time for copying to cuda: 1.049041748046875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2632904052734375
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.1280295848846436 seconds
Streaming imagenet data took 4.297556161880493 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7865610122680664
One training iteration takes: 4.559130430221558 seconds
Index: 2
Then, training+dataloading take 4.5656938552856445 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41346216201782227
Time for copying to cuda: 9.059906005859375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3253400325775146
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.083993196487427 seconds
Streaming imagenet data took 4.178717136383057 seconds
Time for backpropagation: 2.936582088470459
One training iteration takes: 4.773543357849121 seconds
Index: 3
Then, training+dataloading take 4.777895212173462 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4509303569793701
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 1.1389944553375244
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.01994776725769 seconds
Streaming imagenet data took 4.114827632904053 seconds
Time for backpropagation: 2.7957229614257812
One training iteration takes: 4.501025676727295 seconds
Index: 4
Then, training+dataloading take 4.503694772720337 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4159080982208252
Time for copying to cuda: 1.1205673217773438e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2962169647216797
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.604150772094727 seconds
Time for backpropagation: 2.9730381965637207
Streaming imagenet data took 4.770572900772095 seconds
One training iteration takes: 4.7940356731414795 seconds
Index: 5
Then, training+dataloading take 4.795337200164795 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4131765365600586
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2916216850280762
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.9975037574768066 seconds
Streaming imagenet data took 4.175178289413452 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 3.179304361343384
One training iteration takes: 5.007291078567505 seconds
Index: 6
Then, training+dataloading take 5.007838726043701 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45894479751586914
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 1.1550464630126953
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.9848902225494385 seconds
Streaming imagenet data took 4.081075668334961 seconds
Time for backpropagation: 2.797954797744751
One training iteration takes: 4.531207084655762 seconds
Index: 7
Then, training+dataloading take 4.533528804779053 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4199652671813965
Time for copying to cuda: 1.2159347534179688e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3585002422332764
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.218799352645874 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 4.391681671142578 seconds
Time for backpropagation: 3.4729301929473877
One training iteration takes: 5.3714494705200195 seconds
Index: 8
Then, training+dataloading take 5.377662420272827 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45397043228149414
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 1.1449503898620605
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.9542031288146973 seconds
Streaming imagenet data took 4.048693418502808 seconds
Time for backpropagation: 2.742206573486328
One training iteration takes: 4.476161003112793 seconds
Index: 9
Then, training+dataloading take 4.4765002727508545 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.417433500289917
Time for copying to cuda: 9.298324584960938e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3412163257598877
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.175991773605347 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 4.271195411682129 seconds
Time for backpropagation: 2.91776180267334
One training iteration takes: 4.787034034729004 seconds
Index: 10
Then, training+dataloading take 4.789819955825806 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42560696601867676
Time for copying to cuda: 1.5974044799804688e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3634843826293945
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.415667772293091 seconds
Streaming imagenet data took 4.510117530822754 seconds
Time for backpropagation: 2.921666145324707
One training iteration takes: 4.824630260467529 seconds
Index: 11
Then, training+dataloading take 4.826988697052002 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.42028284072875977
Time for copying to cuda: 1.049041748046875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3322944641113281
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.892531633377075 seconds
Streaming imagenet data took 4.07290244102478 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.869215726852417
One training iteration takes: 4.748924016952515 seconds
Index: 12
Then, training+dataloading take 4.7494847774505615 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4050304889678955
Time for copying to cuda: 9.5367431640625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3269906044006348
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.970273971557617 seconds
Streaming imagenet data took 4.066271066665649 seconds
Time for backpropagation: 2.9278180599212646
One training iteration takes: 4.771408319473267 seconds
Index: 13
Then, training+dataloading take 4.772577524185181 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4154360294342041
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2926585674285889
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.616759777069092 seconds
Streaming imagenet data took 4.705000638961792 seconds
Time for backpropagation: 3.1384267807006836
One training iteration takes: 4.970562934875488 seconds
Index: 14
Then, training+dataloading take 4.971096515655518 seconds

Epoch: 0
Time of next(dataloader) is: 0.48473668098449707
Time for copying to cuda: 9.5367431640625e-06
Time for forward pass: 1.140869379043579
Time for backpropagation: 2.2484142780303955
Memory occpied: (1250.0, 3.0)
The whole process took 85.87695455551147 seconds
