Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.7838454256246 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 118985044.18762746 118985044.18762746
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.558978319168091 seconds
Streaming imagenet data took 3.683175802230835 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3363206386566162
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2845799922943115
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.10566258430481 seconds
Streaming imagenet data took 4.203188896179199 seconds
Time for backpropagation: 2.860297441482544
One training iteration takes: 4.562336683273315 seconds
Index: 0
Then, training+dataloading take 4.562906503677368 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33678770065307617
Time for copying to cuda: 9.5367431640625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3049795627593994
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7554116249084473 seconds
Streaming imagenet data took 3.8494765758514404 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7262749671936035
One training iteration takes: 4.459415435791016 seconds
Index: 1
Then, training+dataloading take 4.461791276931763 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34015893936157227
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2412960529327393
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7333710193634033 seconds
Streaming imagenet data took 3.8302161693573 seconds
Time for backpropagation: 2.6995928287506104
One training iteration takes: 4.371776103973389 seconds
Index: 2
Then, training+dataloading take 4.3740553855896 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3527367115020752
Time for copying to cuda: 9.5367431640625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2718451023101807
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.9467413425445557 seconds
Streaming imagenet data took 4.1004602909088135 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.8384780883789062
One training iteration takes: 4.561198711395264 seconds
Index: 3
Then, training+dataloading take 4.567297458648682 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3545079231262207
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.306014060974121
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.112421035766602 seconds
Streaming imagenet data took 4.208384275436401 seconds
Time for backpropagation: 2.9550280570983887
One training iteration takes: 4.711734771728516 seconds
Index: 4
Then, training+dataloading take 4.717571258544922 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4111659526824951
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 1.1307134628295898
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.646873712539673 seconds
Streaming imagenet data took 3.744016170501709 seconds
Time for backpropagation: 2.6870944499969482
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.327979803085327 seconds
Index: 5
Then, training+dataloading take 4.334247350692749 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3524641990661621
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.281592845916748
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8031580448150635 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 3.9012999534606934 seconds
Time for backpropagation: 2.6950082778930664
One training iteration takes: 4.4297401905059814 seconds
Index: 6
Then, training+dataloading take 4.432124376296997 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3587608337402344
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2266368865966797
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.397682189941406 seconds
Streaming imagenet data took 4.583608865737915 seconds
Time for backpropagation: 3.0514566898345947
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.746018171310425 seconds
Index: 7
Then, training+dataloading take 4.752293825149536 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35660839080810547
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2909317016601562
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.077078342437744 seconds
Streaming imagenet data took 4.174590110778809 seconds
Time for backpropagation: 2.8073108196258545
One training iteration takes: 4.552935600280762 seconds
Index: 8
Then, training+dataloading take 4.55348539352417 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38765406608581543
Time for copying to cuda: 2.3603439331054688e-05
Time for forward pass: 1.1447069644927979
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.587853193283081 seconds
Streaming imagenet data took 3.684058427810669 seconds
Time for backpropagation: 2.589691638946533
One training iteration takes: 4.220578670501709 seconds
Index: 9
Then, training+dataloading take 4.222237586975098 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.352855920791626
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.260371208190918
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.99969482421875 seconds
Streaming imagenet data took 4.095733404159546 seconds
Time for backpropagation: 2.851972818374634
One training iteration takes: 4.571213245391846 seconds
Index: 10
Then, training+dataloading take 4.571794748306274 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37702441215515137
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Read 30.639458656311035 MBs for this batch
Executing all posts took 1.2958347797393799 seconds
Streaming imagenet data took 1.3102552890777588 seconds
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.431654691696167
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4212489128112793
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.326703071594238 seconds
Index: 11
Then, training+dataloading take 4.329099655151367 seconds

Epoch: 0
Time of next(dataloader) is: 0.25351643562316895
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.2102830410003662
Time for backpropagation: 0.3582644462585449
The whole process took 64.41098427772522 seconds
