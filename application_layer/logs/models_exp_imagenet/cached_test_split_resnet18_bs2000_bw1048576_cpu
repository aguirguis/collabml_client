Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.5095851304889 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118949096.34222344 118949096.34222344
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  214.375 597.2900390625 811.6650390625 13804.3212890625
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.6616716384887695 seconds
Streaming imagenet data took 3.767766237258911 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3950049877166748
Time for copying to cuda: 1.1444091796875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2645177841186523
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.033743143081665 seconds
Streaming imagenet data took 4.110977649688721 seconds
Time for backpropagation: 2.895277500152588
One training iteration takes: 4.636566162109375 seconds
Index: 0
Then, training+dataloading take 4.637144088745117 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3890092372894287
Time for copying to cuda: 1.1682510375976562e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2459206581115723
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8168580532073975 seconds
Streaming imagenet data took 3.913872480392456 seconds
Time for backpropagation: 2.7705447673797607
One training iteration takes: 4.511288166046143 seconds
Index: 1
Then, training+dataloading take 4.513402462005615 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4059419631958008
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.282060146331787
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.9938666820526123 seconds
Streaming imagenet data took 4.088447093963623 seconds
Time for backpropagation: 2.977759599685669
One training iteration takes: 4.784610271453857 seconds
Index: 2
Then, training+dataloading take 4.788747072219849 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4294435977935791
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 1.1667563915252686
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7060999870300293 seconds
Streaming imagenet data took 3.801701307296753 seconds
Time for backpropagation: 2.573376417160034
One training iteration takes: 4.283874988555908 seconds
Index: 3
Then, training+dataloading take 4.285657644271851 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4047203063964844
Time for copying to cuda: 1.2636184692382812e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2958903312683105
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8918590545654297 seconds
Streaming imagenet data took 4.066213846206665 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.858471632003784
One training iteration takes: 4.668946027755737 seconds
Index: 4
Then, training+dataloading take 4.669492959976196 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39780187606811523
Time for copying to cuda: 1.049041748046875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.302647590637207
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.896838426589966 seconds
Streaming imagenet data took 3.9925119876861572 seconds
Time for backpropagation: 2.8929147720336914
One training iteration takes: 4.70013689994812 seconds
Index: 5
Then, training+dataloading take 4.701390504837036 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.40468287467956543
Time for copying to cuda: 1.0967254638671875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.300459623336792
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.1907877922058105 seconds
Streaming imagenet data took 4.286154747009277 seconds
Time for backpropagation: 2.7733280658721924
One training iteration takes: 4.5919013023376465 seconds
Index: 6
Then, training+dataloading take 4.592440128326416 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4172048568725586
Time for copying to cuda: 1.0967254638671875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2924988269805908
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.990438938140869 seconds
Streaming imagenet data took 4.068594217300415 seconds
Time for backpropagation: 3.110412836074829
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.932477712631226 seconds
Index: 7
Then, training+dataloading take 4.937324523925781 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4172194004058838
Time for copying to cuda: 1.0251998901367188e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2945261001586914
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.0242698192596436 seconds
Streaming imagenet data took 4.1187217235565186 seconds
Time for backpropagation: 2.8594539165496826
One training iteration takes: 4.677492618560791 seconds
Index: 8
Then, training+dataloading take 4.681991338729858 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4497525691986084
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 1.1491234302520752
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.9736602306365967 seconds
Streaming imagenet data took 4.069017648696899 seconds
Time for backpropagation: 2.762545347213745
One training iteration takes: 4.486259937286377 seconds
Index: 9
Then, training+dataloading take 4.488692045211792 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4118499755859375
Time for copying to cuda: 1.1682510375976562e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3444538116455078
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8064136505126953 seconds
Streaming imagenet data took 3.9831643104553223 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.821340799331665
One training iteration takes: 4.675772666931152 seconds
Index: 10
Then, training+dataloading take 4.676342487335205 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.406829833984375
Time for copying to cuda: 1.0013580322265625e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3281347751617432
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.883713960647583 seconds
Streaming imagenet data took 3.9599695205688477 seconds
Time for backpropagation: 2.8901236057281494
One training iteration takes: 4.725114822387695 seconds
Index: 11
Then, training+dataloading take 4.72636342048645 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4067404270172119
Time for copying to cuda: 1.1444091796875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2956016063690186
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.189610719680786 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 4.286761045455933 seconds
Time for backpropagation: 2.8513708114624023
One training iteration takes: 4.6672022342681885 seconds
Index: 12
Then, training+dataloading take 4.667775392532349 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.414196252822876
Time for copying to cuda: 1.0251998901367188e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2882440090179443
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.978775978088379 seconds
Streaming imagenet data took 4.0566229820251465 seconds
Time for backpropagation: 2.9912760257720947
One training iteration takes: 4.80762791633606 seconds
Index: 13
Then, training+dataloading take 4.809697389602661 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.41715431213378906
Time for copying to cuda: 1.0728836059570312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3441660404205322
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.139639377593994 seconds
Streaming imagenet data took 4.235674142837524 seconds
Time for backpropagation: 2.9225480556488037
One training iteration takes: 4.804564714431763 seconds
Index: 14
Then, training+dataloading take 4.810560941696167 seconds

Epoch: 0
Time of next(dataloader) is: 0.4566981792449951
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3638203144073486
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.340862274169922
Memory occpied: (1250.0, 3.0)
The whole process took 85.19386196136475 seconds
