Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='densenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (densenet121) till index 20
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Decompress data took 0.10146117210388184 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.8288490772247314 seconds
Decompress data took 0.10259485244750977 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.895007371902466 seconds
Decompress data took 0.10410261154174805 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.8999199867248535 seconds
Decompress data took 0.10139608383178711 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.8658859729766846 seconds
Decompress data took 0.10456156730651855 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.8827710151672363 seconds
Decompress data took 0.10183954238891602 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.998938798904419 seconds
Decompress data took 0.10384988784790039 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.9665310382843018 seconds
Decompress data took 0.10115933418273926 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 2.909893035888672 seconds
Read 1231.3178148269653 MBs for this batch
Memory occpied: (1294.0, 3.0)
Streaming imagenet data took 36.422903060913086 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 3.194304943084717
Time for copying to cuda: 1.2748351097106934
Memory occpied: (1294.0, 3.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/densenet.py", line 215, in forward
    features = self.features(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 11.96 GiB (GPU 0; 14.76 GiB total capacity; 4.52 GiB already allocated; 9.01 GiB free; 4.53 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

The whole process took 50.21365427970886 seconds
Decompress data took 0.09885001182556152 seconds
Total decompress data took 2.606598138809204 seconds
Decompress data took 0.10401511192321777 seconds
Total decompress data took 2.5967295169830322 seconds
Decompress data took 0.10278463363647461 seconds
Total decompress data took 2.6371777057647705 seconds
Decompress data took 0.10174775123596191 seconds
Total decompress data took 2.6222033500671387 seconds
Decompress data took 0.1021733283996582 seconds
Total decompress data took 2.6248371601104736 seconds
Decompress data took 0.10146427154541016 seconds
Total decompress data took 2.6146159172058105 seconds
Decompress data took 0.10255551338195801 seconds
Total decompress data took 2.623837947845459 seconds
Decompress data took 0.10165190696716309 seconds
Total decompress data took 2.6075501441955566 seconds
Read 1233.9197416305542 MBs for this batch
Streaming imagenet data took 33.82087278366089 seconds
