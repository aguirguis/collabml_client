Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.8759828888029 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 118997120.82920118 118997120.82920118
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  0.01220703125 -11054.0771484375 -11054.06494140625 2152.9541015625
Fixed, scale_with_bsz  0 0.00048828125
Mem usage  1250.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.051724672317505 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 6.154357194900513 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3730957508087158
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.134872913360596
Time for backpropagation: 0.26946258544921875
One training iteration takes: 4.844542741775513 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.937585115432739 seconds
Streaming imagenet data took 6.044523000717163 seconds
Then, training+dataloading take 6.058147192001343 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42291784286499023
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 3.590345859527588
Time for backpropagation: 0.21514177322387695
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.319529294967651 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.058157205581665 seconds
Streaming imagenet data took 6.129778623580933 seconds
Then, training+dataloading take 6.14091944694519 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3857090473175049
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.091171979904175
Time for backpropagation: 0.2548556327819824
One training iteration takes: 4.842976093292236 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.04420018196106 seconds
Streaming imagenet data took 6.1180853843688965 seconds
Then, training+dataloading take 6.129687786102295 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39182186126708984
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.122991323471069
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.3067450523376465
One training iteration takes: 4.921107292175293 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.200158596038818 seconds
Streaming imagenet data took 6.271748065948486 seconds
Then, training+dataloading take 6.281302452087402 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3901374340057373
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.103660345077515
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.30608296394348145
One training iteration takes: 4.914939641952515 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.021801710128784 seconds
Streaming imagenet data took 6.0955235958099365 seconds
Then, training+dataloading take 6.107527732849121 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38587021827697754
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.0790300369262695
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.40466785430908203
One training iteration takes: 5.00685453414917 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.199936628341675 seconds
Streaming imagenet data took 6.273468494415283 seconds
Then, training+dataloading take 6.285451650619507 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3942270278930664
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.176995277404785
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.38306665420532227
One training iteration takes: 5.050955295562744 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.0878376960754395 seconds
Streaming imagenet data took 6.159751892089844 seconds
Then, training+dataloading take 6.171172857284546 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39349961280822754
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.184236764907837
Time for backpropagation: 0.3708326816558838
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.056864023208618 seconds
Index: 7
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.167365074157715 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 6.2745137214660645 seconds
Then, training+dataloading take 6.287879228591919 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3873097896575928
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.147136449813843
Time for backpropagation: 0.2834289073944092
One training iteration takes: 4.912153244018555 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.02423882484436 seconds
Streaming imagenet data took 6.132708311080933 seconds
Then, training+dataloading take 6.1439173221588135 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4357306957244873
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.080239534378052
Time for backpropagation: 0.2951064109802246
One training iteration takes: 4.918902158737183 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.093448877334595 seconds
Streaming imagenet data took 6.166097402572632 seconds
Then, training+dataloading take 6.178095817565918 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42008352279663086
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 3.629896879196167
Time for backpropagation: 0.268352746963501
One training iteration takes: 4.431015729904175 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.995962381362915 seconds
Streaming imagenet data took 6.069576025009155 seconds
Then, training+dataloading take 6.0814313888549805 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.392913818359375
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Read 30.639458656311035 MBs for this batch
Executing all posts took 1.905803918838501 seconds
Streaming imagenet data took 2.11453914642334 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.186691522598267
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2993922233581543
One training iteration takes: 4.97256064414978 seconds
Index: 11
Then, training+dataloading take 4.973099946975708 seconds

Epoch: 0
Time of next(dataloader) is: 0.28690361976623535
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8190653324127197
Time for backpropagation: 0.05243682861328125
The whole process took 87.04319596290588 seconds
