Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3443789704388 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119058514.44041336 119058514.44041336
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.767486572265625
Fixed, scale_with_bsz  0 0.00048828125
Mem usage  1250.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.742019176483154 seconds
Streaming imagenet data took 5.81359601020813 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40712594985961914
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 3.600677728652954
Time for backpropagation: 0.1829078197479248
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.256983757019043 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.192898750305176 seconds
Streaming imagenet data took 8.266455888748169 seconds
Then, training+dataloading take 8.278212547302246 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3438289165496826
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.055629730224609
Time for backpropagation: 0.3096466064453125
One training iteration takes: 4.79518985748291 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.986759662628174 seconds
Streaming imagenet data took 6.059278964996338 seconds
Then, training+dataloading take 6.067985534667969 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3509371280670166
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.018357038497925
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.22201323509216309
One training iteration takes: 4.673027038574219 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.739420890808105 seconds
Streaming imagenet data took 8.811848402023315 seconds
Then, training+dataloading take 8.823100090026855 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4198334217071533
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 3.6630218029022217
Time for backpropagation: 0.2904846668243408
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.4765589237213135 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.833582162857056 seconds
Streaming imagenet data took 5.907610177993774 seconds
Then, training+dataloading take 5.919397354125977 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34279441833496094
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.0417492389678955
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.33067893981933594
One training iteration takes: 4.799860239028931 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.130678415298462 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 8.232284784317017 seconds
Then, training+dataloading take 8.242635488510132 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3577408790588379
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.024779319763184
Time for backpropagation: 0.2610893249511719
One training iteration takes: 4.742078065872192 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.799590587615967 seconds
Streaming imagenet data took 5.872040510177612 seconds
Then, training+dataloading take 5.882927894592285 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4180006980895996
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 3.6342387199401855
Time for backpropagation: 0.1964271068572998
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.343457460403442 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.181639671325684 seconds
Streaming imagenet data took 8.253476858139038 seconds
Then, training+dataloading take 8.263092279434204 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36170291900634766
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.193167448043823
Time for backpropagation: 0.2603724002838135
One training iteration takes: 4.913597583770752 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.8658106327056885 seconds
Streaming imagenet data took 5.939996004104614 seconds
Then, training+dataloading take 5.949594020843506 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3620319366455078
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 3.9498279094696045
Time for backpropagation: 0.23953533172607422
One training iteration takes: 4.642413139343262 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.265185832977295 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 8.337465763092041 seconds
Then, training+dataloading take 8.348987817764282 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36316752433776855
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 4.005635738372803
Time for backpropagation: 0.2913479804992676
One training iteration takes: 4.750476598739624 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.88353157043457 seconds
Streaming imagenet data took 6.015710353851318 seconds
Then, training+dataloading take 6.029639959335327 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3492724895477295
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 3.9842138290405273
Time for backpropagation: 0.20545077323913574
One training iteration takes: 4.611985445022583 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.13765025138855 seconds
Streaming imagenet data took 8.208885908126831 seconds
Then, training+dataloading take 8.218055963516235 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3916933536529541
Time for copying to cuda: 7.152557373046875e-06
Read 30.639458656311035 MBs for this batch
Executing all posts took 1.977607250213623 seconds
Streaming imagenet data took 2.088749885559082 seconds
Time for forward pass: 3.7482316493988037
Time for backpropagation: 0.2096705436706543
One training iteration takes: 4.438859939575195 seconds
Index: 11
Then, training+dataloading take 4.4391865730285645 seconds

Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.261918306350708
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.6619336605072021
Time for backpropagation: 0.04660511016845703
The whole process took 97.2981448173523 seconds
