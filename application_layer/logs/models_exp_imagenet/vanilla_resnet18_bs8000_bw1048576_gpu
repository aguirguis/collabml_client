Namespace(all_in_cos=False, batch_size=8000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='resnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=False, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet18) till index 11
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Decompress data took 0.0844578742980957 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.821507215499878 seconds
Decompress data took 0.08676528930664062 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.6910037994384766 seconds
Decompress data took 0.09137392044067383 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.7901623249053955 seconds
Decompress data took 0.0821387767791748 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.5543551445007324 seconds
Decompress data took 0.08484959602355957 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.6993727684020996 seconds
Decompress data took 0.0816807746887207 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.733166456222534 seconds
Decompress data took 0.09052705764770508 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.6993424892425537 seconds
Decompress data took 0.08237719535827637 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.67000675201416 seconds
Read 988.8015155792236 MBs for this batch
Streaming imagenet data took 38.79244589805603 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Decompress data took 0.09021544456481934 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.827683925628662 seconds
Decompress data took 0.08732175827026367 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.9952585697174072 seconds
Decompress data took 0.0872354507446289 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.9968254566192627 seconds
Decompress data took 0.08444356918334961 seconds
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Time of next(dataloader) is: 24.600199937820435
Memory occpied: (1312.0, 3.0)
Total decompress data took 3.9006869792938232 seconds
Decompress data took 0.09081411361694336 seconds
Time for copying to cuda: 1.2722892761230469
Memory occpied: (5906.0, 2408.0)
Memory occpied: (5906.0, 2812.0)
Memory occpied: (5906.0, 3276.0)
Total decompress data took 4.639153957366943 seconds
Decompress data took 0.08816766738891602 seconds
Memory occpied: (5906.0, 3614.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 283, in forward
    return self._forward_impl(x)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 266, in _forward_impl
    x = self.conv1(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 11.96 GiB (GPU 0; 14.76 GiB total capacity; 4.53 GiB already allocated; 8.99 GiB free; 4.55 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

The whole process took 75.528639793396 seconds
Total decompress data took 4.292731761932373 seconds
Decompress data took 0.09106612205505371 seconds
Total decompress data took 3.652611494064331 seconds
Decompress data took 0.08562946319580078 seconds
Total decompress data took 3.40380859375 seconds
Read 1024.4528188705444 MBs for this batch
Streaming imagenet data took 40.91040372848511 seconds
