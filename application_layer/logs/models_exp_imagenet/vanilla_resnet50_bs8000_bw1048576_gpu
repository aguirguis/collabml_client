Namespace(all_in_cos=False, batch_size=8000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='resnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=False, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet50) till index 21
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Decompress data took 0.09262371063232422 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.7655420303344727 seconds
Decompress data took 0.08635306358337402 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.701934337615967 seconds
Decompress data took 0.08460497856140137 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.811154842376709 seconds
Decompress data took 0.08209347724914551 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.5551998615264893 seconds
Decompress data took 0.09192895889282227 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.6077845096588135 seconds
Decompress data took 0.08740592002868652 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.7484512329101562 seconds
Decompress data took 0.0899190902709961 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.855360507965088 seconds
Decompress data took 0.0822591781616211 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.683454751968384 seconds
Read 988.8015155792236 MBs for this batch
Streaming imagenet data took 39.70389437675476 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Decompress data took 0.0833137035369873 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.9030518531799316 seconds
Decompress data took 0.08759260177612305 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 4.0612382888793945 seconds
Decompress data took 0.08711624145507812 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 4.034351587295532 seconds
Decompress data took 0.0868217945098877 seconds
Memory occpied: (1366.0, 3.0)
Time of next(dataloader) is: 24.53518509864807
Memory occpied: (5960.0, 3.0)
Time for copying to cuda: 1.2546718120574951
Total decompress data took 3.7468862533569336 seconds
Decompress data took 0.09015345573425293 seconds
Memory occpied: (5960.0, 2452.0)
Memory occpied: (5960.0, 2886.0)
Memory occpied: (5960.0, 3328.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 283, in forward
    return self._forward_impl(x)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 266, in _forward_impl
    x = self.conv1(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 11.96 GiB (GPU 0; 14.76 GiB total capacity; 4.58 GiB already allocated; 8.94 GiB free; 4.60 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

Total decompress data took 5.2367048263549805 seconds
Decompress data took 0.09292078018188477 seconds
Memory occpied: (5960.0, 3652.0)
The whole process took 76.84335589408875 seconds
Total decompress data took 3.598686456680298 seconds
Decompress data took 0.09256386756896973 seconds
Total decompress data took 3.6163086891174316 seconds
Decompress data took 0.08515810966491699 seconds
Total decompress data took 3.370805501937866 seconds
Read 1024.4528188705444 MBs for this batch
Streaming imagenet data took 41.620142221450806 seconds
