Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='resnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet50) till index 21
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Decompress data took 0.09137248992919922 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.700089454650879 seconds
Decompress data took 0.08655548095703125 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.64705491065979 seconds
Decompress data took 0.09221935272216797 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.739530563354492 seconds
Decompress data took 0.08044624328613281 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.526494264602661 seconds
Decompress data took 0.08489990234375 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.6889827251434326 seconds
Decompress data took 0.0873708724975586 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.6728897094726562 seconds
Decompress data took 0.0907745361328125 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.792232036590576 seconds
Decompress data took 0.08076596260070801 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.6394121646881104 seconds
Read 988.8015155792236 MBs for this batch
Streaming imagenet data took 38.32241630554199 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Decompress data took 0.08911013603210449 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.855590581893921 seconds
Decompress data took 0.0881035327911377 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.939206838607788 seconds
Decompress data took 0.08779191970825195 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.923719882965088 seconds
Decompress data took 0.08395767211914062 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 3.844136953353882 seconds
Decompress data took 0.09170079231262207 seconds
Time of next(dataloader) is: 24.839133262634277
Memory occpied: (5960.0, 3.0)
Time for copying to cuda: 1.3195884227752686
Memory occpied: (5960.0, 2518.0)
Memory occpied: (5960.0, 2918.0)
Total decompress data took 4.444126844406128 seconds
Decompress data took 0.08905768394470215 seconds
Memory occpied: (5960.0, 3398.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 283, in forward
    return self._forward_impl(x)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 266, in _forward_impl
    x = self.conv1(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 11.96 GiB (GPU 0; 14.76 GiB total capacity; 4.58 GiB already allocated; 8.94 GiB free; 4.60 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

Memory occpied: (5960.0, 3652.0)
The whole process took 75.79197263717651 seconds
Total decompress data took 4.510522842407227 seconds
Decompress data took 0.09132862091064453 seconds
Total decompress data took 3.6054699420928955 seconds
Decompress data took 0.08573484420776367 seconds
Total decompress data took 3.3745458126068115 seconds
Read 1024.4528188705444 MBs for this batch
Streaming imagenet data took 40.5652015209198 seconds
