Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.1499726346228 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1795868992034133.2 119033033.21316528 119033033.21316528
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  3209.5 3452.7587890625 6662.2587890625 52835.5712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1250.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.98145866394043 seconds
Streaming imagenet data took 19.26717734336853 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8150720596313477
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 9.28765320777893
Time for backpropagation: 0.9402449131011963
Memory occpied: (1250.0, 3.0)
One training iteration takes: 11.197694301605225 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.159003973007202 seconds
Streaming imagenet data took 19.44454026222229 seconds
Then, training+dataloading take 19.47908043861389 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9154720306396484
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 9.365520715713501
Time for backpropagation: 1.2062866687774658
One training iteration takes: 11.840128898620605 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.082361698150635 seconds
Streaming imagenet data took 19.366347074508667 seconds
Then, training+dataloading take 19.40226101875305 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9021041393280029
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 9.368357419967651
Time for backpropagation: 1.2238638401031494
One training iteration takes: 11.8458890914917 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.11236262321472 seconds
Streaming imagenet data took 19.450345993041992 seconds
Then, training+dataloading take 19.47220468521118 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9041378498077393
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 9.374664306640625
Time for backpropagation: 1.227936029434204
Memory occpied: (1250.0, 3.0)
One training iteration takes: 11.913028717041016 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.08047127723694 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.480865478515625 seconds
Then, training+dataloading take 19.51835298538208 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8512413501739502
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.26296854019165
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.1543374061584473
One training iteration takes: 14.749258518218994 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.607778787612915 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.89918041229248 seconds
Then, training+dataloading take 19.951377391815186 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8344829082489014
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.487493991851807
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.105426073074341
One training iteration takes: 14.820913553237915 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.69861388206482 seconds
Streaming imagenet data took 19.982874393463135 seconds
Then, training+dataloading take 20.041691303253174 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.912665605545044
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 9.378601551055908
Time for backpropagation: 1.2276675701141357
Memory occpied: (1250.0, 3.0)
One training iteration takes: 11.968539953231812 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.16422128677368 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.56744384765625 seconds
Then, training+dataloading take 19.61549973487854 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8407227993011475
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.328485488891602
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.0884392261505127
One training iteration takes: 14.78978681564331 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.74140501022339 seconds
Streaming imagenet data took 20.024115800857544 seconds
Then, training+dataloading take 20.072166204452515 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8800640106201172
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 9.381637334823608
Time for backpropagation: 1.230687141418457
One training iteration takes: 11.858946800231934 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.143852949142456 seconds
Streaming imagenet data took 19.553142070770264 seconds
Then, training+dataloading take 19.582368850708008 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.8287088871002197
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.222331523895264
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.900845766067505
One training iteration takes: 15.33163833618164 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 20.23082137107849 seconds
Streaming imagenet data took 20.647743225097656 seconds
Then, training+dataloading take 20.67701530456543 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.8356366157531738
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.354920625686646
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.2021617889404297
One training iteration takes: 14.804739475250244 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.924133777618408 seconds
Streaming imagenet data took 20.210808753967285 seconds
Then, training+dataloading take 20.25906205177307 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.8799870014190674
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.363875389099121
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.9347708225250244
One training iteration takes: 14.588465452194214 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.49817943572998 seconds
Streaming imagenet data took 19.84210467338562 seconds
Then, training+dataloading take 19.889428853988647 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.8914031982421875
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.2426016330719
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.112363338470459
One training iteration takes: 14.672873973846436 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.419723987579346 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.826244592666626 seconds
Then, training+dataloading take 19.876627683639526 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.829232931137085
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 10.979172945022583
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.8954863548278809
Memory occpied: (1250.0, 3.0)
One training iteration takes: 14.208862781524658 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.364506006240845 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.71058988571167 seconds
Then, training+dataloading take 19.759068489074707 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8519694805145264
Time for copying to cuda: 1.0013580322265625e-05
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 10.972503423690796
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.0158092975616455
One training iteration takes: 14.294273376464844 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.550405979156494 seconds
Streaming imagenet data took 19.83523464202881 seconds
Then, training+dataloading take 19.881567001342773 seconds

Epoch: 0
Time of next(dataloader) is: 0.8883223533630371
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 9.402071237564087
Time for backpropagation: 1.230959177017212
Memory occpied: (1250.0, 3.0)
The whole process took 337.4922173023224 seconds
