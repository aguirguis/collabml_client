Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.5866629238006 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118959199.0827484 118959199.0827484
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  802.375 3452.7587890625 4255.1337890625 52835.5712890625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1250.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.397577047348022 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 18.770416736602783 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7437379360198975
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 10.839857816696167
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.9477148056030273
One training iteration takes: 13.686278581619263 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.12945008277893 seconds
Streaming imagenet data took 19.41923689842224 seconds
Then, training+dataloading take 19.454362869262695 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9111161231994629
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 9.319363117218018
Time for backpropagation: 1.5574862957000732
One training iteration takes: 12.160499334335327 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.687561988830566 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.033702850341797 seconds
Then, training+dataloading take 19.088350772857666 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8381483554840088
Time for copying to cuda: 9.5367431640625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.052365779876709
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7047455310821533
One training iteration takes: 15.045031785964966 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.727375984191895 seconds
Streaming imagenet data took 20.011265516281128 seconds
Then, training+dataloading take 20.06988787651062 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8923919200897217
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 9.381818532943726
Time for backpropagation: 1.2729272842407227
One training iteration takes: 11.923584222793579 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.814782857894897 seconds
Streaming imagenet data took 19.09917449951172 seconds
Then, training+dataloading take 19.143803358078003 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9176695346832275
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 9.37414288520813
Time for backpropagation: 1.3305277824401855
One training iteration takes: 11.990439176559448 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.68189287185669 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.02317786216736 seconds
Then, training+dataloading take 19.06680202484131 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8594188690185547
Time for copying to cuda: 9.5367431640625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.093652486801147
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.1057140827178955
One training iteration takes: 14.524763584136963 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.10264754295349 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.446810722351074 seconds
Then, training+dataloading take 19.492868185043335 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8436965942382812
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.109733819961548
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3010172843933105
One training iteration takes: 14.708666324615479 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.551095247268677 seconds
Streaming imagenet data took 19.836052417755127 seconds
Then, training+dataloading take 19.88158392906189 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8946552276611328
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 9.387540578842163
Time for backpropagation: 1.350682258605957
One training iteration takes: 12.055408954620361 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.7327299118042 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.012925148010254 seconds
Then, training+dataloading take 19.057698249816895 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8460187911987305
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.1421058177948
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.417285680770874
One training iteration takes: 14.824500322341919 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.645451068878174 seconds
Streaming imagenet data took 19.93230128288269 seconds
Then, training+dataloading take 19.978904247283936 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9100003242492676
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 9.38987398147583
Time for backpropagation: 1.3555355072021484
One training iteration takes: 12.029350280761719 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.723570585250854 seconds
Streaming imagenet data took 19.005383491516113 seconds
Then, training+dataloading take 19.048743963241577 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.8450853824615479
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.468221664428711
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.9868724346160889
One training iteration takes: 14.724849700927734 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.275532245635986 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.62211799621582 seconds
Then, training+dataloading take 19.670536756515503 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8570425510406494
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.546622276306152
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3042869567871094
One training iteration takes: 15.168097019195557 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.826478242874146 seconds
Streaming imagenet data took 20.10716676712036 seconds
Then, training+dataloading take 20.151955127716064 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9102976322174072
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 9.402526378631592
Time for backpropagation: 1.3162155151367188
One training iteration takes: 11.995035648345947 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.737648010253906 seconds
Streaming imagenet data took 19.022367477416992 seconds
Then, training+dataloading take 19.068984985351562 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.8675663471221924
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.738225936889648
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.8019518852233887
One training iteration takes: 14.820513248443604 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.15953230857849 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.443894147872925 seconds
Then, training+dataloading take 19.490487813949585 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8605465888977051
Time for copying to cuda: 1.0013580322265625e-05
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.362302303314209
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.7903811931610107
One training iteration takes: 14.424682855606079 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 19.01525640487671 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 19.425297021865845 seconds
Then, training+dataloading take 19.47242283821106 seconds

Epoch: 0
Time of next(dataloader) is: 0.8467812538146973
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.155226707458496
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.545067548751831
Memory occpied: (1250.0, 3.0)
The whole process took 333.9802143573761 seconds
