Namespace(all_in_cos=False, batch_size=8000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='resnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet50) till index 21
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Decompress data took 0.10016703605651855 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 2.8384008407592773 seconds
Decompress data took 0.10502028465270996 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 2.8388144969940186 seconds
Decompress data took 0.10186004638671875 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 2.891547918319702 seconds
Decompress data took 0.10170269012451172 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 2.9119040966033936 seconds
Decompress data took 0.1022193431854248 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 2.8743896484375 seconds
Decompress data took 0.10179948806762695 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 2.9206180572509766 seconds
Decompress data took 0.10416603088378906 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 2.897768020629883 seconds
Decompress data took 0.10124015808105469 seconds
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Total decompress data took 2.9710311889648438 seconds
Read 1231.3178148269653 MBs for this batch
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Streaming imagenet data took 37.32579851150513 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Time of next(dataloader) is: 3.1284587383270264
Memory occpied: (5960.0, 3.0)
Time for copying to cuda: 1.3296747207641602
Memory occpied: (5960.0, 2694.0)
Memory occpied: (5960.0, 3108.0)
Memory occpied: (5960.0, 3520.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 283, in forward
    return self._forward_impl(x)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/resnet.py", line 266, in _forward_impl
    x = self.conv1(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 11.96 GiB (GPU 0; 14.76 GiB total capacity; 4.58 GiB already allocated; 8.94 GiB free; 4.60 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

The whole process took 51.51030731201172 seconds
Decompress data took 0.09919095039367676 seconds
Total decompress data took 2.6050994396209717 seconds
Decompress data took 0.10129714012145996 seconds
Total decompress data took 2.5968096256256104 seconds
Decompress data took 0.11135172843933105 seconds
Total decompress data took 2.649552345275879 seconds
Decompress data took 0.10408639907836914 seconds
Total decompress data took 2.6307575702667236 seconds
Decompress data took 0.1031951904296875 seconds
Total decompress data took 2.6280171871185303 seconds
Decompress data took 0.10110664367675781 seconds
Total decompress data took 2.613301992416382 seconds
Decompress data took 0.10205864906311035 seconds
Total decompress data took 2.6273670196533203 seconds
Decompress data took 0.10220050811767578 seconds
Total decompress data took 2.6089816093444824 seconds
Read 1233.9197416305542 MBs for this batch
Streaming imagenet data took 34.41481375694275 seconds
