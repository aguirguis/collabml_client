Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='densenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=False, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (densenet121) till index 20
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Decompress data took 0.08498644828796387 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.7053799629211426 seconds
Decompress data took 0.08463215827941895 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.624068021774292 seconds
Read 252.732816696167 MBs for this batch
Streaming imagenet data took 11.241819143295288 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Decompress data took 0.08299136161804199 seconds
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Total decompress data took 3.7463886737823486 seconds
Decompress data took 0.08410000801086426 seconds
Time of next(dataloader) is: 6.499792814254761
Time for copying to cuda: 0.29258012771606445
Memory occpied: (2444.0, 736.0)
Memory occpied: (2444.0, 1174.0)
Memory occpied: (2444.0, 1630.0)
Total decompress data took 3.6503000259399414 seconds
Read 244.98475742340088 MBs for this batch
Streaming imagenet data took 10.015409231185913 seconds
Memory occpied: (12556.0, 11974.0)
Memory occpied: (12556.0, 11974.0)
Memory occpied: (14472.0, 13890.0)
Memory occpied: (14472.0, 13890.0)
Memory occpied: (7818.0, 7236.0)
Memory occpied: (10216.0, 9784.0)
Memory occpied: (14862.0, 14280.0)
Memory occpied: (6770.0, 6188.0)
Memory occpied: (6770.0, 6188.0)
Memory occpied: (13436.0, 8490.0)
Memory occpied: (12316.0, 12052.0)
Memory occpied: (8102.0, 9742.0)
Time for forward pass: 19.416056871414185
Time for backpropagation: 0.10195255279541016
GPU memory for training: 22.67752742767334                          

One training iteration takes: 26.5572772026062 seconds
Index: 0
Then, training+dataloading take 26.560152292251587 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Decompress data took 0.08850526809692383 seconds
Total decompress data took 3.3809292316436768 seconds
Decompress data took 0.08292293548583984 seconds
Time of next(dataloader) is: 6.868265628814697
Time for copying to cuda: 0.2894139289855957
Time for forward pass: 0.09368562698364258
Time for backpropagation: 0.8515415191650391
GPU memory for training: 20.449398040771484                          

Memory occpied: (8452.0, 5410.0)
One training iteration takes: 8.357467889785767 seconds
Index: 1
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.03629732131958 seconds
Read 248.08854579925537 MBs for this batch
Streaming imagenet data took 10.054754972457886 seconds
Then, training+dataloading take 10.071107864379883 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Decompress data took 0.08844494819641113 seconds
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.064227342605591 seconds
Decompress data took 0.08390665054321289 seconds
Time of next(dataloader) is: 6.807727098464966
Time for copying to cuda: 0.3056807518005371
Time for forward pass: 0.06546306610107422
Memory occpied: (14596.0, 14234.0)
Time for backpropagation: 0.8848357200622559
GPU memory for training: 20.449092864990234                          

One training iteration takes: 8.38737440109253 seconds
Index: 2
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.3575356006622314 seconds
Read 242.9953956604004 MBs for this batch
Streaming imagenet data took 11.081607341766357 seconds
Then, training+dataloading take 11.098440408706665 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Decompress data took 0.08941769599914551 seconds
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.026204586029053 seconds
Decompress data took 0.08563351631164551 seconds
Time of next(dataloader) is: 6.969863653182983
Time for copying to cuda: 0.30417418479919434
Time for forward pass: 0.06464552879333496
Memory occpied: (14596.0, 14234.0)
Time for backpropagation: 0.8870837688446045
GPU memory for training: 20.449092864990234                          

One training iteration takes: 8.526354551315308 seconds
Index: 3
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.74091649055481 seconds
Read 252.47015571594238 MBs for this batch
Streaming imagenet data took 11.62684416770935 seconds
Then, training+dataloading take 11.643821477890015 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Decompress data took 0.10030078887939453 seconds
Total decompress data took 3.7413952350616455 seconds
Decompress data took 0.08583736419677734 seconds
Time of next(dataloader) is: 6.997416019439697
Time for copying to cuda: 0.29992079734802246
Time for forward pass: 0.06501245498657227
Time for backpropagation: 0.8859751224517822
GPU memory for training: 20.449092864990234                          

One training iteration takes: 8.475393056869507 seconds
Index: 4
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.289096117019653 seconds
Read 251.06946277618408 MBs for this batch
Streaming imagenet data took 10.726188659667969 seconds
Then, training+dataloading take 10.743566513061523 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Decompress data took 0.08605051040649414 seconds
Total decompress data took 3.880371332168579 seconds
Decompress data took 0.0882115364074707 seconds
Time of next(dataloader) is: 6.961215972900391
Time for copying to cuda: 0.30463171005249023
Time for forward pass: 0.06528472900390625
Time for backpropagation: 0.8867716789245605
GPU memory for training: 20.449092864990234                          

One training iteration takes: 8.492425918579102 seconds
Index: 5
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.6980390548706055 seconds
Read 260.5531940460205 MBs for this batch
Streaming imagenet data took 11.359481811523438 seconds
Then, training+dataloading take 11.378345251083374 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Decompress data took 0.08980822563171387 seconds
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Time of next(dataloader) is: 7.048936367034912
Time for copying to cuda: 0.3061330318450928
Time for forward pass: 0.0663447380065918
Total decompress data took 5.061091661453247 seconds
Decompress data took 0.08659482002258301 seconds
Time for backpropagation: 0.8874192237854004
GPU memory for training: 20.449092864990234                          

Memory occpied: (14596.0, 14234.0)
One training iteration takes: 8.630011081695557 seconds
Index: 6
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 3.9380016326904297 seconds
Read 260.36000633239746 MBs for this batch
Streaming imagenet data took 12.005169868469238 seconds
Then, training+dataloading take 12.023400783538818 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Decompress data took 0.08149528503417969 seconds
Total decompress data took 3.6013965606689453 seconds
Decompress data took 0.09293723106384277 seconds
Time of next(dataloader) is: 6.972413539886475
Time for copying to cuda: 0.3090400695800781
Time for forward pass: 0.06317329406738281
Time for backpropagation: 0.8779275417327881
GPU memory for training: 20.449092864990234                          

One training iteration takes: 8.498395204544067 seconds
Index: 7
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.878260612487793 seconds
Read 261.12704849243164 MBs for this batch
Streaming imagenet data took 11.287039995193481 seconds
Then, training+dataloading take 11.338040113449097 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Decompress data took 0.09740495681762695 seconds
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Time of next(dataloader) is: 7.11159873008728
Time for copying to cuda: 0.30726146697998047
Total decompress data took 4.528465270996094 seconds
Decompress data took 0.08831381797790527 seconds
Time for forward pass: 0.15641450881958008
Time for backpropagation: 0.7842767238616943
GPU memory for training: 20.449092864990234                          

Memory occpied: (14596.0, 14234.0)
One training iteration takes: 8.679874658584595 seconds
Index: 8
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.638380765914917 seconds
Read 260.28413105010986 MBs for this batch
Streaming imagenet data took 12.112868309020996 seconds
Then, training+dataloading take 12.13180685043335 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Decompress data took 0.0906982421875 seconds
Total decompress data took 3.55607271194458 seconds
Decompress data took 0.08543038368225098 seconds
Time of next(dataloader) is: 7.124181270599365
Time for copying to cuda: 0.313647985458374
Time for forward pass: 0.07677674293518066
Time for backpropagation: 0.8675830364227295
GPU memory for training: 20.449092864990234                          

One training iteration takes: 8.649714946746826 seconds
Index: 9
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.172532796859741 seconds
Read 248.79518508911133 MBs for this batch
Streaming imagenet data took 9.941441535949707 seconds
Then, training+dataloading take 9.958970069885254 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Decompress data took 0.08845996856689453 seconds
Total decompress data took 3.4937238693237305 seconds
Decompress data took 0.08796000480651855 seconds
Time of next(dataloader) is: 6.99753475189209
Time for copying to cuda: 0.3103189468383789
Time for forward pass: 0.06670117378234863
Time for backpropagation: 0.8712713718414307
GPU memory for training: 20.449092864990234                          

Memory occpied: (14596.0, 14234.0)
One training iteration takes: 8.57018256187439 seconds
Index: 10
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.47651743888855 seconds
Read 257.3747863769531 MBs for this batch
Streaming imagenet data took 10.562195777893066 seconds
Then, training+dataloading take 10.581384897232056 seconds
The mode is:  vanilla
Start 24000, end 26000, post_step 1000


Epoch: 0
Decompress data took 0.08498024940490723 seconds
Total decompress data took 3.7140495777130127 seconds
Decompress data took 0.09502339363098145 seconds
Time of next(dataloader) is: 7.057592868804932
Time for copying to cuda: 0.3114023208618164
Time for forward pass: 0.06678152084350586
Time for backpropagation: 0.8768618106842041
GPU memory for training: 20.449092864990234                          

One training iteration takes: 8.556629419326782 seconds
Index: 11
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.450610637664795 seconds
Read 252.83970260620117 MBs for this batch
Streaming imagenet data took 10.839898586273193 seconds
Then, training+dataloading take 10.859301805496216 seconds
The mode is:  vanilla
Start 26000, end 28000, post_step 1000


Epoch: 0
Decompress data took 0.08867478370666504 seconds
Total decompress data took 3.523097276687622 seconds
Decompress data took 0.08521056175231934 seconds
Time of next(dataloader) is: 7.067564964294434
Time for copying to cuda: 0.309462308883667
Time for forward pass: 0.07148194313049316
Time for backpropagation: 0.8715205192565918
GPU memory for training: 20.449092864990234                          

One training iteration takes: 8.583837985992432 seconds
Index: 12
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.451838493347168 seconds
Read 249.70881175994873 MBs for this batch
Streaming imagenet data took 10.642295122146606 seconds
Then, training+dataloading take 10.66118836402893 seconds
The mode is:  vanilla
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Decompress data took 0.0914011001586914 seconds
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Time of next(dataloader) is: 7.1456074714660645
Time for copying to cuda: 0.30936384201049805
Time for forward pass: 0.06850528717041016
Time for backpropagation: 0.8820912837982178
GPU memory for training: 20.449092864990234                          

Memory occpied: (14596.0, 14234.0)
Total decompress data took 5.509063482284546 seconds
Decompress data took 0.09197998046875 seconds
One training iteration takes: 8.827883243560791 seconds
Index: 13
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.316670179367065 seconds
Read 261.96021938323975 MBs for this batch
Streaming imagenet data took 12.932963848114014 seconds
Then, training+dataloading take 12.961735486984253 seconds
The mode is:  vanilla
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Decompress data took 0.08568358421325684 seconds
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Time of next(dataloader) is: 7.224173069000244
Total decompress data took 4.4007110595703125 seconds
Decompress data took 0.08384490013122559 seconds
Time for copying to cuda: 0.30005311965942383
Time for forward pass: 0.06486058235168457
Time for backpropagation: 0.8727829456329346
GPU memory for training: 20.449092864990234                          

Memory occpied: (14596.0, 14234.0)
One training iteration takes: 8.776246547698975 seconds
Index: 14
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Total decompress data took 4.646738290786743 seconds
Read 245.20663356781006 MBs for this batch
Streaming imagenet data took 12.011469602584839 seconds
Then, training+dataloading take 12.029543161392212 seconds

Epoch: 0
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Memory occpied: (14596.0, 14234.0)
Time of next(dataloader) is: 7.152958869934082
Time for copying to cuda: 0.2906057834625244
Time for forward pass: 0.1821439266204834
Memory occpied: (14596.0, 14234.0)
Time for backpropagation: 0.8623867034912109
GPU memory for training: 20.449092864990234                          

The whole process took 209.26906991004944 seconds
