Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 906.9312326324738 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118873290.5236036 118873290.5236036
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.015625
24.5
Total layers size  62.687408447265625
Server, client, server+client, vanilla  1309.583984375 803.7177734375 2113.3017578125 50920.9052734375
Candidate split  23
Server, client, server+client, vanilla  1309.583984375 803.7177734375 2113.3017578125 50920.9052734375
Model size  507.208984375
Fixed, scale_with_bsz  507.208984375 25.07421875
Mem usage  1840.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Memory occpied: (1840.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.705008029937744 seconds
Streaming imagenet data took 5.717759132385254 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34091949462890625
Time for copying to cuda: 0.008924484252929688
Time for forward pass: 2.9722959995269775
Time for backpropagation: 0.04967904090881348
GPU memory for training: 2.0919079780578613                          

One training iteration takes: 3.4610676765441895 seconds
Index: 0
Memory occpied: (1840.0, 1862.0)
Memory occpied: (3058.0, 1862.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.608687400817871 seconds
Streaming imagenet data took 5.6214213371276855 seconds
Then, training+dataloading take 5.622404098510742 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3775606155395508
Time for copying to cuda: 0.008311033248901367
Time for forward pass: 0.06417179107666016
Time for backpropagation: 0.0031070709228515625
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5554752349853516 seconds
Index: 1
Memory occpied: (3058.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.658220529556274 seconds
Streaming imagenet data took 5.671449899673462 seconds
Then, training+dataloading take 5.6724693775177 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3361999988555908
Time for copying to cuda: 0.008278608322143555
Time for forward pass: 0.06418251991271973
Time for backpropagation: 0.003349781036376953
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.4949228763580322 seconds
Index: 2
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.9026198387146 seconds
Streaming imagenet data took 5.915597677230835 seconds
Then, training+dataloading take 5.91648268699646 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33779096603393555
Time for copying to cuda: 0.008400440216064453
Time for forward pass: 0.06428408622741699
Time for backpropagation: 0.003137350082397461
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.4984016418457031 seconds
Index: 3
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.756978273391724 seconds
Streaming imagenet data took 5.765769720077515 seconds
Then, training+dataloading take 5.766933441162109 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3749687671661377
Time for copying to cuda: 0.008334159851074219
Time for forward pass: 0.06419181823730469
Time for backpropagation: 0.0030372142791748047
GPU memory for training: 2.247260570526123                          

Memory occpied: (3460.0, 1870.0)
One training iteration takes: 0.5395324230194092 seconds
Index: 4
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.719934940338135 seconds
Streaming imagenet data took 5.732932806015015 seconds
Then, training+dataloading take 5.733796834945679 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3377823829650879
Time for copying to cuda: 0.008362531661987305
Time for forward pass: 0.06426692008972168
Time for backpropagation: 0.0030219554901123047
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.49500060081481934 seconds
Index: 5
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.768450021743774 seconds
Streaming imagenet data took 5.777034521102905 seconds
Then, training+dataloading take 5.778174877166748 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3530147075653076
Time for copying to cuda: 0.008428573608398438
Time for forward pass: 0.06424999237060547
Time for backpropagation: 0.003110647201538086
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5106263160705566 seconds
Index: 6
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.863269090652466 seconds
Streaming imagenet data took 5.8763508796691895 seconds
Then, training+dataloading take 5.877959489822388 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3511655330657959
Time for copying to cuda: 0.008410215377807617
Time for forward pass: 0.06433749198913574
Time for backpropagation: 0.0031855106353759766
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5108087062835693 seconds
Index: 7
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.713124513626099 seconds
Streaming imagenet data took 5.721471548080444 seconds
Then, training+dataloading take 5.722684621810913 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3769686222076416
Time for copying to cuda: 0.008353471755981445
Time for forward pass: 0.06420302391052246
Time for backpropagation: 0.0030825138092041016
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5646650791168213 seconds
Index: 8
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.736244440078735 seconds
Streaming imagenet data took 5.749451398849487 seconds
Then, training+dataloading take 5.750376224517822 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3517777919769287
Time for copying to cuda: 0.00825047492980957
Time for forward pass: 0.06417512893676758
Time for backpropagation: 0.003061532974243164
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5139691829681396 seconds
Index: 9
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.776991605758667 seconds
Streaming imagenet data took 5.7854437828063965 seconds
Then, training+dataloading take 5.786638975143433 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33956122398376465
Time for copying to cuda: 0.008316516876220703
Time for forward pass: 0.06432056427001953
Time for backpropagation: 0.0032281875610351562
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.4848330020904541 seconds
Index: 10
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.925894498825073 seconds
Streaming imagenet data took 5.938941717147827 seconds
Then, training+dataloading take 5.940585374832153 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34047436714172363
Time for copying to cuda: 0.008420228958129883
Time for forward pass: 0.06443023681640625
Time for backpropagation: 0.003228902816772461
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.4987194538116455 seconds
Index: 11
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.75186824798584 seconds
Streaming imagenet data took 5.764815330505371 seconds
Then, training+dataloading take 5.765731334686279 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3825864791870117
Time for copying to cuda: 0.008334875106811523
Time for forward pass: 0.06424689292907715
Time for backpropagation: 0.003090381622314453
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5713386535644531 seconds
Index: 12
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.721324443817139 seconds
Streaming imagenet data took 5.731346845626831 seconds
Then, training+dataloading take 5.732658624649048 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3390164375305176
Time for copying to cuda: 0.008346796035766602
Time for forward pass: 0.06436872482299805
Time for backpropagation: 0.003077268600463867
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.49848461151123047 seconds
Index: 13
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.851864576339722 seconds
Streaming imagenet data took 5.865180253982544 seconds
Then, training+dataloading take 5.866148948669434 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3406381607055664
Time for copying to cuda: 0.008431434631347656
Time for forward pass: 0.06438946723937988
Time for backpropagation: 0.0031023025512695312
GPU memory for training: 2.247260570526123                          

One training iteration takes: 0.5071780681610107 seconds
Index: 14
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Memory occpied: (3460.0, 1870.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 5.9306652545928955 seconds
Streaming imagenet data took 5.939224004745483 seconds
Then, training+dataloading take 5.941221714019775 seconds

Epoch: 0
Time of next(dataloader) is: 0.34404683113098145
Time for copying to cuda: 0.008221149444580078
Time for forward pass: 0.06418848037719727
Time for backpropagation: 0.00302886962890625
GPU memory for training: 2.247260570526123                          

The whole process took 101.39834213256836 seconds
