Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3085221025224 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119053814.60902181 119053814.60902181
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  167.48046875 30.8837890625 198.3642578125 13413.6962890625
Candidate split  21
Server, client, server+client, vanilla  167.48046875 30.8837890625 198.3642578125 13413.6962890625
Model size  0.0
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  167.48046875 30.8837890625 198.3642578125 13413.6962890625
Fixed, scale_with_bsz  0.0 6.69921875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.018370628356934 seconds
Streaming imagenet data took 4.026255130767822 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28160738945007324
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.011537551879882812
Time for backpropagation: 0.34830427169799805
One training iteration takes: 0.6977317333221436 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8156721591949463 seconds
Streaming imagenet data took 3.822667121887207 seconds
Then, training+dataloading take 3.8234827518463135 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2513728141784668
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.0266265869140625
Time for backpropagation: 0.047608137130737305
One training iteration takes: 0.3885786533355713 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8428735733032227 seconds
Streaming imagenet data took 3.850001335144043 seconds
Then, training+dataloading take 3.8508429527282715 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29572153091430664
Time for copying to cuda: 6.4373016357421875e-06
Time for forward pass: 0.027414560317993164
Time for backpropagation: 0.04282879829406738
One training iteration takes: 0.4574928283691406 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.0141441822052 seconds
Streaming imagenet data took 4.021042823791504 seconds
Then, training+dataloading take 4.021920204162598 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26265716552734375
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.02223801612854004
Time for backpropagation: 0.06750273704528809
One training iteration takes: 0.4174809455871582 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.868216037750244 seconds
Streaming imagenet data took 3.8729703426361084 seconds
Then, training+dataloading take 3.8738009929656982 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26108503341674805
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.025899410247802734
Time for backpropagation: 0.07168912887573242
One training iteration takes: 0.43723464012145996 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8778295516967773 seconds
Streaming imagenet data took 3.882596731185913 seconds
Then, training+dataloading take 3.8834149837493896 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2550923824310303
Time for copying to cuda: 6.198883056640625e-06
Time for forward pass: 0.029811620712280273
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.16767120361328125
One training iteration takes: 0.514758825302124 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.981447219848633 seconds
Streaming imagenet data took 3.986032009124756 seconds
Then, training+dataloading take 3.986851930618286 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.25383901596069336
Time for copying to cuda: 5.9604644775390625e-06
Time for forward pass: 0.02684164047241211
Time for backpropagation: 0.06987571716308594
One training iteration takes: 0.41359853744506836 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8807220458984375 seconds
Streaming imagenet data took 3.8853774070739746 seconds
Then, training+dataloading take 3.886204242706299 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.25934672355651855
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.03522634506225586
Time for backpropagation: 0.0702207088470459
One training iteration takes: 0.43291521072387695 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.9947593212127686 seconds
Streaming imagenet data took 3.9995369911193848 seconds
Then, training+dataloading take 4.00037145614624 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29293131828308105
Time for copying to cuda: 6.198883056640625e-06
Time for forward pass: 0.023177385330200195
Time for backpropagation: 0.06785726547241211
One training iteration takes: 0.4676506519317627 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.8911640644073486 seconds
Streaming imagenet data took 3.897674798965454 seconds
Then, training+dataloading take 3.899244546890259 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2841968536376953
Time for copying to cuda: 6.198883056640625e-06
Time for forward pass: 0.03539013862609863
Time for backpropagation: 0.0773172378540039
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.481870174407959 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.909292221069336 seconds
Streaming imagenet data took 3.9152073860168457 seconds
Then, training+dataloading take 3.9167840480804443 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2648758888244629
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.03272676467895508
Time for backpropagation: 0.0712740421295166
One training iteration takes: 0.44003987312316895 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.9901065826416016 seconds
Streaming imagenet data took 3.9946632385253906 seconds
Then, training+dataloading take 3.995509624481201 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26535964012145996
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.0355832576751709
Time for backpropagation: 0.05130910873413086
One training iteration takes: 0.423861026763916 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Read 2.5120468139648438 MBs for this batch
Executing all posts took 1.302544116973877 seconds
Streaming imagenet data took 1.3039319515228271 seconds
Then, training+dataloading take 1.304368257522583 seconds

Epoch: 0
Time of next(dataloader) is: 0.25366902351379395
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.005094766616821289
Time for backpropagation: 0.04600167274475098
The whole process took 55.314371824264526 seconds
