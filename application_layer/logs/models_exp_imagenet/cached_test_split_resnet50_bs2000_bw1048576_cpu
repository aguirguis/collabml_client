Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5313676839155 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119083023.42506617 119083023.42506617
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  214.375 30.8837890625 245.2587890625 13413.6962890625
Candidate split  21
Server, client, server+client, vanilla  214.375 30.8837890625 245.2587890625 13413.6962890625
Model size  0.0
Intermediate:  0.0078125
6.125
Total layers size  110.74014282226562
Server, client, server+client, vanilla  214.375 30.8837890625 245.2587890625 13413.6962890625
Fixed, scale_with_bsz  0.0 6.69921875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.294297695159912 seconds
Streaming imagenet data took 4.302362442016602 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3643984794616699
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.014940738677978516
Time for backpropagation: 0.16642165184020996
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.6065847873687744 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.206669092178345 seconds
Streaming imagenet data took 4.214357376098633 seconds
Then, training+dataloading take 4.215285301208496 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2900550365447998
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.02685093879699707
Time for backpropagation: 0.04809236526489258
One training iteration takes: 0.444704532623291 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.277957201004028 seconds
Streaming imagenet data took 4.285086393356323 seconds
Then, training+dataloading take 4.285950183868408 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35828518867492676
Time for copying to cuda: 2.0265579223632812e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.030631303787231445
Time for backpropagation: 0.05439615249633789
One training iteration takes: 0.5204153060913086 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.211237192153931 seconds
Streaming imagenet data took 4.216400384902954 seconds
Then, training+dataloading take 4.217278480529785 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2766835689544678
Time for copying to cuda: 8.821487426757812e-06
Time for forward pass: 0.026578903198242188
Time for backpropagation: 0.05263566970825195
One training iteration takes: 0.41721487045288086 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.2522125244140625 seconds
Streaming imagenet data took 4.293898820877075 seconds
Then, training+dataloading take 4.299734592437744 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.29312562942504883
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.033405303955078125
Time for backpropagation: 0.07086372375488281
One training iteration takes: 0.46652936935424805 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.285358667373657 seconds
Streaming imagenet data took 4.290664434432983 seconds
Then, training+dataloading take 4.292320489883423 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2892720699310303
Time for copying to cuda: 8.821487426757812e-06
Time for forward pass: 0.030094146728515625
Time for backpropagation: 0.09370136260986328
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.5133380889892578 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.2816078662872314 seconds
Streaming imagenet data took 4.286571264266968 seconds
Then, training+dataloading take 4.287458419799805 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2936544418334961
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.0302731990814209
Time for backpropagation: 0.06948018074035645
One training iteration takes: 0.455219030380249 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.85788631439209 seconds
Streaming imagenet data took 3.863335132598877 seconds
Then, training+dataloading take 3.8642618656158447 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28360843658447266
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.029547929763793945
Time for backpropagation: 0.10323929786682129
One training iteration takes: 0.4883697032928467 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.306382179260254 seconds
Streaming imagenet data took 4.311340093612671 seconds
Then, training+dataloading take 4.312248468399048 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2831087112426758
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 0.03668212890625
Time for backpropagation: 0.06117105484008789
One training iteration takes: 0.4517817497253418 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.229060411453247 seconds
Streaming imagenet data took 4.234261989593506 seconds
Then, training+dataloading take 4.235132217407227 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.311673641204834
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.026445388793945312
Time for backpropagation: 0.07245373725891113
One training iteration takes: 0.5026590824127197 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.2705793380737305 seconds
Streaming imagenet data took 4.275388240814209 seconds
Then, training+dataloading take 4.276268720626831 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.27844905853271484
Time for copying to cuda: 9.059906005859375e-06
Time for forward pass: 0.02704143524169922
Time for backpropagation: 0.07799243927001953
One training iteration takes: 0.444674015045166 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.251737594604492 seconds
Streaming imagenet data took 4.256869077682495 seconds
Then, training+dataloading take 4.257699966430664 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3179359436035156
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.025966167449951172
Time for backpropagation: 0.07492184638977051
One training iteration takes: 0.5326194763183594 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.25069785118103 seconds
Streaming imagenet data took 4.255747556686401 seconds
Then, training+dataloading take 4.2573182582855225 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2915961742401123
Time for copying to cuda: 9.5367431640625e-06
Time for forward pass: 0.023450136184692383
Time for backpropagation: 0.07615423202514648
One training iteration takes: 0.45778393745422363 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 3.901962995529175 seconds
Streaming imagenet data took 3.907087564468384 seconds
Then, training+dataloading take 3.907996892929077 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2859044075012207
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.026036739349365234
Time for backpropagation: 0.06900191307067871
One training iteration takes: 0.4489901065826416 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.289355039596558 seconds
Streaming imagenet data took 4.294128179550171 seconds
Then, training+dataloading take 4.295015335083008 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2824070453643799
Time for copying to cuda: 9.5367431640625e-06
Time for forward pass: 0.023707866668701172
Time for backpropagation: 0.0570836067199707
One training iteration takes: 0.43799924850463867 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 4.341376543045044 seconds
Streaming imagenet data took 4.346503496170044 seconds
Then, training+dataloading take 4.347369194030762 seconds

Epoch: 0
Time of next(dataloader) is: 0.3148937225341797
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 0.026024818420410156
Time for backpropagation: 0.0717470645904541
Memory occpied: (1250.0, 3.0)
The whole process took 75.34217977523804 seconds
