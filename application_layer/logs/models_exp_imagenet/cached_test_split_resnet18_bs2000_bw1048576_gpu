Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.9331712665252 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119004616.62424599 119004616.62424599
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  212.1708984375 641.98046875 854.1513671875 13849.01171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.901790142059326 seconds
Streaming imagenet data took 3.9735360145568848 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3650529384613037
Time for copying to cuda: 0.04885745048522949
Memory occpied: (1528.0, 282.0)
Memory occpied: (1528.0, 692.0)
Memory occpied: (1528.0, 1114.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.78494930267334 seconds
Streaming imagenet data took 3.8602516651153564 seconds
Memory occpied: (7004.0, 6858.0)
Time for forward pass: 4.261923313140869
Memory occpied: (12312.0, 7436.0)
Time for backpropagation: 1.5237505435943604
GPU memory for training: 11.528353214263916                          

One training iteration takes: 6.274089813232422 seconds
Index: 0
Then, training+dataloading take 6.274686336517334 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (6980.0, 1888.0)
Time of next(dataloader) is: 0.43596506118774414
Time for copying to cuda: 0.049291133880615234
Time for forward pass: 0.05805563926696777
Time for backpropagation: 0.005408525466918945
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.6382489204406738 seconds
Index: 1
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.729992151260376 seconds
Streaming imagenet data took 3.8023107051849365 seconds
Then, training+dataloading take 3.8139166831970215 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44994449615478516
Time for copying to cuda: 0.04878735542297363
Time for forward pass: 0.08609437942504883
Time for backpropagation: 0.0045092105865478516
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.7031750679016113 seconds
Index: 2
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.779811382293701 seconds
Streaming imagenet data took 3.8513588905334473 seconds
Then, training+dataloading take 3.8614399433135986 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45386481285095215
Time for copying to cuda: 0.049196481704711914
Memory occpied: (6996.0, 3112.0)
Time for forward pass: 0.08622145652770996
Time for backpropagation: 0.0043299198150634766
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.6867725849151611 seconds
Index: 3
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7704479694366455 seconds
Streaming imagenet data took 3.841158390045166 seconds
Then, training+dataloading take 3.85127329826355 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45163965225219727
Time for copying to cuda: 0.0484318733215332
Time for forward pass: 0.08609747886657715
Time for backpropagation: 0.004285573959350586
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.690185546875 seconds
Index: 4
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.787691354751587 seconds
Streaming imagenet data took 3.8596057891845703 seconds
Then, training+dataloading take 3.8698325157165527 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4318561553955078
Time for copying to cuda: 0.048829078674316406
Memory occpied: (6996.0, 3112.0)
Time for forward pass: 0.0863797664642334
Time for backpropagation: 0.0043735504150390625
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.6615540981292725 seconds
Index: 5
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.79101824760437 seconds
Streaming imagenet data took 3.8632960319519043 seconds
Then, training+dataloading take 3.8734934329986572 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4572296142578125
Time for copying to cuda: 0.049027442932128906
Time for forward pass: 0.08612680435180664
Time for backpropagation: 0.0042819976806640625
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.7087574005126953 seconds
Index: 6
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.792618989944458 seconds
Streaming imagenet data took 3.864811897277832 seconds
Then, training+dataloading take 3.875016212463379 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4260988235473633
Time for copying to cuda: 0.049213409423828125
Memory occpied: (6996.0, 3112.0)
Time for forward pass: 0.08621048927307129
Time for backpropagation: 0.004300594329833984
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.6556284427642822 seconds
Index: 7
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.742955207824707 seconds
Streaming imagenet data took 3.8154537677764893 seconds
Then, training+dataloading take 3.825767993927002 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4566762447357178
Time for copying to cuda: 0.04898548126220703
Time for forward pass: 0.08624529838562012
Time for backpropagation: 0.00445246696472168
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.6971957683563232 seconds
Index: 8
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8479013442993164 seconds
Streaming imagenet data took 3.9201512336730957 seconds
Then, training+dataloading take 3.930462598800659 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45516037940979004
Time for copying to cuda: 0.04919242858886719
Time for forward pass: 0.08607769012451172
Time for backpropagation: 0.004230976104736328
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.6998913288116455 seconds
Index: 9
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7872812747955322 seconds
Streaming imagenet data took 3.859567642211914 seconds
Then, training+dataloading take 3.869853973388672 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.430009126663208
Time for copying to cuda: 0.04937338829040527
Memory occpied: (6996.0, 3112.0)
Time for forward pass: 0.08619523048400879
Time for backpropagation: 0.004247903823852539
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.6620273590087891 seconds
Index: 10
Memory occpied: (6996.0, 3112.0)
Memory occpied: (6996.0, 3112.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.691908836364746 seconds
Streaming imagenet data took 3.7638978958129883 seconds
Then, training+dataloading take 3.7742090225219727 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44896960258483887
Time for copying to cuda: 0.0482630729675293
Time for forward pass: 0.08614301681518555
Time for backpropagation: 0.004316806793212891
GPU memory for training: 2.3272194862365723                          

One training iteration takes: 0.6996841430664062 seconds
Index: 11
Memory occpied: (6996.0, 3112.0)
Read 30.639458656311035 MBs for this batch
Executing all posts took 0.9977834224700928 seconds
Streaming imagenet data took 1.0109407901763916 seconds
Then, training+dataloading take 1.0133082866668701 seconds

Epoch: 0
Time of next(dataloader) is: 0.3199613094329834
Time for copying to cuda: 0.008135318756103516
Time for forward pass: 0.1967778205871582
Time for backpropagation: 0.27316904067993164
GPU memory for training: 3.7235946655273438                          

Memory occpied: (3426.0, 3672.0)
The whole process took 57.99689960479736 seconds
