Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3157865511826 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119054766.7748366 119054766.7748366
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 10.13245964050293 seconds
Streaming imagenet data took 10.256743669509888 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1336.0, 3.0)
Time of next(dataloader) is: 0.3683745861053467
Time for copying to cuda: 0.04886579513549805
Memory occpied: (1528.0, 460.0)
Memory occpied: (1528.0, 854.0)
Memory occpied: (1528.0, 1314.0)
Time for forward pass: 4.068858861923218
Memory occpied: (12312.0, 12204.0)
Memory occpied: (12312.0, 6834.0)
Time for backpropagation: 1.4705815315246582
GPU memory for training: 11.528353214263916                          

One training iteration takes: 6.0331385135650635 seconds
Index: 0
Memory occpied: (6980.0, 6834.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.148776531219482 seconds
Streaming imagenet data took 7.221364974975586 seconds
Then, training+dataloading take 7.2298102378845215 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.380216121673584
Time for copying to cuda: 0.04850506782531738
Time for forward pass: 0.05634784698486328
Time for backpropagation: 0.004804849624633789
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.577347993850708 seconds
Index: 1
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.280603647232056 seconds
Streaming imagenet data took 7.35204005241394 seconds
Then, training+dataloading take 7.362213373184204 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37562012672424316
Time for copying to cuda: 0.04884076118469238
Time for forward pass: 0.08772778511047363
Time for backpropagation: 0.0051920413970947266
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6144938468933105 seconds
Index: 2
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.2971649169921875 seconds
Streaming imagenet data took 7.369119882583618 seconds
Then, training+dataloading take 7.379501104354858 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40905332565307617
Time for copying to cuda: 0.0486905574798584
Time for forward pass: 0.0863037109375
Time for backpropagation: 0.004515171051025391
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6378450393676758 seconds
Index: 3
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.5769107341766357 seconds
Streaming imagenet data took 3.649332046508789 seconds
Then, training+dataloading take 3.658358573913574 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37859010696411133
Time for copying to cuda: 0.07881426811218262
Time for forward pass: 0.08795285224914551
Time for backpropagation: 0.005166769027709961
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6996.0, 6850.0)
One training iteration takes: 0.6548593044281006 seconds
Index: 4
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.5891711711883545 seconds
Streaming imagenet data took 3.660435199737549 seconds
Then, training+dataloading take 3.670687675476074 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3807792663574219
Time for copying to cuda: 0.048705339431762695
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.08651995658874512
Time for backpropagation: 0.004526376724243164
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6082158088684082 seconds
Index: 5
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.585479736328125 seconds
Streaming imagenet data took 3.6568603515625 seconds
Then, training+dataloading take 3.666992425918579 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40743541717529297
Time for copying to cuda: 0.048432350158691406
Time for forward pass: 0.08632326126098633
Time for backpropagation: 0.00440669059753418
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6363503932952881 seconds
Index: 6
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.611924171447754 seconds
Streaming imagenet data took 3.6838974952697754 seconds
Then, training+dataloading take 3.6941721439361572 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3972442150115967
Time for copying to cuda: 0.04890751838684082
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.1117699146270752
Time for backpropagation: 0.004525899887084961
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6483469009399414 seconds
Index: 7
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.5754830837249756 seconds
Streaming imagenet data took 3.647259473800659 seconds
Then, training+dataloading take 3.658008098602295 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41324687004089355
Memory occpied: (6996.0, 6850.0)
Time for copying to cuda: 0.04879927635192871
Time for forward pass: 0.08644461631774902
Time for backpropagation: 0.0045318603515625
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6506776809692383 seconds
Index: 8
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7094016075134277 seconds
Streaming imagenet data took 3.81618070602417 seconds
Then, training+dataloading take 3.8257646560668945 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (6996.0, 6850.0)
Time of next(dataloader) is: 0.41682863235473633
Time for copying to cuda: 0.04887032508850098
Time for forward pass: 0.08640408515930176
Time for backpropagation: 0.004546642303466797
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6434636116027832 seconds
Index: 9
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.6007466316223145 seconds
Streaming imagenet data took 3.7390265464782715 seconds
Then, training+dataloading take 3.7487473487854004 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (6996.0, 6850.0)
Time of next(dataloader) is: 0.38562512397766113
Time for copying to cuda: 0.049399614334106445
Time for forward pass: 0.08633542060852051
Time for backpropagation: 0.004518747329711914
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6141016483306885 seconds
Index: 10
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.5985889434814453 seconds
Memory occpied: (6996.0, 6850.0)
Streaming imagenet data took 3.705914258956909 seconds
Then, training+dataloading take 3.7177534103393555 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3814737796783447
Time for copying to cuda: 0.0488588809967041
Time for forward pass: 0.08645439147949219
Time for backpropagation: 0.004545688629150391
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6143496036529541 seconds
Index: 11
Read 30.639458656311035 MBs for this batch
Executing all posts took 1.1277573108673096 seconds
Streaming imagenet data took 1.144216775894165 seconds
Then, training+dataloading take 1.1452205181121826 seconds

Epoch: 0
Memory occpied: (6996.0, 6850.0)
Time of next(dataloader) is: 0.28924012184143066
Time for copying to cuda: 0.008174657821655273
Time for forward pass: 0.1876213550567627
Time for backpropagation: 0.24391508102416992
GPU memory for training: 3.7243499755859375                          

The whole process took 70.15172863006592 seconds
