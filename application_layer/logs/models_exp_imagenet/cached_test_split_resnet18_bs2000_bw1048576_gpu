Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.4360930111984 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1795868992034133.2 118939463.5831638 118939463.5831638
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  902.1904296875 641.98046875 1544.1708984375 13849.01171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8146157264709473 seconds
Streaming imagenet data took 3.8869409561157227 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41513943672180176
Time for copying to cuda: 0.04948306083679199
Memory occpied: (1528.0, 310.0)
Memory occpied: (1528.0, 738.0)
Memory occpied: (1528.0, 1150.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8013105392456055 seconds
Streaming imagenet data took 3.8785855770111084 seconds
Memory occpied: (7004.0, 6858.0)
Time for forward pass: 4.195389032363892
Memory occpied: (12312.0, 12170.0)
Time for backpropagation: 1.4412484169006348
GPU memory for training: 11.528353214263916                          

One training iteration takes: 6.184390068054199 seconds
Index: 0
Then, training+dataloading take 6.184908390045166 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42325425148010254
Time for copying to cuda: 0.04922842979431152
Time for forward pass: 0.05620121955871582
Time for backpropagation: 0.00460052490234375
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6149108409881592 seconds
Index: 1
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7504396438598633 seconds
Streaming imagenet data took 3.8237390518188477 seconds
Then, training+dataloading take 3.8325257301330566 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45276379585266113
Time for copying to cuda: 0.08656549453735352
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.08666348457336426
Time for backpropagation: 0.004544973373413086
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7329843044281006 seconds
Index: 2
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.747144937515259 seconds
Streaming imagenet data took 3.8193750381469727 seconds
Then, training+dataloading take 3.8297924995422363 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49326443672180176
Time for copying to cuda: 0.04904747009277344
Time for forward pass: 0.08622956275939941
Time for backpropagation: 0.00452876091003418
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7398338317871094 seconds
Index: 3
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.740283727645874 seconds
Streaming imagenet data took 3.8137474060058594 seconds
Then, training+dataloading take 3.8241279125213623 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45074892044067383
Time for copying to cuda: 0.049218177795410156
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.11974167823791504
Time for backpropagation: 0.00448918342590332
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7287120819091797 seconds
Index: 4
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7040607929229736 seconds
Streaming imagenet data took 3.7762436866760254 seconds
Then, training+dataloading take 3.7867839336395264 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (6996.0, 6850.0)
Time of next(dataloader) is: 0.47813916206359863
Time for copying to cuda: 0.048635005950927734
Time for forward pass: 0.08637332916259766
Time for backpropagation: 0.004483938217163086
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7127776145935059 seconds
Index: 5
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.730755567550659 seconds
Streaming imagenet data took 3.8042244911193848 seconds
Then, training+dataloading take 3.8146259784698486 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.520343542098999
Time for copying to cuda: 0.048737525939941406
Time for forward pass: 0.08627557754516602
Time for backpropagation: 0.00456690788269043
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6996.0, 6850.0)
One training iteration takes: 0.7524940967559814 seconds
Index: 6
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7268943786621094 seconds
Streaming imagenet data took 3.7981765270233154 seconds
Then, training+dataloading take 3.8105783462524414 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47510290145874023
Time for copying to cuda: 0.04940032958984375
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.08651304244995117
Time for backpropagation: 0.004652261734008789
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7065889835357666 seconds
Index: 7
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7787973880767822 seconds
Streaming imagenet data took 3.852436065673828 seconds
Then, training+dataloading take 3.8644206523895264 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (6996.0, 6850.0)
Time of next(dataloader) is: 0.517240047454834
Time for copying to cuda: 0.0489344596862793
Time for forward pass: 0.0863797664642334
Time for backpropagation: 0.004831552505493164
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.750342607498169 seconds
Index: 8
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7175910472869873 seconds
Streaming imagenet data took 3.7887423038482666 seconds
Then, training+dataloading take 3.8005428314208984 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.475679874420166
Time for copying to cuda: 0.04884076118469238
Time for forward pass: 0.08643817901611328
Time for backpropagation: 0.004554033279418945
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.733792781829834 seconds
Index: 9
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7841856479644775 seconds
Streaming imagenet data took 3.8558008670806885 seconds
Then, training+dataloading take 3.8677868843078613 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43798351287841797
Time for copying to cuda: 0.08566427230834961
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.08664655685424805
Time for backpropagation: 0.0048177242279052734
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7277510166168213 seconds
Index: 10
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.6946372985839844 seconds
Streaming imagenet data took 3.765643835067749 seconds
Then, training+dataloading take 3.7775301933288574 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (6996.0, 6850.0)
Time of next(dataloader) is: 0.47806882858276367
Time for copying to cuda: 0.04887223243713379
Time for forward pass: 0.08617472648620605
Time for backpropagation: 0.004456758499145508
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7182888984680176 seconds
Index: 11
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.733765125274658 seconds
Streaming imagenet data took 3.8056094646453857 seconds
Then, training+dataloading take 3.817920446395874 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4726216793060303
Time for copying to cuda: 0.0488431453704834
Time for forward pass: 0.0863037109375
Time for backpropagation: 0.004822731018066406
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7177026271820068 seconds
Index: 12
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7555160522460938 seconds
Streaming imagenet data took 3.826653480529785 seconds
Then, training+dataloading take 3.8390231132507324 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4374427795410156
Time for copying to cuda: 0.08586812019348145
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.08669376373291016
Time for backpropagation: 0.004579305648803711
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.710442066192627 seconds
Index: 13
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7670624256134033 seconds
Streaming imagenet data took 3.838723659515381 seconds
Then, training+dataloading take 3.8506293296813965 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.477374792098999
Time for copying to cuda: 0.04911017417907715
Time for forward pass: 0.08629655838012695
Time for backpropagation: 0.004582405090332031
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7222588062286377 seconds
Index: 14
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.740464687347412 seconds
Streaming imagenet data took 3.8127167224884033 seconds
Then, training+dataloading take 3.825688362121582 seconds

Epoch: 0
Time of next(dataloader) is: 0.45575642585754395
Time for copying to cuda: 0.049607038497924805
Time for forward pass: 0.08792901039123535
Time for backpropagation: 0.0052912235260009766
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6996.0, 6850.0)
The whole process took 71.45712637901306 seconds
