Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.1713950010674 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118904769.0855799 118904769.0855799
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  259.0654296875 641.98046875 901.0458984375 13849.01171875
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.721874237060547 seconds
Memory occpied: (1336.0, 3.0)
Streaming imagenet data took 3.7940616607666016 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39514827728271484
Time for copying to cuda: 0.04937601089477539
Memory occpied: (1528.0, 404.0)
Memory occpied: (1528.0, 866.0)
Memory occpied: (1528.0, 1280.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.679492473602295 seconds
Streaming imagenet data took 3.7589848041534424 seconds
Time for forward pass: 4.169301509857178
Memory occpied: (12312.0, 12204.0)
Memory occpied: (12312.0, 6832.0)
Time for backpropagation: 1.4376344680786133
GPU memory for training: 11.528353214263916                          

One training iteration takes: 6.140501260757446 seconds
Index: 0
Then, training+dataloading take 6.141036510467529 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4385864734649658
Time for copying to cuda: 0.048863887786865234
Time for forward pass: 0.05746769905090332
Time for backpropagation: 0.004587650299072266
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.6407485008239746 seconds
Index: 1
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.680290460586548 seconds
Streaming imagenet data took 3.7517778873443604 seconds
Then, training+dataloading take 3.760308027267456 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45970869064331055
Time for copying to cuda: 0.048691749572753906
Time for forward pass: 0.08638596534729004
Time for backpropagation: 0.004445791244506836
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7193541526794434 seconds
Index: 2
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.71295428276062 seconds
Streaming imagenet data took 3.7853963375091553 seconds
Then, training+dataloading take 3.7966103553771973 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45647740364074707
Time for copying to cuda: 0.049067020416259766
Time for forward pass: 0.1240835189819336
Time for backpropagation: 0.005269527435302734
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7217013835906982 seconds
Index: 3
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.644777297973633 seconds
Streaming imagenet data took 3.7168996334075928 seconds
Then, training+dataloading take 3.7275524139404297 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45417261123657227
Time for copying to cuda: 0.048728227615356445
Time for forward pass: 0.08774590492248535
Time for backpropagation: 0.005433320999145508
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7214477062225342 seconds
Index: 4
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.6692075729370117 seconds
Streaming imagenet data took 3.740345001220703 seconds
Then, training+dataloading take 3.7509820461273193 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45195937156677246
Time for copying to cuda: 0.08885550498962402
Time for forward pass: 0.0963277816772461
Time for backpropagation: 0.006180286407470703
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6996.0, 6850.0)
One training iteration takes: 0.7522788047790527 seconds
Index: 5
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.665128469467163 seconds
Streaming imagenet data took 3.737177610397339 seconds
Then, training+dataloading take 3.7475781440734863 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4555480480194092
Time for copying to cuda: 0.05452561378479004
Time for forward pass: 0.08813619613647461
Time for backpropagation: 0.005261421203613281
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6996.0, 6850.0)
One training iteration takes: 0.7026078701019287 seconds
Index: 6
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.6241002082824707 seconds
Streaming imagenet data took 3.6958305835723877 seconds
Then, training+dataloading take 3.7064738273620605 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45606040954589844
Time for copying to cuda: 0.08791041374206543
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.08679318428039551
Time for backpropagation: 0.004824161529541016
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7268648147583008 seconds
Index: 7
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.6777493953704834 seconds
Streaming imagenet data took 3.750241756439209 seconds
Then, training+dataloading take 3.76080584526062 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4979736804962158
Memory occpied: (6996.0, 6850.0)
Time for copying to cuda: 0.04903221130371094
Time for forward pass: 0.08615541458129883
Time for backpropagation: 0.0043010711669921875
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7285263538360596 seconds
Index: 8
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.644289255142212 seconds
Streaming imagenet data took 3.716454029083252 seconds
Then, training+dataloading take 3.727228879928589 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49632787704467773
Time for copying to cuda: 0.049199581146240234
Time for forward pass: 0.08641839027404785
Time for backpropagation: 0.004467487335205078
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7500119209289551 seconds
Index: 9
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.6970038414001465 seconds
Streaming imagenet data took 3.7681076526641846 seconds
Then, training+dataloading take 3.778916835784912 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46871066093444824
Time for copying to cuda: 0.08926653861999512
Time for forward pass: 0.1004788875579834
Time for backpropagation: 0.005277872085571289
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7535912990570068 seconds
Index: 10
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.697012186050415 seconds
Streaming imagenet data took 3.7708373069763184 seconds
Then, training+dataloading take 3.7819488048553467 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45957040786743164
Time for copying to cuda: 0.04884028434753418
Time for forward pass: 0.08815193176269531
Time for backpropagation: 0.005151510238647461
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6996.0, 6850.0)
One training iteration takes: 0.6983633041381836 seconds
Index: 11
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.631493330001831 seconds
Streaming imagenet data took 3.7030324935913086 seconds
Then, training+dataloading take 3.714177370071411 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4559812545776367
Time for copying to cuda: 0.04926443099975586
Time for forward pass: 0.09272313117980957
Time for backpropagation: 0.005059719085693359
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6996.0, 6850.0)
One training iteration takes: 0.7239933013916016 seconds
Index: 12
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.6249234676361084 seconds
Streaming imagenet data took 3.6964380741119385 seconds
Then, training+dataloading take 3.708014726638794 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4554939270019531
Time for copying to cuda: 0.04918789863586426
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.12183165550231934
Time for backpropagation: 0.0046634674072265625
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7373623847961426 seconds
Index: 13
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.640075922012329 seconds
Streaming imagenet data took 3.711946487426758 seconds
Then, training+dataloading take 3.723374605178833 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4920198917388916
Time for copying to cuda: 0.04941987991333008
Memory occpied: (6996.0, 6850.0)
Time for forward pass: 0.08655428886413574
Time for backpropagation: 0.004606008529663086
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7392866611480713 seconds
Index: 14
Memory occpied: (6996.0, 6850.0)
Memory occpied: (6996.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.653501033782959 seconds
Streaming imagenet data took 3.7269535064697266 seconds
Then, training+dataloading take 3.738278388977051 seconds

Epoch: 0
Time of next(dataloader) is: 0.5075092315673828
Time for copying to cuda: 0.04892253875732422
Time for forward pass: 0.08645915985107422
Time for backpropagation: 0.004621982574462891
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6996.0, 6850.0)
The whole process took 70.42181253433228 seconds
