Namespace(all_in_cos=False, batch_size=8000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='vgg11', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=False)
Nb GPUS  2
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (vgg11) till index 25
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Decompress data took 0.10024762153625488 seconds
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Total decompress data took 2.817608118057251 seconds
Decompress data took 0.10283255577087402 seconds
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Total decompress data took 2.8219728469848633 seconds
Decompress data took 0.1037147045135498 seconds
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Total decompress data took 2.9300482273101807 seconds
Decompress data took 0.10203981399536133 seconds
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Total decompress data took 2.8443210124969482 seconds
Decompress data took 0.10515642166137695 seconds
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Total decompress data took 2.8537893295288086 seconds
Decompress data took 0.10197067260742188 seconds
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Total decompress data took 2.85666561126709 seconds
Decompress data took 0.1045382022857666 seconds
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Total decompress data took 2.910808563232422 seconds
Decompress data took 0.1014089584350586 seconds
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Total decompress data took 2.939122438430786 seconds
Read 1231.3178148269653 MBs for this batch
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Streaming imagenet data took 37.17169547080994 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Time of next(dataloader) is: 3.116321563720703
Memory occpied: (6356.0, 3.0)
Time for copying to cuda: 1.313798427581787
Memory occpied: (6356.0, 2690.0)
Memory occpied: (6356.0, 3080.0)
Memory occpied: (6356.0, 3486.0)
Exception: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torchvision/models/vgg.py", line 66, in forward
    x = self.features(x)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 47.85 GiB (GPU 0; 14.76 GiB total capacity; 4.98 GiB already allocated; 8.55 GiB free; 4.99 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

Memory occpied: (6356.0, 4062.0)
The whole process took 54.1094012260437 seconds
Decompress data took 0.1088254451751709 seconds
Total decompress data took 2.6228487491607666 seconds
Decompress data took 0.10337376594543457 seconds
Total decompress data took 2.6034278869628906 seconds
Decompress data took 0.10259151458740234 seconds
Total decompress data took 2.636138439178467 seconds
Decompress data took 0.10178232192993164 seconds
Total decompress data took 2.6230885982513428 seconds
Decompress data took 0.10235929489135742 seconds
Total decompress data took 2.626042366027832 seconds
Decompress data took 0.10179328918457031 seconds
Total decompress data took 2.6154251098632812 seconds
Decompress data took 0.10233712196350098 seconds
Total decompress data took 2.627826452255249 seconds
Decompress data took 0.10173392295837402 seconds
Total decompress data took 2.610297203063965 seconds
Read 1233.9197416305542 MBs for this batch
Streaming imagenet data took 34.435118198394775 seconds
