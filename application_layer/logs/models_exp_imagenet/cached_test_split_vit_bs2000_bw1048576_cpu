Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2613249090554 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03 3.07200e+03 3.07200e+03
 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119047628.3784797 119047628.3784797
All candidates indexes:  (array([15, 16, 17, 18]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.0029296875
17.314453125
Total layers size  104.47354125976562
Server, client, server+client, vanilla  447.216796875 44.5556640625 491.7724609375 35816.0400390625
Candidate split  16
Server, client, server+client, vanilla  447.216796875 44.5556640625 491.7724609375 35816.0400390625
Model size  0.0
Intermediate:  0.0029296875
17.314453125
Total layers size  104.47354125976562
Server, client, server+client, vanilla  447.216796875 44.5556640625 491.7724609375 35816.0400390625
Fixed, scale_with_bsz  0.0 17.888671875
Mem usage  1250.0 3.0
Using split index: 16
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 24.436087131500244 seconds
Streaming imagenet data took 24.439568519592285 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2792043685913086
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.006162405014038086
Time for backpropagation: 0.015868663787841797
One training iteration takes: 0.34842896461486816 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.803622961044312 seconds
Streaming imagenet data took 12.807499170303345 seconds
Then, training+dataloading take 12.808188438415527 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.24446392059326172
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.01844048500061035
Time for backpropagation: 0.047180891036987305
One training iteration takes: 0.37333130836486816 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 25.598572731018066 seconds
Streaming imagenet data took 25.60196328163147 seconds
Then, training+dataloading take 25.602683067321777 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.24376368522644043
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.018527507781982422
Time for backpropagation: 0.04204607009887695
One training iteration takes: 0.38010406494140625 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.788003921508789 seconds
Streaming imagenet data took 12.791351079940796 seconds
Then, training+dataloading take 12.792047262191772 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26005029678344727
Time for copying to cuda: 1.1682510375976562e-05
Time for forward pass: 0.018445253372192383
Time for backpropagation: 0.0637655258178711
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.40668177604675293 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 24.82110905647278 seconds
Streaming imagenet data took 24.823983430862427 seconds
Then, training+dataloading take 24.825205087661743 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.24006175994873047
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.01885509490966797
Time for backpropagation: 0.047324419021606445
One training iteration takes: 0.36035680770874023 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.149163007736206 seconds
Streaming imagenet data took 13.15145754814148 seconds
Then, training+dataloading take 13.152175903320312 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.24393033981323242
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.018628597259521484
Time for backpropagation: 0.04455065727233887
One training iteration takes: 0.3716442584991455 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 25.827964305877686 seconds
Streaming imagenet data took 25.831011533737183 seconds
Then, training+dataloading take 25.83238458633423 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2717735767364502
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.018503427505493164
Time for backpropagation: 0.039296627044677734
One training iteration takes: 0.3835735321044922 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.439298629760742 seconds
Streaming imagenet data took 13.44160771369934 seconds
Then, training+dataloading take 13.442914009094238 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.24238944053649902
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.018557071685791016
Time for backpropagation: 0.04349112510681152
One training iteration takes: 0.37308597564697266 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 25.220952033996582 seconds
Streaming imagenet data took 25.22345471382141 seconds
Then, training+dataloading take 25.224191904067993 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.24213314056396484
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.018627405166625977
Time for backpropagation: 0.04492950439453125
One training iteration takes: 0.35934925079345703 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.00923204421997 seconds
Streaming imagenet data took 13.012248039245605 seconds
Then, training+dataloading take 13.012958765029907 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.24172234535217285
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.01926875114440918
Time for backpropagation: 0.05442500114440918
One training iteration takes: 0.384077787399292 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 25.937422513961792 seconds
Streaming imagenet data took 25.941036462783813 seconds
Then, training+dataloading take 25.943624019622803 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2457435131072998
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.01912403106689453
Time for backpropagation: 0.0490720272064209
One training iteration takes: 0.3793814182281494 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.506877660751343 seconds
Streaming imagenet data took 13.509846687316895 seconds
Then, training+dataloading take 13.511254072189331 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2452542781829834
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.01871037483215332
Time for backpropagation: 0.03823041915893555
One training iteration takes: 0.36887598037719727 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 0.9481115341186523 MBs for this batch
Executing all posts took 4.112860202789307 seconds
Streaming imagenet data took 4.113478183746338 seconds
Then, training+dataloading take 4.1138834953308105 seconds

Epoch: 0
Time of next(dataloader) is: 0.24205470085144043
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.005418539047241211
Time for backpropagation: 0.03284311294555664
Memory occpied: (1250.0, 3.0)
The whole process took 243.03451657295227 seconds
