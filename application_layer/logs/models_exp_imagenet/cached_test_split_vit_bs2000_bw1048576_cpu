Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 906.7295245486503 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03 3.07200e+03 3.07200e+03
 4.00000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 118846852.24164069 118846852.24164069
All candidates indexes:  (array([15, 16, 17, 18]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.0029296875
17.314453125
Total layers size  104.47354125976562
Server, client, server+client, vanilla  572.4375 44.5556640625 616.9931640625 35816.0400390625
Candidate split  16
Server, client, server+client, vanilla  572.4375 44.5556640625 616.9931640625 35816.0400390625
Model size  0.0
Intermediate:  0.0029296875
17.314453125
Total layers size  104.47354125976562
Server, client, server+client, vanilla  572.4375 44.5556640625 616.9931640625 35816.0400390625
Fixed, scale_with_bsz  0.0 17.888671875
Mem usage  1250.0 3.0
Using split index: 16
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.022540092468262 seconds
Streaming imagenet data took 13.025851726531982 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3461341857910156
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.00651097297668457
Time for backpropagation: 0.016669511795043945
One training iteration takes: 0.4586222171783447 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.936847448348999 seconds
Streaming imagenet data took 12.940507173538208 seconds
Then, training+dataloading take 12.941229820251465 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2820165157318115
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.018871545791625977
Time for backpropagation: 0.06326866149902344
One training iteration takes: 0.4309713840484619 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.00992465019226 seconds
Streaming imagenet data took 13.013763666152954 seconds
Then, training+dataloading take 13.014574527740479 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3113667964935303
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.019343137741088867
Time for backpropagation: 0.06961798667907715
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.47996950149536133 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 13.038129329681396 seconds
Streaming imagenet data took 13.04076099395752 seconds
Then, training+dataloading take 13.041553497314453 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3172330856323242
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.05421781539916992
Time for backpropagation: 0.034790992736816406
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.47601890563964844 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.85244631767273 seconds
Streaming imagenet data took 12.855009078979492 seconds
Then, training+dataloading take 12.855724334716797 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.27815699577331543
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.017693519592285156
Time for backpropagation: 0.08042168617248535
One training iteration takes: 0.47620391845703125 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.83785104751587 seconds
Streaming imagenet data took 12.840550184249878 seconds
Then, training+dataloading take 12.841322183609009 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2768409252166748
Time for copying to cuda: 6.4373016357421875e-06
Time for forward pass: 0.015646696090698242
Time for backpropagation: 0.03760242462158203
One training iteration takes: 0.39643025398254395 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.80466341972351 seconds
Streaming imagenet data took 12.80728006362915 seconds
Then, training+dataloading take 12.808025598526001 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2839527130126953
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.014316797256469727
Time for backpropagation: 0.0490565299987793
One training iteration takes: 0.4164872169494629 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.718036413192749 seconds
Streaming imagenet data took 12.720946311950684 seconds
Then, training+dataloading take 12.722184181213379 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.32656168937683105
Time for copying to cuda: 6.198883056640625e-06
Time for forward pass: 0.01566171646118164
Time for backpropagation: 0.0432431697845459
One training iteration takes: 0.45235395431518555 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.683311223983765 seconds
Streaming imagenet data took 12.686163425445557 seconds
Then, training+dataloading take 12.686964273452759 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3022582530975342
Time for copying to cuda: 1.2636184692382812e-05
Time for forward pass: 0.015870094299316406
Time for backpropagation: 0.045809030532836914
One training iteration takes: 0.4659256935119629 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.633609533309937 seconds
Streaming imagenet data took 12.636179447174072 seconds
Then, training+dataloading take 12.636907815933228 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28491806983947754
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.017508983612060547
Time for backpropagation: 0.045861244201660156
One training iteration takes: 0.4169912338256836 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.572443008422852 seconds
Streaming imagenet data took 12.57520580291748 seconds
Then, training+dataloading take 12.576493740081787 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2793576717376709
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.01796412467956543
Time for backpropagation: 0.0454256534576416
One training iteration takes: 0.42085790634155273 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.611993074417114 seconds
Streaming imagenet data took 12.614587306976318 seconds
Then, training+dataloading take 12.615339040756226 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32546019554138184
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.01907038688659668
Time for backpropagation: 0.04208183288574219
One training iteration takes: 0.4892570972442627 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.588860034942627 seconds
Streaming imagenet data took 12.591615676879883 seconds
Then, training+dataloading take 12.592894792556763 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2909069061279297
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.01762866973876953
Time for backpropagation: 0.05098319053649902
One training iteration takes: 0.4227004051208496 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.693866491317749 seconds
Streaming imagenet data took 12.698188066482544 seconds
Then, training+dataloading take 12.699141263961792 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2883918285369873
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.01888298988342285
Time for backpropagation: 0.049477338790893555
One training iteration takes: 0.42804908752441406 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.571717500686646 seconds
Streaming imagenet data took 12.574617147445679 seconds
Then, training+dataloading take 12.575546264648438 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30263566970825195
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.01778268814086914
Time for backpropagation: 0.0899658203125
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.49547457695007324 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 12.608874559402466 seconds
Streaming imagenet data took 12.61150074005127 seconds
Then, training+dataloading take 12.61226511001587 seconds

Epoch: 0
Time of next(dataloader) is: 0.29673004150390625
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.01850724220275879
Time for backpropagation: 0.04407382011413574
The whole process took 211.90682983398438 seconds
