Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.0396792269873 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119018576.83563969 119018576.83563969
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.767486572265625
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.759220838546753 seconds
Memory occpied: (1318.0, 3.0)
Streaming imagenet data took 5.856715440750122 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34261584281921387
Time for copying to cuda: 0.04910993576049805
Memory occpied: (1510.0, 422.0)
Memory occpied: (1510.0, 888.0)
Memory occpied: (1510.0, 1284.0)
Memory occpied: (6832.0, 6808.0)
Time for forward pass: 4.780884504318237
Time for backpropagation: 0.07798624038696289
GPU memory for training: 6.092698097229004                          

One training iteration takes: 5.324204444885254 seconds
Index: 0
Memory occpied: (5278.0, 5252.0)
Memory occpied: (5278.0, 5252.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.00444221496582 seconds
Memory occpied: (5278.0, 5252.0)
Streaming imagenet data took 8.108587265014648 seconds
Then, training+dataloading take 8.121771335601807 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37177324295043945
Time for copying to cuda: 0.04852795600891113
Time for forward pass: 0.22876405715942383
Time for backpropagation: 0.01097869873046875
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.745896577835083 seconds
Index: 1
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.881414413452148 seconds
Memory occpied: (5294.0, 5268.0)
Streaming imagenet data took 5.952563047409058 seconds
Then, training+dataloading take 5.96103572845459 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3803586959838867
Time for copying to cuda: 0.04874610900878906
Time for forward pass: 0.22678589820861816
Time for backpropagation: 0.010936737060546875
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.7389392852783203 seconds
Index: 2
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.123313188552856 seconds
Memory occpied: (5294.0, 5268.0)
Streaming imagenet data took 8.19505524635315 seconds
Then, training+dataloading take 8.204353332519531 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38130950927734375
Time for copying to cuda: 0.04867100715637207
Time for forward pass: 0.22693681716918945
Time for backpropagation: 0.010783672332763672
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.7532258033752441 seconds
Index: 3
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.887763500213623 seconds
Streaming imagenet data took 5.959420680999756 seconds
Then, training+dataloading take 5.968814849853516 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38065242767333984
Time for copying to cuda: 0.049410343170166016
Time for forward pass: 0.225388765335083
Time for backpropagation: 0.010929584503173828
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.7533526420593262 seconds
Index: 4
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.151670932769775 seconds
Streaming imagenet data took 8.225224494934082 seconds
Then, training+dataloading take 8.236476421356201 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37505269050598145
Time for copying to cuda: 0.04913473129272461
Time for forward pass: 0.22618508338928223
Time for backpropagation: 0.011278867721557617
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.7460918426513672 seconds
Index: 5
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.079658269882202 seconds
Streaming imagenet data took 6.153447151184082 seconds
Then, training+dataloading take 6.162769079208374 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43320512771606445
Time for copying to cuda: 0.07832551002502441
Memory occpied: (5294.0, 5268.0)
Time for forward pass: 0.30661463737487793
Time for backpropagation: 0.010826826095581055
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9253056049346924 seconds
Index: 6
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.218828916549683 seconds
Streaming imagenet data took 8.289929389953613 seconds
Then, training+dataloading take 8.29883599281311 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3788797855377197
Time for copying to cuda: 0.07946491241455078
Memory occpied: (5294.0, 5268.0)
Time for forward pass: 0.25927186012268066
Time for backpropagation: 0.010929346084594727
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8235909938812256 seconds
Index: 7
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.807988882064819 seconds
Streaming imagenet data took 5.881248235702515 seconds
Then, training+dataloading take 5.891886234283447 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39287853240966797
Time for copying to cuda: 0.0493016242980957
Memory occpied: (5294.0, 5268.0)
Time for forward pass: 0.2601456642150879
Time for backpropagation: 0.011277914047241211
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.7987096309661865 seconds
Index: 8
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.26813554763794 seconds
Streaming imagenet data took 8.340208530426025 seconds
Then, training+dataloading take 8.349077463150024 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4154472351074219
Time for copying to cuda: 0.04912590980529785
Time for forward pass: 0.22187113761901855
Time for backpropagation: 0.01109457015991211
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8138618469238281 seconds
Index: 9
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.786022424697876 seconds
Streaming imagenet data took 5.8584065437316895 seconds
Then, training+dataloading take 5.871744871139526 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37322998046875
Time for copying to cuda: 0.04917478561401367
Time for forward pass: 0.22365140914916992
Time for backpropagation: 0.011174917221069336
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.7372705936431885 seconds
Index: 10
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Memory occpied: (5294.0, 5268.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.264199495315552 seconds
Streaming imagenet data took 8.336292505264282 seconds
Then, training+dataloading take 8.345783948898315 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38329339027404785
Time for copying to cuda: 0.048810482025146484
Time for forward pass: 0.22918701171875
Time for backpropagation: 0.01172780990600586
GPU memory for training: 1.753188133239746                          

Memory occpied: (5294.0, 5268.0)
One training iteration takes: 0.7597441673278809 seconds
Index: 11
Memory occpied: (5294.0, 5268.0)
Read 30.639458656311035 MBs for this batch
Executing all posts took 1.928661823272705 seconds
Streaming imagenet data took 1.9419543743133545 seconds
Then, training+dataloading take 1.9428985118865967 seconds

Epoch: 0
Time of next(dataloader) is: 0.2859635353088379
Time for copying to cuda: 0.00816035270690918
Time for forward pass: 0.3695495128631592
Time for backpropagation: 0.01770329475402832
GPU memory for training: 1.4980192184448242                          

The whole process took 94.22509431838989 seconds
