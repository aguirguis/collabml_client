Namespace(all_in_cos=False, batch_size=2000, cached=True, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, transformed=True, use_intermediate=True)
Nb GPUS  2
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5862995851065 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
448967248008533.3 119090223.45921908 119090223.45921908
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  359.59326171875 9521.70361328125 9881.296875 22728.73486328125
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.010862827301025 seconds
Streaming imagenet data took 6.084256172180176 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40434908866882324
Time for copying to cuda: 0.049768924713134766
Memory occpied: (1510.0, 384.0)
Memory occpied: (1510.0, 836.0)
Memory occpied: (1510.0, 1298.0)
Memory occpied: (6832.0, 6966.0)
Time for forward pass: 4.768524885177612
Time for backpropagation: 0.11336040496826172
GPU memory for training: 6.092698097229004                          

One training iteration takes: 5.428679704666138 seconds
Index: 0
Memory occpied: (5278.0, 2792.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.094463109970093 seconds
Streaming imagenet data took 6.166962146759033 seconds
Then, training+dataloading take 6.175814867019653 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44451308250427246
Time for copying to cuda: 0.04886746406555176
Time for forward pass: 0.1896207332611084
Time for backpropagation: 0.011009454727172852
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.7923088073730469 seconds
Index: 1
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.059340238571167 seconds
Streaming imagenet data took 6.130486249923706 seconds
Then, training+dataloading take 6.141291856765747 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4471251964569092
Time for copying to cuda: 0.049405574798583984
Time for forward pass: 0.253873348236084
Time for backpropagation: 0.011941671371459961
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8799431324005127 seconds
Index: 2
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.058300256729126 seconds
Streaming imagenet data took 6.130461692810059 seconds
Then, training+dataloading take 6.141545295715332 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4462120532989502
Time for copying to cuda: 0.0491795539855957
Time for forward pass: 0.22834300994873047
Time for backpropagation: 0.011846303939819336
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.84242844581604 seconds
Index: 3
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.048581838607788 seconds
Streaming imagenet data took 6.119811773300171 seconds
Then, training+dataloading take 6.128475666046143 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44867539405822754
Time for copying to cuda: 0.04905843734741211
Time for forward pass: 0.22839570045471191
Time for backpropagation: 0.05344438552856445
GPU memory for training: 1.753188133239746                          

Memory occpied: (5294.0, 2808.0)
One training iteration takes: 0.8748655319213867 seconds
Index: 4
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.043944358825684 seconds
Streaming imagenet data took 6.116535663604736 seconds
Then, training+dataloading take 6.129368782043457 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4425654411315918
Time for copying to cuda: 0.04928851127624512
Time for forward pass: 0.2319939136505127
Time for backpropagation: 0.01567697525024414
GPU memory for training: 1.753188133239746                          

Memory occpied: (5294.0, 2808.0)
One training iteration takes: 0.8475790023803711 seconds
Index: 5
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.101851940155029 seconds
Streaming imagenet data took 6.174596071243286 seconds
Then, training+dataloading take 6.183452606201172 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5196757316589355
Time for copying to cuda: 0.04924488067626953
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.3270893096923828
Time for backpropagation: 0.011057138442993164
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9955415725708008 seconds
Index: 6
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.98467493057251 seconds
Streaming imagenet data took 6.0568013191223145 seconds
Then, training+dataloading take 6.068538665771484 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4464900493621826
Time for copying to cuda: 0.04927420616149902
Time for forward pass: 0.23042964935302734
Time for backpropagation: 0.01196908950805664
GPU memory for training: 1.753188133239746                          

Memory occpied: (5294.0, 2808.0)
One training iteration takes: 0.8474361896514893 seconds
Index: 7
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.043370246887207 seconds
Streaming imagenet data took 6.116328716278076 seconds
Then, training+dataloading take 6.127985000610352 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46545839309692383
Time for copying to cuda: 0.049004316329956055
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.2253122329711914
Time for backpropagation: 0.011218547821044922
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8980700969696045 seconds
Index: 8
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.0359930992126465 seconds
Streaming imagenet data took 6.107789039611816 seconds
Then, training+dataloading take 6.1196064949035645 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4459571838378906
Time for copying to cuda: 0.08800911903381348
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.23022842407226562
Time for backpropagation: 0.011282920837402344
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8799314498901367 seconds
Index: 9
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.015597820281982 seconds
Streaming imagenet data took 6.08775782585144 seconds
Then, training+dataloading take 6.100961446762085 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4771847724914551
Time for copying to cuda: 0.049437522888183594
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.2622056007385254
Time for backpropagation: 0.011391639709472656
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8955798149108887 seconds
Index: 10
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.023528337478638 seconds
Streaming imagenet data took 6.097441911697388 seconds
Then, training+dataloading take 6.1104230880737305 seconds
The mode is:  split
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4551424980163574
Time for copying to cuda: 0.04987311363220215
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.2686171531677246
Time for backpropagation: 0.011196374893188477
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8724865913391113 seconds
Index: 11
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.028381824493408 seconds
Streaming imagenet data took 6.100785255432129 seconds
Then, training+dataloading take 6.114373207092285 seconds
The mode is:  split
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4438462257385254
Time for copying to cuda: 0.08685827255249023
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.22869229316711426
Time for backpropagation: 0.011289358139038086
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8710060119628906 seconds
Index: 12
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.01548433303833 seconds
Streaming imagenet data took 6.087215423583984 seconds
Then, training+dataloading take 6.09648323059082 seconds
The mode is:  split
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47667479515075684
Time for copying to cuda: 0.049514055252075195
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.22446608543395996
Time for backpropagation: 0.011168718338012695
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8521127700805664 seconds
Index: 13
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.985934495925903 seconds
Streaming imagenet data took 6.058765411376953 seconds
Then, training+dataloading take 6.069995641708374 seconds
The mode is:  split
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4496448040008545
Time for copying to cuda: 0.08703923225402832
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.2289137840270996
Time for backpropagation: 0.011503219604492188
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.869760274887085 seconds
Index: 14
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.0192177295684814 seconds
Streaming imagenet data took 6.09159255027771 seconds
Then, training+dataloading take 6.102789640426636 seconds

Epoch: 0
Time of next(dataloader) is: 0.4762568473815918
Time for copying to cuda: 0.049730539321899414
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.22852301597595215
Time for backpropagation: 0.011544466018676758
GPU memory for training: 1.753188133239746                          

The whole process took 105.62923622131348 seconds
