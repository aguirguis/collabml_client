Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.7876294283495 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 118985540.16443263 118985540.16443263
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.767486572265625
Server, client, server+client, vanilla  287.6826171875 9521.70361328125 9809.38623046875 22728.73486328125
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1318.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Memory occpied: (1318.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.069951057434082 seconds
Streaming imagenet data took 6.143020153045654 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.366347074508667
Time for copying to cuda: 0.04937314987182617
Memory occpied: (1510.0, 330.0)
Memory occpied: (1510.0, 788.0)
Memory occpied: (1510.0, 1178.0)
Memory occpied: (6356.0, 4664.0)
Time for forward pass: 4.91683030128479
Time for backpropagation: 0.08150696754455566
GPU memory for training: 6.092698097229004                          

One training iteration takes: 5.501038074493408 seconds
Index: 0
Memory occpied: (5278.0, 2792.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.002054452896118 seconds
Streaming imagenet data took 6.076039791107178 seconds
Then, training+dataloading take 6.087894916534424 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4031662940979004
Time for copying to cuda: 0.04866671562194824
Time for forward pass: 0.19113492965698242
Time for backpropagation: 0.011441230773925781
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.7350444793701172 seconds
Index: 1
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.067058086395264 seconds
Streaming imagenet data took 6.139237403869629 seconds
Then, training+dataloading take 6.1477673053741455 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4542217254638672
Time for copying to cuda: 0.04902768135070801
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.2646808624267578
Time for backpropagation: 0.01077127456665039
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8734712600708008 seconds
Index: 2
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.9913249015808105 seconds
Streaming imagenet data took 6.064955472946167 seconds
Then, training+dataloading take 6.073883533477783 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4147365093231201
Time for copying to cuda: 0.09317159652709961
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.22858500480651855
Time for backpropagation: 0.010931730270385742
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.838306188583374 seconds
Index: 3
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.039369821548462 seconds
Streaming imagenet data took 6.11318826675415 seconds
Then, training+dataloading take 6.1222100257873535 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4508495330810547
Time for copying to cuda: 0.04867243766784668
Time for forward pass: 0.22751975059509277
Time for backpropagation: 0.010785102844238281
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.839367151260376 seconds
Index: 4
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.001040458679199 seconds
Streaming imagenet data took 6.0718584060668945 seconds
Then, training+dataloading take 6.084486246109009 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4027998447418213
Time for copying to cuda: 0.048775434494018555
Time for forward pass: 0.23022222518920898
Time for backpropagation: 0.011757612228393555
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.773256778717041 seconds
Index: 5
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.074939012527466 seconds
Streaming imagenet data took 6.148932933807373 seconds
Then, training+dataloading take 6.161610841751099 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40155744552612305
Time for copying to cuda: 0.08288002014160156
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.26063013076782227
Time for backpropagation: 0.010961771011352539
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.850553035736084 seconds
Index: 6
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.97611141204834 seconds
Streaming imagenet data took 6.047882795333862 seconds
Then, training+dataloading take 6.060549020767212 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4033341407775879
Time for copying to cuda: 0.08209586143493652
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.22761964797973633
Time for backpropagation: 0.010811328887939453
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8228754997253418 seconds
Index: 7
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.1200666427612305 seconds
Streaming imagenet data took 6.190995454788208 seconds
Then, training+dataloading take 6.203273296356201 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (5294.0, 2808.0)
Time of next(dataloader) is: 0.5244734287261963
Time for copying to cuda: 0.04841446876525879
Time for forward pass: 0.27092766761779785
Time for backpropagation: 0.010828256607055664
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.9467887878417969 seconds
Index: 8
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.949695110321045 seconds
Streaming imagenet data took 6.021965742111206 seconds
Then, training+dataloading take 6.0345683097839355 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44593238830566406
Time for copying to cuda: 0.04901862144470215
Time for forward pass: 0.2269906997680664
Time for backpropagation: 0.01080632209777832
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8350362777709961 seconds
Index: 9
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 6.145748138427734 seconds
Streaming imagenet data took 6.217520236968994 seconds
Then, training+dataloading take 6.23058557510376 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4099998474121094
Time for copying to cuda: 0.08353376388549805
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.22967863082885742
Time for backpropagation: 0.01101827621459961
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8373405933380127 seconds
Index: 10
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Memory occpied: (5294.0, 2808.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 5.95622706413269 seconds
Streaming imagenet data took 6.026985168457031 seconds
Then, training+dataloading take 6.039863586425781 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4048275947570801
Time for copying to cuda: 0.04883146286010742
Memory occpied: (5294.0, 2808.0)
Time for forward pass: 0.26384401321411133
Time for backpropagation: 0.01085662841796875
GPU memory for training: 1.753188133239746                          

One training iteration takes: 0.8152790069580078 seconds
Index: 11
Memory occpied: (5294.0, 2808.0)
Read 30.639458656311035 MBs for this batch
Executing all posts took 1.9142849445343018 seconds
Streaming imagenet data took 1.92759108543396 seconds
Then, training+dataloading take 1.930145263671875 seconds

Epoch: 0
Time of next(dataloader) is: 0.30628132820129395
Time for copying to cuda: 0.008107662200927734
Time for forward pass: 0.3495614528656006
Time for backpropagation: 0.02268075942993164
GPU memory for training: 1.4980192184448242                          

The whole process took 82.4105851650238 seconds
