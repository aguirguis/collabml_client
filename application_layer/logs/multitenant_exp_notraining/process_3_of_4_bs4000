Namespace(batch_size=4000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, manual_split=False, model='myresnet50', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.2855256674147 Mbps
[3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
133802.66666666666
97.49234008789062 110.86393229166667
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
Start 0, end 4000, post_step 1000

Memory occpied: (3569.0, 3.0)
Memory occpied: (4463.0, 3.0)
Memory occpied: (5269.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 30.63686490058899 seconds
Streaming imagenet data took 30.651360988616943 seconds
Start 4000, end 8000, post_step 1000

One training iteration takes: 0.00047898292541503906 seconds
Index: 0
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 52.339792013168335 seconds
Streaming imagenet data took 52.354897022247314 seconds
Then, training+dataloading take 52.35772633552551 seconds
Start 8000, end 12000, post_step 1000

One training iteration takes: 0.0004978179931640625 seconds
Index: 1
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 37.84263777732849 seconds
Streaming imagenet data took 37.8567054271698 seconds
Then, training+dataloading take 37.858317613601685 seconds
Start 12000, end 16000, post_step 1000

One training iteration takes: 0.00041484832763671875 seconds
Index: 2
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 43.68791842460632 seconds
Streaming imagenet data took 43.70168900489807 seconds
Then, training+dataloading take 43.70310950279236 seconds
Start 16000, end 20000, post_step 1000

One training iteration takes: 0.0004048347473144531 seconds
Index: 3
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 47.29256081581116 seconds
Streaming imagenet data took 47.31090235710144 seconds
Then, training+dataloading take 47.312854290008545 seconds
Start 20000, end 24000, post_step 1000

One training iteration takes: 0.0007462501525878906 seconds
Index: 4
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 23.478135585784912 seconds
Streaming imagenet data took 23.486929416656494 seconds
Then, training+dataloading take 23.488532304763794 seconds
Start 24000, end 28000, post_step 1000

One training iteration takes: 0.00044465065002441406 seconds
Index: 5
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 30.800293445587158 seconds
Streaming imagenet data took 30.81477999687195 seconds
Then, training+dataloading take 30.816123485565186 seconds
Start 28000, end 32000, post_step 1000

One training iteration takes: 0.0003972053527832031 seconds
Index: 6
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 38.355743646621704 seconds
Streaming imagenet data took 38.36550426483154 seconds
Then, training+dataloading take 38.367135763168335 seconds
Start 32000, end 36000, post_step 1000

One training iteration takes: 0.00046706199645996094 seconds
Index: 7
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5541.0, 18.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 37.90352916717529 seconds
Streaming imagenet data took 37.912898778915405 seconds
Then, training+dataloading take 37.915024280548096 seconds
Start 36000, end 40000, post_step 1000

One training iteration takes: 0.0003986358642578125 seconds
Index: 8
Memory occpied: (5541.0, 514.0)
Memory occpied: (5541.0, 908.0)
Memory occpied: (11029.0, 6722.0)
Memory occpied: (11003.0, 12070.0)
Memory occpied: (11003.0, 6696.0)
Memory occpied: (11007.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 30.26029348373413 seconds
Memory occpied: (4184.0, 3.0)
Streaming imagenet data took 30.2761070728302 seconds
Then, training+dataloading take 30.27802276611328 seconds
Start 40000, end 44000, post_step 1000

One training iteration takes: 0.00037169456481933594 seconds
Index: 9
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 37.595486640930176 seconds
Streaming imagenet data took 37.61124849319458 seconds
Then, training+dataloading take 37.613247871398926 seconds
Start 44000, end 48000, post_step 1000

One training iteration takes: 0.00046253204345703125 seconds
Index: 10
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Read 31.399677276611328 MBs for this batch
Executing all posts took 26.95611882209778 seconds
Streaming imagenet data took 27.01626682281494 seconds
Then, training+dataloading take 27.02857780456543 seconds
Start 48000, end 50000, post_step 1000

One training iteration takes: 0.0007195472717285156 seconds
Index: 11
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 20.664511680603027 seconds
Streaming imagenet data took 20.66931986808777 seconds
Then, training+dataloading take 20.67020058631897 seconds

Epoch: 0
Control connection MSS 1448
Time of next(dataloader) is: 0.37335968017578125
Time for copying to cuda: 0.009346723556518555
Memory occpied: (4200.0, 216.0)
Memory occpied: (4200.0, 592.0)
Memory occpied: (4200.0, 1016.0)
Time for forward pass: 3.4198122024536133
Time for backpropagation: 0.019603252410888672
GPU memory for training: 0.4394540786743164                          

The whole process took 467.57175612449646 seconds
