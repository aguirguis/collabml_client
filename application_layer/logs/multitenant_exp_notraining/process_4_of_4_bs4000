Namespace(batch_size=4000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, manual_split=False, model='myvgg11', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 4455.325686349368 Mbps
[1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
133802.66666666666
506.8334045410156 62.621744791666664
Using split index: 21
Freezing the lower layers of the model (myvgg11) till index 25
Start 0, end 4000, post_step 1000

Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 60.63786458969116 seconds
Streaming imagenet data took 60.784815073013306 seconds
Start 4000, end 8000, post_step 1000

One training iteration takes: 0.0004165172576904297 seconds
Index: 0
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 36.0915846824646 seconds
Streaming imagenet data took 36.241307735443115 seconds
Then, training+dataloading take 36.265663862228394 seconds
Start 8000, end 12000, post_step 1000

One training iteration takes: 0.0004761219024658203 seconds
Index: 1
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 43.03085494041443 seconds
Streaming imagenet data took 43.21860456466675 seconds
Then, training+dataloading take 43.24904727935791 seconds
Start 12000, end 16000, post_step 1000

One training iteration takes: 0.0005283355712890625 seconds
Index: 2
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 44.13200306892395 seconds
Streaming imagenet data took 44.317503929138184 seconds
Then, training+dataloading take 44.339446783065796 seconds
Memory occpied: (5349.0, 3.0)
Start 16000, end 20000, post_step 1000

One training iteration takes: 0.0005269050598144531 seconds
Index: 3
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 28.584707260131836 seconds
Streaming imagenet data took 28.769487380981445 seconds
Then, training+dataloading take 28.796594858169556 seconds
Start 20000, end 24000, post_step 1000

One training iteration takes: 0.0005481243133544922 seconds
Index: 4
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 48.5465726852417 seconds
Streaming imagenet data took 48.69058012962341 seconds
Then, training+dataloading take 48.71095848083496 seconds
Start 24000, end 28000, post_step 1000

One training iteration takes: 0.0005490779876708984 seconds
Index: 5
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 24.61956238746643 seconds
Memory occpied: (5349.0, 3.0)
Streaming imagenet data took 24.80684757232666 seconds
Then, training+dataloading take 24.834171056747437 seconds
Start 28000, end 32000, post_step 1000

One training iteration takes: 0.0005366802215576172 seconds
Index: 6
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 34.55053424835205 seconds
Streaming imagenet data took 34.794543743133545 seconds
Then, training+dataloading take 34.8246431350708 seconds
Memory occpied: (5349.0, 3.0)
Start 32000, end 36000, post_step 1000

One training iteration takes: 0.0005612373352050781 seconds
Index: 7
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5349.0, 3.0)
Memory occpied: (5541.0, 334.0)
Memory occpied: (5541.0, 742.0)
Memory occpied: (5541.0, 1214.0)
Memory occpied: (10995.0, 12070.0)
Memory occpied: (11003.0, 6696.0)
Memory occpied: (11007.0, 6582.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 33.19268846511841 seconds
Streaming imagenet data took 33.38087463378906 seconds
Then, training+dataloading take 33.40448236465454 seconds
Start 36000, end 40000, post_step 1000

One training iteration takes: 0.0007326602935791016 seconds
Index: 8
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 53.54722285270691 seconds
Streaming imagenet data took 53.69235134124756 seconds
Then, training+dataloading take 53.72318768501282 seconds
Start 40000, end 44000, post_step 1000

One training iteration takes: 0.00043511390686035156 seconds
Index: 9
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 26.407711029052734 seconds
Streaming imagenet data took 26.554054260253906 seconds
Then, training+dataloading take 26.58306884765625 seconds
Start 44000, end 48000, post_step 1000

One training iteration takes: 0.00039267539978027344 seconds
Index: 10
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4184.0, 3.0)
Memory occpied: (4200.0, 332.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 21.571280479431152 seconds
Streaming imagenet data took 21.71887516975403 seconds
Then, training+dataloading take 21.74302053451538 seconds
Start 48000, end 50000, post_step 1000

One training iteration takes: 0.0004730224609375 seconds
Index: 11
Memory occpied: (4200.0, 708.0)
Memory occpied: (4200.0, 1124.0)
Memory occpied: (4440.0, 1270.0)
Memory occpied: (2965.0, 3.0)
Memory occpied: (2965.0, 3.0)
Memory occpied: (2965.0, 3.0)
Memory occpied: (2965.0, 3.0)
Memory occpied: (2965.0, 3.0)
Memory occpied: (2965.0, 3.0)
Memory occpied: (2965.0, 3.0)
Memory occpied: (2965.0, 3.0)
Memory occpied: (2965.0, 3.0)
Memory occpied: (2965.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.49507737159729 seconds
Streaming imagenet data took 15.566297054290771 seconds
Then, training+dataloading take 15.581287384033203 seconds

Epoch: 0
Time of next(dataloader) is: 0.4535696506500244
Time for copying to cuda: 0.05585289001464844
Memory occpied: (3157.0, 120.0)
Memory occpied: (3157.0, 568.0)
Memory occpied: (3157.0, 946.0)
Time for forward pass: 3.466315269470215
Time for backpropagation: 0.005295276641845703
GPU memory for training: 2.381150722503662                          

The whole process took 484.79154443740845 seconds
