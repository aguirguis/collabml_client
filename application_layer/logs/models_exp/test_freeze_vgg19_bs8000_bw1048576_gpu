Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 907.5968440059316 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 36
Intermediate:  3062.5
119.0546875
Total layers size  119.34365844726562
Fixed, scale_with_bsz  548.0470275878906 119.62890625
Mem usage  1250.0 3.0
Using split index: 36
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 60.26777386665344 seconds
Memory occpied: (1822.0, 3.0)
Streaming imagenet data took 61.48715329170227 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.219923257827759
Time for copying to cuda: 0.7855081558227539
Time for forward pass: 3.599532127380371
Time for backpropagation: 0.21848011016845703
GPU memory for training: 7.937506198883057                          

One training iteration takes: 7.2893385887146 seconds
Index: 0
Memory occpied: (1822.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 59.71470260620117 seconds
Memory occpied: (6492.0, 4500.0)
Streaming imagenet data took 61.043726205825806 seconds
Then, training+dataloading take 61.18005418777466 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Time of next(dataloader) is: 2.361180067062378
Time for copying to cuda: 0.7857358455657959
Memory occpied: (7668.0, 4508.0)
Time for forward pass: 0.6673016548156738
Time for backpropagation: 0.0045719146728515625
GPU memory for training: 8.724570751190186                          

Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
One training iteration takes: 9.174182415008545 seconds
Index: 1
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 57.383195877075195 seconds
Memory occpied: (7668.0, 4508.0)
Streaming imagenet data took 58.52863001823425 seconds
Then, training+dataloading take 58.67844557762146 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.4842333793640137
Time for copying to cuda: 0.7841174602508545
Time for forward pass: 0.6728529930114746
Time for backpropagation: 0.004543781280517578
GPU memory for training: 8.724570751190186                          

Memory occpied: (7668.0, 4508.0)
One training iteration takes: 4.388492107391357 seconds
Index: 2
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 61.70625281333923 seconds
Memory occpied: (7668.0, 4508.0)
Streaming imagenet data took 62.96267366409302 seconds
Then, training+dataloading take 63.105974435806274 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3543481826782227
Time for copying to cuda: 0.7815539836883545
Time for forward pass: 0.6480507850646973
Time for backpropagation: 0.004407644271850586
GPU memory for training: 8.724570751190186                          

Memory occpied: (7668.0, 4508.0)
One training iteration takes: 4.24984073638916 seconds
Index: 3
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 57.778425216674805 seconds
Memory occpied: (7668.0, 4508.0)
Streaming imagenet data took 59.12403416633606 seconds
Then, training+dataloading take 59.260130643844604 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.4248783588409424
Time for copying to cuda: 0.7857675552368164
Time for forward pass: 0.6513793468475342
Time for backpropagation: 0.004354238510131836
GPU memory for training: 8.724570751190186                          

One training iteration takes: 4.424756050109863 seconds
Index: 4
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 61.09258818626404 seconds
Memory occpied: (7668.0, 4508.0)
Streaming imagenet data took 62.342512130737305 seconds
Then, training+dataloading take 62.53025007247925 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.401729106903076
Time for copying to cuda: 0.7823338508605957
Time for forward pass: 0.6240279674530029
Time for backpropagation: 0.004409313201904297
GPU memory for training: 8.724570751190186                          

Memory occpied: (7668.0, 4508.0)
One training iteration takes: 4.268833637237549 seconds
Index: 5
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 27.43808078765869 seconds
Memory occpied: (7668.0, 4508.0)
Streaming imagenet data took 27.72433090209961 seconds
Then, training+dataloading take 27.76602053642273 seconds

Epoch: 0
Time of next(dataloader) is: 0.9278101921081543
Memory occpied: (7668.0, 4508.0)
Time for copying to cuda: 0.20772838592529297
Time for forward pass: 0.2504866123199463
Time for backpropagation: 0.004110097885131836
GPU memory for training: 4.476007461547852                          

The whole process took 404.18733072280884 seconds
