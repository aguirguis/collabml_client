Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='myalexnet', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=True, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.5412138540867 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
Intermediate:  125.0
4.138671875
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.712890625
Mem usage  1250.0 3.0
Using split index: 17
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 13.209665536880493 seconds
Streaming imagenet data took 13.260331630706787 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1494.0, 3.0)
Time of next(dataloader) is: 0.44518113136291504
Time for copying to cuda: 0.03305506706237793
Memory occpied: (1620.0, 412.0)
Memory occpied: (1620.0, 842.0)
Memory occpied: (1620.0, 1298.0)
Time for forward pass: 3.473649740219116
Time for backpropagation: 0.07869076728820801
GPU memory for training: 1.263702392578125                          

One training iteration takes: 4.111191272735596 seconds
Index: 0
Memory occpied: (2328.0, 1704.0)
Memory occpied: (2328.0, 1704.0)
Memory occpied: (2328.0, 1704.0)
Memory occpied: (2328.0, 1704.0)
Memory occpied: (2328.0, 1704.0)
Memory occpied: (2328.0, 1704.0)
Memory occpied: (2328.0, 1704.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 13.285463809967041 seconds
Streaming imagenet data took 13.335404872894287 seconds
Then, training+dataloading take 13.340891361236572 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5843336582183838
Time for copying to cuda: 0.03272247314453125
Time for forward pass: 0.1102912425994873
Time for backpropagation: 0.002999544143676758
GPU memory for training: 1.4203567504882812                          

One training iteration takes: 0.863776445388794 seconds
Index: 1
Memory occpied: (2328.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 13.462707042694092 seconds
Streaming imagenet data took 13.514756202697754 seconds
Then, training+dataloading take 13.52996015548706 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (2336.0, 1712.0)
Time of next(dataloader) is: 0.5046939849853516
Time for copying to cuda: 0.0323796272277832
Time for forward pass: 0.10941410064697266
Time for backpropagation: 0.0028569698333740234
GPU memory for training: 1.4203567504882812                          

One training iteration takes: 0.7446355819702148 seconds
Index: 2
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 13.640427589416504 seconds
Streaming imagenet data took 13.741234540939331 seconds
Then, training+dataloading take 13.763826608657837 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5903415679931641
Time for copying to cuda: 0.032540321350097656
Time for forward pass: 0.10938477516174316
Time for backpropagation: 0.0029010772705078125
GPU memory for training: 1.4203567504882812                          

Memory occpied: (2336.0, 1712.0)
One training iteration takes: 0.8460474014282227 seconds
Index: 3
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 13.973692655563354 seconds
Streaming imagenet data took 14.024667024612427 seconds
Then, training+dataloading take 14.029270887374878 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5172955989837646
Time for copying to cuda: 0.08076906204223633
Memory occpied: (2336.0, 1712.0)
Time for forward pass: 0.11417245864868164
Time for backpropagation: 0.003122568130493164
GPU memory for training: 1.4203567504882812                          

One training iteration takes: 0.8126873970031738 seconds
Index: 4
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 13.347399473190308 seconds
Streaming imagenet data took 13.398073196411133 seconds
Then, training+dataloading take 13.403916358947754 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.503126859664917
Time for copying to cuda: 0.032434701919555664
Time for forward pass: 0.10883474349975586
Time for backpropagation: 0.0030088424682617188
GPU memory for training: 1.4203567504882812                          

One training iteration takes: 0.7402119636535645 seconds
Index: 5
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Memory occpied: (2336.0, 1712.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.203404188156128 seconds
Streaming imagenet data took 9.218505144119263 seconds
Then, training+dataloading take 9.220711946487427 seconds

Epoch: 0
Time of next(dataloader) is: 0.4870927333831787
Time for copying to cuda: 0.008394718170166016
Time for forward pass: 0.054819583892822266
Time for backpropagation: 0.0032372474670410156
GPU memory for training: 1.1559886932373047                          

Memory occpied: (2336.0, 1712.0)
The whole process took 98.72572684288025 seconds
