Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, manual_split=False, model='mydensenet121', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Error of iperf: unable to connect to server: 
Recorded bandwidth: 908.2855256674147 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([21]),)
Intermediate:  1531.25
29.572265625
Total layers size  29.767486572265625
Fixed, scale_with_bsz  30.436920166015625 30.146484375
Mem usage  1250.0 3.0
Using split index: 20
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 36.252605676651 seconds
Memory occpied: (1294.0, 3.0)
Streaming imagenet data took 36.88477301597595 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1294.0, 3.0)
Time of next(dataloader) is: 1.2316703796386719
Time for copying to cuda: 0.3889293670654297
Memory occpied: (2826.0, 896.0)
Memory occpied: (2826.0, 1346.0)
Memory occpied: (2826.0, 1774.0)
Time for forward pass: 3.42909836769104
Time for backpropagation: 0.07446956634521484
GPU memory for training: 6.810298919677734                          

One training iteration takes: 5.353911399841309 seconds
Index: 0
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 31.45228409767151 seconds
Memory occpied: (5328.0, 4462.0)
Streaming imagenet data took 32.15296959877014 seconds
Then, training+dataloading take 32.222254276275635 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (5328.0, 4462.0)
Time of next(dataloader) is: 1.323657512664795
Time for copying to cuda: 0.3878204822540283
Time for forward pass: 0.16094541549682617
Time for backpropagation: 0.01161646842956543
GPU memory for training: 6.8247809410095215                          

Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
One training iteration takes: 7.0653417110443115 seconds
Index: 1
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 31.072211742401123 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 31.78112030029297 seconds
Then, training+dataloading take 31.850229263305664 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.3352012634277344
Time for copying to cuda: 0.3862740993499756
Time for forward pass: 0.16074061393737793
Time for backpropagation: 0.011784553527832031
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.1466403007507324 seconds
Index: 2
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 31.355161428451538 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 32.06820487976074 seconds
Then, training+dataloading take 32.13833212852478 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.3330814838409424
Time for copying to cuda: 0.3880753517150879
Time for forward pass: 0.17238593101501465
Time for backpropagation: 0.01165914535522461
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.153548240661621 seconds
Index: 3
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 31.86016273498535 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 32.43594002723694 seconds
Then, training+dataloading take 32.50757074356079 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.3315651416778564
Time for copying to cuda: 0.4530923366546631
Time for forward pass: 0.16389179229736328
Time for backpropagation: 0.012495756149291992
GPU memory for training: 6.8247809410095215                          

Memory occpied: (5344.0, 4478.0)
One training iteration takes: 2.219900369644165 seconds
Index: 4
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 29.71211338043213 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 30.415579080581665 seconds
Then, training+dataloading take 30.500410318374634 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.3020904064178467
Time for copying to cuda: 0.38979506492614746
Time for forward pass: 0.16103744506835938
Time for backpropagation: 0.012073755264282227
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.136387825012207 seconds
Index: 5
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 13.050965547561646 seconds
Streaming imagenet data took 13.193359851837158 seconds
Then, training+dataloading take 13.21412444114685 seconds

Epoch: 0
Time of next(dataloader) is: 0.6693027019500732
Time for copying to cuda: 0.0996389389038086
Time for forward pass: 0.04692983627319336
Time for backpropagation: 0.01098012924194336
GPU memory for training: 1.753340721130371                          

Memory occpied: (5344.0, 4478.0)
The whole process took 217.52037453651428 seconds
