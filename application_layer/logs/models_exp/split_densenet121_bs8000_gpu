Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, manual_split=False, model='mydensenet121', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.4826502379033 Mbps
[3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
133802.66666666666
30.436920166015625 29.699869791666668
Using split index: 20
Freezing the lower layers of the model (mydensenet121) till index 20
Start 0, end 8000, post_step 1000

Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 38.88836646080017 seconds
Memory occpied: (1150.0, 3.0)
Streaming imagenet data took 39.62960648536682 seconds
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1150.0, 3.0)
Time of next(dataloader) is: 1.3713152408599854
Time for copying to cuda: 0.3980867862701416
Memory occpied: (2682.0, 116.0)
Memory occpied: (2682.0, 544.0)
Memory occpied: (2682.0, 964.0)
Time for forward pass: 3.351163387298584
Time for backpropagation: 0.029900789260864258
GPU memory for training: 6.810298919677734                          

One training iteration takes: 5.459296226501465 seconds
Index: 0
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Memory occpied: (5190.0, 4324.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 41.891582012176514 seconds
Memory occpied: (5190.0, 4324.0)
Streaming imagenet data took 42.456400632858276 seconds
Then, training+dataloading take 42.5483078956604 seconds
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (5190.0, 4324.0)
Time of next(dataloader) is: 1.683368444442749
Time for copying to cuda: 0.5302131175994873
Memory occpied: (5190.0, 4324.0)
Time for forward pass: 0.17695188522338867
Time for backpropagation: 0.01090693473815918
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.7084662914276123 seconds
Index: 1
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 42.86142444610596 seconds
Streaming imagenet data took 43.527098655700684 seconds
Then, training+dataloading take 43.59441804885864 seconds
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (5206.0, 4340.0)
Time of next(dataloader) is: 1.5918300151824951
Memory occpied: (5206.0, 4340.0)
Time for copying to cuda: 0.4694399833679199
Time for forward pass: 0.1339113712310791
Time for backpropagation: 0.01130366325378418
GPU memory for training: 6.8247809410095215                          

Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
One training iteration takes: 7.421638488769531 seconds
Index: 2
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 43.2630090713501 seconds
Memory occpied: (5206.0, 4340.0)
Streaming imagenet data took 43.917248487472534 seconds
Then, training+dataloading take 44.00943183898926 seconds
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (5206.0, 4340.0)
Time of next(dataloader) is: 1.5402402877807617
Time for copying to cuda: 0.4065835475921631
Time for forward pass: 0.13570356369018555
Time for backpropagation: 0.011775970458984375
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.3222131729125977 seconds
Index: 3
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 43.98343372344971 seconds
Memory occpied: (5206.0, 4340.0)
Streaming imagenet data took 44.65936040878296 seconds
Then, training+dataloading take 44.75123476982117 seconds
Start 40000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (5206.0, 4340.0)
Time of next(dataloader) is: 1.5218586921691895
Time for copying to cuda: 0.40636301040649414
Time for forward pass: 0.13701581954956055
Time for backpropagation: 0.011593103408813477
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.420213222503662 seconds
Index: 4
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 43.65101146697998 seconds
Streaming imagenet data took 44.222976207733154 seconds
Then, training+dataloading take 44.31355142593384 seconds
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (5206.0, 4340.0)
Time of next(dataloader) is: 1.6162116527557373
Memory occpied: (5206.0, 4340.0)
Time for copying to cuda: 0.5325982570648193
Time for forward pass: 0.13358855247497559
Time for backpropagation: 0.011639118194580078
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.606318473815918 seconds
Index: 5
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Memory occpied: (5206.0, 4340.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 17.4976487159729 seconds
Streaming imagenet data took 17.642271280288696 seconds
Then, training+dataloading take 17.666025400161743 seconds

Epoch: 0
Memory occpied: (5206.0, 4340.0)
Time of next(dataloader) is: 0.8624815940856934
Time for copying to cuda: 0.10238337516784668
Time for forward pass: 0.038786888122558594
Time for backpropagation: 0.010630130767822266
GPU memory for training: 1.753340721130371                          

The whole process took 284.09421467781067 seconds
