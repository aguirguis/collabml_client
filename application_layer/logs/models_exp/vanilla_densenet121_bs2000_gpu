Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=19, manual_split=False, model='densenet121', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (densenet121) till index 19
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Memory occpied: (1150.0, 3.0)
Read 254.37291526794434 MBs for this batch
Streaming imagenet data took 14.786143064498901 seconds

Epoch: 0
Time of next(dataloader) is: 7.469709157943726
Time for copying to cuda: 0.2994534969329834
Read 246.17637538909912 MBs for this batch
Streaming imagenet data took 14.693341970443726 seconds
Time for forward pass: 19.037125825881958
Time for backpropagation: 2.5908145904541016
GPU memory for training: 22.67754077911377                          

One training iteration takes: 29.71351146697998 seconds
Index: 0
Then, training+dataloading take 29.739293813705444 seconds

Epoch: 0
Memory occpied: (1150.0, 3072.0)
Memory occpied: (6088.0, 3072.0)
Memory occpied: (6088.0, 3072.0)
Memory occpied: (6088.0, 3072.0)
Memory occpied: (6088.0, 3072.0)
Time of next(dataloader) is: 7.447365999221802
Memory occpied: (6088.0, 3072.0)
Time for copying to cuda: 0.2961883544921875
Memory occpied: (14904.0, 9208.0)
Memory occpied: (14904.0, 9208.0)
Memory occpied: (14912.0, 11864.0)
Time for forward pass: 5.252225875854492
Time for backpropagation: 0.15569067001342773
GPU memory for training: 20.46723699569702                          

One training iteration takes: 13.507306814193726 seconds
Index: 1
Memory occpied: (14920.0, 11896.0)
Memory occpied: (14920.0, 11896.0)
Read 249.3784418106079 MBs for this batch
Streaming imagenet data took 16.6167893409729 seconds
Then, training+dataloading take 16.646751880645752 seconds

Epoch: 0
Memory occpied: (14920.0, 11896.0)
Memory occpied: (14920.0, 11896.0)
Memory occpied: (14920.0, 11896.0)
Memory occpied: (14920.0, 11896.0)
Memory occpied: (14920.0, 11896.0)
Memory occpied: (14920.0, 11896.0)
Memory occpied: (14920.0, 11896.0)
Time of next(dataloader) is: 7.980681896209717
Time for copying to cuda: 0.29627370834350586
Time for forward pass: 0.07961821556091309
Memory occpied: (14920.0, 14576.0)
Time for backpropagation: 3.142435073852539
GPU memory for training: 20.46693181991577                          

One training iteration takes: 11.856645584106445 seconds
Index: 2
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 244.35633087158203 MBs for this batch
Streaming imagenet data took 18.998618841171265 seconds
Then, training+dataloading take 19.0034077167511 seconds

Epoch: 0
Time of next(dataloader) is: 7.940327405929565
Time for copying to cuda: 0.32024264335632324
Time for forward pass: 0.07690668106079102
Time for backpropagation: 3.153756618499756
GPU memory for training: 20.46693181991577                          

Memory occpied: (14920.0, 14576.0)
One training iteration takes: 11.882068395614624 seconds
Index: 3
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 253.86819553375244 MBs for this batch
Streaming imagenet data took 18.396008729934692 seconds
Then, training+dataloading take 18.402347326278687 seconds

Epoch: 0
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Time of next(dataloader) is: 8.195133924484253
Memory occpied: (14920.0, 14576.0)
Time for copying to cuda: 0.31226181983947754
Time for forward pass: 0.07806611061096191
Memory occpied: (14920.0, 14576.0)
Time for backpropagation: 3.1558566093444824
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.190174579620361 seconds
Index: 4
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 252.4394989013672 MBs for this batch
Streaming imagenet data took 20.735386610031128 seconds
Then, training+dataloading take 20.774093866348267 seconds

Epoch: 0
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Time of next(dataloader) is: 7.7817223072052
Time for copying to cuda: 0.4508688449859619
Time for forward pass: 0.25601983070373535
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Time for backpropagation: 2.9778857231140137
GPU memory for training: 20.46693181991577                          

One training iteration takes: 11.85240364074707 seconds
Index: 5
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 261.95561695098877 MBs for this batch
Streaming imagenet data took 21.631305694580078 seconds
Then, training+dataloading take 21.63745427131653 seconds

Epoch: 0
Time of next(dataloader) is: 8.281499147415161
Time for copying to cuda: 0.3081493377685547
Time for forward pass: 0.07675957679748535
Time for backpropagation: 3.1585254669189453
GPU memory for training: 20.46693181991577                          

Memory occpied: (14920.0, 14576.0)
One training iteration takes: 12.266411781311035 seconds
Index: 6
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 261.8905849456787 MBs for this batch
Streaming imagenet data took 18.526853799819946 seconds
Then, training+dataloading take 18.533541202545166 seconds

Epoch: 0
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Time of next(dataloader) is: 8.1243314743042
Memory occpied: (14920.0, 14576.0)
Time for copying to cuda: 0.4551219940185547
Time for forward pass: 0.12640595436096191
Memory occpied: (14920.0, 14576.0)
Time for backpropagation: 3.144801616668701
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.27788758277893 seconds
Index: 7
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 262.69672298431396 MBs for this batch
Streaming imagenet data took 21.871466636657715 seconds
Then, training+dataloading take 21.877521991729736 seconds

Epoch: 0
Time of next(dataloader) is: 8.392203092575073
Time for copying to cuda: 0.30966663360595703
Time for forward pass: 0.07952594757080078
Time for backpropagation: 3.1523568630218506
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.314955711364746 seconds
Index: 8
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 261.7017765045166 MBs for this batch
Streaming imagenet data took 19.10769009590149 seconds
Then, training+dataloading take 19.114745378494263 seconds

Epoch: 0
Time of next(dataloader) is: 8.278934001922607
Time for copying to cuda: 0.30905914306640625
Time for forward pass: 0.07684063911437988
Time for backpropagation: 3.163538932800293
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.207582235336304 seconds
Index: 9
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 250.33413314819336 MBs for this batch
Streaming imagenet data took 17.948360919952393 seconds
Then, training+dataloading take 17.954453706741333 seconds

Epoch: 0
Time of next(dataloader) is: 8.269432783126831
Time for copying to cuda: 0.31160831451416016
Time for forward pass: 0.07710528373718262
Time for backpropagation: 3.1774489879608154
GPU memory for training: 20.46693181991577                          

Memory occpied: (14920.0, 14576.0)
One training iteration takes: 12.235284566879272 seconds
Index: 10
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 258.8827705383301 MBs for this batch
Streaming imagenet data took 18.624639749526978 seconds
Then, training+dataloading take 18.631505489349365 seconds

Epoch: 0
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Time of next(dataloader) is: 8.154895782470703
Memory occpied: (14920.0, 14576.0)
Time for copying to cuda: 0.4477369785308838
Time for forward pass: 0.08195257186889648
Memory occpied: (14920.0, 14576.0)
Time for backpropagation: 3.163135528564453
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.241342544555664 seconds
Index: 11
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 254.204758644104 MBs for this batch
Streaming imagenet data took 21.517504692077637 seconds
Then, training+dataloading take 21.524076223373413 seconds

Epoch: 0
Time of next(dataloader) is: 8.12163758277893
Time for copying to cuda: 0.30969858169555664
Time for forward pass: 0.08254623413085938
Time for backpropagation: 3.163952112197876
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.090473651885986 seconds
Index: 12
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 251.16800022125244 MBs for this batch
Streaming imagenet data took 18.056982040405273 seconds
Then, training+dataloading take 18.062538862228394 seconds

Epoch: 0
Time of next(dataloader) is: 8.185582876205444
Time for copying to cuda: 0.3041849136352539
Time for forward pass: 0.07268357276916504
Time for backpropagation: 3.1717708110809326
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.11398696899414 seconds
Index: 13
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 263.21127796173096 MBs for this batch
Streaming imagenet data took 19.393264055252075 seconds
Then, training+dataloading take 19.399335622787476 seconds

Epoch: 0
Time of next(dataloader) is: 8.260824918746948
Time for copying to cuda: 0.3088560104370117
Time for forward pass: 0.07995152473449707
Time for backpropagation: 3.1686151027679443
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.207040309906006 seconds
Index: 14
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 246.3751916885376 MBs for this batch
Streaming imagenet data took 18.569278240203857 seconds
Then, training+dataloading take 18.57648992538452 seconds

Epoch: 0
Time of next(dataloader) is: 8.03040885925293
Time for copying to cuda: 0.3107311725616455
Time for forward pass: 0.07744455337524414
Time for backpropagation: 3.1599199771881104
GPU memory for training: 20.46693181991577                          

Memory occpied: (14920.0, 14576.0)
One training iteration takes: 11.976225852966309 seconds
Index: 15
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 261.75882625579834 MBs for this batch
Streaming imagenet data took 18.925323724746704 seconds
Then, training+dataloading take 18.932957649230957 seconds

Epoch: 0
Time of next(dataloader) is: 8.069664239883423
Time for copying to cuda: 0.3146953582763672
Time for forward pass: 0.0768270492553711
Time for backpropagation: 3.1623528003692627
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.02028775215149 seconds
Index: 16
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 261.02636432647705 MBs for this batch
Streaming imagenet data took 18.953295469284058 seconds
Then, training+dataloading take 18.95999312400818 seconds

Epoch: 0
Time of next(dataloader) is: 8.025450706481934
Time for copying to cuda: 0.3084745407104492
Time for forward pass: 0.0785980224609375
Time for backpropagation: 3.161494016647339
GPU memory for training: 20.46693181991577                          

One training iteration takes: 11.978576898574829 seconds
Index: 17
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 256.2697467803955 MBs for this batch
Streaming imagenet data took 18.64306616783142 seconds
Then, training+dataloading take 18.650451183319092 seconds

Epoch: 0
Time of next(dataloader) is: 8.108975887298584
Time for copying to cuda: 0.30465149879455566
Time for forward pass: 0.07636165618896484
Time for backpropagation: 3.1740095615386963
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.046271800994873 seconds
Index: 18
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 261.5575933456421 MBs for this batch
Streaming imagenet data took 19.668246507644653 seconds
Then, training+dataloading take 19.673847675323486 seconds

Epoch: 0
Time of next(dataloader) is: 8.209533452987671
Time for copying to cuda: 0.3139634132385254
Time for forward pass: 0.0737617015838623
Time for backpropagation: 3.1871840953826904
GPU memory for training: 20.46693181991577                          

One training iteration takes: 12.178093910217285 seconds
Index: 19
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 256.53156757354736 MBs for this batch
Streaming imagenet data took 18.365696907043457 seconds
Then, training+dataloading take 18.460108757019043 seconds

Epoch: 0
Time of next(dataloader) is: 7.863556623458862
Time for copying to cuda: 0.31395745277404785
Time for forward pass: 0.07548069953918457
Time for backpropagation: 3.168581485748291
GPU memory for training: 20.46693181991577                          

Memory occpied: (14920.0, 14576.0)
One training iteration takes: 11.87649130821228 seconds
Index: 20
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 253.90072631835938 MBs for this batch
Streaming imagenet data took 18.316263675689697 seconds
Then, training+dataloading take 18.323004961013794 seconds

Epoch: 0
Time of next(dataloader) is: 7.964709758758545
Time for copying to cuda: 0.30663108825683594
Time for forward pass: 0.07633805274963379
Time for backpropagation: 3.179292678833008
GPU memory for training: 20.46693181991577                          

One training iteration takes: 11.91994333267212 seconds
Index: 21
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 252.76372814178467 MBs for this batch
Streaming imagenet data took 18.580765962600708 seconds
Then, training+dataloading take 18.588306188583374 seconds

Epoch: 0
Memory occpied: (14920.0, 14576.0)
Time of next(dataloader) is: 8.051903247833252
Time for copying to cuda: 0.3048372268676758
Time for forward pass: 0.07850241661071777
Time for backpropagation: 3.1663668155670166
GPU memory for training: 20.46693181991577                          

One training iteration takes: 11.989585399627686 seconds
Index: 22
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 259.8807888031006 MBs for this batch
Streaming imagenet data took 19.370599031448364 seconds
Then, training+dataloading take 19.376622200012207 seconds

Epoch: 0
Time of next(dataloader) is: 8.01517653465271
Time for copying to cuda: 0.3071870803833008
Time for forward pass: 0.0791783332824707
Time for backpropagation: 3.1795287132263184
GPU memory for training: 20.46693181991577                          

One training iteration takes: 11.971403360366821 seconds
Index: 23
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Memory occpied: (14920.0, 14576.0)
Read 259.17239475250244 MBs for this batch
Streaming imagenet data took 19.385233640670776 seconds
Then, training+dataloading take 19.391006469726562 seconds

Epoch: 0
Time of next(dataloader) is: 7.890633821487427
Time for copying to cuda: 0.29297375679016113
Time for forward pass: 0.0819554328918457
Time for backpropagation: 3.1592297554016113
GPU memory for training: 20.46693181991577                          

Memory occpied: (14920.0, 14576.0)
The whole process took 502.56557846069336 seconds
