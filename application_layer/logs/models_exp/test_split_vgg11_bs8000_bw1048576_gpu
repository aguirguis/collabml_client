Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.0973239193524 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 3.2112640e+06 6.4225280e+06 6.4225280e+06
 1.6056320e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 8.0281600e+05 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  125.0
62.60546875
Total layers size  62.687408447265625
Candidate split  23
Server, client, server+client, vanilla  2086.3255920410156 1692.8685607910156 3779.1941528320312 507005.368560791
Model size  506.8334045410156
Fixed, scale_with_bsz  506.8334045410156 63.1796875
Mem usage  1250.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Memory occpied: (1762.0, 3.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 26.77108597755432 seconds
Streaming imagenet data took 26.821062564849854 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46216607093811035
Time for copying to cuda: 0.03370809555053711
Memory occpied: (1888.0, 184.0)
Memory occpied: (1888.0, 624.0)
Memory occpied: (1888.0, 1070.0)
Time for forward pass: 3.4487292766571045
Time for backpropagation: 0.0811319351196289
GPU memory for training: 2.4113597869873047                          

One training iteration takes: 4.1193320751190186 seconds
Index: 0
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Memory occpied: (3114.0, 2062.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 26.835155248641968 seconds
Streaming imagenet data took 26.884979724884033 seconds
Then, training+dataloading take 26.89181423187256 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4994540214538574
Time for copying to cuda: 0.03258633613586426
Time for forward pass: 0.15258169174194336
Time for backpropagation: 0.003406524658203125
GPU memory for training: 2.566183090209961                          

One training iteration takes: 0.7784135341644287 seconds
Index: 1
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 24.903181314468384 seconds
Streaming imagenet data took 24.952651739120483 seconds
Then, training+dataloading take 24.960774898529053 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5028460025787354
Time for copying to cuda: 0.033119916915893555
Time for forward pass: 0.1534883975982666
Time for backpropagation: 0.0033752918243408203
GPU memory for training: 2.566183090209961                          

Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
One training iteration takes: 5.718773603439331 seconds
Index: 2
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 25.254464626312256 seconds
Streaming imagenet data took 25.305234670639038 seconds
Then, training+dataloading take 25.312756538391113 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5081496238708496
Time for copying to cuda: 0.03306293487548828
Memory occpied: (3516.0, 2070.0)
Time for forward pass: 0.15292620658874512
Time for backpropagation: 0.003378152847290039
GPU memory for training: 2.566183090209961                          

One training iteration takes: 0.8073544502258301 seconds
Index: 3
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 26.40692162513733 seconds
Streaming imagenet data took 26.456995248794556 seconds
Then, training+dataloading take 26.46527886390686 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5897881984710693
Time for copying to cuda: 0.03305196762084961
Time for forward pass: 0.15215754508972168
Time for backpropagation: 0.0033173561096191406
GPU memory for training: 2.566183090209961                          

Memory occpied: (3516.0, 2070.0)
One training iteration takes: 0.8715083599090576 seconds
Index: 4
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Read 125.27742004394531 MBs for this batch
Executing all posts took 25.232784271240234 seconds
Streaming imagenet data took 25.28348684310913 seconds
Then, training+dataloading take 25.291761875152588 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5767273902893066
Time for copying to cuda: 0.03275179862976074
Time for forward pass: 0.1526048183441162
Time for backpropagation: 0.0033707618713378906
GPU memory for training: 2.566183090209961                          

One training iteration takes: 0.922743558883667 seconds
Index: 5
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Memory occpied: (3516.0, 2070.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 11.751342058181763 seconds
Streaming imagenet data took 11.765984296798706 seconds
Then, training+dataloading take 11.767361402511597 seconds

Epoch: 0
Time of next(dataloader) is: 0.458759069442749
Time for copying to cuda: 0.008507013320922852
Time for forward pass: 0.09772467613220215
Time for backpropagation: 0.0032012462615966797
GPU memory for training: 2.245178699493408                          

Memory occpied: (3516.0, 2070.0)
The whole process took 177.1211438179016 seconds
