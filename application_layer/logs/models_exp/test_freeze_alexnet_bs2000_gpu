Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='myalexnet', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=True, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.7406357403052 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
Intermediate:  31.25
4.138671875
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.712890625
Mem usage  1250.0 3.0
Using split index: 17
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.836051225662231 seconds
Streaming imagenet data took 8.848799705505371 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35951781272888184
Time for copying to cuda: 0.009167909622192383
Memory occpied: (1526.0, 240.0)
Memory occpied: (1526.0, 670.0)
Memory occpied: (1526.0, 1100.0)
Time for forward pass: 3.4472815990448
Time for backpropagation: 0.05242800712585449
GPU memory for training: 1.0012569427490234                          

One training iteration takes: 3.9329638481140137 seconds
Index: 0
Memory occpied: (2042.0, 1692.0)
Memory occpied: (2042.0, 1692.0)
Memory occpied: (2042.0, 1692.0)
Memory occpied: (2042.0, 1692.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.013871431350708 seconds
Streaming imagenet data took 9.026692628860474 seconds
Then, training+dataloading take 9.02852463722229 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4973592758178711
Time for copying to cuda: 0.008714914321899414
Time for forward pass: 0.05514335632324219
Time for backpropagation: 0.0037016868591308594
GPU memory for training: 1.1577000617980957                          

Memory occpied: (2042.0, 1700.0)
One training iteration takes: 0.6701500415802002 seconds
Index: 1
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.629496574401855 seconds
Streaming imagenet data took 8.642292261123657 seconds
Then, training+dataloading take 8.643471717834473 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41823267936706543
Time for copying to cuda: 0.008611202239990234
Time for forward pass: 0.054808855056762695
Time for backpropagation: 0.003076314926147461
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.59641432762146 seconds
Index: 2
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.738749980926514 seconds
Streaming imagenet data took 8.751805067062378 seconds
Then, training+dataloading take 8.752725601196289 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47206830978393555
Time for copying to cuda: 0.008777618408203125
Time for forward pass: 0.054871320724487305
Time for backpropagation: 0.0028176307678222656
GPU memory for training: 1.1577000617980957                          

Memory occpied: (2268.0, 1700.0)
One training iteration takes: 0.617591381072998 seconds
Index: 3
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.799817562103271 seconds
Streaming imagenet data took 8.807990074157715 seconds
Then, training+dataloading take 8.809226274490356 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45020174980163574
Time for copying to cuda: 0.008991718292236328
Time for forward pass: 0.05496835708618164
Time for backpropagation: 0.002832174301147461
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6516201496124268 seconds
Index: 4
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.918234586715698 seconds
Streaming imagenet data took 8.931730031967163 seconds
Then, training+dataloading take 8.932674646377563 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4871523380279541
Time for copying to cuda: 0.008680105209350586
Time for forward pass: 0.054944753646850586
Time for backpropagation: 0.0029327869415283203
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6801435947418213 seconds
Index: 5
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.003848314285278 seconds
Streaming imagenet data took 9.011860847473145 seconds
Then, training+dataloading take 9.013057231903076 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5260787010192871
Time for copying to cuda: 0.008780717849731445
Time for forward pass: 0.054865121841430664
Time for backpropagation: 0.0029964447021484375
GPU memory for training: 1.1577000617980957                          

Memory occpied: (2268.0, 1700.0)
One training iteration takes: 0.6708147525787354 seconds
Index: 6
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.775866985321045 seconds
Streaming imagenet data took 8.789278984069824 seconds
Then, training+dataloading take 8.790216207504272 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4573795795440674
Time for copying to cuda: 0.008643627166748047
Time for forward pass: 0.0548098087310791
Time for backpropagation: 0.002890348434448242
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6486637592315674 seconds
Index: 7
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.185834884643555 seconds
Streaming imagenet data took 9.194087505340576 seconds
Then, training+dataloading take 9.195290803909302 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46743321418762207
Time for copying to cuda: 0.008617877960205078
Time for forward pass: 0.05490612983703613
Time for backpropagation: 0.0032804012298583984
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6888072490692139 seconds
Index: 8
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.247838735580444 seconds
Streaming imagenet data took 9.261595487594604 seconds
Then, training+dataloading take 9.263351202011108 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4751908779144287
Time for copying to cuda: 0.00884556770324707
Time for forward pass: 0.059633731842041016
Time for backpropagation: 0.0028657913208007812
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6989016532897949 seconds
Index: 9
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.021668195724487 seconds
Streaming imagenet data took 9.029719829559326 seconds
Then, training+dataloading take 9.031629800796509 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4681253433227539
Time for copying to cuda: 0.008679866790771484
Time for forward pass: 0.05480766296386719
Time for backpropagation: 0.0027496814727783203
GPU memory for training: 1.1577000617980957                          

Memory occpied: (2268.0, 1700.0)
One training iteration takes: 0.631415605545044 seconds
Index: 10
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.214681386947632 seconds
Memory occpied: (2268.0, 1700.0)
Streaming imagenet data took 9.228988647460938 seconds
Then, training+dataloading take 9.229992866516113 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42048120498657227
Time for copying to cuda: 0.008686542510986328
Time for forward pass: 0.05484342575073242
Time for backpropagation: 0.002914905548095703
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.5963163375854492 seconds
Index: 11
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.908665657043457 seconds
Streaming imagenet data took 8.916772365570068 seconds
Then, training+dataloading take 8.918014764785767 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42203545570373535
Time for copying to cuda: 0.008563518524169922
Time for forward pass: 0.054770469665527344
Time for backpropagation: 0.0028367042541503906
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.5899026393890381 seconds
Index: 12
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.215708017349243 seconds
Streaming imagenet data took 9.228803634643555 seconds
Then, training+dataloading take 9.23051118850708 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4908144474029541
Time for copying to cuda: 0.008620023727416992
Time for forward pass: 0.05482125282287598
Time for backpropagation: 0.0028629302978515625
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.7075576782226562 seconds
Index: 13
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.448965549468994 seconds
Streaming imagenet data took 9.457254409790039 seconds
Then, training+dataloading take 9.458517789840698 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (2268.0, 1700.0)
Time of next(dataloader) is: 0.4377470016479492
Time for copying to cuda: 0.008690357208251953
Time for forward pass: 0.05703878402709961
Time for backpropagation: 0.002918720245361328
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.5922873020172119 seconds
Index: 14
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.900271654129028 seconds
Streaming imagenet data took 8.91348385810852 seconds
Then, training+dataloading take 8.914374351501465 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3967115879058838
Time for copying to cuda: 0.008554220199584961
Time for forward pass: 0.05475735664367676
Time for backpropagation: 0.0032258033752441406
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.5574769973754883 seconds
Index: 15
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.269446849822998 seconds
Streaming imagenet data took 9.277426719665527 seconds
Then, training+dataloading take 9.279367923736572 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5044593811035156
Memory occpied: (2268.0, 1700.0)
Time for copying to cuda: 0.008687019348144531
Time for forward pass: 0.05476212501525879
Time for backpropagation: 0.0028409957885742188
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6630849838256836 seconds
Index: 16
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.038828611373901 seconds
Streaming imagenet data took 9.052154064178467 seconds
Then, training+dataloading take 9.0531644821167 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4496634006500244
Time for copying to cuda: 0.008624076843261719
Time for forward pass: 0.05490255355834961
Time for backpropagation: 0.0029211044311523438
GPU memory for training: 1.1577000617980957                          

Memory occpied: (2268.0, 1700.0)
One training iteration takes: 0.6127307415008545 seconds
Index: 17
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.663805961608887 seconds
Streaming imagenet data took 8.67206621170044 seconds
Then, training+dataloading take 8.673399686813354 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40636301040649414
Time for copying to cuda: 0.008831262588500977
Time for forward pass: 0.07405853271484375
Time for backpropagation: 0.003275632858276367
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.633225679397583 seconds
Index: 18
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.998893976211548 seconds
Streaming imagenet data took 9.012182712554932 seconds
Then, training+dataloading take 9.013104438781738 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47664785385131836
Time for copying to cuda: 0.008711099624633789
Time for forward pass: 0.05480623245239258
Time for backpropagation: 0.0029294490814208984
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6664113998413086 seconds
Index: 19
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.788028717041016 seconds
Streaming imagenet data took 8.796252250671387 seconds
Then, training+dataloading take 8.797688245773315 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45418787002563477
Time for copying to cuda: 0.008878469467163086
Time for forward pass: 0.05486488342285156
Time for backpropagation: 0.002789020538330078
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6231212615966797 seconds
Index: 20
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.297829151153564 seconds
Streaming imagenet data took 9.311405897140503 seconds
Then, training+dataloading take 9.313159942626953 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Memory occpied: (2268.0, 1700.0)
Time of next(dataloader) is: 0.49757957458496094
Time for copying to cuda: 0.008678674697875977
Time for forward pass: 0.05823349952697754
Time for backpropagation: 0.0029120445251464844
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6733875274658203 seconds
Index: 21
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.217705726623535 seconds
Streaming imagenet data took 9.22585678100586 seconds
Then, training+dataloading take 9.227816820144653 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4432220458984375
Time for copying to cuda: 0.008820533752441406
Time for forward pass: 0.054874420166015625
Time for backpropagation: 0.002904176712036133
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6102230548858643 seconds
Index: 22
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.112761735916138 seconds
Streaming imagenet data took 9.12596321105957 seconds
Then, training+dataloading take 9.126873016357422 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4693925380706787
Time for copying to cuda: 0.008780717849731445
Time for forward pass: 0.055994510650634766
Time for backpropagation: 0.002870798110961914
GPU memory for training: 1.1577000617980957                          

One training iteration takes: 0.6667921543121338 seconds
Index: 23
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Memory occpied: (2268.0, 1700.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.46314549446106 seconds
Streaming imagenet data took 9.471208095550537 seconds
Then, training+dataloading take 9.472453117370605 seconds

Epoch: 0
Time of next(dataloader) is: 0.4086027145385742
Time for copying to cuda: 0.008621931076049805
Time for forward pass: 0.054756879806518555
Time for backpropagation: 0.003000974655151367
GPU memory for training: 1.1577000617980957                          

The whole process took 233.38654088974 seconds
