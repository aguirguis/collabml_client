Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, manual_split=False, model='myresnet18', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=True, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.3357643841614 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
Intermediate:  1148.4375
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.740918397903442 seconds
Streaming imagenet data took 7.820128679275513 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46375250816345215
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3766307830810547
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5291800498962402
One training iteration takes: 4.468100547790527 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.420677185058594 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.493792772293091 seconds
Then, training+dataloading take 7.50389838218689 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46236371994018555
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3692352771759033
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.645956516265869
One training iteration takes: 4.581447124481201 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.445471286773682 seconds
Streaming imagenet data took 7.518796682357788 seconds
Then, training+dataloading take 7.531107187271118 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49578166007995605
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 1.171959400177002
Time for backpropagation: 2.2618587017059326
One training iteration takes: 4.059735059738159 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.555304765701294 seconds
Streaming imagenet data took 7.670319557189941 seconds
Then, training+dataloading take 7.683450937271118 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4978303909301758
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4337389469146729
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5099730491638184
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.546204566955566 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.576089859008789 seconds
Streaming imagenet data took 7.649423122406006 seconds
Then, training+dataloading take 7.659317970275879 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5231256484985352
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 1.1863195896148682
Time for backpropagation: 2.258997917175293
One training iteration takes: 4.1089396476745605 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.039469480514526 seconds
Streaming imagenet data took 8.112519264221191 seconds
Then, training+dataloading take 8.125114440917969 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4595177173614502
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3929064273834229
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.593283176422119
One training iteration takes: 4.57056188583374 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.795324325561523 seconds
Streaming imagenet data took 7.8669562339782715 seconds
Then, training+dataloading take 7.8792712688446045 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4717857837677002
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.422452688217163
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.653334379196167
One training iteration takes: 4.655766487121582 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.384528875350952 seconds
Streaming imagenet data took 7.45727276802063 seconds
Then, training+dataloading take 7.469528913497925 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5436809062957764
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 1.1630470752716064
Time for backpropagation: 2.2316510677337646
One training iteration takes: 4.069025754928589 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.516539812088013 seconds
Streaming imagenet data took 7.632922887802124 seconds
Then, training+dataloading take 7.644488334655762 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5063967704772949
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 1.165726900100708
Time for backpropagation: 2.255815029144287
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.033941745758057 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.776579856872559 seconds
Streaming imagenet data took 7.849269390106201 seconds
Then, training+dataloading take 7.8616766929626465 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46073198318481445
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3786728382110596
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.714046001434326
One training iteration takes: 4.681456804275513 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.691323757171631 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.80573582649231 seconds
Then, training+dataloading take 7.818789958953857 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45296359062194824
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3515222072601318
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5742523670196533
One training iteration takes: 4.486635208129883 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.713762283325195 seconds
Streaming imagenet data took 7.882218360900879 seconds
Then, training+dataloading take 7.89341926574707 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4530668258666992
Time for copying to cuda: 9.059906005859375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.328901767730713
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5490686893463135
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.439600229263306 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.514575004577637 seconds
Streaming imagenet data took 7.5861687660217285 seconds
Then, training+dataloading take 7.598674058914185 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5241377353668213
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.330531358718872
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4324285984039307
One training iteration takes: 4.390765428543091 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.705483913421631 seconds
Streaming imagenet data took 7.7782816886901855 seconds
Then, training+dataloading take 7.79034686088562 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49802112579345703
Time for copying to cuda: 8.58306884765625e-06
Time for forward pass: 1.1619760990142822
Time for backpropagation: 2.259716033935547
One training iteration takes: 4.087011337280273 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.62645697593689 seconds
Streaming imagenet data took 7.785022974014282 seconds
Then, training+dataloading take 7.795658349990845 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4550814628601074
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3973581790924072
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3913793563842773
One training iteration takes: 4.342050075531006 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.632182836532593 seconds
Streaming imagenet data took 7.705772399902344 seconds
Then, training+dataloading take 7.718279123306274 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5006418228149414
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 1.1548511981964111
Time for backpropagation: 2.239753484725952
One training iteration takes: 4.029570579528809 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.5280115604400635 seconds
Streaming imagenet data took 7.64397931098938 seconds
Then, training+dataloading take 7.657163143157959 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5018818378448486
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 1.1686646938323975
Time for backpropagation: 2.2836802005767822
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.062145471572876 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.776546478271484 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.84866189956665 seconds
Then, training+dataloading take 7.858853101730347 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4700770378112793
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3513352870941162
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.681302785873413
One training iteration takes: 4.6108558177948 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.05006742477417 seconds
Streaming imagenet data took 8.123427391052246 seconds
Then, training+dataloading take 8.133220672607422 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47058844566345215
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4231863021850586
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7281405925750732
One training iteration takes: 4.734840154647827 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.167010307312012 seconds
Streaming imagenet data took 8.238986492156982 seconds
Then, training+dataloading take 8.248342037200928 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47467923164367676
Time for copying to cuda: 1.0967254638671875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3586575984954834
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4806413650512695
One training iteration takes: 4.423212289810181 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.691957950592041 seconds
Streaming imagenet data took 7.7643444538116455 seconds
Then, training+dataloading take 7.773823976516724 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4744846820831299
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3232698440551758
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.583803653717041
One training iteration takes: 4.496681213378906 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.882095813751221 seconds
Streaming imagenet data took 7.9548375606536865 seconds
Then, training+dataloading take 7.964271306991577 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4676191806793213
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4603793621063232
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4803855419158936
One training iteration takes: 4.5154829025268555 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.7637779712677 seconds
Streaming imagenet data took 7.836140871047974 seconds
Then, training+dataloading take 7.845554828643799 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46654486656188965
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3977508544921875
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.560115337371826
One training iteration takes: 4.536956787109375 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.970338344573975 seconds
Streaming imagenet data took 8.044718742370605 seconds
Then, training+dataloading take 8.057705402374268 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48221278190612793
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.279426097869873
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.556957483291626
One training iteration takes: 4.427314758300781 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.627370834350586 seconds
Streaming imagenet data took 7.699981927871704 seconds
Then, training+dataloading take 7.7123706340789795 seconds

Epoch: 0
Time of next(dataloader) is: 0.4569981098175049
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3791561126708984
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6369357109069824
The whole process took 206.04756140708923 seconds
