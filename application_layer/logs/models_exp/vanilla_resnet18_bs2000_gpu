Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, manual_split=False, model='resnet18', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet18) till index 11
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Read 254.37291526794434 MBs for this batch
Streaming imagenet data took 14.51038408279419 seconds

Epoch: 0
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Memory occpied: (1168.0, 3.0)
Time of next(dataloader) is: 7.162328004837036
Time for copying to cuda: 0.2979569435119629
Memory occpied: (2318.0, 230.0)
Memory occpied: (2318.0, 518.0)
Memory occpied: (2318.0, 836.0)
Memory occpied: (12470.0, 11866.0)
Memory occpied: (12436.0, 11866.0)
Memory occpied: (8846.0, 8968.0)
Read 246.17637538909912 MBs for this batch
Streaming imagenet data took 16.102341651916504 seconds
Memory occpied: (12608.0, 10170.0)
Time for forward pass: 10.21403956413269
Memory occpied: (9488.0, 9568.0)
Time for backpropagation: 1.4367327690124512
GPU memory for training: 21.49008321762085                          

One training iteration takes: 19.423163175582886 seconds
Index: 0
Then, training+dataloading take 19.427764892578125 seconds

Epoch: 0
Time of next(dataloader) is: 7.633278846740723
Time for copying to cuda: 0.3022441864013672
Time for forward pass: 0.9144096374511719
Time for backpropagation: 0.007670164108276367
GPU memory for training: 13.771410465240479                          

One training iteration takes: 9.16327977180481 seconds
Index: 1
Memory occpied: (4152.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 249.3784418106079 MBs for this batch
Streaming imagenet data took 14.165687799453735 seconds
Then, training+dataloading take 14.173804759979248 seconds

Epoch: 0
Time of next(dataloader) is: 7.960980176925659
Time for copying to cuda: 0.29084134101867676
Time for forward pass: 0.025647401809692383
Time for backpropagation: 0.0063784122467041016
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.676447868347168 seconds
Index: 2
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 244.35633087158203 MBs for this batch
Streaming imagenet data took 15.146382093429565 seconds
Then, training+dataloading take 15.166835308074951 seconds

Epoch: 0
Memory occpied: (10296.0, 10374.0)
Time of next(dataloader) is: 7.924866437911987
Time for copying to cuda: 0.3042876720428467
Time for forward pass: 0.024927854537963867
Time for backpropagation: 0.006524562835693359
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.63577127456665 seconds
Index: 3
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 253.86819553375244 MBs for this batch
Streaming imagenet data took 16.570388793945312 seconds
Then, training+dataloading take 16.578843116760254 seconds

Epoch: 0
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Time of next(dataloader) is: 8.308146715164185
Time for copying to cuda: 0.43144965171813965
Time for forward pass: 0.18597626686096191
Time for backpropagation: 0.00817251205444336
GPU memory for training: 13.771410465240479                          

Memory occpied: (10296.0, 10374.0)
One training iteration takes: 9.310965538024902 seconds
Index: 4
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 252.4394989013672 MBs for this batch
Streaming imagenet data took 19.009976148605347 seconds
Then, training+dataloading take 19.01630473136902 seconds

Epoch: 0
Time of next(dataloader) is: 8.03974437713623
Time for copying to cuda: 0.3092515468597412
Time for forward pass: 0.029429197311401367
Time for backpropagation: 0.006641387939453125
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.769659519195557 seconds
Index: 5
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 261.95561695098877 MBs for this batch
Streaming imagenet data took 17.617433547973633 seconds
Then, training+dataloading take 17.62349796295166 seconds

Epoch: 0
Time of next(dataloader) is: 8.161784172058105
Time for copying to cuda: 0.3071401119232178
Time for forward pass: 0.026721954345703125
Time for backpropagation: 0.007576465606689453
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.877549886703491 seconds
Index: 6
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 261.8905849456787 MBs for this batch
Streaming imagenet data took 16.878905773162842 seconds
Then, training+dataloading take 16.888033390045166 seconds

Epoch: 0
Time of next(dataloader) is: 8.016237735748291
Time for copying to cuda: 0.3094484806060791
Time for forward pass: 0.02680039405822754
Time for backpropagation: 0.0077283382415771484
GPU memory for training: 13.771410465240479                          

Memory occpied: (10296.0, 10374.0)
One training iteration takes: 8.80443263053894 seconds
Index: 7
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 262.69672298431396 MBs for this batch
Streaming imagenet data took 17.381765127182007 seconds
Then, training+dataloading take 17.387698650360107 seconds

Epoch: 0
Time of next(dataloader) is: 8.212303400039673
Time for copying to cuda: 0.3080720901489258
Time for forward pass: 0.026834726333618164
Time for backpropagation: 0.007632732391357422
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.971448421478271 seconds
Index: 8
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 261.7017765045166 MBs for this batch
Streaming imagenet data took 17.39920735359192 seconds
Then, training+dataloading take 17.406012296676636 seconds

Epoch: 0
Time of next(dataloader) is: 7.933439016342163
Time for copying to cuda: 0.3041656017303467
Time for forward pass: 0.026303768157958984
Time for backpropagation: 0.0072383880615234375
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.651993989944458 seconds
Index: 9
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 250.33413314819336 MBs for this batch
Streaming imagenet data took 16.357799768447876 seconds
Then, training+dataloading take 16.36347532272339 seconds

Epoch: 0
Time of next(dataloader) is: 7.905430793762207
Time for copying to cuda: 0.3179051876068115
Time for forward pass: 0.02668285369873047
Time for backpropagation: 0.008207559585571289
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.656964302062988 seconds
Index: 10
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 258.8827705383301 MBs for this batch
Streaming imagenet data took 17.06898522377014 seconds
Then, training+dataloading take 17.075954914093018 seconds

Epoch: 0
Time of next(dataloader) is: 7.940752744674683
Time for copying to cuda: 0.31195712089538574
Time for forward pass: 0.02601337432861328
Time for backpropagation: 0.007318258285522461
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.674116611480713 seconds
Index: 11
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 254.204758644104 MBs for this batch
Streaming imagenet data took 17.18994688987732 seconds
Then, training+dataloading take 17.196524381637573 seconds

Epoch: 0
Time of next(dataloader) is: 8.0760338306427
Time for copying to cuda: 0.3171539306640625
Time for forward pass: 0.029030323028564453
Time for backpropagation: 0.006976127624511719
GPU memory for training: 13.771410465240479                          

Memory occpied: (10296.0, 10374.0)
One training iteration takes: 8.873926401138306 seconds
Index: 12
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 251.16800022125244 MBs for this batch
Streaming imagenet data took 17.145939111709595 seconds
Then, training+dataloading take 17.152199745178223 seconds

Epoch: 0
Time of next(dataloader) is: 7.958698987960815
Time for copying to cuda: 0.30681300163269043
Time for forward pass: 0.026742935180664062
Time for backpropagation: 0.009018898010253906
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.739916324615479 seconds
Index: 13
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 263.21127796173096 MBs for this batch
Streaming imagenet data took 17.96584939956665 seconds
Then, training+dataloading take 17.97142481803894 seconds

Epoch: 0
Time of next(dataloader) is: 8.417368412017822
Time for copying to cuda: 0.30756211280822754
Time for forward pass: 0.027346134185791016
Time for backpropagation: 0.007101535797119141
GPU memory for training: 13.771410465240479                          

One training iteration takes: 9.140516519546509 seconds
Index: 14
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 246.3751916885376 MBs for this batch
Streaming imagenet data took 17.17664074897766 seconds
Then, training+dataloading take 17.186457872390747 seconds

Epoch: 0
Time of next(dataloader) is: 8.003249645233154
Time for copying to cuda: 0.30730271339416504
Time for forward pass: 0.028575897216796875
Time for backpropagation: 0.0066564083099365234
GPU memory for training: 13.771410465240479                          

Memory occpied: (10296.0, 10374.0)
One training iteration takes: 8.744466781616211 seconds
Index: 15
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 261.75882625579834 MBs for this batch
Streaming imagenet data took 17.342361450195312 seconds
Then, training+dataloading take 17.348541498184204 seconds

Epoch: 0
Time of next(dataloader) is: 7.995962381362915
Time for copying to cuda: 0.3068993091583252
Time for forward pass: 0.030376434326171875
Time for backpropagation: 0.006993293762207031
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.722976922988892 seconds
Index: 16
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 261.02636432647705 MBs for this batch
Streaming imagenet data took 17.33639097213745 seconds
Then, training+dataloading take 17.34305691719055 seconds

Epoch: 0
Time of next(dataloader) is: 7.97369122505188
Time for copying to cuda: 0.31424665451049805
Time for forward pass: 0.02711319923400879
Time for backpropagation: 0.007357597351074219
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.725381135940552 seconds
Index: 17
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 256.2697467803955 MBs for this batch
Streaming imagenet data took 17.326343059539795 seconds
Then, training+dataloading take 17.332576990127563 seconds

Epoch: 0
Time of next(dataloader) is: 8.163236141204834
Time for copying to cuda: 0.30602598190307617
Time for forward pass: 0.02978801727294922
Time for backpropagation: 0.006766080856323242
GPU memory for training: 13.771410465240479                          

Memory occpied: (10296.0, 10374.0)
One training iteration takes: 8.915211200714111 seconds
Index: 18
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 261.5575933456421 MBs for this batch
Streaming imagenet data took 18.48991847038269 seconds
Then, training+dataloading take 18.51562190055847 seconds

Epoch: 0
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Time of next(dataloader) is: 7.935864686965942
Time for copying to cuda: 0.4378378391265869
Time for forward pass: 0.07573437690734863
Time for backpropagation: 0.0070421695709228516
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.825326442718506 seconds
Index: 19
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 256.53156757354736 MBs for this batch
Streaming imagenet data took 19.162184715270996 seconds
Then, training+dataloading take 19.16880774497986 seconds

Epoch: 0
Time of next(dataloader) is: 8.063782215118408
Time for copying to cuda: 0.3047623634338379
Time for forward pass: 0.03179192543029785
Time for backpropagation: 0.00868082046508789
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.821813344955444 seconds
Index: 20
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 253.90072631835938 MBs for this batch
Streaming imagenet data took 17.21120262145996 seconds
Then, training+dataloading take 17.218292713165283 seconds

Epoch: 0
Time of next(dataloader) is: 7.939810037612915
Time for copying to cuda: 0.3080630302429199
Time for forward pass: 0.02673959732055664
Time for backpropagation: 0.006607770919799805
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.67402720451355 seconds
Index: 21
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 252.76372814178467 MBs for this batch
Streaming imagenet data took 17.613632202148438 seconds
Then, training+dataloading take 17.619882822036743 seconds

Epoch: 0
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Time of next(dataloader) is: 8.01665186882019
Memory occpied: (10296.0, 10374.0)
Time for copying to cuda: 0.4593086242675781
Time for forward pass: 0.030496835708618164
Time for backpropagation: 0.008148431777954102
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.928987503051758 seconds
Index: 22
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 259.8807888031006 MBs for this batch
Streaming imagenet data took 19.937563180923462 seconds
Then, training+dataloading take 19.94505023956299 seconds

Epoch: 0
Time of next(dataloader) is: 8.094484090805054
Time for copying to cuda: 0.31058287620544434
Time for forward pass: 0.025749683380126953
Time for backpropagation: 0.006814002990722656
GPU memory for training: 13.771410465240479                          

One training iteration takes: 8.831594944000244 seconds
Index: 23
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Memory occpied: (10296.0, 10374.0)
Read 259.17239475250244 MBs for this batch
Streaming imagenet data took 18.53626775741577 seconds
Then, training+dataloading take 18.54533624649048 seconds

Epoch: 0
Time of next(dataloader) is: 7.9357264041900635
Time for copying to cuda: 0.2920825481414795
Time for forward pass: 0.04750490188598633
Time for backpropagation: 0.005921840667724609
GPU memory for training: 13.771410465240479                          

Memory occpied: (10296.0, 10374.0)
The whole process took 448.16326427459717 seconds
