Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, manual_split=False, model='mydensenet121', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=True, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.0395283799821 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([21]),)
Intermediate:  1531.25
29.572265625
Total layers size  29.767486572265625
Fixed, scale_with_bsz  30.436920166015625 30.146484375
Mem usage  1250.0 3.0
Using split index: 20
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 35.00493764877319 seconds
Memory occpied: (1294.0, 3.0)
Streaming imagenet data took 35.650471210479736 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1294.0, 3.0)
Time of next(dataloader) is: 1.3055016994476318
Time for copying to cuda: 0.4354841709136963
Memory occpied: (2826.0, 18.0)
Memory occpied: (2826.0, 1284.0)
Memory occpied: (2826.0, 1724.0)
Time for forward pass: 3.4983606338500977
Time for backpropagation: 0.0789487361907959
GPU memory for training: 6.810298919677734                          

One training iteration takes: 5.591478109359741 seconds
Index: 0
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 36.16702699661255 seconds
Streaming imagenet data took 36.73627424240112 seconds
Then, training+dataloading take 36.81313681602478 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.5934219360351562
Time for copying to cuda: 0.39632391929626465
Time for forward pass: 0.1611800193786621
Time for backpropagation: 0.011977910995483398
GPU memory for training: 6.8247809410095215                          

Memory occpied: (5328.0, 4462.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
One training iteration takes: 7.334696531295776 seconds
Index: 1
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 37.32863640785217 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 37.90773344039917 seconds
Then, training+dataloading take 37.990782737731934 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.5632109642028809
Time for copying to cuda: 0.5100216865539551
Memory occpied: (5344.0, 4478.0)
Time for forward pass: 0.16605758666992188
Time for backpropagation: 0.011710882186889648
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.5336062908172607 seconds
Index: 2
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 36.62229299545288 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 37.35560655593872 seconds
Then, training+dataloading take 37.434107303619385 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.4674255847930908
Time for copying to cuda: 0.3933689594268799
Time for forward pass: 0.17174482345581055
Time for backpropagation: 0.012080907821655273
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.2621395587921143 seconds
Index: 3
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 36.38576912879944 seconds
Streaming imagenet data took 36.96493411064148 seconds
Then, training+dataloading take 37.04374122619629 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.5087225437164307
Time for copying to cuda: 0.3985412120819092
Time for forward pass: 0.16817831993103027
Time for backpropagation: 0.011780977249145508
GPU memory for training: 6.8247809410095215                          

Memory occpied: (5344.0, 4478.0)
One training iteration takes: 2.430091381072998 seconds
Index: 4
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 37.332786560058594 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 37.90526747703552 seconds
Then, training+dataloading take 38.00473713874817 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.449589490890503
Time for copying to cuda: 0.5116534233093262
Memory occpied: (5344.0, 4478.0)
Time for forward pass: 0.16126036643981934
Time for backpropagation: 0.011719226837158203
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.4083268642425537 seconds
Index: 5
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 12.975889444351196 seconds
Streaming imagenet data took 13.12264084815979 seconds
Then, training+dataloading take 13.14684796333313 seconds

Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 0.764155387878418
Time for copying to cuda: 0.10124635696411133
Time for forward pass: 0.04663991928100586
Time for backpropagation: 0.010889053344726562
GPU memory for training: 1.753340721130371                          

The whole process took 244.0924665927887 seconds
