Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='myalexnet', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=True, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.2782615261311 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
Intermediate:  31.25
4.138671875
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.712890625
Mem usage  1250.0 3.0
Using split index: 17
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.057294845581055 seconds
Streaming imagenet data took 9.070020198822021 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37307167053222656
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.1180109977722168
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.4608597755432129
One training iteration takes: 1.019754409790039 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.867164611816406 seconds
Streaming imagenet data took 8.880114555358887 seconds
Then, training+dataloading take 8.8819260597229 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38187742233276367
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.33440494537353516
Time for backpropagation: 0.238511323928833
One training iteration takes: 1.110600233078003 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.911818742752075 seconds
Streaming imagenet data took 8.924924850463867 seconds
Then, training+dataloading take 8.925938844680786 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4596235752105713
Time for copying to cuda: 1.0251998901367188e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.15520930290222168
Time for backpropagation: 0.2838869094848633
One training iteration takes: 1.0192768573760986 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.710215330123901 seconds
Streaming imagenet data took 8.718762397766113 seconds
Then, training+dataloading take 8.719982147216797 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.436495304107666
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.13710761070251465
Time for backpropagation: 0.23685193061828613
One training iteration takes: 0.9580976963043213 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.77729868888855 seconds
Streaming imagenet data took 8.79041600227356 seconds
Then, training+dataloading take 8.79136872291565 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3919804096221924
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.1691586971282959
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.520625114440918
One training iteration takes: 1.210252285003662 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.81175684928894 seconds
Streaming imagenet data took 8.820188283920288 seconds
Then, training+dataloading take 8.82141923904419 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.393247127532959
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.4184563159942627
Time for backpropagation: 0.2707991600036621
One training iteration takes: 1.2184727191925049 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.080184698104858 seconds
Streaming imagenet data took 9.093556880950928 seconds
Then, training+dataloading take 9.09454083442688 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45032644271850586
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.19304442405700684
Time for backpropagation: 0.28134679794311523
One training iteration takes: 1.0751616954803467 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.090718984603882 seconds
Streaming imagenet data took 9.099324703216553 seconds
Then, training+dataloading take 9.100573778152466 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4071791172027588
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.3879678249359131
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2929873466491699
One training iteration takes: 1.2232928276062012 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.542964220046997 seconds
Streaming imagenet data took 9.556039094924927 seconds
Then, training+dataloading take 9.557729482650757 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38678789138793945
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.16539907455444336
Time for backpropagation: 0.25651097297668457
One training iteration takes: 0.9678490161895752 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.184772968292236 seconds
Streaming imagenet data took 9.193535566329956 seconds
Then, training+dataloading take 9.19557237625122 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4246251583099365
Time for copying to cuda: 1.049041748046875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.2726125717163086
Time for backpropagation: 0.27920961380004883
One training iteration takes: 1.1227076053619385 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.732494592666626 seconds
Streaming imagenet data took 8.746053695678711 seconds
Then, training+dataloading take 8.747053623199463 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4540135860443115
Time for copying to cuda: 3.218650817871094e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.2553822994232178
Time for backpropagation: 0.2703821659088135
One training iteration takes: 1.1279208660125732 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.842675924301147 seconds
Streaming imagenet data took 8.851261854171753 seconds
Then, training+dataloading take 8.85256576538086 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4384162425994873
Time for copying to cuda: 8.344650268554688e-06
Time for forward pass: 0.17613935470581055
Time for backpropagation: 0.28403520584106445
One training iteration takes: 1.049004316329956 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.142114639282227 seconds
Streaming imagenet data took 9.155302047729492 seconds
Then, training+dataloading take 9.156252145767212 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4073975086212158
Time for copying to cuda: 1.0728836059570312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.2763404846191406
Time for backpropagation: 0.24038219451904297
One training iteration takes: 1.0365514755249023 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.783228397369385 seconds
Streaming imagenet data took 8.791661262512207 seconds
Then, training+dataloading take 8.792840242385864 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4664466381072998
Time for copying to cuda: 2.1219253540039062e-05
Time for forward pass: 0.16355538368225098
Time for backpropagation: 0.23475885391235352
One training iteration takes: 1.0191214084625244 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.177168369293213 seconds
Streaming imagenet data took 9.1903076171875 seconds
Then, training+dataloading take 9.19197964668274 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40950489044189453
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.30040502548217773
Time for backpropagation: 0.30760669708251953
One training iteration takes: 1.1338114738464355 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.989506959915161 seconds
Streaming imagenet data took 8.998065710067749 seconds
Then, training+dataloading take 9.000111103057861 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4352993965148926
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.16586637496948242
Time for backpropagation: 0.245652437210083
One training iteration takes: 1.0093543529510498 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.87792420387268 seconds
Streaming imagenet data took 8.890997886657715 seconds
Then, training+dataloading take 8.891999244689941 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38726234436035156
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.15063190460205078
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.5692121982574463
One training iteration takes: 1.224316120147705 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.840434074401855 seconds
Streaming imagenet data took 8.849892139434814 seconds
Then, training+dataloading take 8.852126598358154 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39192819595336914
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.1755962371826172
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.4416205883026123
One training iteration takes: 1.1271462440490723 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.618860960006714 seconds
Streaming imagenet data took 8.632331371307373 seconds
Then, training+dataloading take 8.633388042449951 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3913407325744629
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.17252850532531738
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.5584609508514404
One training iteration takes: 1.2340912818908691 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 8.87643837928772 seconds
Streaming imagenet data took 8.885004758834839 seconds
Then, training+dataloading take 8.886274576187134 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3967275619506836
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.1525745391845703
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.5023012161254883
One training iteration takes: 1.188675880432129 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.128105640411377 seconds
Streaming imagenet data took 9.141130447387695 seconds
Then, training+dataloading take 9.142811298370361 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4395146369934082
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.1516575813293457
Time for backpropagation: 0.27828502655029297
One training iteration takes: 1.018921136856079 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.148797512054443 seconds
Streaming imagenet data took 9.157394170761108 seconds
Then, training+dataloading take 9.159321546554565 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42201876640319824
Time for copying to cuda: 1.049041748046875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.2758464813232422
Time for backpropagation: 0.2927253246307373
One training iteration takes: 1.1268701553344727 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.13283371925354 seconds
Streaming imagenet data took 9.146482467651367 seconds
Then, training+dataloading take 9.147717714309692 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.46218156814575195
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.16478276252746582
Time for backpropagation: 0.2865321636199951
One training iteration takes: 1.0551912784576416 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.068061351776123 seconds
Streaming imagenet data took 9.076701402664185 seconds
Then, training+dataloading take 9.078161478042603 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3930778503417969
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.1899428367614746
Time for backpropagation: 0.35851550102233887
One training iteration takes: 1.087691068649292 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 9.132302045822144 seconds
Streaming imagenet data took 9.145625829696655 seconds
Then, training+dataloading take 9.147376537322998 seconds

Epoch: 0
Time of next(dataloader) is: 0.4026327133178711
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.27866268157958984
Time for backpropagation: 0.2898566722869873
The whole process took 232.95392513275146 seconds
