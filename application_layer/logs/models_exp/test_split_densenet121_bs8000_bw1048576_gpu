Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.5310777890288 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  1531.25
29.572265625
Total layers size  29.767486572265625
Fixed, scale_with_bsz  30.436920166015625 30.146484375
Mem usage  1250.0 3.0
Using split index: 20
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 30.36444902420044 seconds
Memory occpied: (1294.0, 3.0)
Streaming imagenet data took 31.065251111984253 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1294.0, 3.0)
Time of next(dataloader) is: 1.2899067401885986
Time for copying to cuda: 0.3943164348602295
Memory occpied: (2826.0, 930.0)
Memory occpied: (2826.0, 1348.0)
Memory occpied: (2826.0, 1762.0)
Time for forward pass: 3.6009438037872314
Time for backpropagation: 0.07507777214050293
GPU memory for training: 6.810298919677734                          

One training iteration takes: 5.6266560554504395 seconds
Index: 0
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Memory occpied: (5328.0, 4462.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 31.083075284957886 seconds
Memory occpied: (5328.0, 4462.0)
Streaming imagenet data took 31.80808162689209 seconds
Then, training+dataloading take 31.882692575454712 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (5328.0, 4462.0)
Time of next(dataloader) is: 1.4627339839935303
Time for copying to cuda: 0.39382481575012207
Time for forward pass: 0.1611952781677246
Time for backpropagation: 0.013153791427612305
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.301013469696045 seconds
Index: 1
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 30.40552830696106 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 31.07579207420349 seconds
Then, training+dataloading take 31.15052080154419 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.4544131755828857
Time for copying to cuda: 0.3885362148284912
Time for forward pass: 0.16826248168945312
Time for backpropagation: 0.012221097946166992
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.2177867889404297 seconds
Index: 2
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 29.345325469970703 seconds
Streaming imagenet data took 29.911996841430664 seconds
Then, training+dataloading take 29.984273433685303 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.6093811988830566
Memory occpied: (5344.0, 4478.0)
Time for copying to cuda: 0.5110366344451904
Time for forward pass: 0.16131162643432617
Time for backpropagation: 0.011934041976928711
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.583075761795044 seconds
Index: 3
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 31.351683378219604 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 32.003809213638306 seconds
Then, training+dataloading take 32.09729623794556 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.3744409084320068
Time for copying to cuda: 0.3952045440673828
Time for forward pass: 0.16428160667419434
Time for backpropagation: 0.012356042861938477
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.135709285736084 seconds
Index: 4
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 30.880570888519287 seconds
Memory occpied: (5344.0, 4478.0)
Streaming imagenet data took 31.541818141937256 seconds
Then, training+dataloading take 31.61788582801819 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (5344.0, 4478.0)
Time of next(dataloader) is: 1.442300796508789
Time for copying to cuda: 0.38997530937194824
Time for forward pass: 0.1646137237548828
Time for backpropagation: 0.012751340866088867
GPU memory for training: 6.8247809410095215                          

One training iteration takes: 2.1998283863067627 seconds
Index: 5
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Memory occpied: (5344.0, 4478.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 14.25790810585022 seconds
Streaming imagenet data took 14.399799346923828 seconds
Then, training+dataloading take 14.43315863609314 seconds

Epoch: 0
Time of next(dataloader) is: 0.7130181789398193
Time for copying to cuda: 0.15709853172302246
Time for forward pass: 0.047612667083740234
Time for backpropagation: 0.011830806732177734
GPU memory for training: 1.753340721130371                          

Memory occpied: (5344.0, 4478.0)
The whole process took 210.39278364181519 seconds
