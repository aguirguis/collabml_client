Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, manual_split=False, model='myresnet50', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Error of iperf: unable to connect to server: 
Recorded bandwidth: 908.2855256674147 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([20, 21]),)
Intermediate:  15.625
110.736328125
Total layers size  110.74014282226562
Candidate split  21
Server, client, server+client, vanilla  2880.2560119628906 128.37612915039062 3008.6321411132812 222733.8448791504
Model size  97.49234008789062
Fixed, scale_with_bsz  97.49234008789062 111.310546875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.251381874084473 seconds
Streaming imagenet data took 12.258894920349121 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.321134090423584
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.011739730834960938
Time for backpropagation: 0.2674829959869385
One training iteration takes: 0.6707408428192139 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.511059284210205 seconds
Streaming imagenet data took 13.518624544143677 seconds
Then, training+dataloading take 13.519535303115845 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3723464012145996
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.030396461486816406
Time for backpropagation: 0.07480597496032715
One training iteration takes: 0.5526416301727295 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.96493411064148 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 10.972344636917114 seconds
Then, training+dataloading take 10.973177194595337 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28513145446777344
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.030849933624267578
Time for backpropagation: 0.04642295837402344
One training iteration takes: 0.43473339080810547 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.42226266860962 seconds
Streaming imagenet data took 13.429245233535767 seconds
Then, training+dataloading take 13.4300537109375 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2985398769378662
Time for copying to cuda: 9.5367431640625e-06
Time for forward pass: 0.02651357650756836
Time for backpropagation: 0.06904292106628418
One training iteration takes: 0.47662854194641113 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.754102468490601 seconds
Streaming imagenet data took 7.759390830993652 seconds
Then, training+dataloading take 7.760223388671875 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.2947835922241211
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.026723146438598633
Time for backpropagation: 0.05370330810546875
One training iteration takes: 0.4448561668395996 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.357256650924683 seconds
Streaming imagenet data took 10.362199306488037 seconds
Then, training+dataloading take 10.363021850585938 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33017659187316895
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.02682781219482422
Time for backpropagation: 0.07647562026977539
One training iteration takes: 0.5424644947052002 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.918454885482788 seconds
Streaming imagenet data took 7.923832416534424 seconds
Then, training+dataloading take 7.924649000167847 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2886056900024414
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.02681589126586914
Time for backpropagation: 0.06748032569885254
One training iteration takes: 0.45074009895324707 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.08642578125 seconds
Streaming imagenet data took 10.091349363327026 seconds
Then, training+dataloading take 10.092150688171387 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3785252571105957
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.029749631881713867
Time for backpropagation: 0.061348676681518555
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.5433454513549805 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.948448657989502 seconds
Streaming imagenet data took 7.953813314437866 seconds
Then, training+dataloading take 7.955308675765991 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29804301261901855
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.031182527542114258
Time for backpropagation: 0.07958173751831055
One training iteration takes: 0.4925994873046875 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.382411241531372 seconds
Streaming imagenet data took 10.387378931045532 seconds
Then, training+dataloading take 10.388262748718262 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30231189727783203
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.026457548141479492
Time for backpropagation: 0.07520079612731934
One training iteration takes: 0.467113733291626 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.64243745803833 seconds
Streaming imagenet data took 7.647800922393799 seconds
Then, training+dataloading take 7.648607492446899 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2967803478240967
Time for copying to cuda: 6.198883056640625e-06
Time for forward pass: 0.10126781463623047
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.11214065551757812
One training iteration takes: 0.5882620811462402 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.275775909423828 seconds
Streaming imagenet data took 10.280766725540161 seconds
Then, training+dataloading take 10.28161358833313 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2991757392883301
Time for copying to cuda: 6.4373016357421875e-06
Time for forward pass: 0.030567407608032227
Time for backpropagation: 0.07733988761901855
One training iteration takes: 0.4774026870727539 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.741113901138306 seconds
Streaming imagenet data took 7.7826738357543945 seconds
Then, training+dataloading take 7.78868842124939 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3360099792480469
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.02698206901550293
Time for backpropagation: 0.07385873794555664
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.5141031742095947 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.285932302474976 seconds
Streaming imagenet data took 10.2917160987854 seconds
Then, training+dataloading take 10.292748928070068 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30097341537475586
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.02689647674560547
Time for backpropagation: 0.07139468193054199
One training iteration takes: 0.4640371799468994 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.890277147293091 seconds
Streaming imagenet data took 7.895352125167847 seconds
Then, training+dataloading take 7.896219253540039 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.299318790435791
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.03622555732727051
Time for backpropagation: 0.08119344711303711
One training iteration takes: 0.4928901195526123 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.158183097839355 seconds
Streaming imagenet data took 10.163717031478882 seconds
Then, training+dataloading take 10.164620161056519 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3037729263305664
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.03611302375793457
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.18443870544433594
One training iteration takes: 0.6027162075042725 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.911218643188477 seconds
Streaming imagenet data took 7.9162726402282715 seconds
Then, training+dataloading take 7.917125463485718 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29772353172302246
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.026883840560913086
Time for backpropagation: 0.05817389488220215
One training iteration takes: 0.45977210998535156 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.319708108901978 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 10.325210809707642 seconds
Then, training+dataloading take 10.326013803482056 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30796265602111816
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.026812314987182617
Time for backpropagation: 0.07431578636169434
One training iteration takes: 0.4869849681854248 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.957587242126465 seconds
Streaming imagenet data took 7.962576866149902 seconds
Then, training+dataloading take 7.963414907455444 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3475477695465088
Time for copying to cuda: 9.059906005859375e-06
Time for forward pass: 0.02737116813659668
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.06868338584899902
One training iteration takes: 0.5133254528045654 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.312294960021973 seconds
Streaming imagenet data took 10.317611694335938 seconds
Then, training+dataloading take 10.318453788757324 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2908658981323242
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.026259660720825195
Time for backpropagation: 0.07016897201538086
One training iteration takes: 0.45719099044799805 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.9017863273620605 seconds
Streaming imagenet data took 7.906813621520996 seconds
Then, training+dataloading take 7.907651662826538 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2946922779083252
Time for copying to cuda: 6.4373016357421875e-06
Time for forward pass: 0.027383089065551758
Time for backpropagation: 0.07385754585266113
One training iteration takes: 0.4663872718811035 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.413101434707642 seconds
Streaming imagenet data took 10.422445058822632 seconds
Then, training+dataloading take 10.42566990852356 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33867883682250977
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.02656412124633789
Time for backpropagation: 0.0689082145690918
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.5007326602935791 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.824810266494751 seconds
Streaming imagenet data took 7.8298749923706055 seconds
Then, training+dataloading take 7.830768585205078 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2980842590332031
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.027536392211914062
Time for backpropagation: 0.0716550350189209
One training iteration takes: 0.4676523208618164 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.389134645462036 seconds
Streaming imagenet data took 10.394481182098389 seconds
Then, training+dataloading take 10.395986795425415 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29361867904663086
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.0254514217376709
Time for backpropagation: 0.07059144973754883
One training iteration takes: 0.45755481719970703 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.854295253753662 seconds
Streaming imagenet data took 7.8593738079071045 seconds
Then, training+dataloading take 7.860328197479248 seconds

Epoch: 0
Time of next(dataloader) is: 0.3331592082977295
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.026647090911865234
Time for backpropagation: 0.07050418853759766
Memory occpied: (1250.0, 3.0)
The whole process took 247.50770235061646 seconds
