Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, manual_split=False, model='myvgg19', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=True, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.0551118736134 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
Intermediate:  3062.5
119.0546875
Total layers size  119.34365844726562
Fixed, scale_with_bsz  548.0470275878906 119.62890625
Mem usage  1250.0 3.0
Using split index: 36
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 71.17527532577515 seconds
Memory occpied: (1822.0, 3.0)
Streaming imagenet data took 72.43389105796814 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1822.0, 3.0)
Memory occpied: (1822.0, 3.0)
Time of next(dataloader) is: 2.2923474311828613
Memory occpied: (4886.0, 3.0)
Time for copying to cuda: 0.8673050403594971
Memory occpied: (4886.0, 1840.0)
Memory occpied: (4886.0, 2278.0)
Memory occpied: (4886.0, 2740.0)
Time for forward pass: 4.098553419113159
Time for backpropagation: 0.2583441734313965
GPU memory for training: 7.937506198883057                          

One training iteration takes: 7.998670339584351 seconds
Index: 0
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 72.65878033638 seconds
Streaming imagenet data took 74.03411054611206 seconds
Then, training+dataloading take 74.11222743988037 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (6492.0, 4500.0)
Memory occpied: (6492.0, 4500.0)
Time of next(dataloader) is: 2.467432737350464
Memory occpied: (6492.0, 4500.0)
Time for copying to cuda: 0.9345896244049072
Time for forward pass: 0.6685919761657715
Time for backpropagation: 0.004860639572143555
GPU memory for training: 8.724570751190186                          

Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
One training iteration takes: 9.4466712474823 seconds
Index: 1
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 72.69157671928406 seconds
Memory occpied: (7668.0, 4508.0)
Streaming imagenet data took 74.03322386741638 seconds
Then, training+dataloading take 74.1853187084198 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Time of next(dataloader) is: 2.5573744773864746
Time for copying to cuda: 0.921729564666748
Memory occpied: (7668.0, 4508.0)
Time for forward pass: 0.653296947479248
Time for backpropagation: 0.0041620731353759766
GPU memory for training: 8.724570751190186                          

One training iteration takes: 4.599019289016724 seconds
Index: 2
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 70.07605481147766 seconds
Memory occpied: (7668.0, 4508.0)
Streaming imagenet data took 71.42464303970337 seconds
Then, training+dataloading take 71.5881884098053 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.554330825805664
Time for copying to cuda: 0.7896881103515625
Time for forward pass: 0.6394922733306885
Time for backpropagation: 0.004446268081665039
GPU memory for training: 8.724570751190186                          

Memory occpied: (7668.0, 4508.0)
One training iteration takes: 4.467668533325195 seconds
Index: 3
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 65.31352710723877 seconds
Memory occpied: (7668.0, 4508.0)
Streaming imagenet data took 66.46958780288696 seconds
Then, training+dataloading take 66.63288521766663 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.5533854961395264
Time for copying to cuda: 0.78741455078125
Time for forward pass: 0.6349966526031494
Time for backpropagation: 0.004422903060913086
GPU memory for training: 8.724570751190186                          

Memory occpied: (7668.0, 4508.0)
One training iteration takes: 4.452022075653076 seconds
Index: 4
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 69.44087982177734 seconds
Memory occpied: (7668.0, 4508.0)
Streaming imagenet data took 70.81427502632141 seconds
Then, training+dataloading take 70.98400664329529 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.4601922035217285
Time for copying to cuda: 0.7838568687438965
Time for forward pass: 0.6534559726715088
Time for backpropagation: 0.004480838775634766
GPU memory for training: 8.724570751190186                          

One training iteration takes: 4.46061110496521 seconds
Index: 5
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Memory occpied: (7668.0, 4508.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 27.661277532577515 seconds
Streaming imagenet data took 27.94835114479065 seconds
Then, training+dataloading take 27.992876529693604 seconds

Epoch: 0
Memory occpied: (7668.0, 4508.0)
Time of next(dataloader) is: 1.095191240310669
Time for copying to cuda: 0.19920992851257324
Time for forward pass: 0.2505176067352295
Time for backpropagation: 0.004157304763793945
GPU memory for training: 4.476007461547852                          

The whole process took 468.0519595146179 seconds
