Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, manual_split=False, model='myresnet18', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=True, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.0809825633467 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
Intermediate:  1148.4375
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.587310314178467 seconds
Streaming imagenet data took 7.65886926651001 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4484233856201172
Time for copying to cuda: 0.05009269714355469
Memory occpied: (1504.0, 278.0)
Memory occpied: (1504.0, 692.0)
Memory occpied: (1504.0, 1152.0)
Memory occpied: (6984.0, 6858.0)
Time for forward pass: 4.253415822982788
Memory occpied: (6958.0, 12170.0)
Time for backpropagation: 1.493605375289917
GPU memory for training: 11.528353214263916                          

One training iteration takes: 6.329119920730591 seconds
Index: 0
Memory occpied: (6962.0, 6834.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.874002933502197 seconds
Streaming imagenet data took 7.945566892623901 seconds
Then, training+dataloading take 7.959920406341553 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5742106437683105
Time for copying to cuda: 0.049744367599487305
Time for forward pass: 0.09524416923522949
Time for backpropagation: 0.004729747772216797
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8573579788208008 seconds
Index: 1
Memory occpied: (6962.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.6563720703125 seconds
Streaming imagenet data took 7.728165149688721 seconds
Then, training+dataloading take 7.737826585769653 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5724809169769287
Time for copying to cuda: 0.04982280731201172
Time for forward pass: 0.09666633605957031
Time for backpropagation: 0.00538182258605957
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.8284769058227539 seconds
Index: 2
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.56708836555481 seconds
Streaming imagenet data took 7.639068603515625 seconds
Then, training+dataloading take 7.650829076766968 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5848631858825684
Time for copying to cuda: 0.04981350898742676
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09540128707885742
Time for backpropagation: 0.00462651252746582
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8322491645812988 seconds
Index: 3
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.5211992263793945 seconds
Streaming imagenet data took 7.594688892364502 seconds
Then, training+dataloading take 7.607879400253296 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5410420894622803
Time for copying to cuda: 0.09724235534667969
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.0954744815826416
Time for backpropagation: 0.004658222198486328
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.838843584060669 seconds
Index: 4
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.668967247009277 seconds
Streaming imagenet data took 7.742897033691406 seconds
Then, training+dataloading take 7.752695560455322 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.5726385116577148
Time for copying to cuda: 0.0500485897064209
Time for forward pass: 0.09522175788879395
Time for backpropagation: 0.004679203033447266
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8217599391937256 seconds
Index: 5
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.822805404663086 seconds
Streaming imagenet data took 7.895416736602783 seconds
Then, training+dataloading take 7.909483909606934 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5714559555053711
Time for copying to cuda: 0.050337791442871094
Time for forward pass: 0.09529232978820801
Time for backpropagation: 0.004658222198486328
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8684210777282715 seconds
Index: 6
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.58588719367981 seconds
Streaming imagenet data took 7.658638954162598 seconds
Then, training+dataloading take 7.673598527908325 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5167114734649658
Time for copying to cuda: 0.09579277038574219
Time for forward pass: 0.09741854667663574
Time for backpropagation: 0.006239652633666992
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.8367617130279541 seconds
Index: 7
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.056103944778442 seconds
Streaming imagenet data took 8.179429054260254 seconds
Then, training+dataloading take 8.194453954696655 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.5995001792907715
Time for copying to cuda: 0.050020694732666016
Time for forward pass: 0.09533524513244629
Time for backpropagation: 0.004599094390869141
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8471150398254395 seconds
Index: 8
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.799274444580078 seconds
Streaming imagenet data took 7.8717663288116455 seconds
Then, training+dataloading take 7.886770963668823 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5021307468414307
Time for copying to cuda: 0.05005931854248047
Time for forward pass: 0.0971517562866211
Time for backpropagation: 0.004664182662963867
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7742011547088623 seconds
Index: 9
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.581924676895142 seconds
Streaming imagenet data took 7.6556782722473145 seconds
Then, training+dataloading take 7.6715087890625 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5354170799255371
Time for copying to cuda: 0.05022859573364258
Time for forward pass: 0.13533806800842285
Time for backpropagation: 0.006244659423828125
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8574943542480469 seconds
Index: 10
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.783813238143921 seconds
Streaming imagenet data took 7.856252670288086 seconds
Then, training+dataloading take 7.870898962020874 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6083762645721436
Time for copying to cuda: 0.04975104331970215
Time for forward pass: 0.09524321556091309
Time for backpropagation: 0.004929542541503906
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.9030160903930664 seconds
Index: 11
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.535705089569092 seconds
Streaming imagenet data took 7.607892990112305 seconds
Then, training+dataloading take 7.623208999633789 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5508284568786621
Time for copying to cuda: 0.09660053253173828
Time for forward pass: 0.12440967559814453
Time for backpropagation: 0.006327390670776367
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.9026646614074707 seconds
Index: 12
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.737039804458618 seconds
Streaming imagenet data took 7.808924913406372 seconds
Then, training+dataloading take 7.824102163314819 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.5866320133209229
Time for copying to cuda: 0.049818992614746094
Time for forward pass: 0.09527921676635742
Time for backpropagation: 0.004656314849853516
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8337488174438477 seconds
Index: 13
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.134775638580322 seconds
Memory occpied: (6978.0, 6850.0)
Streaming imagenet data took 8.20648193359375 seconds
Then, training+dataloading take 8.221474170684814 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5410995483398438
Time for copying to cuda: 0.05007791519165039
Time for forward pass: 0.09507060050964355
Time for backpropagation: 0.004546165466308594
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7887687683105469 seconds
Index: 14
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.93824028968811 seconds
Streaming imagenet data took 8.009634494781494 seconds
Then, training+dataloading take 8.02426028251648 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5034544467926025
Time for copying to cuda: 0.05039072036743164
Time for forward pass: 0.09674072265625
Time for backpropagation: 0.006258487701416016
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.7864787578582764 seconds
Index: 15
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.756523370742798 seconds
Streaming imagenet data took 7.830251455307007 seconds
Then, training+dataloading take 7.844332218170166 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5768578052520752
Time for copying to cuda: 0.05045723915100098
Time for forward pass: 0.09602785110473633
Time for backpropagation: 0.00461888313293457
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.8410160541534424 seconds
Index: 16
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.84409236907959 seconds
Streaming imagenet data took 7.91811466217041 seconds
Then, training+dataloading take 7.932366609573364 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5522494316101074
Time for copying to cuda: 0.05013298988342285
Time for forward pass: 0.09978580474853516
Time for backpropagation: 0.004655599594116211
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8401896953582764 seconds
Index: 17
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.856663703918457 seconds
Streaming imagenet data took 7.929162502288818 seconds
Then, training+dataloading take 7.944357633590698 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5547020435333252
Time for copying to cuda: 0.04986071586608887
Time for forward pass: 0.09528160095214844
Time for backpropagation: 0.004984617233276367
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8368961811065674 seconds
Index: 18
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.6213507652282715 seconds
Streaming imagenet data took 7.696109056472778 seconds
Then, training+dataloading take 7.711581230163574 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5400218963623047
Time for copying to cuda: 0.09439206123352051
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09544801712036133
Time for backpropagation: 0.004597902297973633
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8559794425964355 seconds
Index: 19
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.646501541137695 seconds
Streaming imagenet data took 7.719771862030029 seconds
Then, training+dataloading take 7.7347471714019775 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5863814353942871
Time for copying to cuda: 0.05004525184631348
Time for forward pass: 0.09557032585144043
Time for backpropagation: 0.004724740982055664
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8668103218078613 seconds
Index: 20
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.704119443893433 seconds
Streaming imagenet data took 7.776907920837402 seconds
Then, training+dataloading take 7.791420936584473 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5938012599945068
Time for copying to cuda: 0.05017662048339844
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09536218643188477
Time for backpropagation: 0.004749774932861328
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8415005207061768 seconds
Index: 21
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.602121353149414 seconds
Streaming imagenet data took 7.674824476242065 seconds
Then, training+dataloading take 7.689298629760742 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.570382833480835
Time for copying to cuda: 0.04984641075134277
Time for forward pass: 0.09513616561889648
Time for backpropagation: 0.004615068435668945
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8643612861633301 seconds
Index: 22
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.945523738861084 seconds
Streaming imagenet data took 8.01793622970581 seconds
Then, training+dataloading take 8.03232192993164 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.6200246810913086
Time for copying to cuda: 0.0496213436126709
Time for forward pass: 0.09528708457946777
Time for backpropagation: 0.004725933074951172
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.9240870475769043 seconds
Index: 23
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.634847402572632 seconds
Streaming imagenet data took 7.7089173793792725 seconds
Then, training+dataloading take 7.7242913246154785 seconds

Epoch: 0
Time of next(dataloader) is: 0.5722572803497314
Time for copying to cuda: 0.04967975616455078
Time for forward pass: 0.09512805938720703
Time for backpropagation: 0.004551887512207031
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
The whole process took 203.68420243263245 seconds
