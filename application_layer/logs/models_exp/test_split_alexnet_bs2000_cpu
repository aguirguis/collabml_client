Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='myalexnet', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=False, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.3378751371181 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
Intermediate:  70.3125
4.037109375
Total layers size  4.189361572265625
Candidate split  13
Server, client, server+client, vanilla  348.3644104003906 709.2774963378906 1057.6419067382812 9861.62124633789
Model size  233.08120727539062
Fixed, scale_with_bsz  233.08120727539062 4.611328125
Mem usage  1250.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.213126420974731 seconds
Streaming imagenet data took 9.240328311920166 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4256453514099121
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.492708683013916
Time for backpropagation: 0.17587733268737793
One training iteration takes: 1.1884002685546875 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.19740605354309 seconds
Streaming imagenet data took 9.28551435470581 seconds
Then, training+dataloading take 9.293554067611694 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4093327522277832
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.35192012786865234
Time for backpropagation: 0.2600226402282715
One training iteration takes: 1.2011783123016357 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.92128610610962 seconds
Streaming imagenet data took 8.94950556755066 seconds
Then, training+dataloading take 8.954111337661743 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42165708541870117
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.36742424964904785
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.5267012119293213
One training iteration takes: 1.4279189109802246 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.959618091583252 seconds
Streaming imagenet data took 8.987282276153564 seconds
Then, training+dataloading take 8.991899490356445 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42605090141296387
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.5520439147949219
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2856593132019043
One training iteration takes: 1.394629955291748 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.017304182052612 seconds
Streaming imagenet data took 9.04563307762146 seconds
Then, training+dataloading take 9.050050973892212 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46633124351501465
Time for copying to cuda: 1.4543533325195312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.47126269340515137
Time for backpropagation: 0.2719695568084717
One training iteration takes: 1.3525950908660889 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.268937826156616 seconds
Streaming imagenet data took 9.29796290397644 seconds
Then, training+dataloading take 9.303253889083862 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4160017967224121
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.371204137802124
Time for backpropagation: 0.3009212017059326
One training iteration takes: 1.2462444305419922 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.658129692077637 seconds
Streaming imagenet data took 9.685551404953003 seconds
Then, training+dataloading take 9.690831899642944 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4594414234161377
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.36676645278930664
Time for backpropagation: 0.2816460132598877
One training iteration takes: 1.2595384120941162 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.433478116989136 seconds
Streaming imagenet data took 9.461383581161499 seconds
Then, training+dataloading take 9.466054439544678 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4673473834991455
Time for copying to cuda: 1.2159347534179688e-05
Time for forward pass: 0.3831937313079834
Time for backpropagation: 0.26282525062561035
One training iteration takes: 1.2695934772491455 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.449506521224976 seconds
Streaming imagenet data took 9.478192806243896 seconds
Then, training+dataloading take 9.482711791992188 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5125188827514648
Time for copying to cuda: 1.2159347534179688e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.36472511291503906
Time for backpropagation: 0.23322796821594238
One training iteration takes: 1.233095645904541 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.473228693008423 seconds
Streaming imagenet data took 9.50075888633728 seconds
Then, training+dataloading take 9.504462718963623 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44508981704711914
Time for copying to cuda: 1.0728836059570312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6190860271453857
Time for backpropagation: 0.26502299308776855
One training iteration takes: 1.4586799144744873 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.302856922149658 seconds
Streaming imagenet data took 9.330602645874023 seconds
Then, training+dataloading take 9.334068059921265 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49356913566589355
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.35338568687438965
Time for backpropagation: 0.26113009452819824
One training iteration takes: 1.2554621696472168 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.001430034637451 seconds
Streaming imagenet data took 9.028884410858154 seconds
Then, training+dataloading take 9.033257961273193 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4266629219055176
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.6422936916351318
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2696058750152588
One training iteration takes: 1.4574322700500488 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.977551221847534 seconds
Streaming imagenet data took 9.005218744277954 seconds
Then, training+dataloading take 9.009643316268921 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4109678268432617
Time for copying to cuda: 1.049041748046875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5975198745727539
Time for backpropagation: 0.27367091178894043
One training iteration takes: 1.415041208267212 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.960785150527954 seconds
Streaming imagenet data took 8.988319158554077 seconds
Then, training+dataloading take 8.992886781692505 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46344637870788574
Time for copying to cuda: 1.1205673217773438e-05
Time for forward pass: 0.37011098861694336
Time for backpropagation: 0.2635784149169922
One training iteration takes: 1.2726683616638184 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.142177104949951 seconds
Streaming imagenet data took 9.170049905776978 seconds
Then, training+dataloading take 9.17412781715393 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4257631301879883
Time for copying to cuda: 1.1920928955078125e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6302845478057861
Time for backpropagation: 0.24402952194213867
One training iteration takes: 1.4504024982452393 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.42529845237732 seconds
Streaming imagenet data took 9.453445434570312 seconds
Then, training+dataloading take 9.457736730575562 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.469768762588501
Time for copying to cuda: 1.33514404296875e-05
Time for forward pass: 0.3877699375152588
Time for backpropagation: 0.22619271278381348
One training iteration takes: 1.2359910011291504 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.366547584533691 seconds
Streaming imagenet data took 9.394789695739746 seconds
Then, training+dataloading take 9.399647235870361 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4256165027618408
Time for copying to cuda: 1.239776611328125e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.4882233142852783
Time for backpropagation: 0.27426838874816895
One training iteration takes: 1.3162574768066406 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.543775081634521 seconds
Streaming imagenet data took 9.571702718734741 seconds
Then, training+dataloading take 9.576729536056519 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4648466110229492
Time for copying to cuda: 1.0967254638671875e-05
Time for forward pass: 0.5760560035705566
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2730245590209961
One training iteration takes: 1.4516119956970215 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.333201169967651 seconds
Streaming imagenet data took 9.360511064529419 seconds
Then, training+dataloading take 9.363385677337646 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48554372787475586
Time for copying to cuda: 1.0967254638671875e-05
Time for forward pass: 0.37044334411621094
Time for backpropagation: 0.25899410247802734
One training iteration takes: 1.287038803100586 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.330221891403198 seconds
Streaming imagenet data took 9.358190774917603 seconds
Then, training+dataloading take 9.363333225250244 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41640710830688477
Time for copying to cuda: 1.1444091796875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6021020412445068
Time for backpropagation: 0.2569587230682373
One training iteration takes: 1.3921949863433838 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.264876365661621 seconds
Streaming imagenet data took 9.336773157119751 seconds
Then, training+dataloading take 9.345137119293213 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4621303081512451
Time for copying to cuda: 1.33514404296875e-05
Time for forward pass: 0.36017632484436035
Time for backpropagation: 0.26350855827331543
One training iteration takes: 1.2220418453216553 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.37629747390747 seconds
Streaming imagenet data took 9.4037446975708 seconds
Then, training+dataloading take 9.409034252166748 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42261338233947754
Time for copying to cuda: 1.0967254638671875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6436672210693359
Time for backpropagation: 0.24189138412475586
One training iteration takes: 1.4497151374816895 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.08131742477417 seconds
Streaming imagenet data took 9.109083414077759 seconds
Then, training+dataloading take 9.11349368095398 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4649226665496826
Time for copying to cuda: 1.1444091796875e-05
Time for forward pass: 0.3602602481842041
Time for backpropagation: 0.2711036205291748
One training iteration takes: 1.2509324550628662 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.367525577545166 seconds
Streaming imagenet data took 9.39563775062561 seconds
Then, training+dataloading take 9.400882482528687 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44234561920166016
Time for copying to cuda: 1.5735626220703125e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.46323347091674805
Time for backpropagation: 0.2587578296661377
One training iteration takes: 1.317244291305542 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.406148195266724 seconds
Streaming imagenet data took 9.496334552764893 seconds
Then, training+dataloading take 9.50398325920105 seconds

Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.45774173736572266
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.3684067726135254
Time for backpropagation: 0.23342633247375488
Memory occpied: (1250.0, 3.0)
The whole process took 241.22340726852417 seconds
