Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.2505771066537 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.    4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 20
Intermediate:  3062.5
29.28515625
Total layers size  29.767486572265625
Fixed, scale_with_bsz  30.436920166015625 29.859375
Mem usage  1250.0 3.0
Using split index: 18
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 42.172675371170044 seconds
Memory occpied: (1294.0, 3.0)
Streaming imagenet data took 43.4009850025177 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Time of next(dataloader) is: 2.2421681880950928
Memory occpied: (4358.0, 3.0)
Time for copying to cuda: 0.8515067100524902
Memory occpied: (4358.0, 1904.0)
Memory occpied: (4358.0, 2366.0)
Memory occpied: (4358.0, 2780.0)
Memory occpied: (15010.0, 13760.0)
Memory occpied: (9784.0, 14922.0)
Memory occpied: (13402.0, 11746.0)
Time for forward pass: 8.0427885055542
Time for backpropagation: 0.07015275955200195
GPU memory for training: 19.22982931137085                          

One training iteration takes: 11.632718801498413 seconds
Index: 0
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 41.818973541259766 seconds
Memory occpied: (8020.0, 11778.0)
Streaming imagenet data took 43.06563758850098 seconds
Then, training+dataloading take 43.20338463783264 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (8020.0, 11778.0)
Memory occpied: (8020.0, 11778.0)
Time of next(dataloader) is: 2.5148019790649414
Memory occpied: (8020.0, 11778.0)
Time for copying to cuda: 0.9065544605255127
Time for forward pass: 0.964698076248169
Time for backpropagation: 0.08007144927978516
GPU memory for training: 9.852764129638672                          

Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
One training iteration takes: 9.81782341003418 seconds
Index: 1
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 45.46510314941406 seconds
Memory occpied: (8036.0, 11794.0)
Streaming imagenet data took 46.78934907913208 seconds
Then, training+dataloading take 46.94502329826355 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Time of next(dataloader) is: 2.4166910648345947
Time for copying to cuda: 0.841045618057251
Memory occpied: (8036.0, 11794.0)
Time for forward pass: 0.9709930419921875
Time for backpropagation: 0.011833429336547852
GPU memory for training: 9.852764129638672                          

One training iteration takes: 4.834076166152954 seconds
Index: 2
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 44.785459995269775 seconds
Streaming imagenet data took 46.02285957336426 seconds
Then, training+dataloading take 46.179229736328125 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.407078981399536
Time for copying to cuda: 0.777367353439331
Time for forward pass: 0.9801111221313477
Time for backpropagation: 0.011907577514648438
GPU memory for training: 9.852764129638672                          

Memory occpied: (8036.0, 11794.0)
One training iteration takes: 4.61371111869812 seconds
Index: 3
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 45.66094660758972 seconds
Memory occpied: (8036.0, 11794.0)
Streaming imagenet data took 46.783390283584595 seconds
Then, training+dataloading take 47.00172233581543 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.430356740951538
Time for copying to cuda: 0.7812376022338867
Time for forward pass: 0.9633698463439941
Time for backpropagation: 0.011693000793457031
GPU memory for training: 9.852764129638672                          

Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
One training iteration takes: 9.539541482925415 seconds
Index: 4
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 43.846723318099976 seconds
Memory occpied: (8036.0, 11794.0)
Streaming imagenet data took 45.0762734413147 seconds
Then, training+dataloading take 45.23341703414917 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.4645299911499023
Time for copying to cuda: 0.7818295955657959
Time for forward pass: 0.9932403564453125
Time for backpropagation: 0.011801481246948242
GPU memory for training: 9.852764129638672                          

Memory occpied: (8036.0, 11794.0)
One training iteration takes: 4.709463596343994 seconds
Index: 5
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Memory occpied: (8036.0, 11794.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 17.889857053756714 seconds
Memory occpied: (8036.0, 11794.0)
Streaming imagenet data took 18.24987244606018 seconds
Then, training+dataloading take 18.291117191314697 seconds

Epoch: 0
Time of next(dataloader) is: 1.0140981674194336
Memory occpied: (8036.0, 11794.0)
Time for copying to cuda: 0.19853591918945312
Memory occpied: (8012.0, 7986.0)
Time for forward pass: 1.6345374584197998
Time for backpropagation: 0.033469200134277344
GPU memory for training: 7.133565425872803                          

The whole process took 299.9830403327942 seconds
