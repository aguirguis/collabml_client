Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.2679773171154 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 21
Intermediate:  15.625
110.736328125
Total layers size  110.74014282226562
Fixed, scale_with_bsz  97.49234008789062 111.310546875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.193600177764893 seconds
Streaming imagenet data took 10.200985670089722 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.362454891204834
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.022440671920776367
Time for backpropagation: 0.294968843460083
One training iteration takes: 0.7818326950073242 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.731507778167725 seconds
Streaming imagenet data took 7.738937854766846 seconds
Then, training+dataloading take 7.739780902862549 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36730527877807617
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.03040790557861328
Time for backpropagation: 0.07674336433410645
One training iteration takes: 0.5796413421630859 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 9.904473066329956 seconds
Streaming imagenet data took 9.911787271499634 seconds
Then, training+dataloading take 9.912705898284912 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37179017066955566
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.027053356170654297
Time for backpropagation: 0.06706595420837402
One training iteration takes: 0.593597412109375 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.017751932144165 seconds
Streaming imagenet data took 10.022841215133667 seconds
Then, training+dataloading take 10.023762464523315 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37633728981018066
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.02680182456970215
Time for backpropagation: 0.053856611251831055
One training iteration takes: 0.5617847442626953 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.216015100479126 seconds
Streaming imagenet data took 10.224915742874146 seconds
Then, training+dataloading take 10.226033687591553 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.34038567543029785
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.027744054794311523
Time for backpropagation: 0.05142974853515625
One training iteration takes: 0.49228596687316895 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.820507764816284 seconds
Streaming imagenet data took 7.825890064239502 seconds
Then, training+dataloading take 7.827583312988281 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32672643661499023
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.029709815979003906
Time for backpropagation: 0.12677550315856934
One training iteration takes: 0.5821218490600586 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.253183126449585 seconds
Streaming imagenet data took 10.2579505443573 seconds
Then, training+dataloading take 10.258860349655151 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32480835914611816
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.029888629913330078
Time for backpropagation: 0.0694279670715332
One training iteration takes: 0.5153830051422119 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.15912914276123 seconds
Streaming imagenet data took 10.164438247680664 seconds
Then, training+dataloading take 10.165390014648438 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3274233341217041
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.026843786239624023
Time for backpropagation: 0.11815381050109863
One training iteration takes: 0.557187557220459 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.401658058166504 seconds
Streaming imagenet data took 10.406613111495972 seconds
Then, training+dataloading take 10.40753960609436 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32930684089660645
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.027452707290649414
Time for backpropagation: 0.07222104072570801
One training iteration takes: 0.5002865791320801 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.775908708572388 seconds
Streaming imagenet data took 7.7813029289245605 seconds
Then, training+dataloading take 7.782241344451904 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36678647994995117
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.028827428817749023
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.07311105728149414
One training iteration takes: 0.5873732566833496 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.048889875411987 seconds
Streaming imagenet data took 10.057436466217041 seconds
Then, training+dataloading take 10.05848240852356 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3309319019317627
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.026948213577270508
Time for backpropagation: 0.07638859748840332
One training iteration takes: 0.5085957050323486 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.012796878814697 seconds
Streaming imagenet data took 10.018098831176758 seconds
Then, training+dataloading take 10.019074440002441 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33410143852233887
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.03071451187133789
Time for backpropagation: 0.06878829002380371
One training iteration takes: 0.5284535884857178 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.259115219116211 seconds
Streaming imagenet data took 10.30497932434082 seconds
Then, training+dataloading take 10.311507940292358 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37281274795532227
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.03616070747375488
Time for backpropagation: 0.056372880935668945
Memory occpied: (1250.0, 3.0)
One training iteration takes: 0.5376489162445068 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.768236398696899 seconds
Streaming imagenet data took 7.773609161376953 seconds
Then, training+dataloading take 7.776072978973389 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3279266357421875
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.027042865753173828
Time for backpropagation: 0.07638001441955566
One training iteration takes: 0.5059812068939209 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.127955675125122 seconds
Streaming imagenet data took 10.132790565490723 seconds
Then, training+dataloading take 10.133676767349243 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32955217361450195
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.026767969131469727
Time for backpropagation: 0.12550973892211914
One training iteration takes: 0.5958945751190186 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.2375328540802 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 10.242958545684814 seconds
Then, training+dataloading take 10.244555473327637 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3310675621032715
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.027942657470703125
Time for backpropagation: 0.080352783203125
One training iteration takes: 0.5170924663543701 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.146278619766235 seconds
Streaming imagenet data took 10.151308298110962 seconds
Then, training+dataloading take 10.152216911315918 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32943248748779297
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.0311739444732666
Time for backpropagation: 0.06344056129455566
One training iteration takes: 0.5313565731048584 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.801111698150635 seconds
Streaming imagenet data took 7.8102126121521 seconds
Then, training+dataloading take 7.81129789352417 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.33648204803466797
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.026851654052734375
Time for backpropagation: 0.07905268669128418
One training iteration takes: 0.5487504005432129 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.149958610534668 seconds
Streaming imagenet data took 10.154876470565796 seconds
Then, training+dataloading take 10.15659213066101 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3310520648956299
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.024551868438720703
Time for backpropagation: 0.07551193237304688
One training iteration takes: 0.5441977977752686 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.428359270095825 seconds
Streaming imagenet data took 10.433668613433838 seconds
Then, training+dataloading take 10.43460726737976 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3269040584564209
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.027448415756225586
Time for backpropagation: 0.07687687873840332
One training iteration takes: 0.5005419254302979 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.178260087966919 seconds
Streaming imagenet data took 10.183122158050537 seconds
Then, training+dataloading take 10.184047937393188 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3707160949707031
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.031661272048950195
Time for backpropagation: 0.07065033912658691
One training iteration takes: 0.5804498195648193 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.8374528884887695 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 7.843080043792725 seconds
Then, training+dataloading take 7.844695806503296 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.333904504776001
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.025278329849243164
Time for backpropagation: 0.05379438400268555
One training iteration takes: 0.49808526039123535 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.190718650817871 seconds
Streaming imagenet data took 10.195693254470825 seconds
Then, training+dataloading take 10.196635246276855 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3325824737548828
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.02668285369873047
Time for backpropagation: 0.15712928771972656
One training iteration takes: 0.5923924446105957 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.454079151153564 seconds
Streaming imagenet data took 10.459394216537476 seconds
Then, training+dataloading take 10.460302114486694 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33081698417663574
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.027184486389160156
Time for backpropagation: 0.07804656028747559
One training iteration takes: 0.5058548450469971 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.097481966018677 seconds
Streaming imagenet data took 10.102348566055298 seconds
Then, training+dataloading take 10.103243827819824 seconds

Epoch: 0
Time of next(dataloader) is: 0.35507965087890625
Time for copying to cuda: 9.298324584960938e-06
Time for forward pass: 0.030796051025390625
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.12624049186706543
The whole process took 248.18113780021667 seconds
