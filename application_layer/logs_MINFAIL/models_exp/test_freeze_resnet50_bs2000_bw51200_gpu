Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 44.45363472565532 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([], dtype=int64),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 21
Intermediate:  15.625
110.736328125
Total layers size  110.74014282226562
Fixed, scale_with_bsz  97.49234008789062 111.310546875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.92794942855835 seconds
Streaming imagenet data took 12.93531060218811 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3973369598388672
Time for copying to cuda: 0.005110740661621094
Time for forward pass: 3.033519983291626
Time for backpropagation: 0.06737685203552246
GPU memory for training: 0.4394540786743164                          

One training iteration takes: 3.6063921451568604 seconds
Index: 0
Memory occpied: (1366.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.152530670166016 seconds
Streaming imagenet data took 10.159709930419922 seconds
Then, training+dataloading take 10.160681009292603 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3791923522949219
Time for copying to cuda: 0.004422426223754883
Time for forward pass: 0.020474910736083984
Time for backpropagation: 0.007391452789306641
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.48506689071655273 seconds
Index: 1
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.054072141647339 seconds
Streaming imagenet data took 10.061326265335083 seconds
Then, training+dataloading take 10.062928199768066 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38153815269470215
Time for copying to cuda: 0.004435539245605469
Time for forward pass: 0.020566940307617188
Time for backpropagation: 0.006487369537353516
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5202112197875977 seconds
Index: 2
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 9.950762510299683 seconds
Streaming imagenet data took 9.95591402053833 seconds
Then, training+dataloading take 9.956865787506104 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4359126091003418
Time for copying to cuda: 0.004573345184326172
Time for forward pass: 0.023543357849121094
Time for backpropagation: 0.0070209503173828125
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5810267925262451 seconds
Index: 3
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.360869646072388 seconds
Streaming imagenet data took 12.365789413452148 seconds
Then, training+dataloading take 12.367404222488403 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.409191370010376
Time for copying to cuda: 0.004495859146118164
Time for forward pass: 0.02085280418395996
Time for backpropagation: 0.006570577621459961
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5398948192596436 seconds
Index: 4
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.196717023849487 seconds
Streaming imagenet data took 10.201529026031494 seconds
Then, training+dataloading take 10.202386617660522 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.423567533493042
Time for copying to cuda: 0.00439453125
Time for forward pass: 0.020518779754638672
Time for backpropagation: 0.0065059661865234375
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5698873996734619 seconds
Index: 5
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.46697735786438 seconds
Streaming imagenet data took 10.475954055786133 seconds
Then, training+dataloading take 10.47964334487915 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.41802334785461426
Time for copying to cuda: 0.00447535514831543
Time for forward pass: 0.0204927921295166
Time for backpropagation: 0.006364345550537109
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5521426200866699 seconds
Index: 6
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.17523193359375 seconds
Streaming imagenet data took 10.180209159851074 seconds
Then, training+dataloading take 10.181805610656738 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42109155654907227
Time for copying to cuda: 0.0044269561767578125
Time for forward pass: 0.020426511764526367
Time for backpropagation: 0.006470680236816406
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5387871265411377 seconds
Index: 7
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.192151308059692 seconds
Streaming imagenet data took 13.196988821029663 seconds
Then, training+dataloading take 13.197824001312256 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43677854537963867
Time for copying to cuda: 0.004426479339599609
Time for forward pass: 0.020537853240966797
Time for backpropagation: 0.006482839584350586
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5827629566192627 seconds
Index: 8
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.216470003128052 seconds
Streaming imagenet data took 10.221370697021484 seconds
Then, training+dataloading take 10.222252368927002 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43425965309143066
Time for copying to cuda: 0.004468202590942383
Time for forward pass: 0.020493268966674805
Time for backpropagation: 0.006558895111083984
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.6046047210693359 seconds
Index: 9
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.023606300354004 seconds
Streaming imagenet data took 10.028573513031006 seconds
Then, training+dataloading take 10.029471635818481 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4409964084625244
Time for copying to cuda: 0.004474163055419922
Time for forward pass: 0.020578622817993164
Time for backpropagation: 0.00662541389465332
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5896077156066895 seconds
Index: 10
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.092795372009277 seconds
Streaming imagenet data took 10.099931716918945 seconds
Then, training+dataloading take 10.10078239440918 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.502199649810791
Time for copying to cuda: 0.004489421844482422
Memory occpied: (1644.0, 1416.0)
Time for forward pass: 0.020958900451660156
Time for backpropagation: 0.0067138671875
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.6261982917785645 seconds
Index: 11
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.650193214416504 seconds
Streaming imagenet data took 12.659142971038818 seconds
Then, training+dataloading take 12.66288709640503 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.42449522018432617
Time for copying to cuda: 0.004468441009521484
Time for forward pass: 0.020576000213623047
Time for backpropagation: 0.006308555603027344
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5493149757385254 seconds
Index: 12
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.346808671951294 seconds
Streaming imagenet data took 10.351635694503784 seconds
Then, training+dataloading take 10.35335922241211 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3831493854522705
Time for copying to cuda: 0.004476308822631836
Time for forward pass: 0.020465373992919922
Time for backpropagation: 0.00643610954284668
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5018701553344727 seconds
Index: 13
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.280461549758911 seconds
Streaming imagenet data took 10.285411834716797 seconds
Then, training+dataloading take 10.28629732131958 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43929266929626465
Time for copying to cuda: 0.004504680633544922
Time for forward pass: 0.020975828170776367
Time for backpropagation: 0.00662994384765625
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5830276012420654 seconds
Index: 14
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.015454292297363 seconds
Streaming imagenet data took 10.020379543304443 seconds
Then, training+dataloading take 10.021275997161865 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44631361961364746
Time for copying to cuda: 0.0045375823974609375
Time for forward pass: 0.02040386199951172
Time for backpropagation: 0.006397724151611328
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5941572189331055 seconds
Index: 15
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.03565788269043 seconds
Streaming imagenet data took 13.040370464324951 seconds
Then, training+dataloading take 13.041244745254517 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4161031246185303
Time for copying to cuda: 0.004437446594238281
Time for forward pass: 0.020502567291259766
Time for backpropagation: 0.0065877437591552734
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5213291645050049 seconds
Index: 16
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.208086252212524 seconds
Streaming imagenet data took 10.212820053100586 seconds
Then, training+dataloading take 10.213693141937256 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4183533191680908
Time for copying to cuda: 0.004484415054321289
Time for forward pass: 0.020545244216918945
Time for backpropagation: 0.006567239761352539
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5237338542938232 seconds
Index: 17
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 9.952042818069458 seconds
Streaming imagenet data took 9.957010507583618 seconds
Then, training+dataloading take 9.958617210388184 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3931615352630615
Time for copying to cuda: 0.004458427429199219
Time for forward pass: 0.02045893669128418
Time for backpropagation: 0.006367921829223633
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5200319290161133 seconds
Index: 18
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.056758642196655 seconds
Streaming imagenet data took 10.061599731445312 seconds
Then, training+dataloading take 10.06316351890564 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4798154830932617
Time for copying to cuda: 0.004534244537353516
Time for forward pass: 0.02115488052368164
Time for backpropagation: 0.0068395137786865234
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
One training iteration takes: 0.6094205379486084 seconds
Index: 19
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.947734832763672 seconds
Streaming imagenet data took 12.952762126922607 seconds
Then, training+dataloading take 12.954326868057251 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3797607421875
Time for copying to cuda: 0.004498481750488281
Time for forward pass: 0.020623445510864258
Time for backpropagation: 0.0066068172454833984
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4853060245513916 seconds
Index: 20
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.127202033996582 seconds
Streaming imagenet data took 10.132158994674683 seconds
Then, training+dataloading take 10.133036851882935 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40633344650268555
Time for copying to cuda: 0.004439830780029297
Time for forward pass: 0.020435094833374023
Time for backpropagation: 0.0063934326171875
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5271377563476562 seconds
Index: 21
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.147092819213867 seconds
Streaming imagenet data took 10.151965618133545 seconds
Then, training+dataloading take 10.152862310409546 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4512672424316406
Time for copying to cuda: 0.004496335983276367
Time for forward pass: 0.06305599212646484
Time for backpropagation: 0.006788015365600586
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
One training iteration takes: 0.6005911827087402 seconds
Index: 22
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.363351345062256 seconds
Streaming imagenet data took 10.372294425964355 seconds
Then, training+dataloading take 10.376075267791748 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.4295520782470703
Time for copying to cuda: 0.00455164909362793
Time for forward pass: 0.020598649978637695
Time for backpropagation: 0.006505727767944336
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.568415641784668 seconds
Index: 23
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.170270681381226 seconds
Streaming imagenet data took 13.175285577774048 seconds
Then, training+dataloading take 13.176279067993164 seconds

Epoch: 0
Time of next(dataloader) is: 0.44081783294677734
Time for copying to cuda: 0.00454258918762207
Time for forward pass: 0.020628690719604492
Time for backpropagation: 0.00652623176574707
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
The whole process took 281.42227005958557 seconds
