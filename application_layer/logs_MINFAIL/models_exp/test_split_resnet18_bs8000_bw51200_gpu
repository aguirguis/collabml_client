Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 44.42014631651151 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  4593.75
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 146.3857913017273 seconds
Streaming imagenet data took 146.67528915405273 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1312.0, 3.0)
Time of next(dataloader) is: 0.8905525207519531
Time for copying to cuda: 0.19680023193359375
Memory occpied: (2078.0, 632.0)
Memory occpied: (2078.0, 1074.0)
Memory occpied: (2078.0, 1516.0)
Memory occpied: (7594.0, 7182.0)
Time for forward pass: 5.423476934432983
Memory occpied: (7568.0, 12276.0)
Memory occpied: (12654.0, 12276.0)
Memory occpied: (12654.0, 7164.0)
Memory occpied: (12654.0, 7164.0)
Time for backpropagation: 4.783477306365967
GPU memory for training: 14.14211130142212                          

One training iteration takes: 11.429466962814331 seconds
Index: 0
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Memory occpied: (7572.0, 1676.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 147.30162858963013 seconds
Memory occpied: (7572.0, 1676.0)
Streaming imagenet data took 147.65588688850403 seconds
Then, training+dataloading take 147.70001316070557 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.934945821762085
Memory occpied: (7572.0, 1676.0)
Time for copying to cuda: 0.26934361457824707
Time for forward pass: 0.3315727710723877
Time for backpropagation: 0.0051212310791015625
GPU memory for training: 8.730688571929932                          

Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
One training iteration takes: 6.6440136432647705 seconds
Index: 1
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 146.2763752937317 seconds
Streaming imagenet data took 146.56525254249573 seconds
Then, training+dataloading take 146.61551356315613 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (7588.0, 6682.0)
Time of next(dataloader) is: 0.9824378490447998
Time for copying to cuda: 0.19942617416381836
Time for forward pass: 0.34770989418029785
Time for backpropagation: 0.0050656795501708984
GPU memory for training: 8.730311393737793                          

One training iteration takes: 1.7276015281677246 seconds
Index: 2
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 148.83676958084106 seconds
Streaming imagenet data took 149.13115429878235 seconds
Then, training+dataloading take 149.1748824119568 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (7588.0, 6682.0)
Time of next(dataloader) is: 0.9297573566436768
Time for copying to cuda: 0.19942617416381836
Time for forward pass: 0.3474733829498291
Time for backpropagation: 0.005057573318481445
GPU memory for training: 8.730311393737793                          

One training iteration takes: 1.661860466003418 seconds
Index: 3
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 146.45771646499634 seconds
Streaming imagenet data took 146.74885201454163 seconds
Then, training+dataloading take 146.79667615890503 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9928274154663086
Time for copying to cuda: 0.1984570026397705
Time for forward pass: 0.3224654197692871
Time for backpropagation: 0.004923343658447266
GPU memory for training: 8.730311393737793                          

One training iteration takes: 1.6924381256103516 seconds
Index: 4
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 765.984504699707 MBs for this batch
Executing all posts took 146.43684911727905 seconds
Streaming imagenet data took 146.73036575317383 seconds
Then, training+dataloading take 146.77027416229248 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (7588.0, 6682.0)
Time of next(dataloader) is: 1.037550687789917
Time for copying to cuda: 0.199188232421875
Time for forward pass: 0.31315064430236816
Time for backpropagation: 0.004919528961181641
GPU memory for training: 8.730311393737793                          

One training iteration takes: 1.7399876117706299 seconds
Index: 5
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Memory occpied: (7588.0, 6682.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 40.76980018615723 seconds
Streaming imagenet data took 40.84151220321655 seconds
Then, training+dataloading take 40.86001992225647 seconds

Epoch: 0
Time of next(dataloader) is: 0.5453290939331055
Time for copying to cuda: 0.10163187980651855
Memory occpied: (12926.0, 12020.0)
Time for forward pass: 0.8726933002471924
Memory occpied: (12156.0, 12400.0)
Time for backpropagation: 1.5193910598754883
GPU memory for training: 11.565897464752197                          

Memory occpied: (6822.0, 7044.0)
The whole process took 935.2344062328339 seconds
