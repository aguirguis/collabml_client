Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 907.868110427364 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 17
Intermediate:  70.3125
4.107421875
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.681640625
Mem usage  1250.0 3.0
Using split index: 15
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.087208986282349 seconds
Streaming imagenet data took 9.114521503448486 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3825714588165283
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5324447154998779
Time for backpropagation: 0.17385268211364746
One training iteration takes: 1.1837830543518066 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.100730895996094 seconds
Streaming imagenet data took 9.128799438476562 seconds
Then, training+dataloading take 9.133780479431152 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4554176330566406
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.305377721786499
Time for backpropagation: 0.22268295288085938
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.098052740097046 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.40945816040039 seconds
Streaming imagenet data took 9.437572002410889 seconds
Then, training+dataloading take 9.441640853881836 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44447994232177734
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3586869239807129
Time for backpropagation: 0.26493382453918457
One training iteration takes: 1.2164974212646484 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.0399010181427 seconds
Streaming imagenet data took 9.067233562469482 seconds
Then, training+dataloading take 9.072186708450317 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3964118957519531
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5804347991943359
Time for backpropagation: 0.2634317874908447
One training iteration takes: 1.3559720516204834 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.02185606956482 seconds
Streaming imagenet data took 9.050231456756592 seconds
Then, training+dataloading take 9.054385900497437 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4379312992095947
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.31948137283325195
Time for backpropagation: 0.24659395217895508
One training iteration takes: 1.1559791564941406 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.970415830612183 seconds
Streaming imagenet data took 8.997507572174072 seconds
Then, training+dataloading take 9.002478122711182 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4025461673736572
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5302348136901855
Time for backpropagation: 0.2483363151550293
One training iteration takes: 1.2919714450836182 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.772111892700195 seconds
Streaming imagenet data took 9.799306631088257 seconds
Then, training+dataloading take 9.803389072418213 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39748144149780273
Time for copying to cuda: 2.1457672119140625e-05
Time for forward pass: 0.5295727252960205
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.27202820777893066
One training iteration takes: 1.3114705085754395 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.2573983669281 seconds
Streaming imagenet data took 9.284908294677734 seconds
Then, training+dataloading take 9.289905071258545 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.49015164375305176
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.36936521530151367
Time for backpropagation: 0.25943565368652344
One training iteration takes: 1.250300645828247 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.170776128768921 seconds
Streaming imagenet data took 9.198208570480347 seconds
Then, training+dataloading take 9.202420711517334 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40363502502441406
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.32859301567077637
Time for backpropagation: 0.38471245765686035
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.2598683834075928 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.283693313598633 seconds
Streaming imagenet data took 9.310672044754028 seconds
Then, training+dataloading take 9.314892053604126 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4655575752258301
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.32763147354125977
Time for backpropagation: 0.22940659523010254
One training iteration takes: 1.1540870666503906 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.397594928741455 seconds
Streaming imagenet data took 9.425352811813354 seconds
Then, training+dataloading take 9.4280366897583 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4084014892578125
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.42754316329956055
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.3372986316680908
One training iteration takes: 1.3104054927825928 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.25918698310852 seconds
Streaming imagenet data took 9.286937475204468 seconds
Then, training+dataloading take 9.291819095611572 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4944784641265869
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.31467175483703613
Time for backpropagation: 0.287503719329834
One training iteration takes: 1.2323668003082275 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.406651973724365 seconds
Streaming imagenet data took 9.43486475944519 seconds
Then, training+dataloading take 9.438950061798096 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40909910202026367
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5596225261688232
Time for backpropagation: 0.2748451232910156
One training iteration takes: 1.3643522262573242 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.30993127822876 seconds
Streaming imagenet data took 9.337879180908203 seconds
Then, training+dataloading take 9.342339038848877 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4527409076690674
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.3287363052368164
Time for backpropagation: 0.2354733943939209
One training iteration takes: 1.1901347637176514 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.846887826919556 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 9.874578952789307 seconds
Then, training+dataloading take 9.878316164016724 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40252685546875
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.33225059509277344
Time for backpropagation: 0.33245348930358887
One training iteration takes: 1.200117588043213 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.07890510559082 seconds
Streaming imagenet data took 9.105907917022705 seconds
Then, training+dataloading take 9.10886526107788 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40348291397094727
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5820786952972412
Time for backpropagation: 0.27432799339294434
One training iteration takes: 1.381589412689209 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.029501914978027 seconds
Streaming imagenet data took 9.057406187057495 seconds
Then, training+dataloading take 9.061898469924927 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45102596282958984
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.31821751594543457
Time for backpropagation: 0.272045373916626
One training iteration takes: 1.188643455505371 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.16974949836731 seconds
Streaming imagenet data took 9.196679830551147 seconds
Then, training+dataloading take 9.199894905090332 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4020812511444092
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.45418500900268555
Time for backpropagation: 0.2515902519226074
One training iteration takes: 1.2853615283966064 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.77111029624939 seconds
Streaming imagenet data took 9.79845905303955 seconds
Then, training+dataloading take 9.80228567123413 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4274430274963379
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5639019012451172
Time for backpropagation: 0.26558589935302734
One training iteration takes: 1.384883165359497 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.675268650054932 seconds
Streaming imagenet data took 9.70278000831604 seconds
Then, training+dataloading take 9.706472873687744 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40502238273620605
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.3665447235107422
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.41884660720825195
One training iteration takes: 1.3225014209747314 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.035195350646973 seconds
Streaming imagenet data took 9.062017917633057 seconds
Then, training+dataloading take 9.066565752029419 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44579148292541504
Time for copying to cuda: 1.0251998901367188e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.46266818046569824
Time for backpropagation: 0.258136510848999
One training iteration takes: 1.296703815460205 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 8.883911609649658 seconds
Streaming imagenet data took 8.91214370727539 seconds
Then, training+dataloading take 8.915332794189453 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4516875743865967
Time for copying to cuda: 1.0728836059570312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.33884096145629883
Time for backpropagation: 0.2621121406555176
One training iteration takes: 1.1892735958099365 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.516059875488281 seconds
Streaming imagenet data took 9.54343843460083 seconds
Then, training+dataloading take 9.548186779022217 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40140509605407715
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5877296924591064
Time for backpropagation: 0.27428460121154785
One training iteration takes: 1.3861641883850098 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.342873811721802 seconds
Streaming imagenet data took 9.414385080337524 seconds
Then, training+dataloading take 9.422738075256348 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4006659984588623
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.32790040969848633
Time for backpropagation: 0.2775886058807373
One training iteration takes: 1.1495044231414795 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.296677589416504 seconds
Streaming imagenet data took 9.32372260093689 seconds
Then, training+dataloading take 9.329337120056152 seconds

Epoch: 0
Time of next(dataloader) is: 0.41918468475341797
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.4679996967315674
Time for backpropagation: 0.2449326515197754
The whole process took 240.94247460365295 seconds
