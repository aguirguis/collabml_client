Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, manual_split=False, model='myresnet18', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=False, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.3100430021008 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
Intermediate:  1148.4375
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.443332672119141 seconds
Streaming imagenet data took 7.515580415725708 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4712848663330078
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.360579013824463
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5991342067718506
One training iteration takes: 4.527889013290405 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.574033498764038 seconds
Streaming imagenet data took 7.7400970458984375 seconds
Then, training+dataloading take 7.752882480621338 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.44400644302368164
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3462083339691162
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.413529396057129
One training iteration takes: 4.3146092891693115 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.72217583656311 seconds
Streaming imagenet data took 7.793625593185425 seconds
Then, training+dataloading take 7.803229093551636 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.545769453048706
Time for copying to cuda: 1.8358230590820312e-05
Time for forward pass: 1.207834243774414
Time for backpropagation: 2.2389914989471436
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.121607542037964 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.49451208114624 seconds
Streaming imagenet data took 7.610553503036499 seconds
Then, training+dataloading take 7.62339973449707 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49764108657836914
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 1.207712173461914
Time for backpropagation: 2.222200393676758
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.0683674812316895 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.825598955154419 seconds
Streaming imagenet data took 7.900920152664185 seconds
Then, training+dataloading take 7.915251970291138 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44883155822753906
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4109289646148682
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7336912155151367
One training iteration takes: 4.710700750350952 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.419392824172974 seconds
Streaming imagenet data took 7.538106441497803 seconds
Then, training+dataloading take 7.549064874649048 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5042142868041992
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.395249843597412
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5472283363342285
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.5669872760772705 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.701289415359497 seconds
Streaming imagenet data took 7.773688316345215 seconds
Then, training+dataloading take 7.785992383956909 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5532824993133545
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3784935474395752
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.402675151824951
One training iteration takes: 4.4568870067596436 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.590036869049072 seconds
Streaming imagenet data took 7.664611101150513 seconds
Then, training+dataloading take 7.675060987472534 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48499560356140137
Time for copying to cuda: 1.0251998901367188e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.386305809020996
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.524937868118286
One training iteration takes: 4.540146827697754 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.917504072189331 seconds
Streaming imagenet data took 7.990596771240234 seconds
Then, training+dataloading take 8.005854606628418 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47570204734802246
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2653944492340088
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.465646266937256
One training iteration takes: 4.323904991149902 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.636290788650513 seconds
Streaming imagenet data took 7.70815634727478 seconds
Then, training+dataloading take 7.722916841506958 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46999692916870117
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3208012580871582
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4915432929992676
One training iteration takes: 4.3891072273254395 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.674498081207275 seconds
Streaming imagenet data took 7.749057054519653 seconds
Then, training+dataloading take 7.761898517608643 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4903697967529297
Time for copying to cuda: 9.298324584960938e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.5387852191925049
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.385145902633667
One training iteration takes: 4.5217461585998535 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.717963457107544 seconds
Streaming imagenet data took 7.793105840682983 seconds
Then, training+dataloading take 7.802761554718018 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4752671718597412
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3728854656219482
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.45812726020813
One training iteration takes: 4.415050745010376 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.8606932163238525 seconds
Streaming imagenet data took 7.932990312576294 seconds
Then, training+dataloading take 7.942551136016846 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5066020488739014
Time for copying to cuda: 1.0728836059570312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3648381233215332
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3883349895477295
One training iteration takes: 4.390223026275635 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.5300071239471436 seconds
Streaming imagenet data took 7.601989269256592 seconds
Then, training+dataloading take 7.612306356430054 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4557914733886719
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3927559852600098
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.600121259689331
One training iteration takes: 4.558083772659302 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.578089475631714 seconds
Streaming imagenet data took 7.65524435043335 seconds
Then, training+dataloading take 7.668558835983276 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47573232650756836
Time for copying to cuda: 2.8133392333984375e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4148681163787842
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.709831953048706
One training iteration takes: 4.741950511932373 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.817352056503296 seconds
Streaming imagenet data took 7.891382932662964 seconds
Then, training+dataloading take 7.904139041900635 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49412965774536133
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4097113609313965
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6455726623535156
One training iteration takes: 4.6664063930511475 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.441557884216309 seconds
Streaming imagenet data took 7.515308856964111 seconds
Then, training+dataloading take 7.527778148651123 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.568110466003418
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4368138313293457
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4772017002105713
One training iteration takes: 4.60526704788208 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.637330770492554 seconds
Streaming imagenet data took 7.712608098983765 seconds
Then, training+dataloading take 7.725677490234375 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4773824214935303
Time for copying to cuda: 1.2159347534179688e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2737929821014404
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6578855514526367
One training iteration takes: 4.514442205429077 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.849552392959595 seconds
Streaming imagenet data took 7.923578977584839 seconds
Then, training+dataloading take 7.9388041496276855 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4511110782623291
Time for copying to cuda: 9.298324584960938e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4800379276275635
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4218788146972656
One training iteration takes: 4.488405227661133 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.024789333343506 seconds
Streaming imagenet data took 8.096510410308838 seconds
Then, training+dataloading take 8.110757112503052 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5087780952453613
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 1.154815435409546
Time for backpropagation: 2.2675700187683105
One training iteration takes: 4.0621631145477295 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.578363418579102 seconds
Streaming imagenet data took 7.739536762237549 seconds
Then, training+dataloading take 7.752558708190918 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.48339414596557617
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3690390586853027
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.559201955795288
Memory occpied: (1250.0, 3.0)
One training iteration takes: 4.552621126174927 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.623399496078491 seconds
Streaming imagenet data took 7.695078611373901 seconds
Then, training+dataloading take 7.709315776824951 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5098679065704346
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 1.3605287075042725
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4456074237823486
One training iteration takes: 4.423129558563232 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.839386224746704 seconds
Streaming imagenet data took 7.912848949432373 seconds
Then, training+dataloading take 7.926997423171997 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5171959400177002
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 1.1787340641021729
Time for backpropagation: 2.271343469619751
One training iteration takes: 4.116661310195923 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.441573619842529 seconds
Streaming imagenet data took 7.515533447265625 seconds
Then, training+dataloading take 7.53049111366272 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.49788665771484375
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.348292350769043
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4552698135375977
One training iteration takes: 4.433663368225098 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.6394264698028564 seconds
Streaming imagenet data took 7.711573123931885 seconds
Then, training+dataloading take 7.726363658905029 seconds

Epoch: 0
Time of next(dataloader) is: 0.4548766613006592
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.310636281967163
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.495800733566284
The whole process took 204.5728144645691 seconds
