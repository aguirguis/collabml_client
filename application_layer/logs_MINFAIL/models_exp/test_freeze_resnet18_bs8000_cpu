Namespace(batch_size=8000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.5130576359473 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 11
Intermediate:  9187.5
26.03125
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 26.60546875
Mem usage  1250.0 3.0
Using split index: 10
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 24.774307012557983 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 25.413278579711914 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 1.26173734664917
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 11.985060691833496
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 13.429412126541138
One training iteration takes: 27.18808889389038 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 27.647255182266235 seconds
Streaming imagenet data took 28.2127947807312 seconds
Then, training+dataloading take 28.28627300262451 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.4163320064544678
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 9.81893253326416
Time for backpropagation: 11.37463927268982
One training iteration takes: 22.864105701446533 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 24.920387029647827 seconds
Streaming imagenet data took 25.563838720321655 seconds
Then, training+dataloading take 25.653700351715088 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 1.4142186641693115
Time for copying to cuda: 1.0251998901367188e-05
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 12.372729063034058
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 13.827242136001587
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 30.02378559112549 seconds
Streaming imagenet data took 30.59652805328369 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 37.83002686500549 seconds
Index: 2
Then, training+dataloading take 37.83353614807129 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 1.3531792163848877
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 12.105294227600098
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 13.955870866775513
Read 1531.609504699707 MBs for this batch
Executing all posts took 27.5821590423584 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 28.23028564453125 seconds
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
One training iteration takes: 32.618913412094116 seconds
Index: 3
Then, training+dataloading take 32.64183330535889 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.5757861137390137
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 9.549798011779785
Time for backpropagation: 11.571624040603638
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 1531.609504699707 MBs for this batch
Executing all posts took 25.5659396648407 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 26.23784852027893 seconds
Memory occpied: (1250.0, 3.0)
One training iteration takes: 27.909858226776123 seconds
Index: 4
Then, training+dataloading take 27.96306300163269 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.4843761920928955
Time for copying to cuda: 9.059906005859375e-06
Read 382.90237617492676 MBs for this batch
Executing all posts took 10.710639715194702 seconds
Streaming imagenet data took 10.881671905517578 seconds
Time for forward pass: 10.462257623672485
Time for backpropagation: 9.320685386657715
One training iteration takes: 21.51150631904602 seconds
Index: 5
Then, training+dataloading take 21.58495044708252 seconds

Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5802516937255859
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.708843946456909
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5832059383392334
The whole process took 212.27711701393127 seconds
