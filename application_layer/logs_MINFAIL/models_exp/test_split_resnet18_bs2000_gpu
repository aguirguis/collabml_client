Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, manual_split=False, model='myresnet18', num_epochs=1, sequential=False, split_idx=100, splitindex_to_freezeindex=False, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.412577149107 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
Intermediate:  1148.4375
26.60546875
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 27.1796875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.642019033432007 seconds
Streaming imagenet data took 7.717533111572266 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46309328079223633
Time for copying to cuda: 0.04979300498962402
Memory occpied: (1504.0, 230.0)
Memory occpied: (1504.0, 664.0)
Memory occpied: (1504.0, 1090.0)
Memory occpied: (6984.0, 6858.0)
Time for forward pass: 4.2914512157440186
Memory occpied: (12296.0, 12170.0)
Time for backpropagation: 1.4372172355651855
GPU memory for training: 11.528353214263916                          

One training iteration takes: 6.344652891159058 seconds
Index: 0
Memory occpied: (6962.0, 6834.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.469281911849976 seconds
Streaming imagenet data took 7.54178524017334 seconds
Then, training+dataloading take 7.551577806472778 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5278835296630859
Time for copying to cuda: 0.09624218940734863
Memory occpied: (6962.0, 6850.0)
Time for forward pass: 0.09550786018371582
Time for backpropagation: 0.004950523376464844
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8250813484191895 seconds
Index: 1
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.613302707672119 seconds
Streaming imagenet data took 7.686465263366699 seconds
Then, training+dataloading take 7.69920802116394 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5566079616546631
Time for copying to cuda: 0.0499119758605957
Time for forward pass: 0.09523630142211914
Time for backpropagation: 0.004959583282470703
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8671338558197021 seconds
Index: 2
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.789098739624023 seconds
Streaming imagenet data took 7.862965822219849 seconds
Then, training+dataloading take 7.8783488273620605 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5053505897521973
Time for copying to cuda: 0.09473967552185059
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09548473358154297
Time for backpropagation: 0.004708766937255859
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8010342121124268 seconds
Index: 3
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.7552430629730225 seconds
Streaming imagenet data took 7.833949089050293 seconds
Then, training+dataloading take 7.843761444091797 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5834081172943115
Time for copying to cuda: 0.05022573471069336
Time for forward pass: 0.09523415565490723
Time for backpropagation: 0.004654645919799805
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8678555488586426 seconds
Index: 4
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.612835168838501 seconds
Streaming imagenet data took 7.687097549438477 seconds
Then, training+dataloading take 7.699172496795654 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.543377161026001
Time for copying to cuda: 0.05032157897949219
Time for forward pass: 0.09669232368469238
Time for backpropagation: 0.0056307315826416016
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.8223912715911865 seconds
Index: 5
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.807760238647461 seconds
Streaming imagenet data took 7.881972312927246 seconds
Then, training+dataloading take 7.894121170043945 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.6135635375976562
Time for copying to cuda: 0.04977011680603027
Time for forward pass: 0.09534311294555664
Time for backpropagation: 0.004763126373291016
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8623054027557373 seconds
Index: 6
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.586301565170288 seconds
Streaming imagenet data took 7.660726547241211 seconds
Then, training+dataloading take 7.673445463180542 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.577467679977417
Time for copying to cuda: 0.04961681365966797
Time for forward pass: 0.09565138816833496
Time for backpropagation: 0.005095481872558594
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8781750202178955 seconds
Index: 7
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.061570405960083 seconds
Streaming imagenet data took 8.134379148483276 seconds
Then, training+dataloading take 8.144336700439453 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.596381664276123
Time for copying to cuda: 0.05085563659667969
Time for forward pass: 0.09528493881225586
Time for backpropagation: 0.004616975784301758
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8900260925292969 seconds
Index: 8
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.681166410446167 seconds
Streaming imagenet data took 7.755592107772827 seconds
Then, training+dataloading take 7.768289804458618 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5326249599456787
Time for copying to cuda: 0.09571504592895508
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09552145004272461
Time for backpropagation: 0.00470733642578125
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.832939863204956 seconds
Index: 9
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.639547348022461 seconds
Streaming imagenet data took 7.710887432098389 seconds
Then, training+dataloading take 7.722877025604248 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.5931546688079834
Time for copying to cuda: 0.049381256103515625
Time for forward pass: 0.09531259536743164
Time for backpropagation: 0.004774570465087891
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8402805328369141 seconds
Index: 10
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.650717258453369 seconds
Streaming imagenet data took 7.725492477416992 seconds
Then, training+dataloading take 7.73771333694458 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5887205600738525
Time for copying to cuda: 0.04932355880737305
Time for forward pass: 0.09522032737731934
Time for backpropagation: 0.004652261734008789
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8666915893554688 seconds
Index: 11
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.670144319534302 seconds
Streaming imagenet data took 7.742746829986572 seconds
Then, training+dataloading take 7.754838705062866 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.527585506439209
Time for copying to cuda: 0.09865045547485352
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09535813331604004
Time for backpropagation: 0.004961967468261719
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8250722885131836 seconds
Index: 12
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.588754653930664 seconds
Streaming imagenet data took 7.662991523742676 seconds
Then, training+dataloading take 7.675868272781372 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.5864055156707764
Time for copying to cuda: 0.04987215995788574
Time for forward pass: 0.0952599048614502
Time for backpropagation: 0.00460362434387207
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8520941734313965 seconds
Index: 13
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.675586223602295 seconds
Streaming imagenet data took 7.7486443519592285 seconds
Then, training+dataloading take 7.760810852050781 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5649333000183105
Time for copying to cuda: 0.04994559288024902
Time for forward pass: 0.09530830383300781
Time for backpropagation: 0.004705190658569336
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8803830146789551 seconds
Index: 14
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.694978475570679 seconds
Streaming imagenet data took 7.767752647399902 seconds
Then, training+dataloading take 7.777602195739746 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5177819728851318
Time for copying to cuda: 0.09554314613342285
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09559798240661621
Time for backpropagation: 0.00462794303894043
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8131523132324219 seconds
Index: 15
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.8020100593566895 seconds
Streaming imagenet data took 7.874483108520508 seconds
Then, training+dataloading take 7.886699438095093 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Memory occpied: (6978.0, 6850.0)
Time of next(dataloader) is: 0.6102313995361328
Time for copying to cuda: 0.049652814865112305
Time for forward pass: 0.09528326988220215
Time for backpropagation: 0.0047054290771484375
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.859827995300293 seconds
Index: 16
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.706619739532471 seconds
Streaming imagenet data took 7.829694032669067 seconds
Then, training+dataloading take 7.841260194778442 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5857269763946533
Time for copying to cuda: 0.05480623245239258
Time for forward pass: 0.09534239768981934
Time for backpropagation: 0.004667043685913086
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.8411223888397217 seconds
Index: 17
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.228736877441406 seconds
Streaming imagenet data took 8.35244870185852 seconds
Then, training+dataloading take 8.366749286651611 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000

Memory occpied: (6978.0, 6850.0)

Epoch: 0
Time of next(dataloader) is: 0.5324103832244873
Time for copying to cuda: 0.04981040954589844
Time for forward pass: 0.0953369140625
Time for backpropagation: 0.00493621826171875
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.7822403907775879 seconds
Index: 18
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 8.042621850967407 seconds
Streaming imagenet data took 8.114577293395996 seconds
Then, training+dataloading take 8.127061605453491 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.519458532333374
Time for copying to cuda: 0.04982471466064453
Time for forward pass: 0.09665870666503906
Time for backpropagation: 0.005322456359863281
GPU memory for training: 2.3275094032287598                          

Memory occpied: (6978.0, 6850.0)
One training iteration takes: 0.8025851249694824 seconds
Index: 19
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.636419057846069 seconds
Streaming imagenet data took 7.708289861679077 seconds
Then, training+dataloading take 7.721153974533081 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6167323589324951
Time for copying to cuda: 0.04987978935241699
Time for forward pass: 0.09707117080688477
Time for backpropagation: 0.004688739776611328
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8977594375610352 seconds
Index: 20
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.506526231765747 seconds
Streaming imagenet data took 7.578170299530029 seconds
Then, training+dataloading take 7.590423345565796 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5104012489318848
Time for copying to cuda: 0.050038814544677734
Time for forward pass: 0.09529399871826172
Time for backpropagation: 0.05365872383117676
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8056297302246094 seconds
Index: 21
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.701361656188965 seconds
Streaming imagenet data took 7.773352384567261 seconds
Then, training+dataloading take 7.786176443099976 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5141386985778809
Time for copying to cuda: 0.10475492477416992
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09552574157714844
Time for backpropagation: 0.004718780517578125
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.8179929256439209 seconds
Index: 22
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.592564105987549 seconds
Streaming imagenet data took 7.665696620941162 seconds
Then, training+dataloading take 7.678166627883911 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5975110530853271
Time for copying to cuda: 0.04994654655456543
Time for forward pass: 0.09534335136413574
Time for backpropagation: 0.004932403564453125
GPU memory for training: 2.3275094032287598                          

One training iteration takes: 0.880765438079834 seconds
Index: 23
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Memory occpied: (6978.0, 6850.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 7.798831224441528 seconds
Streaming imagenet data took 7.871584415435791 seconds
Then, training+dataloading take 7.883856296539307 seconds

Epoch: 0
Time of next(dataloader) is: 0.5470247268676758
Time for copying to cuda: 0.09507513046264648
Memory occpied: (6978.0, 6850.0)
Time for forward pass: 0.09876298904418945
Time for backpropagation: 0.004655122756958008
GPU memory for training: 2.3275094032287598                          

The whole process took 202.99651193618774 seconds
