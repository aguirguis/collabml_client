Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='to_min', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.5073177860195 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_min 100 11
Intermediate:  2296.875
26.03125
Total layers size  27.185455322265625
Fixed, scale_with_bsz  44.591949462890625 26.60546875
Mem usage  1250.0 3.0
Using split index: 10
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.563207864761353 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 9.746312856674194 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5667431354522705
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.700873851776123
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.578986406326294
One training iteration takes: 5.967858552932739 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.482486248016357 seconds
Streaming imagenet data took 9.624930143356323 seconds
Then, training+dataloading take 9.64272141456604 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5505661964416504
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.843005895614624
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3948872089385986
One training iteration takes: 5.9137561321258545 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 10.293325185775757 seconds
Streaming imagenet data took 10.437145233154297 seconds
Then, training+dataloading take 10.461304426193237 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5437591075897217
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.614368200302124
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3691024780273438
One training iteration takes: 5.648503303527832 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.522194385528564 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 9.711113691329956 seconds
Then, training+dataloading take 9.735527753829956 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5412135124206543
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.6574859619140625
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6647465229034424
One training iteration takes: 5.996945858001709 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.07273006439209 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 9.258037328720093 seconds
Then, training+dataloading take 9.283078908920288 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5530455112457275
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.649155616760254
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.653535842895508
One training iteration takes: 5.992572784423828 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.399566173553467 seconds
Streaming imagenet data took 9.540502786636353 seconds
Then, training+dataloading take 9.56498646736145 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5455036163330078
Time for copying to cuda: 9.059906005859375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.554615020751953
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.412205696105957
One training iteration takes: 5.67133903503418 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 10.583678960800171 seconds
Streaming imagenet data took 10.774972438812256 seconds
Then, training+dataloading take 10.800976753234863 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5965054035186768
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.6667139530181885
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5010550022125244
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.889943361282349 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.651712894439697 seconds
Streaming imagenet data took 9.793618440628052 seconds
Then, training+dataloading take 9.818426370620728 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5518507957458496
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.7212836742401123
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.543262243270874
One training iteration takes: 5.959878206253052 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.959259271621704 seconds
Streaming imagenet data took 10.19297194480896 seconds
Memory occpied: (1250.0, 3.0)
Then, training+dataloading take 10.218708038330078 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5497312545776367
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.686469316482544
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6426782608032227
One training iteration takes: 6.003467798233032 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.700409173965454 seconds
Streaming imagenet data took 9.842948198318481 seconds
Then, training+dataloading take 9.867468118667603 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5515131950378418
Time for copying to cuda: 8.58306884765625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.6456515789031982
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3838114738464355
One training iteration takes: 5.727474689483643 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 10.274380445480347 seconds
Streaming imagenet data took 10.421229600906372 seconds
Then, training+dataloading take 10.445556640625 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.6025786399841309
Time for copying to cuda: 9.059906005859375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.665325164794922
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.541297435760498
One training iteration takes: 5.939221382141113 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.235451459884644 seconds
Streaming imagenet data took 9.37646222114563 seconds
Then, training+dataloading take 9.401312112808228 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6295311450958252
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 2.3035929203033447
Time for backpropagation: 2.2275710105895996
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.298666954040527 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.62748908996582 seconds
Streaming imagenet data took 9.771126985549927 seconds
Then, training+dataloading take 9.79540205001831 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6368696689605713
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 2.308894157409668
Time for backpropagation: 2.228026866912842
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.295178651809692 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.748727798461914 seconds
Streaming imagenet data took 9.889685869216919 seconds
Then, training+dataloading take 9.91509199142456 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6216554641723633
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 2.3071863651275635
Time for backpropagation: 2.227872848510742
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.29375147819519 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 10.587003231048584 seconds
Streaming imagenet data took 10.730161190032959 seconds
Then, training+dataloading take 10.755109071731567 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5430774688720703
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.664005756378174
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3145029544830322
One training iteration takes: 5.642087936401367 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.684722900390625 seconds
Streaming imagenet data took 9.826631546020508 seconds
Then, training+dataloading take 9.851816892623901 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5505111217498779
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.6578524112701416
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.565513849258423
One training iteration takes: 5.905596494674683 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.560908079147339 seconds
Streaming imagenet data took 9.704722166061401 seconds
Then, training+dataloading take 9.729617357254028 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5820667743682861
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 2.304558277130127
Time for backpropagation: 2.228158712387085
One training iteration takes: 5.24313497543335 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.708688259124756 seconds
Streaming imagenet data took 9.851811408996582 seconds
Then, training+dataloading take 9.87614631652832 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.59725022315979
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 2.3055214881896973
Time for backpropagation: 2.240072250366211
One training iteration takes: 5.288658142089844 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 10.181415796279907 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 10.37122106552124 seconds
Then, training+dataloading take 10.397036790847778 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5444049835205078
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.638192653656006
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6332459449768066
One training iteration takes: 5.962592840194702 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.94003415107727 seconds
Streaming imagenet data took 10.083603620529175 seconds
Then, training+dataloading take 10.10773253440857 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.6365368366241455
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.7339179515838623
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3940279483795166
One training iteration takes: 5.894705533981323 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.789752960205078 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 9.932300806045532 seconds
Then, training+dataloading take 9.95660400390625 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5468919277191162
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.651480197906494
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.617567777633667
One training iteration takes: 5.938001871109009 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.624365091323853 seconds
Streaming imagenet data took 9.76825737953186 seconds
Then, training+dataloading take 9.792346477508545 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5838761329650879
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.714874744415283
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.3581411838531494
One training iteration takes: 5.821662425994873 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 10.491801261901855 seconds
Streaming imagenet data took 10.733361005783081 seconds
Then, training+dataloading take 10.750241756439209 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5576834678649902
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.6972713470458984
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.500548839569092
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.890680313110352 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.497789144515991 seconds
Memory occpied: (1250.0, 3.0)
Streaming imagenet data took 9.685904264450073 seconds
Then, training+dataloading take 9.712523937225342 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5488781929016113
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.681722402572632
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6683902740478516
One training iteration takes: 6.0553529262542725 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 382.90237617492676 MBs for this batch
Executing all posts took 9.509481191635132 seconds
Streaming imagenet data took 9.655921459197998 seconds
Then, training+dataloading take 9.682199478149414 seconds

Epoch: 0
Time of next(dataloader) is: 0.5975344181060791
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 2.527848482131958
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.437126398086548
The whole process took 261.12303924560547 seconds
