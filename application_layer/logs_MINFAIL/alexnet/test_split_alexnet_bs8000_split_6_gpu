Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=6, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.328646996554 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 6 17
Intermediate:  990.234375
2.8466796875
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 3.4208984375
Mem usage  1250.0 3.0
Using split index: 6
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 990.5862503051758 MBs for this batch
Executing all posts took 17.927201509475708 seconds
Memory occpied: (1494.0, 3.0)
Streaming imagenet data took 18.41347336769104 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9292972087860107
Memory occpied: (2486.0, 3.0)
Time for copying to cuda: 0.2934699058532715
Memory occpied: (2486.0, 968.0)
Memory occpied: (2486.0, 1396.0)
Memory occpied: (13514.0, 12856.0)
Memory occpied: (13514.0, 12856.0)
Memory occpied: (13360.0, 12856.0)
Memory occpied: (13360.0, 12856.0)
Memory occpied: (13360.0, 12856.0)
Time for forward pass: 9.158746719360352
Time for backpropagation: 0.05162549018859863
GPU memory for training: 23.116446018218994                          

One training iteration takes: 10.614383935928345 seconds
Index: 0
Memory occpied: (3498.0, 12864.0)
Memory occpied: (3498.0, 12864.0)
Memory occpied: (3498.0, 12864.0)
Memory occpied: (3498.0, 12864.0)
Memory occpied: (3498.0, 12864.0)
Memory occpied: (3498.0, 12864.0)
Read 990.5862503051758 MBs for this batch
Executing all posts took 18.640806436538696 seconds
Memory occpied: (3498.0, 12864.0)
Streaming imagenet data took 19.014168739318848 seconds
Then, training+dataloading take 19.065812349319458 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (3498.0, 12864.0)
Time of next(dataloader) is: 1.0569722652435303
Time for copying to cuda: 0.2539677619934082
Time for forward pass: 0.6957247257232666
Time for backpropagation: 0.0035562515258789062
GPU memory for training: 12.3072190284729                          

One training iteration takes: 2.2087926864624023 seconds
Index: 1
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Read 990.5862503051758 MBs for this batch
Executing all posts took 19.472041130065918 seconds
Streaming imagenet data took 19.843708515167236 seconds
Then, training+dataloading take 19.900328159332275 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0893762111663818
Time for copying to cuda: 0.2543208599090576
Time for forward pass: 0.6718554496765137
Time for backpropagation: 0.0030088424682617188
GPU memory for training: 12.3072190284729                          

One training iteration takes: 2.2256593704223633 seconds
Index: 2
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Read 990.5862503051758 MBs for this batch
Executing all posts took 19.28979778289795 seconds
Memory occpied: (11472.0, 12872.0)
Streaming imagenet data took 19.660984992980957 seconds
Then, training+dataloading take 19.71946668624878 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (11472.0, 12872.0)
Time of next(dataloader) is: 1.0281507968902588
Time for copying to cuda: 0.253464937210083
Time for forward pass: 0.7103550434112549
Time for backpropagation: 0.0034558773040771484
GPU memory for training: 12.3072190284729                          

One training iteration takes: 2.171884059906006 seconds
Index: 3
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Read 990.5862503051758 MBs for this batch
Executing all posts took 18.73275899887085 seconds
Memory occpied: (11472.0, 12872.0)
Streaming imagenet data took 19.23222589492798 seconds
Then, training+dataloading take 19.29021430015564 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0370407104492188
Memory occpied: (11472.0, 12872.0)
Time for copying to cuda: 0.25547122955322266
Time for forward pass: 0.6637184619903564
Time for backpropagation: 0.0030336380004882812
GPU memory for training: 12.3072190284729                          

Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
One training iteration takes: 7.085472345352173 seconds
Index: 4
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Read 990.5862503051758 MBs for this batch
Executing all posts took 18.414671182632446 seconds
Streaming imagenet data took 18.783596992492676 seconds
Then, training+dataloading take 18.85359525680542 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0913479328155518
Time for copying to cuda: 0.25298476219177246
Time for forward pass: 0.658942461013794
Time for backpropagation: 0.0030066967010498047
GPU memory for training: 12.3072190284729                          

Memory occpied: (11472.0, 12872.0)
One training iteration takes: 2.2100284099578857 seconds
Index: 5
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Memory occpied: (11472.0, 12872.0)
Read 247.64656257629395 MBs for this batch
Executing all posts took 11.108793497085571 seconds
Streaming imagenet data took 11.204607725143433 seconds
Then, training+dataloading take 11.219284057617188 seconds

Epoch: 0
Time of next(dataloader) is: 0.5757043361663818
Time for copying to cuda: 0.06581783294677734
Memory occpied: (11472.0, 12872.0)
Memory occpied: (6428.0, 11880.0)
Time for forward pass: 1.803992748260498
Time for backpropagation: 0.0029108524322509766
GPU memory for training: 7.764878749847412                          

The whole process took 136.04656767845154 seconds
