Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=9, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.3265360364093 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 9 17
Intermediate:  1320.3125
3.5068359375
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.0810546875
Mem usage  1250.0 3.0
Using split index: 9
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 22.389489889144897 seconds
Memory occpied: (1494.0, 3.0)
Streaming imagenet data took 22.885145902633667 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1494.0, 3.0)
Time of next(dataloader) is: 1.1314787864685059
Time for copying to cuda: 0.34031152725219727
Memory occpied: (2816.0, 860.0)
Memory occpied: (2816.0, 1322.0)
Memory occpied: (2816.0, 1738.0)
Memory occpied: (12416.0, 11594.0)
Memory occpied: (12270.0, 11602.0)
Time for forward pass: 5.560544490814209
Time for backpropagation: 0.04943561553955078
GPU memory for training: 20.812811374664307                          

One training iteration takes: 7.295265436172485 seconds
Index: 0
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Memory occpied: (3498.0, 11602.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 22.306642770767212 seconds
Memory occpied: (3498.0, 11602.0)
Streaming imagenet data took 22.87294054031372 seconds
Then, training+dataloading take 22.93855857849121 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (3498.0, 11602.0)
Time of next(dataloader) is: 1.2826919555664062
Time for copying to cuda: 0.3360474109649658
Time for forward pass: 0.44254159927368164
Time for backpropagation: 0.0035054683685302734
GPU memory for training: 10.579939365386963                          

One training iteration takes: 2.3383798599243164 seconds
Index: 1
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 22.55877661705017 seconds
Memory occpied: (8678.0, 11610.0)
Streaming imagenet data took 23.058520793914795 seconds
Then, training+dataloading take 23.13670063018799 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (8678.0, 11610.0)
Time of next(dataloader) is: 1.266225814819336
Time for copying to cuda: 0.3395659923553467
Time for forward pass: 0.45538806915283203
Time for backpropagation: 0.003397703170776367
GPU memory for training: 10.579939365386963                          

Memory occpied: (8678.0, 11610.0)
One training iteration takes: 2.31022310256958 seconds
Index: 2
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 21.943322896957397 seconds
Memory occpied: (8678.0, 11610.0)
Streaming imagenet data took 22.52640676498413 seconds
Then, training+dataloading take 22.603199243545532 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (8678.0, 11610.0)
Time of next(dataloader) is: 1.2586994171142578
Time for copying to cuda: 0.33515429496765137
Time for forward pass: 0.46663713455200195
Time for backpropagation: 0.0033855438232421875
GPU memory for training: 10.579939365386963                          

Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
One training iteration takes: 7.173091650009155 seconds
Index: 3
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 22.474952220916748 seconds
Streaming imagenet data took 23.11118745803833 seconds
Then, training+dataloading take 23.168980360031128 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (8678.0, 11610.0)
Time of next(dataloader) is: 1.2390284538269043
Memory occpied: (8678.0, 11610.0)
Time for copying to cuda: 0.3932967185974121
Time for forward pass: 0.4867854118347168
Time for backpropagation: 0.0029871463775634766
GPU memory for training: 10.579939365386963                          

One training iteration takes: 2.358999252319336 seconds
Index: 4
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 23.204959630966187 seconds
Streaming imagenet data took 23.695852994918823 seconds
Then, training+dataloading take 23.776415586471558 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.379091739654541
Time for copying to cuda: 0.34046077728271484
Time for forward pass: 0.4491255283355713
Time for backpropagation: 0.0029654502868652344
GPU memory for training: 10.579939365386963                          

Memory occpied: (8678.0, 11610.0)
One training iteration takes: 2.425928831100464 seconds
Index: 5
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Memory occpied: (8678.0, 11610.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.10344409942627 seconds
Streaming imagenet data took 12.285820484161377 seconds
Then, training+dataloading take 12.301188945770264 seconds

Epoch: 0
Time of next(dataloader) is: 0.7104578018188477
Time for copying to cuda: 0.08602643013000488
Time for forward pass: 0.645723819732666
Time for backpropagation: 0.008197546005249023
GPU memory for training: 6.099586486816406                          

Memory occpied: (8678.0, 11610.0)
The whole process took 159.81317234039307 seconds
