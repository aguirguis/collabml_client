Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=11, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 907.6149914603905 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 11 17
Intermediate:  1320.3125
3.8369140625
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.4111328125
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 22.857347011566162 seconds
Memory occpied: (1494.0, 3.0)
Streaming imagenet data took 23.47164034843445 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1494.0, 3.0)
Time of next(dataloader) is: 1.1395461559295654
Time for copying to cuda: 0.3409898281097412
Memory occpied: (2816.0, 918.0)
Memory occpied: (2816.0, 1384.0)
Memory occpied: (2816.0, 1844.0)
Time for forward pass: 3.674649477005005
Time for backpropagation: 0.05682373046875
GPU memory for training: 3.288896083831787                          

One training iteration takes: 5.435861825942993 seconds
Index: 0
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Memory occpied: (3406.0, 2582.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 23.350799322128296 seconds
Streaming imagenet data took 23.98345708847046 seconds
Then, training+dataloading take 24.055007696151733 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (3406.0, 2582.0)
Time of next(dataloader) is: 1.2495646476745605
Memory occpied: (3406.0, 2582.0)
Time for copying to cuda: 0.33823299407958984
Time for forward pass: 0.3380129337310791
Time for backpropagation: 0.002924203872680664
GPU memory for training: 3.4448180198669434                          

One training iteration takes: 2.1660916805267334 seconds
Index: 1
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 22.492982625961304 seconds
Memory occpied: (3696.0, 2590.0)
Streaming imagenet data took 22.98272943496704 seconds
Then, training+dataloading take 23.059274435043335 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (3696.0, 2590.0)
Time of next(dataloader) is: 1.2665610313415527
Time for copying to cuda: 0.33766913414001465
Time for forward pass: 0.3261759281158447
Time for backpropagation: 0.0032854080200195312
GPU memory for training: 3.4448180198669434                          

One training iteration takes: 2.0995118618011475 seconds
Index: 2
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 23.345595121383667 seconds
Memory occpied: (3696.0, 2590.0)
Streaming imagenet data took 23.913325309753418 seconds
Then, training+dataloading take 23.992432594299316 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (3696.0, 2590.0)
Time of next(dataloader) is: 1.2422106266021729
Time for copying to cuda: 0.33809924125671387
Time for forward pass: 0.3995180130004883
Time for backpropagation: 0.0033740997314453125
GPU memory for training: 3.4448180198669434                          

One training iteration takes: 2.220262289047241 seconds
Index: 3
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 22.486321210861206 seconds
Streaming imagenet data took 22.972193956375122 seconds
Then, training+dataloading take 23.04697561264038 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.28717041015625
Time for copying to cuda: 0.33864331245422363
Time for forward pass: 0.34969162940979004
Time for backpropagation: 0.0029144287109375
GPU memory for training: 3.4448180198669434                          

Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
One training iteration takes: 7.166270732879639 seconds
Index: 4
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Read 1320.672004699707 MBs for this batch
Executing all posts took 23.3694167137146 seconds
Memory occpied: (3696.0, 2590.0)
Streaming imagenet data took 23.855857610702515 seconds
Then, training+dataloading take 23.936805963516235 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (3696.0, 2590.0)
Time of next(dataloader) is: 1.2254951000213623
Time for copying to cuda: 0.34028053283691406
Time for forward pass: 0.3503575325012207
Time for backpropagation: 0.0036420822143554688
GPU memory for training: 3.4448180198669434                          

One training iteration takes: 2.099618911743164 seconds
Index: 5
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Memory occpied: (3696.0, 2590.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.149872064590454 seconds
Streaming imagenet data took 12.389499187469482 seconds
Then, training+dataloading take 12.402957439422607 seconds

Epoch: 0
Memory occpied: (3696.0, 2590.0)
Time of next(dataloader) is: 0.6307809352874756
Time for copying to cuda: 0.08608365058898926
Time for forward pass: 0.11427688598632812
Time for backpropagation: 0.002862215042114258
GPU memory for training: 1.66196870803833                          

The whole process took 161.55101466178894 seconds
