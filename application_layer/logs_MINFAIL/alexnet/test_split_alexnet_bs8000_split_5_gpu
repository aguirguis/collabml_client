Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=5, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.6130741007635 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 5 17
Intermediate:  4271.484375
2.722900390625
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 3.297119140625
Mem usage  1250.0 3.0
Using split index: 5
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 50.479421854019165 seconds
Memory occpied: (1494.0, 3.0)
Streaming imagenet data took 52.42812895774841 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Time of next(dataloader) is: 2.8546977043151855
Memory occpied: (5766.0, 3.0)
Time for copying to cuda: 1.1604790687561035
Memory occpied: (5766.0, 2494.0)
Memory occpied: (5766.0, 2960.0)
Memory occpied: (5766.0, 3384.0)
Memory occpied: (12494.0, 14992.0)
Memory occpied: (11844.0, 14992.0)
Memory occpied: (11844.0, 14496.0)
Memory occpied: (11852.0, 14496.0)
Time for forward pass: 9.37573504447937
Time for backpropagation: 0.1109459400177002
GPU memory for training: 24.208136081695557                          

One training iteration takes: 14.061577081680298 seconds
Index: 0
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 51.28561496734619 seconds
Memory occpied: (6778.0, 14504.0)
Streaming imagenet data took 53.225332260131836 seconds
Then, training+dataloading take 53.421942949295044 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Time of next(dataloader) is: 3.113128423690796
Memory occpied: (6778.0, 14504.0)
Time for copying to cuda: 1.230560302734375
Time for forward pass: 0.9970898628234863
Time for backpropagation: 0.08042621612548828
GPU memory for training: 17.113630771636963                          

Memory occpied: (14752.0, 14512.0)
One training iteration takes: 6.031164646148682 seconds
Index: 1
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 51.71221041679382 seconds
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Streaming imagenet data took 53.54205012321472 seconds
Then, training+dataloading take 53.74531149864197 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 3.121786117553711
Memory occpied: (14752.0, 14512.0)
Time for copying to cuda: 1.2351865768432617
Memory occpied: (14752.0, 14512.0)
Time for forward pass: 0.9530725479125977
Time for backpropagation: 0.0030536651611328125
GPU memory for training: 17.113630771636963                          

One training iteration takes: 5.918566942214966 seconds
Index: 2
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 53.911871671676636 seconds
Memory occpied: (14752.0, 14512.0)
Streaming imagenet data took 55.87197303771973 seconds
Then, training+dataloading take 56.01053810119629 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 3.14648175239563
Memory occpied: (14752.0, 14512.0)
Time for copying to cuda: 1.2380053997039795
Time for forward pass: 1.0003187656402588
Time for backpropagation: 0.003507375717163086
GPU memory for training: 17.113630771636963                          

One training iteration takes: 6.0611021518707275 seconds
Index: 3
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 54.423808097839355 seconds
Memory occpied: (14752.0, 14512.0)
Streaming imagenet data took 56.250683069229126 seconds
Then, training+dataloading take 56.45827627182007 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 3.133094549179077
Memory occpied: (14752.0, 14512.0)
Time for copying to cuda: 1.2324748039245605
Memory occpied: (14752.0, 14512.0)
Time for forward pass: 1.0292212963104248
Time for backpropagation: 0.003072023391723633
GPU memory for training: 17.113630771636963                          

Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
One training iteration takes: 10.909067153930664 seconds
Index: 4
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 53.861417293548584 seconds
Memory occpied: (14752.0, 14512.0)
Streaming imagenet data took 55.811352491378784 seconds
Then, training+dataloading take 55.9313063621521 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 3.1613147258758545
Memory occpied: (14752.0, 14512.0)
Time for copying to cuda: 1.2365162372589111
Time for forward pass: 0.9578320980072021
Time for backpropagation: 0.0030181407928466797
GPU memory for training: 17.113630771636963                          

One training iteration takes: 5.982699394226074 seconds
Index: 5
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 1067.959062576294 MBs for this batch
Executing all posts took 19.267070293426514 seconds
Memory occpied: (14752.0, 14512.0)
Streaming imagenet data took 19.67122745513916 seconds
Then, training+dataloading take 19.727264404296875 seconds

Epoch: 0
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 1.2296152114868164
Time for copying to cuda: 0.2746882438659668
Memory occpied: (9488.0, 12376.0)
Time for forward pass: 1.8428328037261963
Time for backpropagation: 0.002989053726196289
GPU memory for training: 8.967073440551758                          

Memory occpied: (5892.0, 12376.0)
The whole process took 359.2329638004303 seconds
