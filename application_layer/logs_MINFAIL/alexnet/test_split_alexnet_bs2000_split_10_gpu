Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=10, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.3080792301923 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 10 17
Intermediate:  330.078125
3.671875
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.24609375
Mem usage  1250.0 3.0
Using split index: 10
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.238078594207764 seconds
Streaming imagenet data took 12.361146211624146 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5106029510498047
Time for copying to cuda: 0.08521652221679688
Memory occpied: (1826.0, 302.0)
Memory occpied: (1826.0, 770.0)
Memory occpied: (1826.0, 1236.0)
Time for forward pass: 3.881057024002075
Memory occpied: (4410.0, 4236.0)
Time for backpropagation: 0.05314207077026367
GPU memory for training: 5.948799133300781                          

One training iteration takes: 4.628023147583008 seconds
Index: 0
Memory occpied: (2364.0, 4236.0)
Memory occpied: (2364.0, 4236.0)
Memory occpied: (2364.0, 4236.0)
Memory occpied: (2364.0, 4236.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.632755994796753 seconds
Memory occpied: (2364.0, 4236.0)
Streaming imagenet data took 10.806886434555054 seconds
Then, training+dataloading take 10.823782920837402 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5911052227020264
Time for copying to cuda: 0.08429670333862305
Time for forward pass: 0.16015982627868652
Time for backpropagation: 0.0029485225677490234
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 0.9792051315307617 seconds
Index: 1
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.697416543960571 seconds
Streaming imagenet data took 10.821221351623535 seconds
Then, training+dataloading take 10.836371183395386 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6426410675048828
Time for copying to cuda: 0.08499288558959961
Time for forward pass: 0.1607215404510498
Time for backpropagation: 0.0028879642486572266
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 1.0596678256988525 seconds
Index: 2
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.035747528076172 seconds
Streaming imagenet data took 12.209781408309937 seconds
Then, training+dataloading take 12.226721286773682 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (3402.0, 4244.0)
Time of next(dataloader) is: 0.6588892936706543
Time for copying to cuda: 0.08455753326416016
Time for forward pass: 0.16080331802368164
Time for backpropagation: 0.002977609634399414
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 1.0307807922363281 seconds
Index: 3
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.06389832496643 seconds
Streaming imagenet data took 12.186334609985352 seconds
Then, training+dataloading take 12.202758073806763 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6290910243988037
Time for copying to cuda: 0.0852348804473877
Time for forward pass: 0.1607818603515625
Time for backpropagation: 0.002931356430053711
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 1.0129420757293701 seconds
Index: 4
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.71918535232544 seconds
Streaming imagenet data took 10.906773090362549 seconds
Then, training+dataloading take 10.922075748443604 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (3402.0, 4244.0)
Time of next(dataloader) is: 0.6371502876281738
Time for copying to cuda: 0.08461451530456543
Time for forward pass: 0.16071271896362305
Time for backpropagation: 0.0029611587524414062
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 1.013021469116211 seconds
Index: 5
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.882429122924805 seconds
Streaming imagenet data took 11.00540041923523 seconds
Then, training+dataloading take 11.027373552322388 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6342411041259766
Time for copying to cuda: 0.08514165878295898
Time for forward pass: 0.16080307960510254
Time for backpropagation: 0.002946615219116211
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 1.0264010429382324 seconds
Index: 6
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 11.99097490310669 seconds
Streaming imagenet data took 12.21332573890686 seconds
Then, training+dataloading take 12.227495908737183 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Time of next(dataloader) is: 0.5682768821716309
Time for copying to cuda: 0.08526396751403809
Time for forward pass: 0.1607511043548584
Time for backpropagation: 0.0029265880584716797
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 0.9353494644165039 seconds
Index: 7
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.168970584869385 seconds
Streaming imagenet data took 12.395453214645386 seconds
Then, training+dataloading take 12.409528732299805 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Time of next(dataloader) is: 0.5828657150268555
Time for copying to cuda: 0.08541750907897949
Time for forward pass: 0.16081666946411133
Time for backpropagation: 0.0028839111328125
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 0.9652442932128906 seconds
Index: 8
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.831804513931274 seconds
Streaming imagenet data took 11.004513502120972 seconds
Then, training+dataloading take 11.018432855606079 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6429843902587891
Time for copying to cuda: 0.08530759811401367
Time for forward pass: 0.16089320182800293
Time for backpropagation: 0.0029604434967041016
GPU memory for training: 2.8050384521484375                          

Memory occpied: (3402.0, 4244.0)
One training iteration takes: 1.0223157405853271 seconds
Index: 9
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.53361439704895 seconds
Streaming imagenet data took 10.706939935684204 seconds
Then, training+dataloading take 10.721085548400879 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6398458480834961
Time for copying to cuda: 0.0854802131652832
Time for forward pass: 0.1608583927154541
Time for backpropagation: 0.002905130386352539
GPU memory for training: 2.8050384521484375                          

Memory occpied: (3402.0, 4244.0)
One training iteration takes: 1.0161478519439697 seconds
Index: 10
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.420488834381104 seconds
Streaming imagenet data took 12.544360637664795 seconds
Then, training+dataloading take 12.566580533981323 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6170110702514648
Time for copying to cuda: 0.14755010604858398
Memory occpied: (3402.0, 4244.0)
Time for forward pass: 0.16170740127563477
Time for backpropagation: 0.0028922557830810547
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 1.0491840839385986 seconds
Index: 11
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.20020318031311 seconds
Streaming imagenet data took 12.321724891662598 seconds
Then, training+dataloading take 12.343428611755371 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5662486553192139
Time for copying to cuda: 0.14425301551818848
Memory occpied: (3402.0, 4244.0)
Time for forward pass: 0.16133785247802734
Time for backpropagation: 0.0029540061950683594
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 1.0071303844451904 seconds
Index: 12
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.476831197738647 seconds
Streaming imagenet data took 10.64944338798523 seconds
Then, training+dataloading take 10.672807216644287 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6451435089111328
Time for copying to cuda: 0.08560848236083984
Time for forward pass: 0.16077375411987305
Time for backpropagation: 0.0029196739196777344
GPU memory for training: 2.8050384521484375                          

Memory occpied: (3402.0, 4244.0)
One training iteration takes: 1.0254459381103516 seconds
Index: 13
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.994578123092651 seconds
Memory occpied: (3402.0, 4244.0)
Streaming imagenet data took 11.168006658554077 seconds
Then, training+dataloading take 11.191181898117065 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5888171195983887
Time for copying to cuda: 0.08568191528320312
Time for forward pass: 0.1608123779296875
Time for backpropagation: 0.002942800521850586
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 0.9669744968414307 seconds
Index: 14
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 11.980825424194336 seconds
Streaming imagenet data took 12.157644987106323 seconds
Then, training+dataloading take 12.171792268753052 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6507766246795654
Time for copying to cuda: 0.08508920669555664
Time for forward pass: 0.16085028648376465
Time for backpropagation: 0.0029098987579345703
GPU memory for training: 2.8050384521484375                          

Memory occpied: (3402.0, 4244.0)
One training iteration takes: 1.0123183727264404 seconds
Index: 15
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.159311532974243 seconds
Memory occpied: (3402.0, 4244.0)
Streaming imagenet data took 12.334990739822388 seconds
Then, training+dataloading take 12.358304500579834 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5983731746673584
Time for copying to cuda: 0.08565425872802734
Time for forward pass: 0.16083359718322754
Time for backpropagation: 0.0029218196868896484
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 0.9719769954681396 seconds
Index: 16
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.836727857589722 seconds
Streaming imagenet data took 11.02388334274292 seconds
Then, training+dataloading take 11.036535739898682 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Time of next(dataloader) is: 0.6555376052856445
Time for copying to cuda: 0.08501315116882324
Time for forward pass: 0.16074657440185547
Time for backpropagation: 0.003243684768676758
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 1.0407214164733887 seconds
Index: 17
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 11.127098560333252 seconds
Streaming imagenet data took 11.252188444137573 seconds
Then, training+dataloading take 11.268747568130493 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7423322200775146
Time for copying to cuda: 0.08506202697753906
Time for forward pass: 0.16133546829223633
Time for backpropagation: 0.00293731689453125
GPU memory for training: 2.8050384521484375                          

Memory occpied: (3402.0, 4244.0)
One training iteration takes: 1.127192497253418 seconds
Index: 18
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.407490015029907 seconds
Streaming imagenet data took 12.532238721847534 seconds
Then, training+dataloading take 12.553390979766846 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6010777950286865
Time for copying to cuda: 0.08499979972839355
Time for forward pass: 0.16123199462890625
Time for backpropagation: 0.0030069351196289062
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 0.9568800926208496 seconds
Index: 19
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.056123733520508 seconds
Streaming imagenet data took 12.228694677352905 seconds
Then, training+dataloading take 12.24454665184021 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Memory occpied: (3402.0, 4244.0)
Time of next(dataloader) is: 0.5807714462280273
Time for copying to cuda: 0.0851895809173584
Time for forward pass: 0.16067790985107422
Time for backpropagation: 0.002901315689086914
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 0.9621448516845703 seconds
Index: 20
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.53781008720398 seconds
Streaming imagenet data took 10.660461902618408 seconds
Then, training+dataloading take 10.682174444198608 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Memory occpied: (3402.0, 4244.0)
Time of next(dataloader) is: 0.6132729053497314
Time for copying to cuda: 0.08472371101379395
Time for forward pass: 0.16083478927612305
Time for backpropagation: 0.0029282569885253906
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 0.9835693836212158 seconds
Index: 21
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 10.675636529922485 seconds
Streaming imagenet data took 10.799073696136475 seconds
Then, training+dataloading take 10.821108102798462 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5709350109100342
Time for copying to cuda: 0.12828373908996582
Time for forward pass: 0.16139578819274902
Time for backpropagation: 0.003056764602661133
GPU memory for training: 2.8050384521484375                          

Memory occpied: (3402.0, 4244.0)
One training iteration takes: 0.9781591892242432 seconds
Index: 22
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.328979015350342 seconds
Streaming imagenet data took 12.45699429512024 seconds
Then, training+dataloading take 12.48021125793457 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5825107097625732
Time for copying to cuda: 0.12833118438720703
Memory occpied: (3402.0, 4244.0)
Time for forward pass: 0.16131186485290527
Time for backpropagation: 0.0030934810638427734
GPU memory for training: 2.8050384521484375                          

One training iteration takes: 0.9976246356964111 seconds
Index: 23
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Memory occpied: (3402.0, 4244.0)
Read 330.16800117492676 MBs for this batch
Executing all posts took 12.253013372421265 seconds
Streaming imagenet data took 12.376709938049316 seconds
Then, training+dataloading take 12.392603874206543 seconds

Epoch: 0
Time of next(dataloader) is: 0.6434087753295898
Time for copying to cuda: 0.13265609741210938
Memory occpied: (3402.0, 4244.0)
Time for forward pass: 0.16081571578979492
Time for backpropagation: 0.002946138381958008
GPU memory for training: 2.8050384521484375                          

The whole process took 299.73168778419495 seconds
