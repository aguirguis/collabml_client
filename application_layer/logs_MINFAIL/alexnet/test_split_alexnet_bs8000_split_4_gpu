Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=4, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.236660531926 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 4 17
Intermediate:  4271.484375
2.18896484375
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 2.76318359375
Mem usage  1250.0 3.0
Using split index: 4
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 49.39922618865967 seconds
Memory occpied: (1494.0, 3.0)
Streaming imagenet data took 51.29163384437561 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Time of next(dataloader) is: 2.8233020305633545
Memory occpied: (5766.0, 3.0)
Time for copying to cuda: 1.1640913486480713
Memory occpied: (5766.0, 2470.0)
Memory occpied: (5766.0, 2926.0)
Memory occpied: (5766.0, 5122.0)
Memory occpied: (12494.0, 14992.0)
Memory occpied: (11844.0, 14992.0)
Memory occpied: (11844.0, 14496.0)
Memory occpied: (11852.0, 14496.0)
Time for forward pass: 9.389067888259888
Time for backpropagation: 0.055220842361450195
GPU memory for training: 24.208136081695557                          

One training iteration takes: 14.00475788116455 seconds
Index: 0
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 51.538618326187134 seconds
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Streaming imagenet data took 53.374141454696655 seconds
Then, training+dataloading take 53.57118487358093 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (6778.0, 14504.0)
Memory occpied: (6778.0, 14504.0)
Time of next(dataloader) is: 3.1540071964263916
Memory occpied: (6778.0, 14504.0)
Time for copying to cuda: 1.226412057876587
Memory occpied: (14752.0, 14512.0)
Time for forward pass: 0.9968514442443848
Time for backpropagation: 0.0031409263610839844
GPU memory for training: 17.113630771636963                          

One training iteration takes: 5.97780704498291 seconds
Index: 1
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 54.27711224555969 seconds
Memory occpied: (14752.0, 14512.0)
Streaming imagenet data took 56.23222827911377 seconds
Then, training+dataloading take 56.44556188583374 seconds
Memory occpied: (14752.0, 14512.0)
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 3.17939829826355
Memory occpied: (14752.0, 14512.0)
Time for copying to cuda: 1.237464189529419
Time for forward pass: 1.0029315948486328
Time for backpropagation: 0.0034270286560058594
GPU memory for training: 17.113630771636963                          

Memory occpied: (14752.0, 14512.0)
One training iteration takes: 6.043642282485962 seconds
Index: 2
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 53.793604135513306 seconds
Memory occpied: (14752.0, 14512.0)
Streaming imagenet data took 55.74457144737244 seconds
Then, training+dataloading take 55.91100597381592 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 3.046339511871338
Memory occpied: (14752.0, 14512.0)
Time for copying to cuda: 1.211442232131958
Time for forward pass: 1.002168893814087
Time for backpropagation: 0.0033957958221435547
GPU memory for training: 17.113630771636963                          

Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
One training iteration takes: 10.834059238433838 seconds
Index: 3
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 53.4136643409729 seconds
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Streaming imagenet data took 55.291431188583374 seconds
Then, training+dataloading take 55.58164620399475 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 3.0357511043548584
Memory occpied: (14752.0, 14512.0)
Time for copying to cuda: 1.1994099617004395
Memory occpied: (14752.0, 14512.0)
Time for forward pass: 1.0399158000946045
Time for backpropagation: 0.0030889511108398438
GPU memory for training: 17.113630771636963                          

Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
One training iteration takes: 10.767640829086304 seconds
Index: 4
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 4271.836250305176 MBs for this batch
Executing all posts took 52.005396604537964 seconds
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Streaming imagenet data took 54.00198316574097 seconds
Then, training+dataloading take 54.20839309692383 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 3.1339111328125
Memory occpied: (14752.0, 14512.0)
Time for copying to cuda: 1.236687421798706
Memory occpied: (14752.0, 14512.0)
Time for forward pass: 0.9696710109710693
Time for backpropagation: 0.0031061172485351562
GPU memory for training: 17.113630771636963                          

One training iteration takes: 5.967139959335327 seconds
Index: 5
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Memory occpied: (14752.0, 14512.0)
Read 1067.959062576294 MBs for this batch
Executing all posts took 20.1232750415802 seconds
Streaming imagenet data took 20.69908046722412 seconds
Then, training+dataloading take 20.80460500717163 seconds

Epoch: 0
Memory occpied: (14752.0, 14512.0)
Time of next(dataloader) is: 1.1255204677581787
Memory occpied: (14752.0, 14512.0)
Time for copying to cuda: 0.3845059871673584
Memory occpied: (9488.0, 12376.0)
Time for forward pass: 1.7433063983917236
Time for backpropagation: 0.00293731689453125
GPU memory for training: 8.967073440551758                          

The whole process took 358.23727226257324 seconds
