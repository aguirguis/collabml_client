Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=15, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Recorded bandwidth: 908.0964160508115 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 15 17
Intermediate:  281.25
4.107421875
Total layers size  4.189361572265625
Fixed, scale_with_bsz  233.08120727539062 4.681640625
Mem usage  1250.0 3.0
Using split index: 15
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
8
Start 0, end 8000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 13.724008560180664 seconds
Streaming imagenet data took 13.83204197883606 seconds
The mode is:  split
8
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.566124677658081
Memory occpied: (1494.0, 3.0)
Time for copying to cuda: 0.0728909969329834
Memory occpied: (1776.0, 652.0)
Memory occpied: (1776.0, 1064.0)
Time for forward pass: 3.512747049331665
Time for backpropagation: 0.12350916862487793
GPU memory for training: 1.492340087890625                          

Memory occpied: (2340.0, 1782.0)
One training iteration takes: 4.396636486053467 seconds
Index: 0
Memory occpied: (2484.0, 1782.0)
Memory occpied: (2484.0, 1782.0)
Memory occpied: (2484.0, 1782.0)
Memory occpied: (2484.0, 1782.0)
Memory occpied: (2484.0, 1782.0)
Memory occpied: (2484.0, 1782.0)
Memory occpied: (2484.0, 1782.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 13.503451347351074 seconds
Streaming imagenet data took 13.611509561538696 seconds
Then, training+dataloading take 13.62599492073059 seconds
The mode is:  split
8
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6089413166046143
Time for copying to cuda: 0.07230234146118164
Memory occpied: (2484.0, 1790.0)
Time for forward pass: 0.23203611373901367
Time for backpropagation: 0.0030786991119384766
GPU memory for training: 1.6489944458007812                          

Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
One training iteration takes: 5.958676815032959 seconds
Index: 1
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 13.583604097366333 seconds
Streaming imagenet data took 13.693719863891602 seconds
Then, training+dataloading take 13.711604833602905 seconds
The mode is:  split
8
Start 24000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6235072612762451
Time for copying to cuda: 0.11967015266418457
Memory occpied: (2492.0, 1790.0)
Time for forward pass: 0.23125767707824707
Time for backpropagation: 0.0031223297119140625
GPU memory for training: 1.6489944458007812                          

One training iteration takes: 1.112626075744629 seconds
Index: 2
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 13.834860563278198 seconds
Streaming imagenet data took 13.94327425956726 seconds
Then, training+dataloading take 13.962479829788208 seconds
The mode is:  split
8
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6311159133911133
Time for copying to cuda: 0.0726470947265625
Memory occpied: (2492.0, 1790.0)
Time for forward pass: 0.21641230583190918
Time for backpropagation: 0.002971649169921875
GPU memory for training: 1.6489944458007812                          

One training iteration takes: 1.0710253715515137 seconds
Index: 3
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 13.7713041305542 seconds
Streaming imagenet data took 13.879184007644653 seconds
Then, training+dataloading take 13.896214485168457 seconds
The mode is:  split
8
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5991086959838867
Time for copying to cuda: 0.12076687812805176
Memory occpied: (2492.0, 1790.0)
Time for forward pass: 0.23141717910766602
Time for backpropagation: 0.0030450820922851562
GPU memory for training: 1.6489944458007812                          

One training iteration takes: 1.065950632095337 seconds
Index: 4
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 13.65912652015686 seconds
Streaming imagenet data took 13.769123554229736 seconds
Then, training+dataloading take 13.785493850708008 seconds
The mode is:  split
8
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6410431861877441
Time for copying to cuda: 0.12112212181091309
Memory occpied: (2492.0, 1790.0)
Time for forward pass: 0.2316422462463379
Time for backpropagation: 0.003046274185180664
GPU memory for training: 1.6489944458007812                          

One training iteration takes: 1.122396469116211 seconds
Index: 5
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Memory occpied: (2492.0, 1790.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.3546142578125 seconds
Streaming imagenet data took 9.433633804321289 seconds
Then, training+dataloading take 9.442212104797363 seconds

Epoch: 0
Memory occpied: (2492.0, 1790.0)
Time of next(dataloader) is: 0.4986555576324463
Time for copying to cuda: 0.018469572067260742
Time for forward pass: 0.08449578285217285
Time for backpropagation: 0.0029773712158203125
GPU memory for training: 1.2132091522216797                          

The whole process took 100.00692415237427 seconds
