Namespace(batch_size=4000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, manual_split=False, model='myresnet18', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.4741851721033 Mbps
[3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
133802.66666666666
44.591949462890625 26.733072916666668
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
Start 0, end 4000, post_step 1000

Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2515.0, 3.0)
Memory occpied: (2579.0, 384.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 22.87319016456604 seconds
Streaming imagenet data took 23.065284729003906 seconds
Start 4000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (2579.0, 824.0)
Time of next(dataloader) is: 0.6182842254638672
Time for copying to cuda: 0.10880589485168457
Memory occpied: (3581.0, 1815.0)
Memory occpied: (3581.0, 2205.0)
Memory occpied: (3581.0, 2631.0)
Memory occpied: (13415.0, 12779.0)
Time for forward pass: 5.097249746322632
Memory occpied: (13389.0, 12787.0)
Memory occpied: (13389.0, 12755.0)
Time for backpropagation: 2.616259813308716
GPU memory for training: 19.75068759918213                          

One training iteration takes: 8.560733318328857 seconds
Index: 0
Memory occpied: (13393.0, 2955.0)
Memory occpied: (13393.0, 2955.0)
Memory occpied: (13393.0, 2955.0)
Memory occpied: (13393.0, 2955.0)
Memory occpied: (13393.0, 2955.0)
Memory occpied: (13393.0, 2955.0)
Memory occpied: (13393.0, 2955.0)
Memory occpied: (13393.0, 2955.0)
Memory occpied: (13555.0, 2963.0)
Memory occpied: (13555.0, 2963.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 20.97036075592041 seconds
Streaming imagenet data took 21.168340921401978 seconds
Then, training+dataloading take 21.194473266601562 seconds
Start 8000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (13555.0, 2963.0)
Time of next(dataloader) is: 0.6681380271911621
Time for copying to cuda: 0.09919929504394531
Time for forward pass: 0.3578190803527832
Time for backpropagation: 0.004700183868408203
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.2706964015960693 seconds
Index: 1
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 20.464299201965332 seconds
Streaming imagenet data took 20.608590602874756 seconds
Then, training+dataloading take 20.63646674156189 seconds
Start 12000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6404588222503662
Time for copying to cuda: 0.10017633438110352
Time for forward pass: 0.1716914176940918
Time for backpropagation: 0.004801750183105469
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.039060115814209 seconds
Index: 2
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 20.24330186843872 seconds
Streaming imagenet data took 20.393000602722168 seconds
Then, training+dataloading take 20.414464712142944 seconds
Start 16000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6850295066833496
Memory occpied: (13571.0, 5529.0)
Time for copying to cuda: 0.09862065315246582
Time for forward pass: 0.16905450820922852
Time for backpropagation: 0.004279136657714844
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.086601972579956 seconds
Index: 3
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 20.32232666015625 seconds
Streaming imagenet data took 20.466954469680786 seconds
Then, training+dataloading take 20.491368055343628 seconds
Start 20000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (13571.0, 5529.0)
Time of next(dataloader) is: 0.7199184894561768
Time for copying to cuda: 0.09884166717529297
Time for forward pass: 0.17074322700500488
Time for backpropagation: 0.004195690155029297
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.1172206401824951 seconds
Index: 4
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 19.89106321334839 seconds
Streaming imagenet data took 20.0338191986084 seconds
Then, training+dataloading take 20.05896234512329 seconds
Start 24000, end 28000, post_step 1000


Epoch: 0
Memory occpied: (13571.0, 5529.0)
Time of next(dataloader) is: 0.6878640651702881
Time for copying to cuda: 0.09865856170654297
Time for forward pass: 0.1690661907196045
Time for backpropagation: 0.004271745681762695
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.113417387008667 seconds
Index: 5
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 19.689191818237305 seconds
Memory occpied: (13571.0, 5529.0)
Streaming imagenet data took 19.888139724731445 seconds
Then, training+dataloading take 19.91283416748047 seconds
Start 28000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6822097301483154
Time for copying to cuda: 0.09855461120605469
Time for forward pass: 0.20696711540222168
Time for backpropagation: 0.004769086837768555
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.1228938102722168 seconds
Index: 6
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 20.509456157684326 seconds
Memory occpied: (13571.0, 5529.0)
Streaming imagenet data took 20.71132206916809 seconds
Then, training+dataloading take 20.73410129547119 seconds
Start 32000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6867399215698242
Time for copying to cuda: 0.10294008255004883
Time for forward pass: 0.2081291675567627
Time for backpropagation: 0.0047037601470947266
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.1587271690368652 seconds
Index: 7
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 21.058539867401123 seconds
Streaming imagenet data took 21.259979248046875 seconds
Then, training+dataloading take 21.28240394592285 seconds
Start 36000, end 40000, post_step 1000


Epoch: 0
Memory occpied: (13571.0, 5529.0)
Time of next(dataloader) is: 0.7313456535339355
Time for copying to cuda: 0.09937858581542969
Time for forward pass: 0.17084455490112305
Time for backpropagation: 0.004364967346191406
GPU memory for training: 4.462934970855713                          

Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
One training iteration takes: 6.0632219314575195 seconds
Index: 8
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 20.810542106628418 seconds
Streaming imagenet data took 20.951290607452393 seconds
Then, training+dataloading take 20.97414779663086 seconds
Start 40000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7172181606292725
Time for copying to cuda: 0.14559173583984375
Memory occpied: (13571.0, 5529.0)
Time for forward pass: 0.17103862762451172
Time for backpropagation: 0.004517078399658203
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.1658220291137695 seconds
Index: 9
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 20.44989562034607 seconds
Streaming imagenet data took 20.592577695846558 seconds
Then, training+dataloading take 20.616928815841675 seconds
Start 44000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (13571.0, 5529.0)
Time of next(dataloader) is: 0.7913155555725098
Time for copying to cuda: 0.09967041015625
Time for forward pass: 0.16454172134399414
Time for backpropagation: 0.004451751708984375
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.1910767555236816 seconds
Index: 10
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 21.42656135559082 seconds
Streaming imagenet data took 21.620946645736694 seconds
Then, training+dataloading take 21.641887664794922 seconds
Start 48000, end 50000, post_step 1000


Epoch: 0
Memory occpied: (13571.0, 5529.0)
Time of next(dataloader) is: 0.733483076095581
Time for copying to cuda: 0.10085105895996094
Time for forward pass: 0.17084479331970215
Time for backpropagation: 0.004475831985473633
GPU memory for training: 4.462934970855713                          

One training iteration takes: 1.1371965408325195 seconds
Index: 11
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (13571.0, 5529.0)
Memory occpied: (11380.0, 3906.0)
Memory occpied: (11380.0, 3906.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 14.178138732910156 seconds
Streaming imagenet data took 14.302926063537598 seconds
Then, training+dataloading take 14.318802833557129 seconds

Epoch: 0
Time of next(dataloader) is: 0.6506373882293701
Time for copying to cuda: 0.053464651107788086
Time for forward pass: 1.1115493774414062
Time for backpropagation: 1.8733434677124023
GPU memory for training: 11.56652307510376                          

Memory occpied: (11380.0, 3906.0)
The whole process took 275.8161828517914 seconds
