Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, manual_split=False, model='myresnet50', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.0070003910308 Mbps
[3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
133802.66666666666
97.49234008789062 110.86393229166667
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
Start 0, end 8000, post_step 1000

Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Memory occpied: (1222.0, 3.0)
Read 62.799354553222656 MBs for this batch
Executing all posts took 33.82620120048523 seconds
Streaming imagenet data took 33.855281591415405 seconds
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1222.0, 3.0)
Time of next(dataloader) is: 0.4691903591156006
Time for copying to cuda: 0.01765584945678711
Memory occpied: (1286.0, 324.0)
Memory occpied: (1286.0, 720.0)
Time for forward pass: 3.246500015258789
Time for backpropagation: 0.01996636390686035
GPU memory for training: 0.5360298156738281                          

Memory occpied: (1306.0, 1310.0)
One training iteration takes: 3.8311848640441895 seconds
Index: 0
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Memory occpied: (1550.0, 1310.0)
Read 62.799354553222656 MBs for this batch
Executing all posts took 34.40002489089966 seconds
Streaming imagenet data took 34.42738389968872 seconds
Then, training+dataloading take 34.433077812194824 seconds
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5162184238433838
Time for copying to cuda: 0.01709580421447754
Time for forward pass: 0.02567768096923828
Time for backpropagation: 0.009705781936645508
GPU memory for training: 0.5520062446594238                          

Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
One training iteration takes: 5.589329481124878 seconds
Index: 1
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Read 62.799354553222656 MBs for this batch
Executing all posts took 32.87659025192261 seconds
Streaming imagenet data took 32.90355730056763 seconds
Then, training+dataloading take 32.90931224822998 seconds
Start 24000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.571936845779419
Time for copying to cuda: 0.016728639602661133
Time for forward pass: 0.022497177124023438
Time for backpropagation: 0.006297588348388672
GPU memory for training: 0.5515599250793457                          

One training iteration takes: 0.760399341583252 seconds
Index: 2
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Read 62.799354553222656 MBs for this batch
Executing all posts took 36.54048728942871 seconds
Streaming imagenet data took 36.56761956214905 seconds
Then, training+dataloading take 36.573915004730225 seconds
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5800433158874512
Time for copying to cuda: 0.01682424545288086
Time for forward pass: 0.022745132446289062
Time for backpropagation: 0.006649494171142578
GPU memory for training: 0.5515599250793457                          

One training iteration takes: 0.7157821655273438 seconds
Index: 3
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Read 62.799354553222656 MBs for this batch
Executing all posts took 37.62066984176636 seconds
Streaming imagenet data took 37.647709369659424 seconds
Then, training+dataloading take 37.655556440353394 seconds
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5609650611877441
Time for copying to cuda: 0.016598224639892578
Time for forward pass: 0.022535324096679688
Time for backpropagation: 0.006402015686035156
GPU memory for training: 0.5515599250793457                          

One training iteration takes: 0.7371938228607178 seconds
Index: 4
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Read 62.799354553222656 MBs for this batch
Executing all posts took 33.058404207229614 seconds
Streaming imagenet data took 33.08567762374878 seconds
Then, training+dataloading take 33.09208273887634 seconds
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.561976432800293
Time for copying to cuda: 0.016864776611328125
Time for forward pass: 0.022496700286865234
Time for backpropagation: 0.0064051151275634766
GPU memory for training: 0.5515599250793457                          

One training iteration takes: 0.7451143264770508 seconds
Index: 5
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Memory occpied: (1578.0, 1318.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 12.759603023529053 seconds
Streaming imagenet data took 12.767765522003174 seconds
Then, training+dataloading take 12.769305229187012 seconds

Epoch: 0
Time of next(dataloader) is: 0.4873006343841553
Time for copying to cuda: 0.004483699798583984
Time for forward pass: 0.05295753479003906
Time for backpropagation: 0.008417129516601562
GPU memory for training: 0.4541773796081543                          

Memory occpied: (1578.0, 1318.0)
The whole process took 228.82851672172546 seconds
