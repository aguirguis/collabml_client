Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, manual_split=False, model='myvgg19', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 908.5961472546461 Mbps
[1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
133802.66666666666
548.0470275878906 119.18229166666667
Using split index: 36
Freezing the lower layers of the model (myvgg19) till index 36
Start 0, end 8000, post_step 1000

Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 68.0861086845398 seconds
Memory occpied: (1678.0, 3.0)
Streaming imagenet data took 69.43067073822021 seconds
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.3562746047973633
Time for copying to cuda: 0.7981312274932861
Time for forward pass: 3.400876998901367
Time for backpropagation: 0.00622868537902832
GPU memory for training: 7.937506198883057                          

One training iteration takes: 7.0774524211883545 seconds
Index: 0
Memory occpied: (1678.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Memory occpied: (6354.0, 4362.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 71.12845253944397 seconds
Memory occpied: (6354.0, 4362.0)
Streaming imagenet data took 72.39711332321167 seconds
Then, training+dataloading take 72.55412721633911 seconds
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.722214460372925
Time for copying to cuda: 0.809138298034668
Time for forward pass: 0.5832269191741943
Time for backpropagation: 0.004009246826171875
GPU memory for training: 8.724570751190186                          

Memory occpied: (6354.0, 4362.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
One training iteration takes: 9.52234172821045 seconds
Index: 1
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 67.64474105834961 seconds
Memory occpied: (7530.0, 4370.0)
Streaming imagenet data took 68.90560388565063 seconds
Then, training+dataloading take 69.07700085639954 seconds
Start 24000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.688389539718628
Time for copying to cuda: 0.7919497489929199
Time for forward pass: 0.611785888671875
Time for backpropagation: 0.003960609436035156
GPU memory for training: 8.724570751190186                          

Memory occpied: (7530.0, 4370.0)
One training iteration takes: 4.644609212875366 seconds
Index: 2
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 68.37359046936035 seconds
Memory occpied: (7530.0, 4370.0)
Streaming imagenet data took 69.72340416908264 seconds
Then, training+dataloading take 69.89220070838928 seconds
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.618974208831787
Time for copying to cuda: 0.7990400791168213
Time for forward pass: 0.6043014526367188
Time for backpropagation: 0.003954648971557617
GPU memory for training: 8.724570751190186                          

One training iteration takes: 4.61980938911438 seconds
Index: 3
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 81.70042490959167 seconds
Memory occpied: (7530.0, 4370.0)
Streaming imagenet data took 82.94377541542053 seconds
Then, training+dataloading take 83.11396884918213 seconds
Start 40000, end 48000, post_step 1000


Epoch: 0
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Time of next(dataloader) is: 2.735403537750244
Memory occpied: (7530.0, 4370.0)
Time for copying to cuda: 0.9588747024536133
Time for forward pass: 0.5886425971984863
Time for backpropagation: 0.0039010047912597656
GPU memory for training: 8.724570751190186                          

One training iteration takes: 4.80573844909668 seconds
Index: 4
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Read 3062.859504699707 MBs for this batch
Executing all posts took 68.56110000610352 seconds
Memory occpied: (7530.0, 4370.0)
Streaming imagenet data took 69.94391894340515 seconds
Then, training+dataloading take 70.11485624313354 seconds
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 2.605799913406372
Time for copying to cuda: 0.8010849952697754
Time for forward pass: 0.5918011665344238
Time for backpropagation: 0.004101276397705078
GPU memory for training: 8.724570751190186                          

One training iteration takes: 4.60027003288269 seconds
Index: 5
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Memory occpied: (7530.0, 4370.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 26.29540514945984 seconds
Memory occpied: (7530.0, 4370.0)
Streaming imagenet data took 26.69445538520813 seconds
Then, training+dataloading take 26.742252111434937 seconds

Epoch: 0
Time of next(dataloader) is: 1.0943233966827393
Memory occpied: (7530.0, 4370.0)
Time for copying to cuda: 0.20924878120422363
Time for forward pass: 0.21666693687438965
Time for backpropagation: 0.003692150115966797
GPU memory for training: 4.476007461547852                          

The whole process took 470.88546681404114 seconds
