Namespace(batch_size=10000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='alexnet', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Read 1248.1522588729858 MBs for this batch
Streaming imagenet data took 76.48399806022644 seconds

Epoch: 0
Time of next(dataloader) is: 37.76960778236389
Time for copying to cuda: 1.454986333847046
Time for forward pass: 13.108110189437866
Time for backpropagation: 0.003234386444091797
GPU memory for training: 21.566778659820557                          

One training iteration takes: 53.311545610427856 seconds
Index: 0
Memory occpied: (1350.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Memory occpied: (9248.0, 10808.0)
Read 1300.6842002868652 MBs for this batch
Streaming imagenet data took 77.78523921966553 seconds
Then, training+dataloading take 77.81337642669678 seconds

Epoch: 0
Time of next(dataloader) is: 41.84876298904419
Time for copying to cuda: 1.553398847579956
Time for forward pass: 3.444413900375366
Time for backpropagation: 0.0053975582122802734
GPU memory for training: 21.58678674697876                          

Memory occpied: (9248.0, 10808.0)
One training iteration takes: 48.51756811141968 seconds
Index: 1
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Memory occpied: (13996.0, 6376.0)
Read 1277.8009405136108 MBs for this batch
Streaming imagenet data took 87.51518678665161 seconds
Then, training+dataloading take 87.54544878005981 seconds

Epoch: 0
Time of next(dataloader) is: 41.45973563194275
Time for copying to cuda: 1.5298819541931152
Time for forward pass: 1.3812172412872314
Time for backpropagation: 0.0029168128967285156
GPU memory for training: 21.586891651153564                          

One training iteration takes: 46.05792021751404 seconds
Index: 2
Memory occpied: (13996.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Read 1286.9877223968506 MBs for this batch
Streaming imagenet data took 89.47579979896545 seconds
Then, training+dataloading take 89.51002717018127 seconds

Epoch: 0
Time of next(dataloader) is: 42.453346252441406
Time for copying to cuda: 1.4980261325836182
Time for forward pass: 0.009817838668823242
Time for backpropagation: 0.0028371810913085938
GPU memory for training: 21.586891651153564                          

Memory occpied: (14382.0, 15038.0)
One training iteration takes: 45.65870118141174 seconds
Index: 3
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Memory occpied: (14382.0, 15038.0)
Read 1282.2492055892944 MBs for this batch
Streaming imagenet data took 90.60401725769043 seconds
Then, training+dataloading take 90.63681387901306 seconds

Epoch: 0
Time of next(dataloader) is: 41.39421081542969
Time for copying to cuda: 1.4479210376739502
Time for forward pass: 0.5034148693084717
Time for backpropagation: 0.003087282180786133
GPU memory for training: 21.586891651153564                          

Memory occpied: (14382.0, 15038.0)
The whole process took 472.8421130180359 seconds
