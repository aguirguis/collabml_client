Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='myalexnet', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
Recorded bandwidth: 4446.068022746197 Mbps
[774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
133802.66666666666
233.08120727539062 4.164713541666667
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
Start 0, end 8000, post_step 1000

Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 22.323468923568726 seconds
Streaming imagenet data took 22.43131923675537 seconds
Start 8000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6746280193328857
Time for copying to cuda: 0.07775282859802246
Memory occpied: (1632.0, 18.0)
Memory occpied: (1632.0, 504.0)
Memory occpied: (1632.0, 920.0)
Time for forward pass: 3.4527740478515625
Time for backpropagation: 0.0053598880767822266
GPU memory for training: 1.6641554832458496                          

One training iteration takes: 4.348222255706787 seconds
Index: 0
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Memory occpied: (2332.0, 1820.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 23.30781126022339 seconds
Streaming imagenet data took 23.41951298713684 seconds
Then, training+dataloading take 23.43203616142273 seconds
Start 16000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8013701438903809
Time for copying to cuda: 0.07640218734741211
Time for forward pass: 0.24861454963684082
Time for backpropagation: 0.002611875534057617
GPU memory for training: 1.8206424713134766                          

One training iteration takes: 1.310974359512329 seconds
Index: 1
Memory occpied: (2332.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 22.59091830253601 seconds
Streaming imagenet data took 22.700350999832153 seconds
Then, training+dataloading take 22.717073678970337 seconds
Start 24000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7349765300750732
Time for copying to cuda: 0.1338639259338379
Memory occpied: (2494.0, 1828.0)
Time for forward pass: 0.24671006202697754
Time for backpropagation: 0.002727985382080078
GPU memory for training: 1.8206424713134766                          

One training iteration takes: 1.2638881206512451 seconds
Index: 2
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 23.545207738876343 seconds
Streaming imagenet data took 23.652840614318848 seconds
Then, training+dataloading take 23.66900944709778 seconds
Start 32000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7785077095031738
Time for copying to cuda: 0.07725334167480469
Time for forward pass: 0.24059772491455078
Time for backpropagation: 0.0030646324157714844
GPU memory for training: 1.8206424713134766                          

One training iteration takes: 1.2343757152557373 seconds
Index: 3
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 22.655908584594727 seconds
Streaming imagenet data took 22.765395879745483 seconds
Then, training+dataloading take 22.78376007080078 seconds
Start 40000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7568013668060303
Time for copying to cuda: 0.07718729972839355
Memory occpied: (2494.0, 1828.0)
Time for forward pass: 0.24466180801391602
Time for backpropagation: 0.0026323795318603516
GPU memory for training: 1.8206424713134766                          

One training iteration takes: 1.2224810123443604 seconds
Index: 4
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 281.5751037597656 MBs for this batch
Executing all posts took 22.052126169204712 seconds
Streaming imagenet data took 22.1593074798584 seconds
Then, training+dataloading take 22.179256677627563 seconds
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7328054904937744
Time for copying to cuda: 0.13569903373718262
Time for forward pass: 0.2256910800933838
Time for backpropagation: 0.002941131591796875
GPU memory for training: 1.8206424713134766                          

Memory occpied: (2494.0, 1828.0)
One training iteration takes: 1.250450849533081 seconds
Index: 5
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Memory occpied: (2494.0, 1828.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 14.629815816879272 seconds
Streaming imagenet data took 14.656633138656616 seconds
Then, training+dataloading take 14.660270929336548 seconds

Epoch: 0
Time of next(dataloader) is: 0.540153980255127
Time for copying to cuda: 0.019724607467651367
Time for forward pass: 0.11106705665588379
Time for backpropagation: 0.0029535293579101562
GPU memory for training: 1.2567806243896484                          

Memory occpied: (2494.0, 1828.0)
The whole process took 159.77531719207764 seconds
