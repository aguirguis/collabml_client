Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=9, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 16393.203275955788 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 2148689939.786077 1505280000.0
All candidates indexes:  (array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 9 17
Intermediate:  0.1650390625
1.47705078125
Total layers size  4.189361572265625
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Using split index: 9
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
1
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1991.0, 3.0)
Memory occpied: (2419.0, 3.0)
Memory occpied: (3005.0, 3.0)
Memory occpied: (3025.0, 3.0)
Memory occpied: (3025.0, 3.0)
Memory occpied: (3025.0, 3.0)
Memory occpied: (3025.0, 3.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 13.15820574760437 seconds
Streaming imagenet data took 13.261007070541382 seconds
The mode is:  split
1
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.09667086601257324
Memory occpied: (3025.0, 3.0)
Time for copying to cuda: 0.03709673881530762
Memory occpied: (3191.0, 622.0)
Memory occpied: (3357.0, 1533.0)
Time for forward pass: 3.6801202297210693
Memory occpied: (4855.0, 3937.0)
Time for backpropagation: 0.05387568473815918
GPU memory for training: 3.466838836669922                          

One training iteration takes: 3.8748562335968018 seconds
Index: 0
Memory occpied: (4035.0, 6009.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 6.392664194107056 seconds
Memory occpied: (4405.0, 6017.0)
Streaming imagenet data took 6.4552388191223145 seconds
Then, training+dataloading take 6.464104175567627 seconds
The mode is:  split
1
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05329608917236328
Time for copying to cuda: 0.036400794982910156
Time for forward pass: 0.07771086692810059
Time for backpropagation: 0.002293825149536133
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.1759505271911621 seconds
Index: 1
Memory occpied: (4995.0, 6025.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 6.3643553256988525 seconds
Streaming imagenet data took 6.425716161727905 seconds
Then, training+dataloading take 6.433210611343384 seconds
The mode is:  split
1
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04941892623901367
Time for copying to cuda: 0.03685736656188965
Time for forward pass: 0.10350489616394043
Time for backpropagation: 0.002350330352783203
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.19841980934143066 seconds
Index: 2
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.712961435317993 seconds
Streaming imagenet data took 2.7750608921051025 seconds
Then, training+dataloading take 2.783933401107788 seconds
The mode is:  split
1
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.049219369888305664
Time for copying to cuda: 0.03667879104614258
Time for forward pass: 0.10345149040222168
Time for backpropagation: 0.0023088455200195312
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.19799065589904785 seconds
Index: 3
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.7783586978912354 seconds
Streaming imagenet data took 2.8400356769561768 seconds
Then, training+dataloading take 2.848565101623535 seconds
The mode is:  split
1
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.04897427558898926
Time for copying to cuda: 0.06734824180603027
Time for forward pass: 0.11102008819580078
Time for backpropagation: 0.0032205581665039062
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.2343282699584961 seconds
Index: 4
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.7269351482391357 seconds
Streaming imagenet data took 2.7919061183929443 seconds
Then, training+dataloading take 2.801117420196533 seconds
The mode is:  split
1
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10574221611022949
Time for copying to cuda: 0.03704643249511719
Memory occpied: (5585.0, 6033.0)
Time for forward pass: 0.1034550666809082
Time for backpropagation: 0.002371549606323242
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.255173921585083 seconds
Index: 5
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 4.422175645828247 seconds
Streaming imagenet data took 4.484472274780273 seconds
Then, training+dataloading take 4.493480682373047 seconds
The mode is:  split
1
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05375266075134277
Time for copying to cuda: 0.036673545837402344
Time for forward pass: 0.10335016250610352
Time for backpropagation: 0.002481698989868164
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.2027449607849121 seconds
Index: 6
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.369117259979248 seconds
Streaming imagenet data took 3.432770013809204 seconds
Then, training+dataloading take 3.4417564868927 seconds
The mode is:  split
1
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0563197135925293
Time for copying to cuda: 0.036997079849243164
Time for forward pass: 0.1827700138092041
Time for backpropagation: 0.0023186206817626953
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.28577446937561035 seconds
Index: 7
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 4.163172960281372 seconds
Streaming imagenet data took 4.226883411407471 seconds
Then, training+dataloading take 4.233125448226929 seconds
The mode is:  split
1
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.053743839263916016
Time for copying to cuda: 0.037108421325683594
Time for forward pass: 0.10340714454650879
Time for backpropagation: 0.0023758411407470703
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.20302915573120117 seconds
Index: 8
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 4.344507217407227 seconds
Streaming imagenet data took 4.408479690551758 seconds
Then, training+dataloading take 4.4181342124938965 seconds
The mode is:  split
1
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.059155941009521484
Time for copying to cuda: 0.03997206687927246
Time for forward pass: 0.1371781826019287
Time for backpropagation: 0.002347230911254883
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.2459118366241455 seconds
Index: 9
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.8809256553649902 seconds
Streaming imagenet data took 3.943502187728882 seconds
Then, training+dataloading take 3.952718734741211 seconds
The mode is:  split
1
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05830097198486328
Time for copying to cuda: 0.03706502914428711
Time for forward pass: 0.11632943153381348
Time for backpropagation: 0.0025272369384765625
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.22191810607910156 seconds
Index: 10
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 4.159242391586304 seconds
Streaming imagenet data took 4.220693588256836 seconds
Then, training+dataloading take 4.230210542678833 seconds
The mode is:  split
1
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.11971282958984375
Time for copying to cuda: 0.04496955871582031
Memory occpied: (5585.0, 6033.0)
Time for forward pass: 0.1903996467590332
Time for backpropagation: 0.002626657485961914
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.3652007579803467 seconds
Index: 11
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.6776840686798096 seconds
Streaming imagenet data took 3.7402284145355225 seconds
Then, training+dataloading take 3.7471930980682373 seconds
The mode is:  split
1
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.10338902473449707
Time for copying to cuda: 0.03752756118774414
Time for forward pass: 0.13860869407653809
Time for backpropagation: 0.0037415027618408203
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.2870500087738037 seconds
Index: 12
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.7461066246032715 seconds
Streaming imagenet data took 3.858153820037842 seconds
Then, training+dataloading take 3.8653957843780518 seconds
The mode is:  split
1
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05511736869812012
Time for copying to cuda: 0.08611440658569336
Memory occpied: (5585.0, 6033.0)
Time for forward pass: 0.1413257122039795
Time for backpropagation: 0.0023958683013916016
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.2918667793273926 seconds
Index: 13
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 4.169761896133423 seconds
Streaming imagenet data took 4.2312562465667725 seconds
Then, training+dataloading take 4.240572690963745 seconds
The mode is:  split
1
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05453634262084961
Time for copying to cuda: 0.036922454833984375
Time for forward pass: 0.12704920768737793
Time for backpropagation: 0.003056764602661133
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.22857117652893066 seconds
Index: 14
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 4.200265169143677 seconds
Streaming imagenet data took 4.263195991516113 seconds
Then, training+dataloading take 4.270578861236572 seconds
The mode is:  split
1
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05529904365539551
Time for copying to cuda: 0.04145073890686035
Time for forward pass: 0.19949865341186523
Time for backpropagation: 0.0028352737426757812
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.30623626708984375 seconds
Index: 15
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 4.278069496154785 seconds
Memory occpied: (5585.0, 6033.0)
Streaming imagenet data took 4.340870141983032 seconds
Then, training+dataloading take 4.353164434432983 seconds
The mode is:  split
1
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06253910064697266
Time for copying to cuda: 0.04153609275817871
Time for forward pass: 0.2034621238708496
Time for backpropagation: 0.002321004867553711
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.31716394424438477 seconds
Index: 16
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.83671236038208 seconds
Memory occpied: (5585.0, 6033.0)
Streaming imagenet data took 3.8979272842407227 seconds
Then, training+dataloading take 3.9068093299865723 seconds
The mode is:  split
1
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06319856643676758
Time for copying to cuda: 0.0370631217956543
Time for forward pass: 0.1034395694732666
Time for backpropagation: 0.002371072769165039
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.21363472938537598 seconds
Index: 17
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.1845250129699707 seconds
Streaming imagenet data took 3.2465505599975586 seconds
Then, training+dataloading take 3.255838394165039 seconds
The mode is:  split
1
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.06229424476623535
Time for copying to cuda: 0.036830902099609375
Time for forward pass: 0.11182785034179688
Time for backpropagation: 0.0036683082580566406
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.21855449676513672 seconds
Index: 18
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.9293763637542725 seconds
Streaming imagenet data took 4.0403406620025635 seconds
Then, training+dataloading take 4.050943851470947 seconds
The mode is:  split
1
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.1217958927154541
Memory occpied: (5585.0, 6033.0)
Time for copying to cuda: 0.03690838813781738
Time for forward pass: 0.10367226600646973
Time for backpropagation: 0.0024602413177490234
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.271831750869751 seconds
Index: 19
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.9047350883483887 seconds
Streaming imagenet data took 2.9660134315490723 seconds
Then, training+dataloading take 2.975393056869507 seconds
The mode is:  split
1
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05376839637756348
Time for copying to cuda: 0.036750078201293945
Time for forward pass: 0.10347342491149902
Time for backpropagation: 0.0024557113647460938
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.20354843139648438 seconds
Index: 20
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.83292293548584 seconds
Streaming imagenet data took 2.894695281982422 seconds
Then, training+dataloading take 2.903111696243286 seconds
The mode is:  split
1
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.050054311752319336
Time for copying to cuda: 0.03677201271057129
Time for forward pass: 0.10354280471801758
Time for backpropagation: 0.002463817596435547
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.1992335319519043 seconds
Index: 21
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 3.1915664672851562 seconds
Streaming imagenet data took 3.25277042388916 seconds
Then, training+dataloading take 3.2623281478881836 seconds
The mode is:  split
1
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05012941360473633
Time for copying to cuda: 0.0368959903717041
Time for forward pass: 0.1033928394317627
Time for backpropagation: 0.002395153045654297
GPU memory for training: 1.8513984680175781                          

One training iteration takes: 0.19988679885864258 seconds
Index: 22
Memory occpied: (5585.0, 6033.0)
Memory occpied: (5585.0, 6033.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.805004596710205 seconds
Streaming imagenet data took 2.8670873641967773 seconds
Then, training+dataloading take 2.873199701309204 seconds

Epoch: 0
Time of next(dataloader) is: 0.0496363639831543
Time for copying to cuda: 0.03690075874328613
Time for forward pass: 0.10333824157714844
Time for backpropagation: 0.002756357192993164
GPU memory for training: 1.8513984680175781                          

The whole process took 109.96717119216919 seconds
