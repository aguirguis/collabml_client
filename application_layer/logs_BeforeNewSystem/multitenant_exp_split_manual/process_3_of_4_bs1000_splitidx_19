Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=19, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 14766.286177298833 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 1935446661.8309126 1505280000.0
All candidates indexes:  (array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 19 17
Intermediate:  0.015625
1.47705078125
Total layers size  4.189361572265625
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  3717.0 1524.0
Using split index: 19
WARNING! freeze_idx should be >= split_idx; setting freeze_idx to 19
Freezing the lower layers of the model (myalexnet) till index 19
The mode is:  split
1
Start 0, end 1000, post_step 1000

Memory occpied: (3717.0, 1524.0)
Memory occpied: (3717.0, 1524.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.214475631713867 seconds
Streaming imagenet data took 2.2210657596588135 seconds
The mode is:  split
1
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.012398481369018555
Time for copying to cuda: 0.004159212112426758
Memory occpied: (3733.0, 1669.0)
Memory occpied: (3733.0, 2135.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.1001782417297363 seconds
Streaming imagenet data took 2.1077916622161865 seconds
Memory occpied: (3733.0, 2559.0)
Time for forward pass: 3.2103843688964844
Time for backpropagation: 0.04917311668395996
GPU memory for training: 0.9415678977966309                          

One training iteration takes: 3.27717661857605 seconds
Index: 0
Then, training+dataloading take 3.277229070663452 seconds
The mode is:  split
1
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005774497985839844
Time for copying to cuda: 0.017277240753173828
Time for forward pass: 0.0397953987121582
Time for backpropagation: 0.0018260478973388672
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.06569933891296387 seconds
Index: 1
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.8646748065948486 seconds
Streaming imagenet data took 2.8718526363372803 seconds
Then, training+dataloading take 2.872448205947876 seconds
The mode is:  split
1
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007955312728881836
Time for copying to cuda: 0.003865957260131836
Time for forward pass: 0.03946995735168457
Time for backpropagation: 0.0019311904907226562
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.054360151290893555 seconds
Index: 2
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.2905519008636475 seconds
Memory occpied: (4409.0, 3045.0)
Streaming imagenet data took 2.2970640659332275 seconds
Then, training+dataloading take 2.2976157665252686 seconds
The mode is:  split
1
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007777214050292969
Time for copying to cuda: 0.0055694580078125
Time for forward pass: 0.06031394004821777
Time for backpropagation: 0.0019431114196777344
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.07676911354064941 seconds
Index: 3
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.8000497817993164 seconds
Streaming imagenet data took 3.804311990737915 seconds
Then, training+dataloading take 3.8048760890960693 seconds
The mode is:  split
1
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007442474365234375
Time for copying to cuda: 0.0038208961486816406
Time for forward pass: 0.039461612701416016
Time for backpropagation: 0.0019154548645019531
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.053781986236572266 seconds
Index: 4
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.130711078643799 seconds
Streaming imagenet data took 3.138814687728882 seconds
Then, training+dataloading take 3.139509439468384 seconds
The mode is:  split
1
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.01327371597290039
Time for copying to cuda: 0.0038721561431884766
Time for forward pass: 0.05257773399353027
Time for backpropagation: 0.0029439926147460938
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.07433795928955078 seconds
Index: 5
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.7700326442718506 seconds
Streaming imagenet data took 2.776883363723755 seconds
Then, training+dataloading take 2.7774884700775146 seconds
The mode is:  split
1
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007618904113769531
Time for copying to cuda: 0.0038504600524902344
Time for forward pass: 0.039516448974609375
Time for backpropagation: 0.002033233642578125
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05408358573913574 seconds
Index: 6
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.3930137157440186 seconds
Streaming imagenet data took 3.397190809249878 seconds
Then, training+dataloading take 3.39798641204834 seconds
The mode is:  split
1
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007472991943359375
Time for copying to cuda: 0.0038604736328125
Time for forward pass: 0.03944134712219238
Time for backpropagation: 0.0019099712371826172
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05379748344421387 seconds
Index: 7
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.808180093765259 seconds
Streaming imagenet data took 3.812282085418701 seconds
Then, training+dataloading take 3.81282639503479 seconds
The mode is:  split
1
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0075109004974365234
Time for copying to cuda: 0.0038254261016845703
Time for forward pass: 0.039505720138549805
Time for backpropagation: 0.0019526481628417969
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05392956733703613 seconds
Index: 8
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.8328452110290527 seconds
Streaming imagenet data took 3.8398187160491943 seconds
Then, training+dataloading take 3.840423583984375 seconds
The mode is:  split
1
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007744550704956055
Time for copying to cuda: 0.0037140846252441406
Time for forward pass: 0.03956770896911621
Time for backpropagation: 0.0019729137420654297
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05415081977844238 seconds
Index: 9
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 4.079906940460205 seconds
Streaming imagenet data took 4.084123134613037 seconds
Then, training+dataloading take 4.084981203079224 seconds
The mode is:  split
1
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007762432098388672
Time for copying to cuda: 0.0038313865661621094
Time for forward pass: 0.039423465728759766
Time for backpropagation: 0.0018897056579589844
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.053926706314086914 seconds
Index: 10
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.7897870540618896 seconds
Streaming imagenet data took 3.793905019760132 seconds
Then, training+dataloading take 3.794468641281128 seconds
The mode is:  split
1
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007506132125854492
Time for copying to cuda: 0.003818511962890625
Time for forward pass: 0.03945779800415039
Time for backpropagation: 0.0019321441650390625
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05386638641357422 seconds
Index: 11
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.1655008792877197 seconds
Streaming imagenet data took 3.1725149154663086 seconds
Then, training+dataloading take 3.173178195953369 seconds
The mode is:  split
1
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.008236408233642578
Time for copying to cuda: 0.0037071704864501953
Memory occpied: (4409.0, 3045.0)
Time for forward pass: 0.03959298133850098
Time for backpropagation: 0.0020792484283447266
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05490517616271973 seconds
Index: 12
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 4.192419052124023 seconds
Streaming imagenet data took 4.196570634841919 seconds
Then, training+dataloading take 4.197414398193359 seconds
The mode is:  split
1
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00766754150390625
Time for copying to cuda: 0.0038433074951171875
Time for forward pass: 0.03949785232543945
Time for backpropagation: 0.0019686222076416016
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05410575866699219 seconds
Index: 13
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.6122748851776123 seconds
Streaming imagenet data took 3.6164798736572266 seconds
Then, training+dataloading take 3.617035150527954 seconds
The mode is:  split
1
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007837533950805664
Time for copying to cuda: 0.003687620162963867
Time for forward pass: 0.03952479362487793
Time for backpropagation: 0.0019121170043945312
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05413341522216797 seconds
Index: 14
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 4.247021198272705 seconds
Streaming imagenet data took 4.253861427307129 seconds
Then, training+dataloading take 4.25445294380188 seconds
The mode is:  split
1
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007764577865600586
Time for copying to cuda: 0.004255533218383789
Time for forward pass: 0.06303000450134277
Time for backpropagation: 0.00202178955078125
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.07823586463928223 seconds
Index: 15
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.3604815006256104 seconds
Streaming imagenet data took 3.364582061767578 seconds
Then, training+dataloading take 3.3653929233551025 seconds
The mode is:  split
1
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007765769958496094
Time for copying to cuda: 0.0037200450897216797
Time for forward pass: 0.039633750915527344
Time for backpropagation: 0.002066373825073242
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05440688133239746 seconds
Index: 16
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.1678285598754883 seconds
Streaming imagenet data took 2.1732635498046875 seconds
Then, training+dataloading take 2.1738855838775635 seconds
The mode is:  split
1
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00770258903503418
Time for copying to cuda: 0.03600478172302246
Time for forward pass: 0.04016566276550293
Time for backpropagation: 0.002452850341796875
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.08822751045227051 seconds
Index: 17
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.8554141521453857 seconds
Streaming imagenet data took 2.862395763397217 seconds
Then, training+dataloading take 2.862990379333496 seconds
The mode is:  split
1
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007757663726806641
Time for copying to cuda: 0.0037949085235595703
Time for forward pass: 0.03958010673522949
Time for backpropagation: 0.0019402503967285156
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05411553382873535 seconds
Index: 18
Memory occpied: (4409.0, 3045.0)
Memory occpied: (4409.0, 3045.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.035398006439209 seconds
Streaming imagenet data took 3.043498992919922 seconds
Then, training+dataloading take 3.044278860092163 seconds
The mode is:  split
1
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.008117914199829102
Time for copying to cuda: 0.0037479400634765625
Time for forward pass: 0.040633440017700195
Time for backpropagation: 0.002803325653076172
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.05687546730041504 seconds
Index: 19
Memory occpied: (2206.0, 1524.0)
Memory occpied: (2206.0, 1524.0)
Memory occpied: (2206.0, 1524.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.3162009716033936 seconds
Streaming imagenet data took 3.3203158378601074 seconds
Then, training+dataloading take 3.3209009170532227 seconds
The mode is:  split
1
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007606029510498047
Time for copying to cuda: 0.0036487579345703125
Time for forward pass: 0.03942728042602539
Time for backpropagation: 0.0018947124481201172
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.053679704666137695 seconds
Index: 20
Memory occpied: (2206.0, 1524.0)
Memory occpied: (2206.0, 1524.0)
Memory occpied: (2206.0, 1524.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.1150689125061035 seconds
Streaming imagenet data took 3.1220600605010986 seconds
Then, training+dataloading take 3.122641086578369 seconds
The mode is:  split
1
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007772684097290039
Time for copying to cuda: 0.0036773681640625
Time for forward pass: 0.039346933364868164
Time for backpropagation: 0.0018587112426757812
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.053765058517456055 seconds
Index: 21
Memory occpied: (2206.0, 1524.0)
Memory occpied: (2206.0, 1524.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.3704071044921875 seconds
Streaming imagenet data took 2.374547243118286 seconds
Then, training+dataloading take 2.3753573894500732 seconds
The mode is:  split
1
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007701873779296875
Time for copying to cuda: 0.0036509037017822266
Time for forward pass: 0.03953886032104492
Time for backpropagation: 0.0019512176513671875
GPU memory for training: 0.9716653823852539                          

One training iteration takes: 0.054000139236450195 seconds
Index: 22
Memory occpied: (2206.0, 1524.0)
Memory occpied: (2206.0, 1524.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.6301655769348145 seconds
Streaming imagenet data took 2.6343042850494385 seconds
Then, training+dataloading take 2.6348605155944824 seconds

Epoch: 0
Time of next(dataloader) is: 0.007485628128051758
Time for copying to cuda: 0.003633737564086914
Time for forward pass: 0.0394444465637207
Time for backpropagation: 0.001980304718017578
GPU memory for training: 0.9716653823852539                          

The whole process took 83.04818868637085 seconds
