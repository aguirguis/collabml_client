Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 15759.111029077982 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 2065578200.8033092 1505280000.0
All candidates indexes:  (array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 17
Intermediate:  0.015625
1.47705078125
Total layers size  4.189361572265625
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  3025.0 3.0
Using split index: 17
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
1
Start 0, end 1000, post_step 1000

Memory occpied: (3025.0, 3.0)
Memory occpied: (3025.0, 3.0)
Memory occpied: (3025.0, 3.0)
Memory occpied: (3041.0, 166.0)
Memory occpied: (3041.0, 578.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.642254114151001 seconds
Streaming imagenet data took 5.648913860321045 seconds
The mode is:  split
1
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.012467622756958008
Time for copying to cuda: 0.00417017936706543
Memory occpied: (3057.0, 1141.0)
Memory occpied: (3571.0, 2227.0)
Memory occpied: (3571.0, 2683.0)
Time for forward pass: 3.3449647426605225
Time for backpropagation: 0.05076193809509277
GPU memory for training: 0.9570660591125488                          

One training iteration takes: 3.4134955406188965 seconds
Index: 0
Memory occpied: (4311.0, 3365.0)
Memory occpied: (4311.0, 3365.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.557994604110718 seconds
Streaming imagenet data took 5.565348148345947 seconds
Then, training+dataloading take 5.565939664840698 seconds
The mode is:  split
1
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007554769515991211
Time for copying to cuda: 0.003780364990234375
Time for forward pass: 0.04656648635864258
Time for backpropagation: 0.003008604049682617
GPU memory for training: 1.1122322082519531                          

One training iteration takes: 0.0619969367980957 seconds
Index: 1
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.0662620067596436 seconds
Streaming imagenet data took 2.073086977005005 seconds
Then, training+dataloading take 2.073641061782837 seconds
The mode is:  split
1
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007688760757446289
Time for copying to cuda: 0.003688812255859375
Time for forward pass: 0.04599738121032715
Time for backpropagation: 0.0022056102752685547
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06062626838684082 seconds
Index: 2
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.1629436016082764 seconds
Streaming imagenet data took 2.1699564456939697 seconds
Then, training+dataloading take 2.170475959777832 seconds
The mode is:  split
1
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00754094123840332
Time for copying to cuda: 0.0038645267486572266
Time for forward pass: 0.04606795310974121
Time for backpropagation: 0.00238037109375
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06098151206970215 seconds
Index: 3
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.01810359954834 seconds
Streaming imagenet data took 2.0226216316223145 seconds
Then, training+dataloading take 2.0231499671936035 seconds
The mode is:  split
1
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007544517517089844
Time for copying to cuda: 0.003838777542114258
Time for forward pass: 0.046022891998291016
Time for backpropagation: 0.0024073123931884766
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.060907840728759766 seconds
Index: 4
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.796119213104248 seconds
Streaming imagenet data took 2.803077220916748 seconds
Then, training+dataloading take 2.8036367893218994 seconds
The mode is:  split
1
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007669925689697266
Time for copying to cuda: 0.003831148147583008
Time for forward pass: 0.04605603218078613
Time for backpropagation: 0.0023469924926757812
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.0610806941986084 seconds
Index: 5
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.821312189102173 seconds
Streaming imagenet data took 2.825875759124756 seconds
Then, training+dataloading take 2.8264353275299072 seconds
The mode is:  split
1
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0075604915618896484
Time for copying to cuda: 0.003815174102783203
Time for forward pass: 0.046148061752319336
Time for backpropagation: 0.0023326873779296875
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06105613708496094 seconds
Index: 6
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 4.565347194671631 seconds
Streaming imagenet data took 4.574058294296265 seconds
Then, training+dataloading take 4.574737310409546 seconds
The mode is:  split
1
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00795125961303711
Time for copying to cuda: 0.0039653778076171875
Time for forward pass: 0.077789306640625
Time for backpropagation: 0.0024323463439941406
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.09338998794555664 seconds
Index: 7
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.591320037841797 seconds
Streaming imagenet data took 2.596064567565918 seconds
Then, training+dataloading take 2.5966379642486572 seconds
The mode is:  split
1
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007748842239379883
Time for copying to cuda: 0.003810882568359375
Time for forward pass: 0.045972585678100586
Time for backpropagation: 0.002351522445678711
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06096649169921875 seconds
Index: 8
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.530812978744507 seconds
Streaming imagenet data took 2.5372445583343506 seconds
Then, training+dataloading take 2.537808656692505 seconds
The mode is:  split
1
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.009812593460083008
Time for copying to cuda: 0.00447535514831543
Time for forward pass: 0.04746389389038086
Time for backpropagation: 0.002351045608520508
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06537079811096191 seconds
Index: 9
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.971078872680664 seconds
Streaming imagenet data took 2.978146553039551 seconds
Then, training+dataloading take 2.9787180423736572 seconds
The mode is:  split
1
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007737636566162109
Time for copying to cuda: 0.003844738006591797
Time for forward pass: 0.05029749870300293
Time for backpropagation: 0.002583026885986328
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06574630737304688 seconds
Index: 10
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.25154972076416 seconds
Streaming imagenet data took 3.2602670192718506 seconds
Then, training+dataloading take 3.2609827518463135 seconds
The mode is:  split
1
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.011106252670288086
Time for copying to cuda: 0.004271507263183594
Time for forward pass: 0.07550358772277832
Time for backpropagation: 0.0035161972045898438
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.09656238555908203 seconds
Index: 11
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.0378034114837646 seconds
Streaming imagenet data took 3.0450127124786377 seconds
Then, training+dataloading take 3.0456857681274414 seconds
The mode is:  split
1
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007529497146606445
Time for copying to cuda: 0.003845691680908203
Time for forward pass: 0.04613041877746582
Time for backpropagation: 0.0023870468139648438
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06098771095275879 seconds
Index: 12
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.266401767730713 seconds
Streaming imagenet data took 3.2714664936065674 seconds
Then, training+dataloading take 3.2721383571624756 seconds
The mode is:  split
1
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007790565490722656
Time for copying to cuda: 0.0038814544677734375
Time for forward pass: 0.04619550704956055
Time for backpropagation: 0.0024290084838867188
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.061435699462890625 seconds
Index: 13
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.3923118114471436 seconds
Streaming imagenet data took 3.3993704319000244 seconds
Then, training+dataloading take 3.3999223709106445 seconds
The mode is:  split
1
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0077173709869384766
Time for copying to cuda: 0.00384521484375
Time for forward pass: 0.04597926139831543
Time for backpropagation: 0.0023941993713378906
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06101346015930176 seconds
Index: 14
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.9183690547943115 seconds
Streaming imagenet data took 2.9229304790496826 seconds
Then, training+dataloading take 2.923487901687622 seconds
The mode is:  split
1
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007697105407714844
Time for copying to cuda: 0.0038216114044189453
Time for forward pass: 0.046184539794921875
Time for backpropagation: 0.0024781227111816406
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.061370849609375 seconds
Index: 15
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.1143295764923096 seconds
Streaming imagenet data took 3.1215288639068604 seconds
Then, training+dataloading take 3.122100830078125 seconds
The mode is:  split
1
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.008196115493774414
Time for copying to cuda: 0.0038573741912841797
Time for forward pass: 0.07587909698486328
Time for backpropagation: 0.0024950504302978516
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.09152507781982422 seconds
Index: 16
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.387299060821533 seconds
Memory occpied: (4537.0, 3373.0)
Streaming imagenet data took 3.392080307006836 seconds
Then, training+dataloading take 3.392622470855713 seconds
The mode is:  split
1
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007709026336669922
Time for copying to cuda: 0.003827810287475586
Time for forward pass: 0.04606771469116211
Time for backpropagation: 0.0024139881134033203
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06109333038330078 seconds
Index: 17
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.4461541175842285 seconds
Streaming imagenet data took 2.4502642154693604 seconds
Then, training+dataloading take 2.450788974761963 seconds
The mode is:  split
1
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.007550954818725586
Time for copying to cuda: 0.0036873817443847656
Time for forward pass: 0.04618048667907715
Time for backpropagation: 0.002348661422729492
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.06087350845336914 seconds
Index: 18
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.1597654819488525 seconds
Streaming imagenet data took 3.1668362617492676 seconds
Then, training+dataloading take 3.1674156188964844 seconds
The mode is:  split
1
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.010177135467529297
Time for copying to cuda: 0.00625300407409668
Time for forward pass: 0.08395218849182129
Time for backpropagation: 0.0025124549865722656
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.10426020622253418 seconds
Index: 19
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.894685983657837 seconds
Streaming imagenet data took 3.8993399143218994 seconds
Then, training+dataloading take 3.899923801422119 seconds
The mode is:  split
1
Start 21000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (4537.0, 3373.0)
Time of next(dataloader) is: 0.0077056884765625
Time for copying to cuda: 0.005292415618896484
Time for forward pass: 0.08392524719238281
Time for backpropagation: 0.0024018287658691406
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.10053062438964844 seconds
Index: 20
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.184389114379883 seconds
Streaming imagenet data took 3.1916847229003906 seconds
Then, training+dataloading take 3.192275285720825 seconds
The mode is:  split
1
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.009330272674560547
Time for copying to cuda: 0.003699779510498047
Time for forward pass: 0.0695030689239502
Time for backpropagation: 0.0025033950805664062
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.08636164665222168 seconds
Index: 21
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.609133720397949 seconds
Streaming imagenet data took 3.613812208175659 seconds
Then, training+dataloading take 3.6144473552703857 seconds
The mode is:  split
1
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.008220672607421875
Time for copying to cuda: 0.0038580894470214844
Time for forward pass: 0.06375765800476074
Time for backpropagation: 0.0025899410247802734
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.07974100112915039 seconds
Index: 22
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.3901219367980957 seconds
Streaming imagenet data took 2.397359609603882 seconds
Then, training+dataloading take 2.3979294300079346 seconds

Epoch: 0
Time of next(dataloader) is: 0.007521152496337891
Time for copying to cuda: 0.004273653030395508
Time for forward pass: 0.09043002128601074
Time for backpropagation: 0.0024003982543945312
GPU memory for training: 1.1125984191894531                          

The whole process took 82.35202240943909 seconds
