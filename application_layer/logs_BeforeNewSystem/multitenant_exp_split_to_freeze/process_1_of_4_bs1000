Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 16578.549571464573 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 2172983649.4310045 1505280000.0
All candidates indexes:  (array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 17
Intermediate:  0.015625
1.47705078125
Total layers size  4.189361572265625
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Using split index: 17
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
1
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1893.0, 3.0)
Memory occpied: (2319.0, 3.0)
Memory occpied: (2759.0, 3.0)
Memory occpied: (3005.0, 3.0)
Memory occpied: (3025.0, 3.0)
Memory occpied: (3025.0, 3.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 12.127373933792114 seconds
Streaming imagenet data took 12.134533882141113 seconds
The mode is:  split
1
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.013261556625366211
Time for copying to cuda: 0.0041964054107666016
Memory occpied: (3025.0, 15.0)
Memory occpied: (3041.0, 530.0)
Memory occpied: (3057.0, 1109.0)
Time for forward pass: 3.333313226699829
Time for backpropagation: 0.05182480812072754
GPU memory for training: 0.9570660591125488                          

One training iteration takes: 3.403977870941162 seconds
Index: 0
Memory occpied: (3571.0, 2233.0)
Memory occpied: (3571.0, 2711.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.516130208969116 seconds
Streaming imagenet data took 5.523423194885254 seconds
Then, training+dataloading take 5.52411150932312 seconds
The mode is:  split
1
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.006129741668701172
Time for copying to cuda: 0.0036535263061523438
Time for forward pass: 0.04995083808898926
Time for backpropagation: 0.003977060317993164
GPU memory for training: 1.1122322082519531                          

One training iteration takes: 0.06490492820739746 seconds
Index: 1
Memory occpied: (4311.0, 3365.0)
Memory occpied: (4311.0, 3365.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 5.6751508712768555 seconds
Streaming imagenet data took 5.681894063949585 seconds
Then, training+dataloading take 5.682459354400635 seconds
The mode is:  split
1
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0057871341705322266
Time for copying to cuda: 0.0037994384765625
Time for forward pass: 0.04595494270324707
Time for backpropagation: 0.002220630645751953
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.058912038803100586 seconds
Index: 2
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.061546802520752 seconds
Streaming imagenet data took 2.0687410831451416 seconds
Then, training+dataloading take 2.069279193878174 seconds
The mode is:  split
1
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005934715270996094
Time for copying to cuda: 0.0038013458251953125
Time for forward pass: 0.04596066474914551
Time for backpropagation: 0.0023136138916015625
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.05919647216796875 seconds
Index: 3
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.4084813594818115 seconds
Streaming imagenet data took 2.4130477905273438 seconds
Then, training+dataloading take 2.4136085510253906 seconds
The mode is:  split
1
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005983591079711914
Time for copying to cuda: 0.0037724971771240234
Time for forward pass: 0.04590153694152832
Time for backpropagation: 0.002171754837036133
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.05897212028503418 seconds
Index: 4
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.5894954204559326 seconds
Streaming imagenet data took 2.596616506576538 seconds
Then, training+dataloading take 2.5971486568450928 seconds
The mode is:  split
1
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0059278011322021484
Time for copying to cuda: 0.003763914108276367
Time for forward pass: 0.04597592353820801
Time for backpropagation: 0.0022132396697998047
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.058954477310180664 seconds
Index: 5
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.8863272666931152 seconds
Streaming imagenet data took 2.890925407409668 seconds
Then, training+dataloading take 2.8915023803710938 seconds
The mode is:  split
1
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.006104230880737305
Time for copying to cuda: 0.003810405731201172
Time for forward pass: 0.04590296745300293
Time for backpropagation: 0.0021843910217285156
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.05914425849914551 seconds
Index: 6
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.1474664211273193 seconds
Streaming imagenet data took 3.154660224914551 seconds
Then, training+dataloading take 3.1552605628967285 seconds
The mode is:  split
1
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00775909423828125
Time for copying to cuda: 0.004265308380126953
Time for forward pass: 0.07953953742980957
Time for backpropagation: 0.002389192581176758
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.09533166885375977 seconds
Index: 7
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.4867262840270996 seconds
Streaming imagenet data took 2.4914329051971436 seconds
Then, training+dataloading take 2.492079973220825 seconds
The mode is:  split
1
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0058536529541015625
Time for copying to cuda: 0.0036339759826660156
Time for forward pass: 0.046067237854003906
Time for backpropagation: 0.0022401809692382812
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.05894279479980469 seconds
Index: 8
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.5924606323242188 seconds
Streaming imagenet data took 2.59975528717041 seconds
Then, training+dataloading take 2.600299596786499 seconds
The mode is:  split
1
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0063631534576416016
Time for copying to cuda: 0.003869295120239258
Time for forward pass: 0.08752846717834473
Time for backpropagation: 0.0031082630157470703
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.10225605964660645 seconds
Index: 9
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.04567289352417 seconds
Streaming imagenet data took 3.050163745880127 seconds
Then, training+dataloading take 3.050708055496216 seconds
The mode is:  split
1
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00595402717590332
Time for copying to cuda: 0.00504612922668457
Time for forward pass: 0.07621073722839355
Time for backpropagation: 0.0025568008422851562
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.09099817276000977 seconds
Index: 10
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.177520751953125 seconds
Streaming imagenet data took 3.2289183139801025 seconds
Then, training+dataloading take 3.232457160949707 seconds
The mode is:  split
1
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.011565446853637695
Time for copying to cuda: 0.0042877197265625
Time for forward pass: 0.10315918922424316
Time for backpropagation: 0.003533601760864258
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.12444400787353516 seconds
Index: 11
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.2873151302337646 seconds
Streaming imagenet data took 3.294477701187134 seconds
Then, training+dataloading take 3.2951457500457764 seconds
The mode is:  split
1
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.006104469299316406
Time for copying to cuda: 0.0038909912109375
Time for forward pass: 0.04609823226928711
Time for backpropagation: 0.002242565155029297
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.05950927734375 seconds
Index: 12
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.0561654567718506 seconds
Streaming imagenet data took 3.064584732055664 seconds
Then, training+dataloading take 3.065284013748169 seconds
The mode is:  split
1
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.006919145584106445
Time for copying to cuda: 0.005568027496337891
Memory occpied: (4537.0, 3373.0)
Time for forward pass: 0.08371829986572266
Time for backpropagation: 0.0022683143615722656
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.09987759590148926 seconds
Index: 13
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.4357571601867676 seconds
Streaming imagenet data took 3.4429714679718018 seconds
Then, training+dataloading take 3.44358491897583 seconds
The mode is:  split
1
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005981922149658203
Time for copying to cuda: 0.003823518753051758
Time for forward pass: 0.046097755432128906
Time for backpropagation: 0.04703950881958008
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.10446667671203613 seconds
Index: 14
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.896704912185669 seconds
Streaming imagenet data took 2.901283025741577 seconds
Then, training+dataloading take 2.9019064903259277 seconds
The mode is:  split
1
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.006387472152709961
Time for copying to cuda: 0.005005359649658203
Time for forward pass: 0.05202031135559082
Time for backpropagation: 0.0022668838500976562
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.0668489933013916 seconds
Index: 15
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.050687313079834 seconds
Streaming imagenet data took 3.057966470718384 seconds
Then, training+dataloading take 3.05855131149292 seconds
The mode is:  split
1
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.006054878234863281
Time for copying to cuda: 0.004301309585571289
Time for forward pass: 0.09054207801818848
Time for backpropagation: 0.002429485321044922
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.1045379638671875 seconds
Index: 16
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.2467973232269287 seconds
Streaming imagenet data took 3.2514476776123047 seconds
Then, training+dataloading take 3.2520205974578857 seconds
The mode is:  split
1
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.00628662109375
Time for copying to cuda: 0.0036773681640625
Time for forward pass: 0.04619908332824707
Time for backpropagation: 0.002809286117553711
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.060083627700805664 seconds
Index: 17
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.6215875148773193 seconds
Streaming imagenet data took 2.628763198852539 seconds
Then, training+dataloading take 2.629328966140747 seconds
The mode is:  split
1
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005959033966064453
Time for copying to cuda: 0.0055844783782958984
Time for forward pass: 0.08569836616516113
Time for backpropagation: 0.002254009246826172
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.10070109367370605 seconds
Index: 18
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.0182199478149414 seconds
Streaming imagenet data took 3.022710084915161 seconds
Then, training+dataloading take 3.0233888626098633 seconds
The mode is:  split
1
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.05556941032409668
Time for copying to cuda: 0.0036056041717529297
Time for forward pass: 0.0464940071105957
Time for backpropagation: 0.002731800079345703
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.10977911949157715 seconds
Index: 19
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.9374899864196777 seconds
Streaming imagenet data took 3.944948196411133 seconds
Then, training+dataloading take 3.9456369876861572 seconds
The mode is:  split
1
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.006483316421508789
Time for copying to cuda: 0.003803730010986328
Memory occpied: (4537.0, 3373.0)
Time for forward pass: 0.04616236686706543
Time for backpropagation: 0.0024187564849853516
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.060321807861328125 seconds
Index: 20
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.252537488937378 seconds
Streaming imagenet data took 3.2597672939300537 seconds
Then, training+dataloading take 3.2603797912597656 seconds
The mode is:  split
1
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.005953073501586914
Time for copying to cuda: 0.004186868667602539
Time for forward pass: 0.08586692810058594
Time for backpropagation: 0.0023546218872070312
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.09952664375305176 seconds
Index: 21
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 3.6120550632476807 seconds
Streaming imagenet data took 3.616630792617798 seconds
Then, training+dataloading take 3.617185592651367 seconds
The mode is:  split
1
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.0060117244720458984
Time for copying to cuda: 0.004335641860961914
Time for forward pass: 0.0792684555053711
Time for backpropagation: 0.0025224685668945312
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.09324121475219727 seconds
Index: 22
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.3565874099731445 seconds
Streaming imagenet data took 2.363870620727539 seconds
Then, training+dataloading take 2.364410400390625 seconds

Epoch: 0
Time of next(dataloader) is: 0.006142616271972656
Time for copying to cuda: 0.003665447235107422
Time for forward pass: 0.07581782341003418
Time for backpropagation: 0.002489805221557617
GPU memory for training: 1.1125984191894531                          

The whole process took 92.7075502872467 seconds
