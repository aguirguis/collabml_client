Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3147309434006 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [12845056. 12845056.  3211264.  6422528.  6422528.  1605632.  3211264.
  3211264.  3211264.  3211264.   802816.  1605632.  1605632.  1605632.
  1605632.   401408.   401408.   401408.   401408.   401408.   100352.
   100352.    16384.    16384.    16384.    16384.    16384.    16384.
    32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119054628.4142134 119054628.4142134
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.015625
24.5
Total layers size  62.71465301513672
Candidate split  23
Server, client, server+client, vanilla  1246.091796875 1024.723388671875 2270.815185546875 51141.910888671875
Model size  619.236328125
Fixed, scale_with_bsz  619.236328125 25.07421875
Mem usage  1952.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 2000, post_step 250

Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 19.294084548950195 seconds
Streaming inaturalist data took 19.306830167770386 seconds
The mode is:  split
Start 2000, end 4000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.44677138328552246
Time for copying to cuda: 0.009634733200073242
Time for forward pass: 3.0945332050323486
Time for backpropagation: 0.07340431213378906
GPU memory for training: 2.6107091903686523                          

One training iteration takes: 3.7514185905456543 seconds
Index: 0
Memory occpied: (1952.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 19.834288358688354 seconds
Streaming inaturalist data took 19.847097635269165 seconds
Then, training+dataloading take 19.849099159240723 seconds
The mode is:  split
Start 4000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5907750129699707
Time for copying to cuda: 0.009087085723876953
Memory occpied: (3298.0, 2386.0)
Time for forward pass: 0.13534140586853027
Time for backpropagation: 0.0036592483520507812
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.843846321105957 seconds
Index: 1
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 18.382997751235962 seconds
Streaming inaturalist data took 18.396405935287476 seconds
Then, training+dataloading take 18.402601718902588 seconds
The mode is:  split
Start 6000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5431127548217773
Time for copying to cuda: 0.008953332901000977
Time for forward pass: 0.13541555404663086
Time for backpropagation: 0.003431558609008789
GPU memory for training: 2.9835119247436523                          

Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
One training iteration takes: 5.706843852996826 seconds
Index: 2
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 18.34973955154419 seconds
Streaming inaturalist data took 18.36303448677063 seconds
Then, training+dataloading take 18.364967823028564 seconds
The mode is:  split
Start 8000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5690925121307373
Time for copying to cuda: 0.008961200714111328
Time for forward pass: 0.13537955284118652
Time for backpropagation: 0.003579378128051758
GPU memory for training: 2.9835119247436523                          

Memory occpied: (3700.0, 2386.0)
One training iteration takes: 0.8187851905822754 seconds
Index: 3
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 19.533344984054565 seconds
Streaming inaturalist data took 19.541585206985474 seconds
Then, training+dataloading take 19.54354953765869 seconds
The mode is:  split
Start 10000, end 12000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5330867767333984
Time for copying to cuda: 0.009157419204711914
Memory occpied: (3700.0, 2386.0)
Time for forward pass: 0.13544607162475586
Time for backpropagation: 0.0035583972930908203
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7860410213470459 seconds
Index: 4
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 19.29161810874939 seconds
Streaming inaturalist data took 19.304967164993286 seconds
Then, training+dataloading take 19.306849718093872 seconds
The mode is:  split
Start 12000, end 14000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6046228408813477
Time for copying to cuda: 0.009082555770874023
Time for forward pass: 0.13529658317565918
Time for backpropagation: 0.0035800933837890625
GPU memory for training: 2.9835119247436523                          

Memory occpied: (3700.0, 2386.0)
One training iteration takes: 0.842848539352417 seconds
Index: 5
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 19.25790572166443 seconds
Streaming inaturalist data took 19.266077280044556 seconds
Then, training+dataloading take 19.268183708190918 seconds
The mode is:  split
Start 14000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4808640480041504
Time for copying to cuda: 0.009214639663696289
Time for forward pass: 0.13677215576171875
Time for backpropagation: 0.0042874813079833984
GPU memory for training: 2.9835119247436523                          

Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
One training iteration takes: 5.647655487060547 seconds
Index: 6
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 20.360032320022583 seconds
Streaming inaturalist data took 20.373252153396606 seconds
Then, training+dataloading take 20.3749258518219 seconds
The mode is:  split
Start 16000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4611668586730957
Time for copying to cuda: 0.00901651382446289
Time for forward pass: 0.1354665756225586
Time for backpropagation: 0.0036437511444091797
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7621421813964844 seconds
Index: 7
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 18.394320964813232 seconds
Streaming inaturalist data took 18.40256404876709 seconds
Then, training+dataloading take 18.404757738113403 seconds
The mode is:  split
Start 18000, end 20000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5302469730377197
Time for copying to cuda: 0.008989095687866211
Time for forward pass: 0.13540339469909668
Time for backpropagation: 0.0036258697509765625
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.8372800350189209 seconds
Index: 8
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 18.205886840820312 seconds
Streaming inaturalist data took 18.219128847122192 seconds
Then, training+dataloading take 18.220882654190063 seconds
The mode is:  split
Start 20000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5374066829681396
Time for copying to cuda: 0.009070158004760742
Time for forward pass: 0.13546180725097656
Time for backpropagation: 0.003609895706176758
GPU memory for training: 2.9835119247436523                          

Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
One training iteration takes: 5.6998419761657715 seconds
Index: 9
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 19.08210277557373 seconds
Streaming inaturalist data took 19.090248107910156 seconds
Then, training+dataloading take 19.09251880645752 seconds
The mode is:  split
Start 22000, end 24000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.48044633865356445
Time for copying to cuda: 0.009018898010253906
Time for forward pass: 0.13541054725646973
Time for backpropagation: 0.0035247802734375
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7433171272277832 seconds
Index: 10
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.320030212402344 MBs for this batch
Executing all posts took 19.464713096618652 seconds
Streaming inaturalist data took 19.47818374633789 seconds
Then, training+dataloading take 19.480157613754272 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5068385601043701
Time for copying to cuda: 0.009111642837524414
Time for forward pass: 0.13540339469909668
Time for backpropagation: 0.0035429000854492188
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.749478816986084 seconds
Index: 11
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 6.671195030212402 MBs for this batch
Executing all posts took 7.217338562011719 seconds
Streaming inaturalist data took 7.223580837249756 seconds
Then, training+dataloading take 7.2244062423706055 seconds

Epoch: 0
Memory occpied: (3700.0, 2386.0)
Time of next(dataloader) is: 0.458359956741333
Time for copying to cuda: 0.0021855831146240234
Time for forward pass: 0.10635972023010254
Time for backpropagation: 0.0034825801849365234
GPU memory for training: 2.8331379890441895                          

The whole process took 246.39428043365479 seconds
