Namespace(batch_size=2000, cpuonly=True, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6413777535029 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 3.256800e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119097442.66490713 119097442.66490713
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.21269989013672
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.589988231658936 seconds
Streaming inaturalist data took 13.706096649169922 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4711630344390869
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3962347507476807
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.606478691101074
One training iteration takes: 4.570215225219727 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 14.284432649612427 seconds
Streaming inaturalist data took 14.357868194580078 seconds
Then, training+dataloading take 14.368703603744507 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48761987686157227
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4266409873962402
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.773557186126709
One training iteration takes: 4.808296203613281 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.947993755340576 seconds
Streaming inaturalist data took 14.067522764205933 seconds
Then, training+dataloading take 14.081777095794678 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5404021739959717
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 1.6822340488433838
Time for backpropagation: 3.6162209510803223
Memory occpied: (1250.0, 3.0)
One training iteration takes: 5.981537818908691 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.593847513198853 seconds
Streaming inaturalist data took 13.666676998138428 seconds
Then, training+dataloading take 13.680258989334106 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48728418350219727
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4196913242340088
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7655186653137207
One training iteration takes: 4.837547302246094 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.820744752883911 seconds
Streaming inaturalist data took 13.939559698104858 seconds
Then, training+dataloading take 13.951176881790161 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000

Memory occpied: (1250.0, 3.0)

Epoch: 0
Time of next(dataloader) is: 0.49143123626708984
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.386040449142456
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7346031665802
One training iteration takes: 4.73281455039978 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.620589017868042 seconds
Streaming inaturalist data took 13.692234992980957 seconds
Then, training+dataloading take 13.704987287521362 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49863147735595703
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3897039890289307
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.575249671936035
One training iteration takes: 4.586195468902588 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 14.993245840072632 seconds
Memory occpied: (1250.0, 3.0)
Streaming inaturalist data took 15.065922021865845 seconds
Then, training+dataloading take 15.079492092132568 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4871640205383301
Time for copying to cuda: 6.67572021484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.376662254333496
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7414820194244385
One training iteration takes: 4.73983359336853 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.590508460998535 seconds
Streaming inaturalist data took 13.662838220596313 seconds
Then, training+dataloading take 13.675588130950928 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5374104976654053
Time for copying to cuda: 9.298324584960938e-06
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3713898658752441
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.4263999462127686
One training iteration takes: 4.461942434310913 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.641891956329346 seconds
Streaming inaturalist data took 13.714356184005737 seconds
Then, training+dataloading take 13.727645874023438 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4896402359008789
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.386298418045044
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7231967449188232
One training iteration takes: 4.71955132484436 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 14.61489987373352 seconds
Streaming inaturalist data took 14.686967372894287 seconds
Then, training+dataloading take 14.699503898620605 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5310797691345215
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 1.1863007545471191
Time for backpropagation: 2.3090970516204834
One training iteration takes: 4.183709383010864 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 14.117465734481812 seconds
Streaming inaturalist data took 14.237043857574463 seconds
Then, training+dataloading take 14.251009464263916 seconds
Memory occpied: (1250.0, 3.0)
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4866526126861572
Time for copying to cuda: 8.344650268554688e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.4552648067474365
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.7583117485046387
One training iteration takes: 4.826412916183472 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.546231985092163 seconds
Streaming inaturalist data took 13.619812250137329 seconds
Then, training+dataloading take 13.633102893829346 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4882218837738037
Time for copying to cuda: 8.821487426757812e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.382035732269287
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.5677521228790283
One training iteration takes: 4.55780029296875 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Read 40.78874111175537 MBs for this batch
Executing all posts took 6.219062805175781 seconds
Memory occpied: (1250.0, 3.0)
Streaming inaturalist data took 6.237101316452026 seconds
Then, training+dataloading take 6.24006724357605 seconds

Epoch: 0
Time of next(dataloader) is: 0.3924520015716553
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.2599070072174072
Time for backpropagation: 0.7069363594055176
Memory occpied: (1250.0, 3.0)
The whole process took 183.23049688339233 seconds
