Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='resnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet18) till index 11
The mode is:  vanilla
Memory occpied: (1328.0, 3.0)
Memory occpied: (1328.0, 3.0)
Memory occpied: (1328.0, 3.0)
Memory occpied: (1328.0, 3.0)
Memory occpied: (1328.0, 3.0)
Memory occpied: (1328.0, 3.0)
Memory occpied: (1328.0, 3.0)
Read 532.0229377746582 MBs for this batch
Streaming inaturalist data took 8.684834480285645 seconds
The mode is:  vanilla

Epoch: 0
Read 524.311224937439 MBs for this batch
Streaming inaturalist data took 8.855591058731079 seconds
Time of next(dataloader) is: 9.064890623092651
Time for copying to cuda: 0.29708313941955566
Time for forward pass: 8.043246269226074
Time for backpropagation: 1.4822607040405273
GPU memory for training: 21.51752233505249                          

One training iteration takes: 19.175468683242798 seconds
Index: 0
Then, training+dataloading take 19.185283660888672 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (1328.0, 8406.0)
Memory occpied: (1328.0, 8406.0)
Memory occpied: (5566.0, 8406.0)
Memory occpied: (5566.0, 8406.0)
Memory occpied: (5566.0, 8406.0)
Memory occpied: (5566.0, 8406.0)
Memory occpied: (5566.0, 8406.0)
Time of next(dataloader) is: 9.317321300506592
Time for copying to cuda: 0.594141960144043
Time for forward pass: 0.14805889129638672
Time for backpropagation: 0.032563209533691406
GPU memory for training: 14.227360248565674                          

Memory occpied: (5566.0, 11486.0)
One training iteration takes: 10.59447956085205 seconds
Index: 1
Memory occpied: (11710.0, 11486.0)
Read 545.9151782989502 MBs for this batch
Streaming inaturalist data took 12.132548809051514 seconds
Then, training+dataloading take 12.170237064361572 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Time of next(dataloader) is: 10.199707746505737
Memory occpied: (11710.0, 11486.0)
Time for copying to cuda: 0.3457169532775879
Time for forward pass: 0.10428524017333984
Time for backpropagation: 0.04245138168334961
GPU memory for training: 14.227360248565674                          

One training iteration takes: 11.162087678909302 seconds
Index: 2
Memory occpied: (11710.0, 11486.0)
Read 531.9085092544556 MBs for this batch
Streaming inaturalist data took 12.65045166015625 seconds
Then, training+dataloading take 12.67576789855957 seconds
The mode is:  vanilla

Epoch: 0
Time of next(dataloader) is: 9.977823495864868
Time for copying to cuda: 0.3376448154449463
Time for forward pass: 0.05056452751159668
Time for backpropagation: 0.010379791259765625
GPU memory for training: 14.227360248565674                          

Read 517.8980760574341 MBs for this batch
Streaming inaturalist data took 10.409357786178589 seconds
One training iteration takes: 10.783523082733154 seconds
Index: 3
Then, training+dataloading take 10.797144889831543 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Time of next(dataloader) is: 9.838585138320923
Time for copying to cuda: 0.32001757621765137
Time for forward pass: 0.08267951011657715
Time for backpropagation: 0.022490978240966797
GPU memory for training: 14.227360248565674                          

One training iteration takes: 10.758374214172363 seconds
Index: 4
Memory occpied: (11710.0, 11486.0)
Read 533.0337619781494 MBs for this batch
Streaming inaturalist data took 11.759700536727905 seconds
Then, training+dataloading take 11.81521487236023 seconds
The mode is:  vanilla

Epoch: 0
Time of next(dataloader) is: 10.164707660675049
Time for copying to cuda: 0.3382704257965088
Time for forward pass: 0.08196258544921875
Time for backpropagation: 0.019906997680664062
GPU memory for training: 14.227360248565674                          

One training iteration takes: 11.140320777893066 seconds
Index: 5
Read 535.8939018249512 MBs for this batch
Streaming inaturalist data took 11.23151445388794 seconds
Then, training+dataloading take 11.24655818939209 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Time of next(dataloader) is: 9.915089130401611
Time for copying to cuda: 0.3304133415222168
Time for forward pass: 0.10152649879455566
Time for backpropagation: 0.04007458686828613
GPU memory for training: 14.227360248565674                          

One training iteration takes: 11.159326791763306 seconds
Index: 6
Memory occpied: (11710.0, 11486.0)
Read 526.989278793335 MBs for this batch
Streaming inaturalist data took 12.672865867614746 seconds
Then, training+dataloading take 12.703886270523071 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Time of next(dataloader) is: 10.239432096481323
Memory occpied: (11710.0, 11486.0)
Time for copying to cuda: 0.5577919483184814
Time for forward pass: 0.08689022064208984
Time for backpropagation: 0.05084729194641113
GPU memory for training: 14.227360248565674                          

One training iteration takes: 11.52135443687439 seconds
Index: 7
Memory occpied: (11710.0, 11486.0)
Read 542.1471738815308 MBs for this batch
Streaming inaturalist data took 13.338015794754028 seconds
Then, training+dataloading take 13.369312524795532 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Time of next(dataloader) is: 10.45028567314148
Time for copying to cuda: 0.529390811920166
Time for forward pass: 0.12072396278381348
Memory occpied: (11710.0, 11486.0)
Time for backpropagation: 0.050367116928100586
GPU memory for training: 14.227360248565674                          

One training iteration takes: 11.773738622665405 seconds
Index: 8
Memory occpied: (11710.0, 11486.0)
Read 530.3719463348389 MBs for this batch
Streaming inaturalist data took 13.357811689376831 seconds
Then, training+dataloading take 13.383882284164429 seconds
The mode is:  vanilla

Epoch: 0
Time of next(dataloader) is: 10.205594539642334
Time for copying to cuda: 0.3381366729736328
Time for forward pass: 0.0630486011505127
Time for backpropagation: 0.013964653015136719
GPU memory for training: 14.227360248565674                          

Read 526.5409097671509 MBs for this batch
Streaming inaturalist data took 10.77245569229126 seconds
One training iteration takes: 11.06972599029541 seconds
Index: 9
Then, training+dataloading take 11.0808584690094 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Time of next(dataloader) is: 9.885394811630249
Time for copying to cuda: 0.3301715850830078
Time for forward pass: 0.10063815116882324
Time for backpropagation: 0.022067546844482422
GPU memory for training: 14.227360248565674                          

One training iteration takes: 10.85605263710022 seconds
Index: 10
Memory occpied: (11710.0, 11486.0)
Read 527.8905267715454 MBs for this batch
Streaming inaturalist data took 12.778361797332764 seconds
Then, training+dataloading take 12.79638957977295 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Read 112.58902263641357 MBs for this batch
Streaming inaturalist data took 5.254574537277222 seconds
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Time of next(dataloader) is: 9.986681461334229
Memory occpied: (11710.0, 11486.0)
Time for copying to cuda: 0.29369640350341797
Time for forward pass: 0.0309140682220459
Time for backpropagation: 0.005244016647338867
GPU memory for training: 14.227360248565674                          

One training iteration takes: 10.766417264938354 seconds
Index: 11
Then, training+dataloading take 10.788160562515259 seconds

Epoch: 0
Memory occpied: (11710.0, 11486.0)
Memory occpied: (11710.0, 11486.0)
Time of next(dataloader) is: 3.5908098220825195
Time for copying to cuda: 0.06496691703796387
Time for forward pass: 1.297572135925293
Memory occpied: (5580.0, 3856.0)
Time for backpropagation: 0.4481077194213867
GPU memory for training: 4.739571571350098                          

The whole process took 171.89925622940063 seconds
