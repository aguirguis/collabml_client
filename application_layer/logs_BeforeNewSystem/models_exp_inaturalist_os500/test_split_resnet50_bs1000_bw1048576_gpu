Namespace(batch_size=1000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.317307651753 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 3.2568000e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119054966.14853057 119054966.14853057
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.76738739013672
Candidate split  21
Server, client, server+client, vanilla  321.42333984375 223.8739013671875 545.2972412109375 6915.2801513671875
Model size  153.94287109375
Fixed, scale_with_bsz  153.94287109375 6.69921875
Mem usage  1454.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 1000, post_step 250

Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 8.061331987380981 seconds
Streaming inaturalist data took 8.065281629562378 seconds
The mode is:  split
Start 1000, end 2000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.36612653732299805
Time for copying to cuda: 0.002566099166870117
Memory occpied: (1454.0, 176.0)
Memory occpied: (1454.0, 644.0)
Memory occpied: (1454.0, 1066.0)
Time for forward pass: 3.410813093185425
Time for backpropagation: 0.06614446640014648
GPU memory for training: 0.6661324501037598                          

One training iteration takes: 3.920241355895996 seconds
Index: 0
Memory occpied: (1898.0, 1460.0)
Memory occpied: (1898.0, 1460.0)
Memory occpied: (1898.0, 1460.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.590245246887207 seconds
Streaming inaturalist data took 7.59421443939209 seconds
Then, training+dataloading take 7.5950493812561035 seconds
The mode is:  split
Start 2000, end 3000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4483184814453125
Time for copying to cuda: 0.0024843215942382812
Time for forward pass: 0.0745229721069336
Time for backpropagation: 0.00782155990600586
GPU memory for training: 0.7900347709655762                          

One training iteration takes: 0.6630837917327881 seconds
Index: 1
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.4429097175598145 seconds
Streaming inaturalist data took 7.446766376495361 seconds
Then, training+dataloading take 7.447319269180298 seconds
The mode is:  split
Start 3000, end 4000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.43169069290161133
Time for copying to cuda: 0.0025205612182617188
Time for forward pass: 0.03412818908691406
Time for backpropagation: 0.006920576095581055
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5774595737457275 seconds
Index: 2
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.593965291976929 seconds
Streaming inaturalist data took 7.597810506820679 seconds
Then, training+dataloading take 7.598578453063965 seconds
The mode is:  split
Start 4000, end 5000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4332418441772461
Time for copying to cuda: 0.0025110244750976562
Time for forward pass: 0.03401446342468262
Time for backpropagation: 0.006841421127319336
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5665888786315918 seconds
Index: 3
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.680143594741821 seconds
Streaming inaturalist data took 7.682951927185059 seconds
Then, training+dataloading take 7.683718681335449 seconds
The mode is:  split
Start 5000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.43151330947875977
Time for copying to cuda: 0.0025453567504882812
Time for forward pass: 0.034273386001586914
Time for backpropagation: 0.0071964263916015625
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.577660322189331 seconds
Index: 4
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.976273536682129 seconds
Streaming inaturalist data took 7.9790849685668945 seconds
Then, training+dataloading take 7.979871034622192 seconds
The mode is:  split
Start 6000, end 7000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4972727298736572
Time for copying to cuda: 0.0025560855865478516
Time for forward pass: 0.03394460678100586
Time for backpropagation: 0.006850481033325195
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.7038874626159668 seconds
Index: 5
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.425752401351929 seconds
Streaming inaturalist data took 7.428594589233398 seconds
Then, training+dataloading take 7.429355621337891 seconds
The mode is:  split
Start 7000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4606196880340576
Time for copying to cuda: 0.002583026885986328
Time for forward pass: 0.034421443939208984
Time for backpropagation: 0.00702214241027832
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.600055456161499 seconds
Index: 6
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 8.242425680160522 seconds
Streaming inaturalist data took 8.245227098464966 seconds
Then, training+dataloading take 8.246016263961792 seconds
The mode is:  split
Start 8000, end 9000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4844954013824463
Time for copying to cuda: 0.002496480941772461
Time for forward pass: 0.03391265869140625
Time for backpropagation: 0.006787300109863281
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.6683404445648193 seconds
Index: 7
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.85782265663147 seconds
Streaming inaturalist data took 7.860602378845215 seconds
Then, training+dataloading take 7.861412763595581 seconds
The mode is:  split
Start 9000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5232820510864258
Time for copying to cuda: 0.002624034881591797
Time for forward pass: 0.03439521789550781
Time for backpropagation: 0.007197141647338867
GPU memory for training: 0.7900962829589844                          

Memory occpied: (1970.0, 1484.0)
One training iteration takes: 0.657670259475708 seconds
Index: 8
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.3406901359558105 seconds
Streaming inaturalist data took 7.343482255935669 seconds
Then, training+dataloading take 7.344062566757202 seconds
The mode is:  split
Start 10000, end 11000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.43253397941589355
Time for copying to cuda: 0.0025033950805664062
Time for forward pass: 0.03392195701599121
Time for backpropagation: 0.006750583648681641
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5818569660186768 seconds
Index: 9
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.660609245300293 seconds
Streaming inaturalist data took 7.663395881652832 seconds
Then, training+dataloading take 7.664152145385742 seconds
The mode is:  split
Start 11000, end 12000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.438976526260376
Time for copying to cuda: 0.0024793148040771484
Time for forward pass: 0.033980369567871094
Time for backpropagation: 0.0067751407623291016
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5732803344726562 seconds
Index: 10
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.698929071426392 seconds
Streaming inaturalist data took 7.701732635498047 seconds
Then, training+dataloading take 7.702351331710815 seconds
The mode is:  split
Start 12000, end 13000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4342947006225586
Time for copying to cuda: 0.0025038719177246094
Time for forward pass: 0.03400468826293945
Time for backpropagation: 0.006850481033325195
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5708210468292236 seconds
Index: 11
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.681468963623047 seconds
Streaming inaturalist data took 7.684262275695801 seconds
Then, training+dataloading take 7.685032367706299 seconds
The mode is:  split
Start 13000, end 14000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.43509745597839355
Time for copying to cuda: 0.0025076866149902344
Time for forward pass: 0.033975839614868164
Time for backpropagation: 0.006742238998413086
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5946037769317627 seconds
Index: 12
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.491857290267944 seconds
Streaming inaturalist data took 7.494616985321045 seconds
Then, training+dataloading take 7.495412349700928 seconds
The mode is:  split
Start 14000, end 15000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4327547550201416
Time for copying to cuda: 0.0025482177734375
Time for forward pass: 0.03404402732849121
Time for backpropagation: 0.006733894348144531
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5662169456481934 seconds
Index: 13
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.653082370758057 seconds
Streaming inaturalist data took 7.655850648880005 seconds
Then, training+dataloading take 7.656637907028198 seconds
The mode is:  split
Start 15000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4320371150970459
Time for copying to cuda: 0.002541780471801758
Time for forward pass: 0.03403425216674805
Time for backpropagation: 0.006856441497802734
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5657567977905273 seconds
Index: 14
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.3883209228515625 seconds
Streaming inaturalist data took 7.391164541244507 seconds
Then, training+dataloading take 7.391921281814575 seconds
The mode is:  split
Start 16000, end 17000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.43566155433654785
Time for copying to cuda: 0.0025300979614257812
Time for forward pass: 0.03388619422912598
Time for backpropagation: 0.006868124008178711
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5689826011657715 seconds
Index: 15
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.43327522277832 seconds
Streaming inaturalist data took 7.436238527297974 seconds
Then, training+dataloading take 7.4369587898254395 seconds
The mode is:  split
Start 17000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4831349849700928
Time for copying to cuda: 0.002523183822631836
Time for forward pass: 0.03400540351867676
Time for backpropagation: 0.006812334060668945
GPU memory for training: 0.7900962829589844                          

Memory occpied: (1970.0, 1484.0)
One training iteration takes: 0.6162829399108887 seconds
Index: 16
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.316975355148315 seconds
Streaming inaturalist data took 7.319774150848389 seconds
Then, training+dataloading take 7.320606470108032 seconds
The mode is:  split
Start 18000, end 19000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.434786319732666
Time for copying to cuda: 0.0025491714477539062
Time for forward pass: 0.03391098976135254
Time for backpropagation: 0.006821393966674805
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5677597522735596 seconds
Index: 17
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.275496244430542 seconds
Streaming inaturalist data took 7.280624866485596 seconds
Then, training+dataloading take 7.282121181488037 seconds
The mode is:  split
Start 19000, end 20000, post_step 250


Epoch: 0
Memory occpied: (1970.0, 1484.0)
Time of next(dataloader) is: 0.44014406204223633
Time for copying to cuda: 0.0025064945220947266
Time for forward pass: 0.034041643142700195
Time for backpropagation: 0.00678706169128418
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5865662097930908 seconds
Index: 18
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.364667892456055 seconds
Streaming inaturalist data took 7.367509126663208 seconds
Then, training+dataloading take 7.3682239055633545 seconds
The mode is:  split
Start 20000, end 21000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.501807689666748
Time for copying to cuda: 0.0025305747985839844
Time for forward pass: 0.03411221504211426
Time for backpropagation: 0.006963968276977539
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.6858675479888916 seconds
Index: 19
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.495350360870361 seconds
Streaming inaturalist data took 7.498124837875366 seconds
Then, training+dataloading take 7.498914957046509 seconds
The mode is:  split
Start 21000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.44238805770874023
Time for copying to cuda: 0.0025205612182617188
Time for forward pass: 0.03421950340270996
Time for backpropagation: 0.007031679153442383
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.5759875774383545 seconds
Index: 20
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.597458839416504 seconds
Streaming inaturalist data took 7.600320816040039 seconds
Then, training+dataloading take 7.601111888885498 seconds
The mode is:  split
Start 22000, end 23000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4556252956390381
Time for copying to cuda: 0.0024673938751220703
Time for forward pass: 0.03396940231323242
Time for backpropagation: 0.006946086883544922
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.6028022766113281 seconds
Index: 21
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.711167335510254 seconds
Streaming inaturalist data took 7.713951826095581 seconds
Then, training+dataloading take 7.714740037918091 seconds
The mode is:  split
Start 23000, end 24000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4332163333892822
Time for copying to cuda: 0.002517223358154297
Time for forward pass: 0.034032583236694336
Time for backpropagation: 0.00690913200378418
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.579906702041626 seconds
Index: 22
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 7.8502655029296875 MBs for this batch
Executing all posts took 7.994670152664185 seconds
Streaming inaturalist data took 7.997389316558838 seconds
Then, training+dataloading take 7.998194217681885 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5382063388824463
Time for copying to cuda: 0.0024132728576660156
Time for forward pass: 0.06855273246765137
Time for backpropagation: 0.006791591644287109
GPU memory for training: 0.7900962829589844                          

One training iteration takes: 0.7581965923309326 seconds
Index: 23
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Memory occpied: (1970.0, 1484.0)
Read 3.344240188598633 MBs for this batch
Executing all posts took 5.278881549835205 seconds
Streaming inaturalist data took 5.28041934967041 seconds
Then, training+dataloading take 5.2808518409729 seconds

Epoch: 0
Time of next(dataloader) is: 0.48644065856933594
Time for copying to cuda: 0.0012586116790771484
Time for forward pass: 0.03108501434326172
Time for backpropagation: 0.006896257400512695
GPU memory for training: 0.769111156463623                          

Memory occpied: (1970.0, 1484.0)
The whole process took 196.74024057388306 seconds
