Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5657384338141 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 3.2568000e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119087528.46799688 119087528.46799688
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.76738739013672
Candidate split  21
Server, client, server+client, vanilla  321.42333984375 293.804931640625 615.228271484375 13676.617431640625
Model size  153.94287109375
Fixed, scale_with_bsz  153.94287109375 6.69921875
Mem usage  1454.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 2000, post_step 250

Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.432690143585205 seconds
Streaming inaturalist data took 14.439886569976807 seconds
The mode is:  split
Start 2000, end 4000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4411327838897705
Time for copying to cuda: 0.004759550094604492
Memory occpied: (1454.0, 15.0)
Memory occpied: (1454.0, 564.0)
Memory occpied: (1454.0, 1004.0)
Time for forward pass: 3.288883686065674
Time for backpropagation: 0.0657045841217041
GPU memory for training: 0.7243976593017578                          

One training iteration takes: 3.8731753826141357 seconds
Index: 0
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.525695562362671 seconds
Streaming inaturalist data took 14.533087968826294 seconds
Then, training+dataloading take 14.534944772720337 seconds
The mode is:  split
Start 4000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.46015191078186035
Time for copying to cuda: 0.004651784896850586
Time for forward pass: 0.039746761322021484
Time for backpropagation: 0.009179115295410156
GPU memory for training: 0.8476428985595703                          

One training iteration takes: 0.6067550182342529 seconds
Index: 1
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.875082731246948 seconds
Streaming inaturalist data took 14.882792711257935 seconds
Then, training+dataloading take 14.884249210357666 seconds
The mode is:  split
Start 6000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5486061573028564
Time for copying to cuda: 0.004658699035644531
Time for forward pass: 0.039717912673950195
Time for backpropagation: 0.0069386959075927734
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.7413797378540039 seconds
Index: 2
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.379722356796265 seconds
Streaming inaturalist data took 14.387131452560425 seconds
Then, training+dataloading take 14.388779878616333 seconds
The mode is:  split
Start 8000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5050985813140869
Time for copying to cuda: 0.0047016143798828125
Time for forward pass: 0.03978991508483887
Time for backpropagation: 0.00687098503112793
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.7084672451019287 seconds
Index: 3
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.080723524093628 seconds
Streaming inaturalist data took 14.08577847480774 seconds
Then, training+dataloading take 14.087249040603638 seconds
The mode is:  split
Start 10000, end 12000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.45181775093078613
Time for copying to cuda: 0.004666328430175781
Time for forward pass: 0.06579947471618652
Time for backpropagation: 0.009112834930419922
GPU memory for training: 0.8472614288330078                          

Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
One training iteration takes: 5.54455041885376 seconds
Index: 4
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.512300729751587 seconds
Streaming inaturalist data took 14.517253398895264 seconds
Then, training+dataloading take 14.518874645233154 seconds
The mode is:  split
Start 12000, end 14000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5242853164672852
Time for copying to cuda: 0.004675626754760742
Time for forward pass: 0.03995561599731445
Time for backpropagation: 0.0070455074310302734
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.7305135726928711 seconds
Index: 5
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.480813980102539 seconds
Streaming inaturalist data took 14.485872030258179 seconds
Then, training+dataloading take 14.487694501876831 seconds
The mode is:  split
Start 14000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5051565170288086
Time for copying to cuda: 0.004716396331787109
Time for forward pass: 0.03989124298095703
Time for backpropagation: 0.006978273391723633
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.6970374584197998 seconds
Index: 6
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.357879400253296 seconds
Streaming inaturalist data took 14.36294150352478 seconds
Then, training+dataloading take 14.364578008651733 seconds
The mode is:  split
Start 16000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5494594573974609
Time for copying to cuda: 0.004689455032348633
Time for forward pass: 0.039730072021484375
Time for backpropagation: 0.006849527359008789
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.7440950870513916 seconds
Index: 7
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.57713770866394 seconds
Streaming inaturalist data took 14.582237482070923 seconds
Then, training+dataloading take 14.58408784866333 seconds
The mode is:  split
Start 18000, end 20000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5060422420501709
Time for copying to cuda: 0.004689931869506836
Time for forward pass: 0.03984212875366211
Time for backpropagation: 0.0069468021392822266
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.7056369781494141 seconds
Index: 8
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 13.799353122711182 seconds
Streaming inaturalist data took 13.804310321807861 seconds
Then, training+dataloading take 13.80616044998169 seconds
The mode is:  split
Start 20000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.45252513885498047
Time for copying to cuda: 0.004681587219238281
Time for forward pass: 0.039829254150390625
Time for backpropagation: 0.007029056549072266
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.5939388275146484 seconds
Index: 9
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 13.799960851669312 seconds
Streaming inaturalist data took 13.809081315994263 seconds
Then, training+dataloading take 13.81454873085022 seconds
The mode is:  split
Start 22000, end 24000, post_step 250


Epoch: 0
Memory occpied: (2002.0, 1516.0)
Time of next(dataloader) is: 0.4516904354095459
Time for copying to cuda: 0.0047304630279541016
Time for forward pass: 0.04003548622131348
Time for backpropagation: 0.007009029388427734
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.5933811664581299 seconds
Index: 10
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.700531005859375 MBs for this batch
Executing all posts took 14.523307085037231 seconds
Streaming inaturalist data took 14.528332233428955 seconds
Then, training+dataloading take 14.530113458633423 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.44222021102905273
Time for copying to cuda: 0.004717826843261719
Time for forward pass: 0.03972935676574707
Time for backpropagation: 0.006864309310913086
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.5875608921051025 seconds
Index: 11
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 3.344240188598633 MBs for this batch
Executing all posts took 5.467904806137085 seconds
Streaming inaturalist data took 5.46977686882019 seconds
Then, training+dataloading take 5.470231056213379 seconds

Epoch: 0
Time of next(dataloader) is: 0.5196075439453125
Time for copying to cuda: 0.0012543201446533203
Time for forward pass: 0.03073906898498535
Time for backpropagation: 0.006703853607177734
GPU memory for training: 0.7695574760437012                          

Memory occpied: (2002.0, 1516.0)
The whole process took 186.3943154811859 seconds
