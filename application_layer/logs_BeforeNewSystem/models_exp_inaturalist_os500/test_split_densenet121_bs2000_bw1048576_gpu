Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.067365215935 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.   32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119022205.69358303 119022205.69358303
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.79473114013672
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1350.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 2000, post_step 250

Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.862874984741211 seconds
Streaming inaturalist data took 14.982195854187012 seconds
The mode is:  split
Start 2000, end 4000, post_step 250


Epoch: 0
Memory occpied: (1350.0, 3.0)
Time of next(dataloader) is: 0.5539426803588867
Time for copying to cuda: 0.05186605453491211
Memory occpied: (1542.0, 366.0)
Memory occpied: (1542.0, 854.0)
Memory occpied: (1542.0, 1292.0)
Memory occpied: (6904.0, 4930.0)
Time for forward pass: 5.016324520111084
Time for backpropagation: 0.08591699600219727
GPU memory for training: 6.147485733032227                          

One training iteration takes: 5.8107709884643555 seconds
Index: 0
Memory occpied: (5350.0, 2820.0)
Memory occpied: (5350.0, 2820.0)
Memory occpied: (5350.0, 2820.0)
Memory occpied: (5350.0, 2820.0)
Memory occpied: (5350.0, 2820.0)
Memory occpied: (5350.0, 2820.0)
Memory occpied: (5350.0, 2820.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.393963098526001 seconds
Streaming inaturalist data took 14.465822219848633 seconds
Then, training+dataloading take 14.468565702438354 seconds
The mode is:  split
Start 4000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6028671264648438
Time for copying to cuda: 0.049929141998291016
Time for forward pass: 0.23010826110839844
Time for backpropagation: 0.07370543479919434
GPU memory for training: 1.9698281288146973                          

Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
One training iteration takes: 6.037678956985474 seconds
Index: 1
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.582680225372314 seconds
Streaming inaturalist data took 14.654242515563965 seconds
Then, training+dataloading take 14.656999111175537 seconds
The mode is:  split
Start 6000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6279573440551758
Time for copying to cuda: 0.10647416114807129
Memory occpied: (5368.0, 2836.0)
Time for forward pass: 0.23625850677490234
Time for backpropagation: 0.01218104362487793
GPU memory for training: 1.9698281288146973                          

Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
One training iteration takes: 6.005083322525024 seconds
Index: 2
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.472445726394653 seconds
Streaming inaturalist data took 14.544384956359863 seconds
Then, training+dataloading take 14.550161123275757 seconds
The mode is:  split
Start 8000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6624529361724854
Time for copying to cuda: 0.050382375717163086
Time for forward pass: 0.2324676513671875
Time for backpropagation: 0.012310504913330078
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.123279094696045 seconds
Index: 3
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.384018182754517 seconds
Streaming inaturalist data took 14.455734252929688 seconds
Then, training+dataloading take 14.461686372756958 seconds
The mode is:  split
Start 10000, end 12000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6050593852996826
Time for copying to cuda: 0.05045342445373535
Time for forward pass: 0.2384941577911377
Time for backpropagation: 0.013226985931396484
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.0320384502410889 seconds
Index: 4
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.892573118209839 seconds
Streaming inaturalist data took 14.965213775634766 seconds
Then, training+dataloading take 14.970876455307007 seconds
The mode is:  split
Start 12000, end 14000, post_step 250


Epoch: 0
Memory occpied: (5368.0, 2836.0)
Time of next(dataloader) is: 0.7843236923217773
Time for copying to cuda: 0.050374507904052734
Time for forward pass: 0.22492527961730957
Time for backpropagation: 0.01215052604675293
GPU memory for training: 1.9698281288146973                          

Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
One training iteration takes: 6.10787296295166 seconds
Index: 5
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 15.268210172653198 seconds
Streaming inaturalist data took 15.34174633026123 seconds
Then, training+dataloading take 15.347435712814331 seconds
The mode is:  split
Start 14000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6246960163116455
Time for copying to cuda: 0.05052781105041504
Time for forward pass: 0.25034642219543457
Time for backpropagation: 0.013605833053588867
GPU memory for training: 1.9698281288146973                          

Memory occpied: (5368.0, 2836.0)
One training iteration takes: 1.0655832290649414 seconds
Index: 6
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.774253129959106 seconds
Streaming inaturalist data took 14.847880363464355 seconds
Then, training+dataloading take 14.853682518005371 seconds
The mode is:  split
Start 16000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.7403297424316406
Time for copying to cuda: 0.05039334297180176
Time for forward pass: 0.28386950492858887
Time for backpropagation: 0.012101888656616211
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.2632853984832764 seconds
Index: 7
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.01954436302185 seconds
Streaming inaturalist data took 14.093325853347778 seconds
Then, training+dataloading take 14.098976850509644 seconds
The mode is:  split
Start 18000, end 20000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6751561164855957
Time for copying to cuda: 0.05058169364929199
Time for forward pass: 0.2308964729309082
Time for backpropagation: 0.012315988540649414
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.1343626976013184 seconds
Index: 8
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.872492790222168 seconds
Streaming inaturalist data took 14.945175170898438 seconds
Then, training+dataloading take 14.951039552688599 seconds
The mode is:  split
Start 20000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.7113299369812012
Time for copying to cuda: 0.050119876861572266
Time for forward pass: 0.23209142684936523
Time for backpropagation: 0.012436628341674805
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.1785316467285156 seconds
Index: 9
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.42410922050476 seconds
Streaming inaturalist data took 14.497687339782715 seconds
Then, training+dataloading take 14.50390076637268 seconds
The mode is:  split
Start 22000, end 24000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6511290073394775
Time for copying to cuda: 0.05039358139038086
Time for forward pass: 0.23479628562927246
Time for backpropagation: 0.013299703598022461
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.109487771987915 seconds
Index: 10
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.462379932403564 seconds
Streaming inaturalist data took 14.534278154373169 seconds
Then, training+dataloading take 14.54034423828125 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5959103107452393
Time for copying to cuda: 0.05042839050292969
Time for forward pass: 0.22873401641845703
Time for backpropagation: 0.017101287841796875
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.0176780223846436 seconds
Index: 11
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Memory occpied: (5368.0, 2836.0)
Read 40.788856506347656 MBs for this batch
Executing all posts took 5.384412050247192 seconds
Streaming inaturalist data took 5.402817964553833 seconds
Then, training+dataloading take 5.403955459594727 seconds

Epoch: 0
Time of next(dataloader) is: 0.5394954681396484
Time for copying to cuda: 0.011210441589355469
Memory occpied: (2652.0, 3006.0)
Time for forward pass: 0.6149959564208984
Time for backpropagation: 0.02947545051574707
GPU memory for training: 1.9008359909057617                          

The whole process took 190.14936566352844 seconds
