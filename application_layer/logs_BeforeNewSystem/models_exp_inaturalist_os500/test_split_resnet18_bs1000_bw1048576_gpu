Namespace(batch_size=1000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.9995870225542 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 3.256800e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119013321.87022023 119013321.87022023
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.21269989013672
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1352.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 250

Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.942199945449829 seconds
Streaming inaturalist data took 7.978294849395752 seconds
The mode is:  split
Start 1000, end 2000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4455409049987793
Time for copying to cuda: 0.02617049217224121
Memory occpied: (1448.0, 208.0)
Memory occpied: (1448.0, 682.0)
Memory occpied: (1448.0, 1104.0)
Time for forward pass: 3.86091947555542
Memory occpied: (7938.0, 7858.0)
Time for backpropagation: 0.8097589015960693
GPU memory for training: 6.929030418395996                          

One training iteration takes: 5.229519367218018 seconds
Index: 0
Memory occpied: (4728.0, 4602.0)
Memory occpied: (4728.0, 4602.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.840357780456543 seconds
Streaming inaturalist data took 7.876581907272339 seconds
Then, training+dataloading take 7.877725839614868 seconds
The mode is:  split
Start 2000, end 3000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5927572250366211
Time for copying to cuda: 0.028809785842895508
Time for forward pass: 0.05701756477355957
Time for backpropagation: 0.005373954772949219
GPU memory for training: 1.3558835983276367                          

Memory occpied: (4728.0, 4618.0)
One training iteration takes: 0.8057324886322021 seconds
Index: 1
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.808887004852295 seconds
Streaming inaturalist data took 7.845419883728027 seconds
Then, training+dataloading take 7.846553325653076 seconds
The mode is:  split
Start 3000, end 4000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5695445537567139
Time for copying to cuda: 0.025571584701538086
Time for forward pass: 0.055925607681274414
Time for backpropagation: 0.004885435104370117
GPU memory for training: 1.3558835983276367                          

Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
One training iteration takes: 5.6851911544799805 seconds
Index: 2
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.695485830307007 seconds
Streaming inaturalist data took 7.731741666793823 seconds
Then, training+dataloading take 7.733060836791992 seconds
The mode is:  split
Start 4000, end 5000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5363922119140625
Time for copying to cuda: 0.025504350662231445
Time for forward pass: 0.0557856559753418
Time for backpropagation: 0.004704475402832031
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.7195532321929932 seconds
Index: 3
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.9592883586883545 seconds
Streaming inaturalist data took 7.995492696762085 seconds
Then, training+dataloading take 7.9968390464782715 seconds
The mode is:  split
Start 5000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5188283920288086
Time for copying to cuda: 0.025844812393188477
Time for forward pass: 0.10957574844360352
Time for backpropagation: 0.005735158920288086
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.7618939876556396 seconds
Index: 4
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.988101482391357 seconds
Streaming inaturalist data took 8.02462911605835 seconds
Then, training+dataloading take 8.025810480117798 seconds
The mode is:  split
Start 6000, end 7000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5689651966094971
Time for copying to cuda: 0.02547144889831543
Time for forward pass: 0.05571746826171875
Time for backpropagation: 0.004668712615966797
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.816864013671875 seconds
Index: 5
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.950934886932373 seconds
Streaming inaturalist data took 7.987503290176392 seconds
Then, training+dataloading take 7.988842248916626 seconds
The mode is:  split
Start 7000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5203001499176025
Time for copying to cuda: 0.02566814422607422
Time for forward pass: 0.11014938354492188
Time for backpropagation: 0.0057485103607177734
GPU memory for training: 1.3558835983276367                          

Memory occpied: (4744.0, 4618.0)
One training iteration takes: 0.7839338779449463 seconds
Index: 6
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.791295528411865 seconds
Streaming inaturalist data took 7.827624320983887 seconds
Then, training+dataloading take 7.82883620262146 seconds
The mode is:  split
Start 8000, end 9000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5175964832305908
Time for copying to cuda: 0.025931358337402344
Time for forward pass: 0.1093451976776123
Time for backpropagation: 0.005757331848144531
GPU memory for training: 1.3558835983276367                          

Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
One training iteration takes: 5.704339027404785 seconds
Index: 7
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.7586305141448975 seconds
Streaming inaturalist data took 7.79521369934082 seconds
Then, training+dataloading take 7.796521902084351 seconds
The mode is:  split
Start 9000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.554171085357666
Time for copying to cuda: 0.02577662467956543
Time for forward pass: 0.10767006874084473
Time for backpropagation: 0.006849050521850586
GPU memory for training: 1.3558835983276367                          

Memory occpied: (4744.0, 4618.0)
One training iteration takes: 0.8450191020965576 seconds
Index: 8
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.882043838500977 seconds
Streaming inaturalist data took 7.919288873672485 seconds
Then, training+dataloading take 7.920559406280518 seconds
The mode is:  split
Start 10000, end 11000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6312589645385742
Time for copying to cuda: 0.025788545608520508
Time for forward pass: 0.05595803260803223
Time for backpropagation: 0.004777669906616211
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.8951330184936523 seconds
Index: 9
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.8731608390808105 seconds
Streaming inaturalist data took 7.910335063934326 seconds
Then, training+dataloading take 7.911732196807861 seconds
The mode is:  split
Start 11000, end 12000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5423290729522705
Time for copying to cuda: 0.0254514217376709
Time for forward pass: 0.08516931533813477
Time for backpropagation: 0.006613969802856445
GPU memory for training: 1.3558835983276367                          

Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
One training iteration takes: 5.6841912269592285 seconds
Index: 10
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 8.07344651222229 seconds
Streaming inaturalist data took 8.1097993850708 seconds
Then, training+dataloading take 8.111077308654785 seconds
The mode is:  split
Start 12000, end 13000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.573702335357666
Time for copying to cuda: 0.025621652603149414
Memory occpied: (4744.0, 4618.0)
Time for forward pass: 0.056021928787231445
Time for backpropagation: 0.005445003509521484
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.768549919128418 seconds
Index: 11
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.773308515548706 seconds
Streaming inaturalist data took 7.809487342834473 seconds
Then, training+dataloading take 7.810706377029419 seconds
The mode is:  split
Start 13000, end 14000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.572810173034668
Time for copying to cuda: 0.025509357452392578
Time for forward pass: 0.05580401420593262
Time for backpropagation: 0.004835605621337891
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.8131670951843262 seconds
Index: 12
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 8.114658832550049 seconds
Streaming inaturalist data took 8.151195287704468 seconds
Then, training+dataloading take 8.152446985244751 seconds
The mode is:  split
Start 14000, end 15000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6201400756835938
Time for copying to cuda: 0.025860071182250977
Memory occpied: (4744.0, 4618.0)
Time for forward pass: 0.05598783493041992
Time for backpropagation: 0.0046977996826171875
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.8142321109771729 seconds
Index: 13
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.690348863601685 seconds
Streaming inaturalist data took 7.726989030838013 seconds
Then, training+dataloading take 7.728265762329102 seconds
The mode is:  split
Start 15000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5285701751708984
Time for copying to cuda: 0.02584695816040039
Time for forward pass: 0.05600118637084961
Time for backpropagation: 0.005627155303955078
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.7142274379730225 seconds
Index: 14
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.829069375991821 seconds
Streaming inaturalist data took 7.8655478954315186 seconds
Then, training+dataloading take 7.866712331771851 seconds
The mode is:  split
Start 16000, end 17000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.539984941482544
Time for copying to cuda: 0.025829315185546875
Time for forward pass: 0.10865426063537598
Time for backpropagation: 0.005868196487426758
GPU memory for training: 1.3558835983276367                          

Memory occpied: (4744.0, 4618.0)
One training iteration takes: 0.8037467002868652 seconds
Index: 15
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.7083659172058105 seconds
Streaming inaturalist data took 7.744775772094727 seconds
Then, training+dataloading take 7.7462804317474365 seconds
The mode is:  split
Start 17000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5233643054962158
Time for copying to cuda: 0.07994484901428223
Time for forward pass: 0.056157827377319336
Time for backpropagation: 0.004995822906494141
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.8324832916259766 seconds
Index: 16
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 8.018490314483643 seconds
Streaming inaturalist data took 8.055437564849854 seconds
Then, training+dataloading take 8.056699275970459 seconds
The mode is:  split
Start 18000, end 19000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5753364562988281
Time for copying to cuda: 0.02583026885986328
Time for forward pass: 0.055939435958862305
Time for backpropagation: 0.004873991012573242
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.8204412460327148 seconds
Index: 17
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.747586011886597 seconds
Streaming inaturalist data took 7.783981084823608 seconds
Then, training+dataloading take 7.785369157791138 seconds
The mode is:  split
Start 19000, end 20000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5202527046203613
Time for copying to cuda: 0.025896549224853516
Time for forward pass: 0.05590510368347168
Time for backpropagation: 0.004803180694580078
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.7102773189544678 seconds
Index: 18
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.703883647918701 seconds
Streaming inaturalist data took 7.741184949874878 seconds
Then, training+dataloading take 7.742677450180054 seconds
The mode is:  split
Start 20000, end 21000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5340948104858398
Time for copying to cuda: 0.025545120239257812
Time for forward pass: 0.055780887603759766
Time for backpropagation: 0.004997730255126953
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.7291245460510254 seconds
Index: 19
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.869386196136475 seconds
Streaming inaturalist data took 7.905719995498657 seconds
Then, training+dataloading take 7.907047748565674 seconds
The mode is:  split
Start 21000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5191230773925781
Time for copying to cuda: 0.0258331298828125
Time for forward pass: 0.05583000183105469
Time for backpropagation: 0.004831075668334961
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.7717611789703369 seconds
Index: 20
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.667186975479126 seconds
Streaming inaturalist data took 7.704499959945679 seconds
Then, training+dataloading take 7.705791473388672 seconds
The mode is:  split
Start 22000, end 23000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.518571138381958
Time for copying to cuda: 0.025259017944335938
Time for forward pass: 0.055737972259521484
Time for backpropagation: 0.0047054290771484375
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.7592122554779053 seconds
Index: 21
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.632375001907349 seconds
Streaming inaturalist data took 7.6683509349823 seconds
Then, training+dataloading take 7.669684648513794 seconds
The mode is:  split
Start 23000, end 24000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5411591529846191
Time for copying to cuda: 0.025514602661132812
Time for forward pass: 0.05577874183654785
Time for backpropagation: 0.00473332405090332
GPU memory for training: 1.3558835983276367                          

Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
One training iteration takes: 5.656059980392456 seconds
Index: 22
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.903081178665161 seconds
Streaming inaturalist data took 7.939821720123291 seconds
Then, training+dataloading take 7.9411139488220215 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5104749202728271
Time for copying to cuda: 0.025281190872192383
Time for forward pass: 0.05573248863220215
Time for backpropagation: 0.0047359466552734375
GPU memory for training: 1.3558835983276367                          

One training iteration takes: 0.698413610458374 seconds
Index: 23
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Memory occpied: (4744.0, 4618.0)
Read 40.788856506347656 MBs for this batch
Executing all posts took 4.762468099594116 seconds
Streaming inaturalist data took 4.778419494628906 seconds
Then, training+dataloading take 4.779218435287476 seconds

Epoch: 0
Memory occpied: (4744.0, 4618.0)
Time of next(dataloader) is: 0.5950243473052979
Time for copying to cuda: 0.011193037033081055
Time for forward pass: 0.27048826217651367
Time for backpropagation: 0.33244919776916504
GPU memory for training: 4.298344135284424                          

Memory occpied: (4744.0, 4618.0)
The whole process took 202.75610089302063 seconds
