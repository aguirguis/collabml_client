Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.470260973081 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [12845056. 12845056. 12845056. 12845056.  3211264.  6422528.  6422528.
  6422528.  6422528.  1605632.  3211264.  3211264.  3211264.  3211264.
  3211264.  3211264.  3211264.  3211264.   802816.  1605632.  1605632.
  1605632.  1605632.  1605632.  1605632.  1605632.  1605632.   401408.
   401408.   401408.   401408.   401408.   401408.   401408.   401408.
   401408.   100352.   100352.    16384.    16384.    16384.    16384.
    16384.    16384.    32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119075014.04626368 119075014.04626368
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.37090301513672
Fixed, scale_with_bsz  0 25.07421875
Mem usage  2006.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 2000, post_step 250

Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 29.70867896080017 seconds
Streaming inaturalist data took 29.994052171707153 seconds
The mode is:  split
Start 2000, end 4000, post_step 250


Epoch: 0
Time of next(dataloader) is: 1.0145153999328613
Time for copying to cuda: 0.2018280029296875
Time for forward pass: 5.664149761199951
Time for backpropagation: 0.09227299690246582
GPU memory for training: 13.58687686920166                          

One training iteration takes: 7.18515419960022 seconds
Index: 0
Memory occpied: (2006.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 32.023682594299316 seconds
Memory occpied: (4574.0, 8046.0)
Streaming inaturalist data took 32.459569454193115 seconds
Then, training+dataloading take 32.49984836578369 seconds
The mode is:  split
Start 4000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 1.002467155456543
Time for copying to cuda: 0.26208043098449707
Memory occpied: (4574.0, 8046.0)
Time for forward pass: 0.6760993003845215
Time for backpropagation: 0.004912376403808594
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.159259557723999 seconds
Index: 1
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 31.46519923210144 seconds
Streaming inaturalist data took 31.755623817443848 seconds
Then, training+dataloading take 31.808861255645752 seconds
The mode is:  split
Start 6000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 1.0279567241668701
Time for copying to cuda: 0.20181941986083984
Time for forward pass: 0.65621018409729
Time for backpropagation: 0.004654407501220703
GPU memory for training: 8.388604164123535                          

Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
One training iteration takes: 7.002297401428223 seconds
Index: 2
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 30.77047824859619 seconds
Streaming inaturalist data took 31.06136178970337 seconds
Then, training+dataloading take 31.11488628387451 seconds
The mode is:  split
Start 8000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 1.1763575077056885
Time for copying to cuda: 0.20403409004211426
Time for forward pass: 0.6762716770172119
Time for backpropagation: 0.0047261714935302734
GPU memory for training: 8.388604164123535                          

Memory occpied: (8404.0, 8054.0)
One training iteration takes: 2.2599687576293945 seconds
Index: 3
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 30.40828776359558 seconds
Streaming inaturalist data took 30.694543600082397 seconds
Then, training+dataloading take 30.747655630111694 seconds
The mode is:  split
Start 10000, end 12000, post_step 250


Epoch: 0
Memory occpied: (8404.0, 8054.0)
Time of next(dataloader) is: 1.030853033065796
Time for copying to cuda: 0.2008969783782959
Time for forward pass: 0.6462182998657227
Time for backpropagation: 0.005083560943603516
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.027740478515625 seconds
Index: 4
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 31.726784706115723 seconds
Streaming inaturalist data took 32.01331806182861 seconds
Then, training+dataloading take 32.06449580192566 seconds
The mode is:  split
Start 12000, end 14000, post_step 250


Epoch: 0
Memory occpied: (8404.0, 8054.0)
Time of next(dataloader) is: 0.9627809524536133
Time for copying to cuda: 0.20277070999145508
Time for forward pass: 0.7166600227355957
Time for backpropagation: 0.005242347717285156
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.0831806659698486 seconds
Index: 5
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 30.56300377845764 seconds
Streaming inaturalist data took 30.846288681030273 seconds
Then, training+dataloading take 30.898893117904663 seconds
The mode is:  split
Start 14000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 1.0599236488342285
Time for copying to cuda: 0.20355010032653809
Time for forward pass: 0.6557145118713379
Time for backpropagation: 0.004774332046508789
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.121943712234497 seconds
Index: 6
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 31.847306966781616 seconds
Streaming inaturalist data took 32.132935523986816 seconds
Then, training+dataloading take 32.18430161476135 seconds
The mode is:  split
Start 16000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 1.0744483470916748
Time for copying to cuda: 0.20090413093566895
Time for forward pass: 0.6778371334075928
Time for backpropagation: 0.004687786102294922
GPU memory for training: 8.388604164123535                          

Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
One training iteration takes: 7.068886756896973 seconds
Index: 7
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 30.88579559326172 seconds
Streaming inaturalist data took 31.169597148895264 seconds
Then, training+dataloading take 31.27170467376709 seconds
The mode is:  split
Start 18000, end 20000, post_step 250


Epoch: 0
Time of next(dataloader) is: 1.070462942123413
Time for copying to cuda: 0.20096802711486816
Time for forward pass: 0.6860220432281494
Time for backpropagation: 0.004726409912109375
GPU memory for training: 8.388604164123535                          

Memory occpied: (8404.0, 8054.0)
One training iteration takes: 2.2198712825775146 seconds
Index: 8
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 32.596843242645264 seconds
Memory occpied: (8404.0, 8054.0)
Streaming inaturalist data took 32.95543146133423 seconds
Then, training+dataloading take 33.00890493392944 seconds
The mode is:  split
Start 20000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.968834400177002
Memory occpied: (8404.0, 8054.0)
Time for copying to cuda: 0.25921177864074707
Time for forward pass: 0.681814432144165
Time for backpropagation: 0.004845857620239258
GPU memory for training: 8.388604164123535                          

Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
One training iteration takes: 7.025980710983276 seconds
Index: 9
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 32.22365617752075 seconds
Streaming inaturalist data took 32.507110595703125 seconds
Then, training+dataloading take 32.559733390808105 seconds
The mode is:  split
Start 22000, end 24000, post_step 250


Epoch: 0
Memory occpied: (8404.0, 8054.0)
Time of next(dataloader) is: 1.0053348541259766
Time for copying to cuda: 0.20281100273132324
Time for forward pass: 0.6977026462554932
Time for backpropagation: 0.005279064178466797
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.105334758758545 seconds
Index: 10
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7155685424805 MBs for this batch
Executing all posts took 31.545209646224976 seconds
Memory occpied: (8404.0, 8054.0)
Streaming inaturalist data took 31.829509496688843 seconds
Then, training+dataloading take 31.882869243621826 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.9992899894714355
Memory occpied: (8404.0, 8054.0)
Time for copying to cuda: 0.2029716968536377
Time for forward pass: 0.6737661361694336
Time for backpropagation: 0.004785776138305664
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.0900886058807373 seconds
Index: 11
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 163.09745025634766 MBs for this batch
Executing all posts took 9.843230962753296 seconds
Streaming inaturalist data took 9.90492868423462 seconds
Then, training+dataloading take 9.915663480758667 seconds

Epoch: 0
Time of next(dataloader) is: 0.6534228324890137
Time for copying to cuda: 0.045008182525634766
Time for forward pass: 0.7206668853759766
Time for backpropagation: 0.008697032928466797
GPU memory for training: 6.722691059112549                          

Memory occpied: (8404.0, 7670.0)
The whole process took 401.30463790893555 seconds
