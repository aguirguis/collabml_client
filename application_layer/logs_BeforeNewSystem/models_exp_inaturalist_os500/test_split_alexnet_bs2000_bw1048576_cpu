Namespace(batch_size=2000, cpuonly=True, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.499143631535 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.  32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119078799.75407256 119078799.75407256
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.216606140136719
Candidate split  13
Server, client, server+client, vanilla  51.28173828125 522.674560546875 573.956298828125 4554.901123046875
Model size  0.0
Intermediate:  0.03515625
1.47705078125
Total layers size  4.216606140136719
Fixed, scale_with_bsz  0.0 2.05126953125
Mem usage  1250.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.571360349655151 seconds
Streaming inaturalist data took 12.600049257278442 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43894147872924805
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.5849161148071289
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.6691944599151611
One training iteration takes: 1.7902474403381348 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.429183006286621 seconds
Streaming inaturalist data took 12.507889747619629 seconds
Then, training+dataloading take 12.51692247390747 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.46664929389953613
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.5025506019592285
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.9204070568084717
One training iteration takes: 2.075835943222046 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.513848066329956 seconds
Streaming inaturalist data took 12.541962385177612 seconds
Then, training+dataloading take 12.547039985656738 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5507934093475342
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.4904210567474365
Time for backpropagation: 0.6164135932922363
One training iteration takes: 1.8770265579223633 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.560852527618408 seconds
Streaming inaturalist data took 12.588250875473022 seconds
Then, training+dataloading take 12.591839790344238 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4707601070404053
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.64542555809021
Time for backpropagation: 0.7241339683532715
One training iteration takes: 2.148526191711426 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.80294132232666 seconds
Streaming inaturalist data took 12.830126285552979 seconds
Then, training+dataloading take 12.834967374801636 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4691758155822754
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6774206161499023
Time for backpropagation: 0.6742188930511475
One training iteration takes: 2.153869867324829 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.631776571273804 seconds
Streaming inaturalist data took 12.659189701080322 seconds
Then, training+dataloading take 12.665327787399292 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4726884365081787
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8066883087158203
Time for backpropagation: 0.6210851669311523
One training iteration takes: 2.0792176723480225 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.626016616821289 seconds
Streaming inaturalist data took 12.653228521347046 seconds
Then, training+dataloading take 12.658184051513672 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47659754753112793
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8293828964233398
Time for backpropagation: 0.6233458518981934
One training iteration takes: 2.1300575733184814 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.454938888549805 seconds
Streaming inaturalist data took 12.482472658157349 seconds
Then, training+dataloading take 12.485886573791504 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5365405082702637
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.5063753128051758
Time for backpropagation: 0.6731855869293213
One training iteration takes: 1.9345362186431885 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.919147253036499 seconds
Streaming inaturalist data took 12.94648003578186 seconds
Then, training+dataloading take 12.951627731323242 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5327894687652588
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.5072970390319824
Time for backpropagation: 0.68160080909729
One training iteration takes: 1.9492523670196533 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.697458982467651 seconds
Streaming inaturalist data took 12.724426746368408 seconds
Then, training+dataloading take 12.729332447052002 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47980284690856934
Time for copying to cuda: 7.62939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6209888458251953
Time for backpropagation: 0.7576582431793213
One training iteration takes: 2.1236493587493896 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.791604280471802 seconds
Streaming inaturalist data took 12.819623231887817 seconds
Then, training+dataloading take 12.824799537658691 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4799923896789551
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.7905964851379395
Time for backpropagation: 0.6112892627716064
One training iteration takes: 2.0907745361328125 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.626192808151245 seconds
Streaming inaturalist data took 12.653614282608032 seconds
Then, training+dataloading take 12.65961742401123 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4812967777252197
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.7853419780731201
Time for backpropagation: 0.6662356853485107
One training iteration takes: 2.1228935718536377 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 14.993935585021973 MBs for this batch
Executing all posts took 6.088104486465454 seconds
Streaming inaturalist data took 6.151343107223511 seconds
Then, training+dataloading take 6.153496026992798 seconds

Epoch: 0
Time of next(dataloader) is: 0.5108098983764648
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.20257973670959473
Time for backpropagation: 0.36606526374816895
Memory occpied: (1250.0, 3.0)
The whole process took 166.9404592514038 seconds
