Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.7856604887279 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.  32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 118985282.09157854 118985282.09157854
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.216606140136719
Candidate split  13
Server, client, server+client, vanilla  396.76611328125 868.158935546875 1264.925048828125 4900.385498046875
Model size  345.484375
Fixed, scale_with_bsz  345.484375 2.05126953125
Mem usage  1628.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 250

Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.418243885040283 seconds
Streaming inaturalist data took 15.445731163024902 seconds
The mode is:  split
Start 2000, end 4000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.43589305877685547
Time for copying to cuda: 0.06166434288024902
Memory occpied: (1700.0, 146.0)
Memory occpied: (1700.0, 630.0)
Memory occpied: (1700.0, 1082.0)
Time for forward pass: 3.4779367446899414
Time for backpropagation: 0.07216787338256836
GPU memory for training: 1.593996524810791                          

One training iteration takes: 4.139449596405029 seconds
Index: 0
Memory occpied: (2598.0, 1880.0)
Memory occpied: (2598.0, 1880.0)
Memory occpied: (2598.0, 1880.0)
Memory occpied: (2598.0, 1880.0)
Memory occpied: (2598.0, 1880.0)
Memory occpied: (2598.0, 1880.0)
Memory occpied: (2598.0, 1880.0)
Memory occpied: (2598.0, 1880.0)
Memory occpied: (2598.0, 1880.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.563305377960205 seconds
Streaming inaturalist data took 15.590641975402832 seconds
Then, training+dataloading take 15.592602014541626 seconds
The mode is:  split
Start 4000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5637538433074951
Time for copying to cuda: 0.019790172576904297
Time for forward pass: 0.1305406093597412
Time for backpropagation: 0.005038022994995117
GPU memory for training: 1.967562198638916                          

Memory occpied: (2598.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
One training iteration takes: 5.757603645324707 seconds
Index: 1
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.448969602584839 seconds
Streaming inaturalist data took 15.476561546325684 seconds
Then, training+dataloading take 15.47894835472107 seconds
The mode is:  split
Start 6000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.49340319633483887
Time for copying to cuda: 0.019948482513427734
Time for forward pass: 0.13071560859680176
Time for backpropagation: 0.0030515193939208984
GPU memory for training: 1.967562198638916                          

Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
One training iteration takes: 5.67023491859436 seconds
Index: 2
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.44174313545227 seconds
Streaming inaturalist data took 15.468838214874268 seconds
Then, training+dataloading take 15.470816135406494 seconds
The mode is:  split
Start 8000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5151114463806152
Time for copying to cuda: 0.01954054832458496
Time for forward pass: 0.133253812789917
Time for backpropagation: 0.0035355091094970703
GPU memory for training: 1.967562198638916                          

One training iteration takes: 0.8201801776885986 seconds
Index: 3
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.183486700057983 seconds
Streaming inaturalist data took 15.211409330368042 seconds
Then, training+dataloading take 15.213366508483887 seconds
The mode is:  split
Start 10000, end 12000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4933967590332031
Time for copying to cuda: 0.0197598934173584
Time for forward pass: 0.13071751594543457
Time for backpropagation: 0.002992391586303711
GPU memory for training: 1.967562198638916                          

Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
One training iteration takes: 5.667029857635498 seconds
Index: 4
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.639610528945923 seconds
Streaming inaturalist data took 15.66708755493164 seconds
Then, training+dataloading take 15.66888976097107 seconds
The mode is:  split
Start 12000, end 14000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5254850387573242
Time for copying to cuda: 0.02013540267944336
Time for forward pass: 0.1318981647491455
Time for backpropagation: 0.0033540725708007812
GPU memory for training: 1.967562198638916                          

One training iteration takes: 0.7796757221221924 seconds
Index: 5
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.204784870147705 seconds
Streaming inaturalist data took 15.232846975326538 seconds
Then, training+dataloading take 15.235215187072754 seconds
The mode is:  split
Start 14000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5023462772369385
Time for copying to cuda: 0.019930124282836914
Time for forward pass: 0.13071107864379883
Time for backpropagation: 0.0030143260955810547
GPU memory for training: 1.967562198638916                          

One training iteration takes: 0.7666795253753662 seconds
Index: 6
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.774797677993774 seconds
Streaming inaturalist data took 15.80213189125061 seconds
Then, training+dataloading take 15.803948163986206 seconds
The mode is:  split
Start 16000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5915417671203613
Time for copying to cuda: 0.019728899002075195
Time for forward pass: 0.13070344924926758
Time for backpropagation: 0.002971649169921875
GPU memory for training: 1.967562198638916                          

One training iteration takes: 0.8999896049499512 seconds
Index: 7
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.419870853424072 seconds
Streaming inaturalist data took 15.447085618972778 seconds
Then, training+dataloading take 15.448896884918213 seconds
The mode is:  split
Start 18000, end 20000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.49359869956970215
Time for copying to cuda: 0.019774913787841797
Time for forward pass: 0.13059425354003906
Time for backpropagation: 0.0029921531677246094
GPU memory for training: 1.967562198638916                          

Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
One training iteration takes: 5.666164398193359 seconds
Index: 8
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.64187741279602 seconds
Streaming inaturalist data took 15.669261932373047 seconds
Then, training+dataloading take 15.671322107315063 seconds
The mode is:  split
Start 20000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4952430725097656
Time for copying to cuda: 0.020092487335205078
Time for forward pass: 0.13200902938842773
Time for backpropagation: 0.0034592151641845703
GPU memory for training: 1.967562198638916                          

Memory occpied: (2878.0, 1888.0)
One training iteration takes: 0.751396656036377 seconds
Index: 9
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 16.10063099861145 seconds
Streaming inaturalist data took 16.128187656402588 seconds
Then, training+dataloading take 16.13105607032776 seconds
The mode is:  split
Start 22000, end 24000, post_step 250


Epoch: 0
Memory occpied: (2878.0, 1888.0)
Time of next(dataloader) is: 0.514885663986206
Time for copying to cuda: 0.01971292495727539
Time for forward pass: 0.13074636459350586
Time for backpropagation: 0.0030057430267333984
GPU memory for training: 1.967562198638916                          

Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
One training iteration takes: 5.688483238220215 seconds
Index: 10
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 70.39441680908203 MBs for this batch
Executing all posts took 15.698915243148804 seconds
Streaming inaturalist data took 15.72611117362976 seconds
Then, training+dataloading take 15.728163242340088 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.49458861351013184
Time for copying to cuda: 0.019886016845703125
Time for forward pass: 0.13060855865478516
Time for backpropagation: 0.0030095577239990234
GPU memory for training: 1.967562198638916                          

One training iteration takes: 0.8101484775543213 seconds
Index: 11
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Memory occpied: (2878.0, 1888.0)
Read 14.99404239654541 MBs for this batch
Executing all posts took 4.839235305786133 seconds
Streaming inaturalist data took 4.846242666244507 seconds
Then, training+dataloading take 4.84697151184082 seconds

Epoch: 0
Time of next(dataloader) is: 0.45203351974487305
Time for copying to cuda: 0.004468679428100586
Time for forward pass: 0.07355213165283203
Time for backpropagation: 0.002841472625732422
GPU memory for training: 1.7764015197753906                          

The whole process took 199.5783727169037 seconds
