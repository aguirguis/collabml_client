Namespace(batch_size=1000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.4648116337356 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.   32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119074299.790457 119074299.790457
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.79473114013672
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1350.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 1000, post_step 250

Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 8.111477136611938 seconds
Streaming inaturalist data took 8.148228883743286 seconds
The mode is:  split
Start 1000, end 2000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.45500731468200684
Time for copying to cuda: 0.026491880416870117
Memory occpied: (1446.0, 22.0)
Memory occpied: (1446.0, 624.0)
Memory occpied: (1446.0, 1074.0)
Memory occpied: (2906.0, 4518.0)
Time for forward pass: 4.237504005432129
Time for backpropagation: 0.08427095413208008
GPU memory for training: 3.404660224914551                          

One training iteration takes: 4.892656326293945 seconds
Index: 0
Memory occpied: (2026.0, 3576.0)
Memory occpied: (2026.0, 3576.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.724556922912598 seconds
Streaming inaturalist data took 7.7607879638671875 seconds
Then, training+dataloading take 7.762136936187744 seconds
The mode is:  split
Start 2000, end 3000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5710856914520264
Time for copying to cuda: 0.02551579475402832
Memory occpied: (2026.0, 3592.0)
Time for forward pass: 0.13317251205444336
Time for backpropagation: 0.012356758117675781
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.8485405445098877 seconds
Index: 1
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.853182077407837 seconds
Streaming inaturalist data took 7.889362335205078 seconds
Then, training+dataloading take 7.890709161758423 seconds
The mode is:  split
Start 3000, end 4000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5752177238464355
Time for copying to cuda: 0.025465011596679688
Time for forward pass: 0.12862062454223633
Time for backpropagation: 0.01169586181640625
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.8897395133972168 seconds
Index: 2
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.708654403686523 seconds
Streaming inaturalist data took 7.745166063308716 seconds
Then, training+dataloading take 7.746568202972412 seconds
The mode is:  split
Start 4000, end 5000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5210559368133545
Time for copying to cuda: 0.0255281925201416
Time for forward pass: 0.12877416610717773
Time for backpropagation: 0.011633634567260742
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.7833137512207031 seconds
Index: 3
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.8216331005096436 seconds
Streaming inaturalist data took 7.857830762863159 seconds
Then, training+dataloading take 7.859232425689697 seconds
The mode is:  split
Start 5000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5163693428039551
Time for copying to cuda: 0.025640010833740234
Time for forward pass: 0.13229131698608398
Time for backpropagation: 0.01197671890258789
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
One training iteration takes: 5.715220212936401 seconds
Index: 4
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.63062047958374 seconds
Streaming inaturalist data took 7.667497634887695 seconds
Then, training+dataloading take 7.668978929519653 seconds
The mode is:  split
Start 6000, end 7000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5253889560699463
Time for copying to cuda: 0.026022672653198242
Time for forward pass: 0.1300981044769287
Time for backpropagation: 0.011757373809814453
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.8212378025054932 seconds
Index: 5
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 8.145020723342896 seconds
Streaming inaturalist data took 8.182559251785278 seconds
Then, training+dataloading take 8.183985710144043 seconds
The mode is:  split
Start 7000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5795145034790039
Time for copying to cuda: 0.025722503662109375
Time for forward pass: 0.12859892845153809
Time for backpropagation: 0.011737823486328125
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.8994491100311279 seconds
Index: 6
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.8339269161224365 seconds
Streaming inaturalist data took 7.870440244674683 seconds
Then, training+dataloading take 7.871655225753784 seconds
The mode is:  split
Start 8000, end 9000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5749011039733887
Time for copying to cuda: 0.07996344566345215
Time for forward pass: 0.18761396408081055
Time for backpropagation: 0.013195037841796875
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
One training iteration takes: 0.9645669460296631 seconds
Index: 7
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.920990467071533 seconds
Streaming inaturalist data took 7.957578182220459 seconds
Then, training+dataloading take 7.958869218826294 seconds
The mode is:  split
Start 9000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5194787979125977
Time for copying to cuda: 0.025699615478515625
Time for forward pass: 0.13237762451171875
Time for backpropagation: 0.012241363525390625
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
One training iteration takes: 0.805354118347168 seconds
Index: 8
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.569241046905518 seconds
Streaming inaturalist data took 7.605907678604126 seconds
Then, training+dataloading take 7.60727596282959 seconds
The mode is:  split
Start 10000, end 11000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5200257301330566
Time for copying to cuda: 0.02550363540649414
Time for forward pass: 0.1288588047027588
Time for backpropagation: 0.06877827644348145
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.8484501838684082 seconds
Index: 9
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.964415788650513 seconds
Streaming inaturalist data took 8.000946521759033 seconds
Then, training+dataloading take 8.002387285232544 seconds
The mode is:  split
Start 11000, end 12000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5454964637756348
Time for copying to cuda: 0.025712013244628906
Time for forward pass: 0.1330091953277588
Time for backpropagation: 0.012102603912353516
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
One training iteration takes: 0.853203535079956 seconds
Index: 10
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.958585977554321 seconds
Streaming inaturalist data took 7.995176076889038 seconds
Then, training+dataloading take 7.996613025665283 seconds
The mode is:  split
Start 12000, end 13000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5829498767852783
Time for copying to cuda: 0.025807857513427734
Memory occpied: (2140.0, 3592.0)
Time for forward pass: 0.13002753257751465
Time for backpropagation: 0.011754274368286133
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.8701348304748535 seconds
Index: 11
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 8.206364631652832 seconds
Streaming inaturalist data took 8.243574857711792 seconds
Then, training+dataloading take 8.247789144515991 seconds
The mode is:  split
Start 13000, end 14000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6446452140808105
Time for copying to cuda: 0.02574324607849121
Time for forward pass: 0.12890291213989258
Time for backpropagation: 0.011821985244750977
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
One training iteration takes: 5.836109161376953 seconds
Index: 12
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.9146575927734375 seconds
Streaming inaturalist data took 7.951316833496094 seconds
Then, training+dataloading take 7.953002691268921 seconds
The mode is:  split
Start 14000, end 15000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.563791036605835
Time for copying to cuda: 0.025737762451171875
Time for forward pass: 0.132049560546875
Time for backpropagation: 0.01203608512878418
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
One training iteration takes: 0.85556960105896 seconds
Index: 13
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.874550819396973 seconds
Streaming inaturalist data took 7.910800457000732 seconds
Then, training+dataloading take 7.912216901779175 seconds
The mode is:  split
Start 15000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5830469131469727
Time for copying to cuda: 0.025667428970336914
Memory occpied: (2140.0, 3592.0)
Time for forward pass: 0.21412134170532227
Time for backpropagation: 0.011466741561889648
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.947134256362915 seconds
Index: 14
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.835129261016846 seconds
Streaming inaturalist data took 7.8717217445373535 seconds
Then, training+dataloading take 7.873169898986816 seconds
The mode is:  split
Start 16000, end 17000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5215685367584229
Time for copying to cuda: 0.025544166564941406
Time for forward pass: 0.1327192783355713
Time for backpropagation: 0.01226663589477539
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
One training iteration takes: 0.7975943088531494 seconds
Index: 15
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.749693393707275 seconds
Streaming inaturalist data took 7.785878896713257 seconds
Then, training+dataloading take 7.787349700927734 seconds
The mode is:  split
Start 17000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5537300109863281
Time for copying to cuda: 0.02558755874633789
Time for forward pass: 0.13307666778564453
Time for backpropagation: 0.011870622634887695
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
One training iteration takes: 0.8468575477600098 seconds
Index: 16
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.834460496902466 seconds
Streaming inaturalist data took 7.871125936508179 seconds
Then, training+dataloading take 7.872281789779663 seconds
The mode is:  split
Start 18000, end 19000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5545065402984619
Time for copying to cuda: 0.025982141494750977
Time for forward pass: 0.13290119171142578
Time for backpropagation: 0.012041807174682617
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
One training iteration takes: 0.8365590572357178 seconds
Index: 17
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.989741325378418 seconds
Streaming inaturalist data took 8.026169538497925 seconds
Then, training+dataloading take 8.027458429336548 seconds
The mode is:  split
Start 19000, end 20000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5843267440795898
Time for copying to cuda: 0.025479793548583984
Time for forward pass: 0.12853336334228516
Time for backpropagation: 0.011718511581420898
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
One training iteration takes: 5.774150848388672 seconds
Index: 18
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.912025690078735 seconds
Streaming inaturalist data took 7.948711633682251 seconds
Then, training+dataloading take 7.950141191482544 seconds
The mode is:  split
Start 20000, end 21000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5696213245391846
Time for copying to cuda: 0.02567434310913086
Time for forward pass: 0.13288187980651855
Time for backpropagation: 0.015635251998901367
GPU memory for training: 1.0999383926391602                          

Memory occpied: (2140.0, 3592.0)
One training iteration takes: 0.8646066188812256 seconds
Index: 19
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.769378423690796 seconds
Streaming inaturalist data took 7.806206226348877 seconds
Then, training+dataloading take 7.807657480239868 seconds
The mode is:  split
Start 21000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6134846210479736
Time for copying to cuda: 0.07983136177062988
Memory occpied: (2140.0, 3592.0)
Time for forward pass: 0.18172717094421387
Time for backpropagation: 0.011749982833862305
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.9964447021484375 seconds
Index: 20
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.807384014129639 seconds
Streaming inaturalist data took 7.843977212905884 seconds
Then, training+dataloading take 7.845426797866821 seconds
The mode is:  split
Start 22000, end 23000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6223289966583252
Time for copying to cuda: 0.07981491088867188
Memory occpied: (2140.0, 3592.0)
Time for forward pass: 0.13003849983215332
Time for backpropagation: 0.011575460433959961
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.9595587253570557 seconds
Index: 21
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.407069683074951 seconds
Streaming inaturalist data took 7.443136692047119 seconds
Then, training+dataloading take 7.4447174072265625 seconds
The mode is:  split
Start 23000, end 24000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5443844795227051
Time for copying to cuda: 0.0255582332611084
Time for forward pass: 0.12900972366333008
Time for backpropagation: 0.011691808700561523
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.8236372470855713 seconds
Index: 22
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 95.74840927124023 MBs for this batch
Executing all posts took 7.748908758163452 seconds
Streaming inaturalist data took 7.784912586212158 seconds
Then, training+dataloading take 7.786474227905273 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5396163463592529
Time for copying to cuda: 0.025577783584594727
Time for forward pass: 0.1289350986480713
Time for backpropagation: 0.011650562286376953
GPU memory for training: 1.0999383926391602                          

One training iteration takes: 0.8302772045135498 seconds
Index: 23
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Memory occpied: (2140.0, 3592.0)
Read 40.788856506347656 MBs for this batch
Executing all posts took 5.238297939300537 seconds
Streaming inaturalist data took 5.254592180252075 seconds
Then, training+dataloading take 5.255549430847168 seconds

Epoch: 0
Time of next(dataloader) is: 0.4818077087402344
Time for copying to cuda: 0.011113882064819336
Memory occpied: (2500.0, 3246.0)
Time for forward pass: 0.6555399894714355
Time for backpropagation: 0.028144359588623047
GPU memory for training: 1.9000177383422852                          

The whole process took 202.93434476852417 seconds
