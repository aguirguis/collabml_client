Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3166946154352 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 3.256800e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119054885.79663432 119054885.79663432
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.21269989013672
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1352.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 250

Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.841869115829468 seconds
Streaming inaturalist data took 14.961247444152832 seconds
The mode is:  split
Start 2000, end 4000, post_step 250


Epoch: 0
Memory occpied: (1352.0, 3.0)
Time of next(dataloader) is: 0.5629034042358398
Time for copying to cuda: 0.051374197006225586
Memory occpied: (1544.0, 388.0)
Memory occpied: (1544.0, 798.0)
Memory occpied: (1544.0, 1292.0)
Time for forward pass: 4.369605302810669
Memory occpied: (12328.0, 12200.0)
Time for backpropagation: 1.5197782516479492
GPU memory for training: 11.622561931610107                          

Memory occpied: (6996.0, 6822.0)
One training iteration takes: 6.615753173828125 seconds
Index: 0
Memory occpied: (6996.0, 6822.0)
Memory occpied: (6996.0, 6822.0)
Memory occpied: (6996.0, 6822.0)
Memory occpied: (6996.0, 6822.0)
Memory occpied: (6996.0, 6822.0)
Memory occpied: (6996.0, 6822.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.964589834213257 seconds
Streaming inaturalist data took 15.03834080696106 seconds
Then, training+dataloading take 15.040581941604614 seconds
The mode is:  split
Start 4000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6639161109924316
Time for copying to cuda: 0.05074334144592285
Time for forward pass: 0.10022807121276855
Time for backpropagation: 0.0049359798431396484
GPU memory for training: 2.449821949005127                          

One training iteration takes: 0.9844942092895508 seconds
Index: 1
Memory occpied: (6996.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.810238599777222 seconds
Streaming inaturalist data took 14.883984088897705 seconds
Then, training+dataloading take 14.889568567276001 seconds
The mode is:  split
Start 6000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.7172768115997314
Time for copying to cuda: 0.05085444450378418
Time for forward pass: 0.10016083717346191
Time for backpropagation: 0.0048542022705078125
GPU memory for training: 2.449821949005127                          

Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
One training iteration takes: 5.908482551574707 seconds
Index: 2
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.669370651245117 seconds
Streaming inaturalist data took 14.741578817367554 seconds
Then, training+dataloading take 14.746936798095703 seconds
The mode is:  split
Start 8000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6875789165496826
Time for copying to cuda: 0.051035404205322266
Memory occpied: (7012.0, 6838.0)
Time for forward pass: 0.1002814769744873
Time for backpropagation: 0.004901885986328125
GPU memory for training: 2.449821949005127                          

One training iteration takes: 0.9691581726074219 seconds
Index: 3
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 15.266496181488037 seconds
Streaming inaturalist data took 15.337646007537842 seconds
Then, training+dataloading take 15.343013286590576 seconds
The mode is:  split
Start 10000, end 12000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6005432605743408
Time for copying to cuda: 0.050499677658081055
Time for forward pass: 0.1005098819732666
Time for backpropagation: 0.08246612548828125
GPU memory for training: 2.449821949005127                          

One training iteration takes: 0.9595837593078613 seconds
Index: 4
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.409173488616943 seconds
Streaming inaturalist data took 14.48098349571228 seconds
Then, training+dataloading take 14.486640691757202 seconds
The mode is:  split
Start 12000, end 14000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5963785648345947
Time for copying to cuda: 0.05090785026550293
Time for forward pass: 0.1020967960357666
Time for backpropagation: 0.005632162094116211
GPU memory for training: 2.449821949005127                          

Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
One training iteration takes: 5.813635349273682 seconds
Index: 5
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.859947204589844 seconds
Streaming inaturalist data took 14.932778120040894 seconds
Then, training+dataloading take 14.938289403915405 seconds
The mode is:  split
Start 14000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6588642597198486
Time for copying to cuda: 0.05088019371032715
Time for forward pass: 0.10013723373413086
Time for backpropagation: 0.0048980712890625
GPU memory for training: 2.449821949005127                          

Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
One training iteration takes: 5.851196527481079 seconds
Index: 6
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.392241716384888 seconds
Streaming inaturalist data took 14.464349031448364 seconds
Then, training+dataloading take 14.469849348068237 seconds
The mode is:  split
Start 16000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.602792501449585
Time for copying to cuda: 0.05078244209289551
Time for forward pass: 0.10118913650512695
Time for backpropagation: 0.005857706069946289
GPU memory for training: 2.449821949005127                          

One training iteration takes: 0.9080336093902588 seconds
Index: 7
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.817367553710938 seconds
Streaming inaturalist data took 14.891090154647827 seconds
Then, training+dataloading take 14.896476030349731 seconds
The mode is:  split
Start 18000, end 20000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6924538612365723
Time for copying to cuda: 0.051128387451171875
Time for forward pass: 0.10024762153625488
Time for backpropagation: 0.0049648284912109375
GPU memory for training: 2.449821949005127                          

Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
One training iteration takes: 5.901360273361206 seconds
Index: 8
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.558115243911743 seconds
Streaming inaturalist data took 14.629734516143799 seconds
Then, training+dataloading take 14.635315418243408 seconds
The mode is:  split
Start 20000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6331653594970703
Time for copying to cuda: 0.05094647407531738
Time for forward pass: 0.10178995132446289
Time for backpropagation: 0.0057561397552490234
GPU memory for training: 2.449821949005127                          

Memory occpied: (7012.0, 6838.0)
One training iteration takes: 0.9419634342193604 seconds
Index: 9
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 15.222493410110474 seconds
Memory occpied: (7012.0, 6838.0)
Streaming inaturalist data took 15.29490613937378 seconds
Then, training+dataloading take 15.300601720809937 seconds
The mode is:  split
Start 22000, end 24000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.6424238681793213
Time for copying to cuda: 0.051447153091430664
Time for forward pass: 0.10024523735046387
Time for backpropagation: 0.004988431930541992
GPU memory for training: 2.449821949005127                          

One training iteration takes: 0.9382343292236328 seconds
Index: 10
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 191.49681854248047 MBs for this batch
Executing all posts took 14.627777814865112 seconds
Streaming inaturalist data took 14.700612783432007 seconds
Then, training+dataloading take 14.706177234649658 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.604527473449707
Time for copying to cuda: 0.10747194290161133
Time for forward pass: 0.11279892921447754
Time for backpropagation: 0.005605459213256836
GPU memory for training: 2.449821949005127                          

Memory occpied: (7012.0, 6838.0)
One training iteration takes: 0.9707341194152832 seconds
Index: 11
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Memory occpied: (7012.0, 6838.0)
Read 40.788856506347656 MBs for this batch
Executing all posts took 4.913060665130615 seconds
Streaming inaturalist data took 4.931453704833984 seconds
Then, training+dataloading take 4.932658672332764 seconds

Epoch: 0
Time of next(dataloader) is: 0.535330057144165
Time for copying to cuda: 0.011262893676757812
Time for forward pass: 0.2837822437286377
Time for backpropagation: 0.3728468418121338
GPU memory for training: 4.297852039337158                          

Memory occpied: (7008.0, 6742.0)
The whole process took 191.93791151046753 seconds
