Namespace(batch_size=1000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.5901800916957 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.  32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 118959660.08497874 118959660.08497874
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.216606140136719
Candidate split  13
Server, client, server+client, vanilla  396.76611328125 606.8216552734375 1003.5877685546875 2622.9349365234375
Model size  345.484375
Fixed, scale_with_bsz  345.484375 2.05126953125
Mem usage  1628.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 250

Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Memory occpied: (1628.0, 3.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 8.068968057632446 seconds
Streaming inaturalist data took 8.08303451538086 seconds
The mode is:  split
Start 1000, end 2000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.39040660858154297
Time for copying to cuda: 0.010669231414794922
Memory occpied: (1664.0, 136.0)
Memory occpied: (1664.0, 638.0)
Memory occpied: (1664.0, 1086.0)
Time for forward pass: 3.3923895359039307
Time for backpropagation: 0.05586647987365723
GPU memory for training: 1.473337173461914                          

One training iteration takes: 3.9298856258392334 seconds
Index: 0
Memory occpied: (2434.0, 1826.0)
Memory occpied: (2434.0, 1826.0)
Memory occpied: (2434.0, 1826.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 8.08691668510437 seconds
Streaming inaturalist data took 8.101313591003418 seconds
Then, training+dataloading take 8.103564262390137 seconds
The mode is:  split
Start 2000, end 3000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5113108158111572
Time for copying to cuda: 0.01015019416809082
Time for forward pass: 0.0937962532043457
Time for backpropagation: 0.006134986877441406
GPU memory for training: 1.845773696899414                          

Memory occpied: (2434.0, 1826.0)
One training iteration takes: 0.7227845191955566 seconds
Index: 1
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.960755825042725 seconds
Streaming inaturalist data took 7.975047588348389 seconds
Then, training+dataloading take 7.975918292999268 seconds
The mode is:  split
Start 3000, end 4000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5105247497558594
Time for copying to cuda: 0.010100603103637695
Time for forward pass: 0.09367871284484863
Time for backpropagation: 0.0029518604278564453
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7627451419830322 seconds
Index: 2
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.951486110687256 seconds
Streaming inaturalist data took 7.9656102657318115 seconds
Then, training+dataloading take 7.966437816619873 seconds
The mode is:  split
Start 4000, end 5000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5553572177886963
Time for copying to cuda: 0.010254859924316406
Time for forward pass: 0.09378314018249512
Time for backpropagation: 0.0030078887939453125
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.8154566287994385 seconds
Index: 3
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.808967351913452 seconds
Streaming inaturalist data took 7.823013782501221 seconds
Then, training+dataloading take 7.823885440826416 seconds
The mode is:  split
Start 5000, end 6000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.4612562656402588
Time for copying to cuda: 0.0607759952545166
Time for forward pass: 0.1353285312652588
Time for backpropagation: 0.003428220748901367
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7710206508636475 seconds
Index: 4
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.9265148639678955 seconds
Streaming inaturalist data took 7.940717935562134 seconds
Then, training+dataloading take 7.941495656967163 seconds
The mode is:  split
Start 6000, end 7000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5645911693572998
Time for copying to cuda: 0.010280847549438477
Memory occpied: (2858.0, 1834.0)
Time for forward pass: 0.0937814712524414
Time for backpropagation: 0.002912759780883789
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7683737277984619 seconds
Index: 5
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.874029636383057 seconds
Streaming inaturalist data took 7.888117551803589 seconds
Then, training+dataloading take 7.889007568359375 seconds
The mode is:  split
Start 7000, end 8000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5476930141448975
Time for copying to cuda: 0.010059356689453125
Time for forward pass: 0.09378218650817871
Time for backpropagation: 0.002963542938232422
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.8037357330322266 seconds
Index: 6
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.976597547531128 seconds
Streaming inaturalist data took 7.990610599517822 seconds
Then, training+dataloading take 7.991471529006958 seconds
The mode is:  split
Start 8000, end 9000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5745775699615479
Time for copying to cuda: 0.010187387466430664
Time for forward pass: 0.09383344650268555
Time for backpropagation: 0.002883434295654297
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.8401486873626709 seconds
Index: 7
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.966574668884277 seconds
Streaming inaturalist data took 7.9804112911224365 seconds
Then, training+dataloading take 7.981242418289185 seconds
The mode is:  split
Start 9000, end 10000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5357017517089844
Time for copying to cuda: 0.010222673416137695
Time for forward pass: 0.09377861022949219
Time for backpropagation: 0.002955913543701172
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7521240711212158 seconds
Index: 8
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 8.062790393829346 seconds
Streaming inaturalist data took 8.076781034469604 seconds
Then, training+dataloading take 8.077674865722656 seconds
The mode is:  split
Start 10000, end 11000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5296268463134766
Time for copying to cuda: 0.01004934310913086
Time for forward pass: 0.09373188018798828
Time for backpropagation: 0.002997159957885742
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7814843654632568 seconds
Index: 9
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.942816495895386 seconds
Streaming inaturalist data took 7.956685543060303 seconds
Then, training+dataloading take 7.957526683807373 seconds
The mode is:  split
Start 11000, end 12000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5069308280944824
Time for copying to cuda: 0.06064414978027344
Memory occpied: (2858.0, 1834.0)
Time for forward pass: 0.09385323524475098
Time for backpropagation: 0.002923250198364258
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7687411308288574 seconds
Index: 10
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.9326417446136475 seconds
Streaming inaturalist data took 7.946743488311768 seconds
Then, training+dataloading take 7.947628021240234 seconds
The mode is:  split
Start 12000, end 13000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5123255252838135
Time for copying to cuda: 0.01015472412109375
Time for forward pass: 0.09374094009399414
Time for backpropagation: 0.0030031204223632812
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.785254716873169 seconds
Index: 11
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.811819791793823 seconds
Streaming inaturalist data took 7.825896739959717 seconds
Then, training+dataloading take 7.826814889907837 seconds
The mode is:  split
Start 13000, end 14000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.48908400535583496
Time for copying to cuda: 0.010324716567993164
Time for forward pass: 0.1269702911376953
Time for backpropagation: 0.0034143924713134766
GPU memory for training: 1.845010757446289                          

Memory occpied: (2858.0, 1834.0)
One training iteration takes: 0.7318449020385742 seconds
Index: 12
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.9891273975372314 seconds
Streaming inaturalist data took 8.003193140029907 seconds
Then, training+dataloading take 8.004066705703735 seconds
The mode is:  split
Start 14000, end 15000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.566664457321167
Time for copying to cuda: 0.01015472412109375
Time for forward pass: 0.09380173683166504
Time for backpropagation: 0.002976655960083008
GPU memory for training: 1.845010757446289                          

Memory occpied: (2858.0, 1834.0)
One training iteration takes: 0.8056559562683105 seconds
Index: 13
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.911390066146851 seconds
Streaming inaturalist data took 7.925481796264648 seconds
Then, training+dataloading take 7.926363945007324 seconds
The mode is:  split
Start 15000, end 16000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5213441848754883
Time for copying to cuda: 0.010361671447753906
Time for forward pass: 0.09385490417480469
Time for backpropagation: 0.0030126571655273438
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7760379314422607 seconds
Index: 14
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.888671159744263 seconds
Streaming inaturalist data took 7.902665853500366 seconds
Then, training+dataloading take 7.903512716293335 seconds
The mode is:  split
Start 16000, end 17000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.50506591796875
Time for copying to cuda: 0.010181903839111328
Time for forward pass: 0.09389996528625488
Time for backpropagation: 0.0029392242431640625
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7698304653167725 seconds
Index: 15
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.880666255950928 seconds
Streaming inaturalist data took 7.894688129425049 seconds
Then, training+dataloading take 7.8955090045928955 seconds
The mode is:  split
Start 17000, end 18000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5373697280883789
Time for copying to cuda: 0.010230302810668945
Time for forward pass: 0.0938413143157959
Time for backpropagation: 0.0029969215393066406
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.8252558708190918 seconds
Index: 16
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 8.024443626403809 seconds
Streaming inaturalist data took 8.038370370864868 seconds
Then, training+dataloading take 8.039236307144165 seconds
The mode is:  split
Start 18000, end 19000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.541071891784668
Time for copying to cuda: 0.010057687759399414
Time for forward pass: 0.09380531311035156
Time for backpropagation: 0.003001689910888672
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7943592071533203 seconds
Index: 17
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.873266935348511 seconds
Streaming inaturalist data took 7.8873865604400635 seconds
Then, training+dataloading take 7.888214588165283 seconds
The mode is:  split
Start 19000, end 20000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.47658705711364746
Time for copying to cuda: 0.010329961776733398
Time for forward pass: 0.1273336410522461
Time for backpropagation: 0.0036635398864746094
GPU memory for training: 1.845010757446289                          

Memory occpied: (2858.0, 1834.0)
One training iteration takes: 0.7215180397033691 seconds
Index: 18
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.90761137008667 seconds
Streaming inaturalist data took 7.921526193618774 seconds
Then, training+dataloading take 7.922316312789917 seconds
The mode is:  split
Start 20000, end 21000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5098590850830078
Time for copying to cuda: 0.010108232498168945
Time for forward pass: 0.09377622604370117
Time for backpropagation: 0.003057241439819336
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7568514347076416 seconds
Index: 19
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.922103404998779 seconds
Streaming inaturalist data took 7.936422348022461 seconds
Then, training+dataloading take 7.937269449234009 seconds
The mode is:  split
Start 21000, end 22000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5255532264709473
Time for copying to cuda: 0.010274410247802734
Time for forward pass: 0.09377503395080566
Time for backpropagation: 0.002969503402709961
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.7748103141784668 seconds
Index: 20
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.972733974456787 seconds
Streaming inaturalist data took 7.986995220184326 seconds
Then, training+dataloading take 7.987848520278931 seconds
The mode is:  split
Start 22000, end 23000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5282208919525146
Time for copying to cuda: 0.010222196578979492
Time for forward pass: 0.09379148483276367
Time for backpropagation: 0.0030024051666259766
GPU memory for training: 1.845010757446289                          

Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
One training iteration takes: 5.652724266052246 seconds
Index: 21
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.8330159187316895 seconds
Streaming inaturalist data took 7.846981763839722 seconds
Then, training+dataloading take 7.847879648208618 seconds
The mode is:  split
Start 23000, end 24000, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.477217435836792
Time for copying to cuda: 0.010341405868530273
Time for forward pass: 0.1274421215057373
Time for backpropagation: 0.003530263900756836
GPU memory for training: 1.845010757446289                          

Memory occpied: (2858.0, 1834.0)
One training iteration takes: 0.7214794158935547 seconds
Index: 22
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 35.197208404541016 MBs for this batch
Executing all posts took 7.854635238647461 seconds
Streaming inaturalist data took 7.868933439254761 seconds
Then, training+dataloading take 7.8697898387908936 seconds
The mode is:  split
Start 24000, end 24426, post_step 250


Epoch: 0
Time of next(dataloader) is: 0.5151746273040771
Time for copying to cuda: 0.010144710540771484
Time for forward pass: 0.09384751319885254
Time for backpropagation: 0.003064870834350586
GPU memory for training: 1.845010757446289                          

One training iteration takes: 0.765857458114624 seconds
Index: 23
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Memory occpied: (2858.0, 1834.0)
Read 14.99404239654541 MBs for this batch
Executing all posts took 5.092683553695679 seconds
Streaming inaturalist data took 5.098723888397217 seconds
Then, training+dataloading take 5.099374055862427 seconds

Epoch: 0
Time of next(dataloader) is: 0.45325350761413574
Time for copying to cuda: 0.0045430660247802734
Time for forward pass: 0.07371163368225098
Time for backpropagation: 0.002941608428955078
GPU memory for training: 1.7764015197753906                          

Memory occpied: (2858.0, 1834.0)
The whole process took 204.6242105960846 seconds
