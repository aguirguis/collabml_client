Namespace(batch_size=1000, cpuonly=True, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 907.8876293620716 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 3.256800e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 118998647.35574545 118998647.35574545
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.21269989013672
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.95145058631897 seconds
Streaming inaturalist data took 11.988154411315918 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5322360992431641
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.6573801040649414
Time for backpropagation: 1.1601686477661133
Memory occpied: (1250.0, 3.0)
One training iteration takes: 2.445157527923584 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.812568426132202 seconds
Streaming inaturalist data took 11.849710702896118 seconds
Then, training+dataloading take 11.857160329818726 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5563104152679443
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.6006729602813721
Time for backpropagation: 1.1982409954071045
Memory occpied: (1250.0, 3.0)
One training iteration takes: 2.468583106994629 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.717971324920654 seconds
Streaming inaturalist data took 11.755599975585938 seconds
Then, training+dataloading take 11.76317048072815 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4426090717315674
Time for copying to cuda: 1.0967254638671875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.7886168956756592
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.400587797164917
One training iteration takes: 2.7496328353881836 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.75885820388794 seconds
Streaming inaturalist data took 11.795514345169067 seconds
Then, training+dataloading take 11.803191184997559 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4836273193359375
Time for copying to cuda: 1.3113021850585938e-05
Time for forward pass: 0.639369010925293
Time for backpropagation: 1.220034122467041
One training iteration takes: 2.499333381652832 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.953702926635742 seconds
Streaming inaturalist data took 11.990941524505615 seconds
Then, training+dataloading take 11.99852180480957 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4849066734313965
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.6041157245635986
Time for backpropagation: 1.213472604751587
One training iteration takes: 2.4701080322265625 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.8555166721344 seconds
Streaming inaturalist data took 11.892089605331421 seconds
Then, training+dataloading take 11.897965908050537 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4382953643798828
Time for copying to cuda: 1.1444091796875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.7344691753387451
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.3725051879882812
One training iteration takes: 2.695239782333374 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.76304578781128 seconds
Streaming inaturalist data took 11.800419330596924 seconds
Then, training+dataloading take 11.806179523468018 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5049629211425781
Time for copying to cuda: 1.1920928955078125e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6557157039642334
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.3724122047424316
One training iteration takes: 2.657027244567871 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.862089157104492 seconds
Streaming inaturalist data took 11.967097759246826 seconds
Then, training+dataloading take 11.97305417060852 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5532581806182861
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.6043980121612549
Time for backpropagation: 1.2251343727111816
Memory occpied: (1250.0, 3.0)
One training iteration takes: 2.5040054321289062 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.793665409088135 seconds
Streaming inaturalist data took 11.829617738723755 seconds
Then, training+dataloading take 11.83550238609314 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43990349769592285
Time for copying to cuda: 1.0967254638671875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.7574353218078613
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.344510555267334
One training iteration takes: 2.6662039756774902 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.841193437576294 seconds
Streaming inaturalist data took 11.878002405166626 seconds
Then, training+dataloading take 11.883943319320679 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4950239658355713
Time for copying to cuda: 1.049041748046875e-05
Time for forward pass: 0.6191573143005371
Time for backpropagation: 1.2048354148864746
One training iteration takes: 2.5006463527679443 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.871798276901245 seconds
Streaming inaturalist data took 11.909440040588379 seconds
Then, training+dataloading take 11.915550231933594 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4414949417114258
Time for copying to cuda: 1.1444091796875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.7444393634796143
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.343691349029541
One training iteration takes: 2.65042781829834 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.746176481246948 seconds
Streaming inaturalist data took 11.784167766571045 seconds
Then, training+dataloading take 11.790176630020142 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5549843311309814
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.6562340259552002
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.4140267372131348
One training iteration takes: 2.742039918899536 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.775241613388062 seconds
Streaming inaturalist data took 11.860700607299805 seconds
Then, training+dataloading take 11.866524934768677 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5873310565948486
Time for copying to cuda: 1.0967254638671875e-05
Time for forward pass: 0.6347823143005371
Time for backpropagation: 1.2101733684539795
Memory occpied: (1250.0, 3.0)
One training iteration takes: 2.556436777114868 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.861839294433594 seconds
Streaming inaturalist data took 11.898315191268921 seconds
Then, training+dataloading take 11.90430998802185 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4668116569519043
Time for copying to cuda: 1.2636184692382812e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8151543140411377
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.4027996063232422
One training iteration takes: 2.8097739219665527 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.821188688278198 seconds
Streaming inaturalist data took 11.857272863388062 seconds
Then, training+dataloading take 11.863162517547607 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.473552942276001
Time for copying to cuda: 1.1682510375976562e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.785057783126831
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.366473913192749
One training iteration takes: 2.7506535053253174 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.814671516418457 seconds
Streaming inaturalist data took 11.852272033691406 seconds
Then, training+dataloading take 11.85864543914795 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5318212509155273
Time for copying to cuda: 1.239776611328125e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6377744674682617
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.3771469593048096
One training iteration takes: 2.678701162338257 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.879179000854492 seconds
Streaming inaturalist data took 11.91553544998169 seconds
Then, training+dataloading take 11.92138957977295 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5163998603820801
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.6250531673431396
Time for backpropagation: 1.2080423831939697
One training iteration takes: 2.5075840950012207 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.912153005599976 seconds
Streaming inaturalist data took 11.949379682540894 seconds
Then, training+dataloading take 11.955464363098145 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4714639186859131
Time for copying to cuda: 1.0967254638671875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8296034336090088
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.4119224548339844
One training iteration takes: 2.8409066200256348 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.9058997631073 seconds
Streaming inaturalist data took 11.941956043243408 seconds
Then, training+dataloading take 11.947924613952637 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5354535579681396
Time for copying to cuda: 1.0967254638671875e-05
Time for forward pass: 0.7233486175537109
Time for backpropagation: 1.1663379669189453
One training iteration takes: 2.588510274887085 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.828999996185303 seconds
Streaming inaturalist data took 11.865195035934448 seconds
Then, training+dataloading take 11.871021747589111 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46700334548950195
Time for copying to cuda: 1.049041748046875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.9637167453765869
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.32835054397583
One training iteration takes: 2.8864998817443848 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.893800497055054 seconds
Streaming inaturalist data took 11.930463314056396 seconds
Then, training+dataloading take 11.936471939086914 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46770715713500977
Time for copying to cuda: 9.775161743164062e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8709831237792969
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.3134245872497559
One training iteration takes: 2.7984464168548584 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.875040531158447 seconds
Streaming inaturalist data took 11.911035537719727 seconds
Then, training+dataloading take 11.916896343231201 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48127317428588867
Time for copying to cuda: 1.2636184692382812e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8312294483184814
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.3550963401794434
One training iteration takes: 2.848663568496704 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.87363076210022 seconds
Streaming inaturalist data took 11.910190343856812 seconds
Then, training+dataloading take 11.916160583496094 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47473907470703125
Time for copying to cuda: 1.1444091796875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8260951042175293
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.332486867904663
One training iteration takes: 2.772822141647339 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 95.74806308746338 MBs for this batch
Executing all posts took 11.830430746078491 seconds
Streaming inaturalist data took 11.867422342300415 seconds
Then, training+dataloading take 11.873292446136475 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.53790283203125
Time for copying to cuda: 1.0967254638671875e-05
Time for forward pass: 0.7621779441833496
Time for backpropagation: 1.1812829971313477
One training iteration takes: 2.6565754413604736 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 40.78874111175537 MBs for this batch
Executing all posts took 6.168270111083984 seconds
Streaming inaturalist data took 6.183841228485107 seconds
Then, training+dataloading take 6.1868531703948975 seconds

Epoch: 0
Time of next(dataloader) is: 0.5076942443847656
Time for copying to cuda: 9.5367431640625e-06
Time for forward pass: 0.39929652214050293
Time for backpropagation: 0.501715898513794
Memory occpied: (1250.0, 3.0)
The whole process took 300.2902879714966 seconds
