Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myvit', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5024859885848 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [6.02112e+05 0.00000e+00 0.00000e+00 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06 9.07776e+06
 9.07776e+06 9.07776e+06 9.07776e+06 3.07200e+03 3.07200e+03 3.07200e+03
 3.25680e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119079237.84349579 119079237.84349579
All candidates indexes:  (array([15, 16, 17, 18]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.0029296875
17.314453125
Total layers size  104.50078582763672
Candidate split  16
Server, client, server+client, vanilla  798.5439453125 504.861083984375 1303.405029296875 36276.345458984375
Model size  351.3271484375
Fixed, scale_with_bsz  351.3271484375 17.888671875
Mem usage  1678.0 3.0
Using split index: 16
Freezing the lower layers of the model (myvit) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Memory occpied: (1678.0, 3.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 22.276453733444214 seconds
Streaming inaturalist data took 22.279855728149414 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3843977451324463
Time for copying to cuda: 0.0020499229431152344
Memory occpied: (1678.0, 342.0)
Memory occpied: (1678.0, 802.0)
Memory occpied: (1678.0, 1222.0)
Time for forward pass: 3.4881575107574463
Time for backpropagation: 0.08004474639892578
GPU memory for training: 1.4870972633361816                          

One training iteration takes: 4.033553838729858 seconds
Index: 0
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Memory occpied: (2512.0, 1686.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 30.42360258102417 seconds
Streaming inaturalist data took 30.42756199836731 seconds
Then, training+dataloading take 30.428957223892212 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (2512.0, 1686.0)
Time of next(dataloader) is: 0.44324755668640137
Time for copying to cuda: 0.0020742416381835938
Time for forward pass: 0.0626976490020752
Time for backpropagation: 0.010111570358276367
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.6196854114532471 seconds
Index: 1
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 22.330998182296753 seconds
Streaming inaturalist data took 22.33442497253418 seconds
Then, training+dataloading take 22.335190057754517 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4882168769836426
Time for copying to cuda: 0.0020689964294433594
Time for forward pass: 0.06288576126098633
Time for backpropagation: 0.009186506271362305
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.7082927227020264 seconds
Index: 2
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 31.029825448989868 seconds
Streaming inaturalist data took 31.084279775619507 seconds
Then, training+dataloading take 31.090001583099365 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4837377071380615
Time for copying to cuda: 0.0019690990447998047
Time for forward pass: 0.062339067459106445
Time for backpropagation: 0.008702993392944336
GPU memory for training: 1.5423903465270996                          

Memory occpied: (2584.0, 1694.0)
One training iteration takes: 0.6515111923217773 seconds
Index: 3
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 22.713836193084717 seconds
Streaming inaturalist data took 22.71655011177063 seconds
Then, training+dataloading take 22.718172073364258 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43562912940979004
Time for copying to cuda: 0.0020241737365722656
Time for forward pass: 0.06259918212890625
Time for backpropagation: 0.008977413177490234
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.6210155487060547 seconds
Index: 4
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 31.734230279922485 seconds
Streaming inaturalist data took 31.736648082733154 seconds
Then, training+dataloading take 31.73805522918701 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43547606468200684
Time for copying to cuda: 0.001986265182495117
Time for forward pass: 0.06264495849609375
Time for backpropagation: 0.00887751579284668
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.612785816192627 seconds
Index: 5
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 22.637733221054077 seconds
Streaming inaturalist data took 22.642908334732056 seconds
Then, training+dataloading take 22.646116971969604 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (2584.0, 1694.0)
Time of next(dataloader) is: 0.5441498756408691
Time for copying to cuda: 0.001990795135498047
Time for forward pass: 0.06268882751464844
Time for backpropagation: 0.00877237319946289
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.7334256172180176 seconds
Index: 6
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 32.04447650909424 seconds
Streaming inaturalist data took 32.048269748687744 seconds
Then, training+dataloading take 32.05169725418091 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (2584.0, 1694.0)
Time of next(dataloader) is: 0.4924311637878418
Time for copying to cuda: 0.0020508766174316406
Time for forward pass: 0.06278538703918457
Time for backpropagation: 0.009113073348999023
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.6710355281829834 seconds
Index: 7
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 22.958622932434082 seconds
Streaming inaturalist data took 22.961318254470825 seconds
Then, training+dataloading take 22.96289300918579 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48380327224731445
Time for copying to cuda: 0.0019197463989257812
Time for forward pass: 0.062348127365112305
Time for backpropagation: 0.008774280548095703
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.706794261932373 seconds
Index: 8
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 32.13966488838196 seconds
Streaming inaturalist data took 32.14206600189209 seconds
Then, training+dataloading take 32.142908334732056 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.545175313949585
Time for copying to cuda: 0.0020051002502441406
Time for forward pass: 0.06269717216491699
Time for backpropagation: 0.008814096450805664
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.7675426006317139 seconds
Index: 9
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 22.721741199493408 seconds
Streaming inaturalist data took 22.72446870803833 seconds
Then, training+dataloading take 22.72588801383972 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4311995506286621
Time for copying to cuda: 0.0019888877868652344
Time for forward pass: 0.062392234802246094
Time for backpropagation: 0.008754253387451172
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.6014282703399658 seconds
Index: 10
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 5.925228118896484 MBs for this batch
Executing all posts took 32.072734355926514 seconds
Streaming inaturalist data took 32.07505536079407 seconds
Then, training+dataloading take 32.07587003707886 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4319491386413574
Time for copying to cuda: 0.0020041465759277344
Time for forward pass: 0.06257271766662598
Time for backpropagation: 0.008838891983032227
GPU memory for training: 1.5423903465270996                          

One training iteration takes: 0.5968878269195557 seconds
Index: 11
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Memory occpied: (2584.0, 1694.0)
Read 1.2621383666992188 MBs for this batch
Executing all posts took 10.734103202819824 seconds
Streaming inaturalist data took 10.734877586364746 seconds
Then, training+dataloading take 10.73537278175354 seconds

Epoch: 0
Time of next(dataloader) is: 0.5163819789886475
Time for copying to cuda: 0.0006539821624755859
Time for forward pass: 0.05900144577026367
Time for backpropagation: 0.008135318756103516
GPU memory for training: 1.4736242294311523                          

Memory occpied: (2584.0, 1694.0)
The whole process took 345.23866057395935 seconds
