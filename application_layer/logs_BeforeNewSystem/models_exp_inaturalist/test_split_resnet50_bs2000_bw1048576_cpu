Namespace(batch_size=2000, cpuonly=True, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7736275684252 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 3.2568000e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119114776.91264863 119114776.91264863
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.76738739013672
Candidate split  21
Server, client, server+client, vanilla  167.48046875 139.862060546875 307.342529296875 13522.674560546875
Model size  0.0
Intermediate:  0.0078125
6.125
Total layers size  110.76738739013672
Fixed, scale_with_bsz  0.0 6.69921875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.356699228286743 seconds
Streaming inaturalist data took 14.364525079727173 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4595980644226074
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.23730993270874023
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 3.8370296955108643
One training iteration takes: 4.65009617805481 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.669355154037476 seconds
Streaming inaturalist data took 13.677034854888916 seconds
Then, training+dataloading take 13.677948713302612 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.381885290145874
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.12064099311828613
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.3311066627502441
One training iteration takes: 1.9709303379058838 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.308760166168213 seconds
Streaming inaturalist data took 14.31594204902649 seconds
Then, training+dataloading take 14.316742897033691 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42844653129577637
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.09782290458679199
Time for backpropagation: 0.2635955810546875
One training iteration takes: 0.9363489151000977 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.11686897277832 seconds
Streaming inaturalist data took 14.124165773391724 seconds
Then, training+dataloading take 14.125025272369385 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42471861839294434
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.11347532272338867
Time for backpropagation: 0.2768404483795166
One training iteration takes: 0.9943010807037354 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.267623662948608 seconds
Streaming inaturalist data took 14.272975444793701 seconds
Then, training+dataloading take 14.273817777633667 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47638821601867676
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.12095308303833008
Time for backpropagation: 0.32851076126098633
One training iteration takes: 1.0388944149017334 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.196316480636597 seconds
Streaming inaturalist data took 14.20120358467102 seconds
Then, training+dataloading take 14.202777624130249 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41363096237182617
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.11053180694580078
Time for backpropagation: 0.2977111339569092
One training iteration takes: 0.9297149181365967 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.17667841911316 seconds
Streaming inaturalist data took 14.18200159072876 seconds
Then, training+dataloading take 14.18287968635559 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3833475112915039
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.38680028915405273
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.2631833553314209
One training iteration takes: 1.1436262130737305 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.680280923843384 seconds
Streaming inaturalist data took 13.685084342956543 seconds
Then, training+dataloading take 13.685899019241333 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.38449597358703613
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.09992122650146484
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.500197172164917
One training iteration takes: 1.09006667137146 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.18621563911438 seconds
Streaming inaturalist data took 14.191724061965942 seconds
Then, training+dataloading take 14.192586660385132 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43059778213500977
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.09825563430786133
Time for backpropagation: 0.23615598678588867
One training iteration takes: 0.9127137660980225 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.798117399215698 seconds
Streaming inaturalist data took 13.802803993225098 seconds
Then, training+dataloading take 13.803632736206055 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41154980659484863
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.09924888610839844
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.5718686580657959
One training iteration takes: 1.191547155380249 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.173745155334473 seconds
Streaming inaturalist data took 14.179182052612305 seconds
Then, training+dataloading take 14.180049419403076 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48044729232788086
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.09780478477478027
Time for backpropagation: 0.22313499450683594
One training iteration takes: 0.9115877151489258 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.638736724853516 seconds
Streaming inaturalist data took 13.643589735031128 seconds
Then, training+dataloading take 13.644469738006592 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.427046537399292
Time for copying to cuda: 5.9604644775390625e-06
Time for forward pass: 0.09881711006164551
Time for backpropagation: 0.23182439804077148
One training iteration takes: 0.9042093753814697 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 3.3441333770751953 MBs for this batch
Executing all posts took 6.83286714553833 seconds
Streaming inaturalist data took 6.834631681442261 seconds
Then, training+dataloading take 6.835101842880249 seconds

Epoch: 0
Time of next(dataloader) is: 0.4418752193450928
Time for copying to cuda: 6.4373016357421875e-06
Time for forward pass: 0.03813052177429199
Time for backpropagation: 0.1221158504486084
Memory occpied: (1250.0, 3.0)
The whole process took 183.67893624305725 seconds
