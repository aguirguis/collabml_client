Namespace(batch_size=2000, cpuonly=True, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5136755634242 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.  32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119080704.48344913 119080704.48344913
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.216606140136719
Candidate split  13
Server, client, server+client, vanilla  51.28173828125 522.674560546875 573.956298828125 4554.901123046875
Model size  0.0
Intermediate:  0.03515625
1.47705078125
Total layers size  4.216606140136719
Fixed, scale_with_bsz  0.0 2.05126953125
Mem usage  1250.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.551080703735352 seconds
Streaming inaturalist data took 12.579535245895386 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44020652770996094
Time for copying to cuda: 6.4373016357421875e-06
Time for forward pass: 0.4804081916809082
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.7662217617034912
One training iteration takes: 1.7864618301391602 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.387938737869263 seconds
Streaming inaturalist data took 12.415658235549927 seconds
Then, training+dataloading take 12.420804500579834 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5287637710571289
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.48954224586486816
Time for backpropagation: 0.6167223453521729
One training iteration takes: 1.8622658252716064 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.605604410171509 seconds
Streaming inaturalist data took 12.63363790512085 seconds
Then, training+dataloading take 12.637321472167969 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4984583854675293
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.586580753326416
Time for backpropagation: 0.676133394241333
One training iteration takes: 2.0354182720184326 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.520358800888062 seconds
Streaming inaturalist data took 12.548473358154297 seconds
Then, training+dataloading take 12.55269455909729 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4812438488006592
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.7876255512237549
Time for backpropagation: 0.6241223812103271
One training iteration takes: 2.0823147296905518 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.557803630828857 seconds
Streaming inaturalist data took 12.586616039276123 seconds
Then, training+dataloading take 12.590593814849854 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.49592161178588867
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.6620104312896729
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.7987828254699707
One training iteration takes: 2.1389505863189697 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.493403434753418 seconds
Streaming inaturalist data took 12.52098536491394 seconds
Then, training+dataloading take 12.52635931968689 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.544696569442749
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.536081075668335
Time for backpropagation: 0.6099779605865479
One training iteration takes: 1.9283037185668945 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.576879262924194 seconds
Streaming inaturalist data took 12.60512113571167 seconds
Then, training+dataloading take 12.610224962234497 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4902470111846924
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.7302596569061279
Time for backpropagation: 0.6802160739898682
One training iteration takes: 2.1307790279388428 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.622230768203735 seconds
Streaming inaturalist data took 12.649444341659546 seconds
Then, training+dataloading take 12.653608560562134 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48703598976135254
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8169944286346436
Time for backpropagation: 0.6738343238830566
One training iteration takes: 2.17368221282959 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.441433429718018 seconds
Streaming inaturalist data took 12.46948528289795 seconds
Then, training+dataloading take 12.472925662994385 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6065356731414795
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.5570106506347656
Time for backpropagation: 0.6609482765197754
Memory occpied: (1250.0, 3.0)
One training iteration takes: 2.0332956314086914 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.568551540374756 seconds
Streaming inaturalist data took 12.59548830986023 seconds
Then, training+dataloading take 12.600706100463867 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49425673484802246
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.8232512474060059
Time for backpropagation: 0.6288754940032959
One training iteration takes: 2.1766865253448486 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.444671869277954 seconds
Streaming inaturalist data took 12.473511934280396 seconds
Then, training+dataloading take 12.479349374771118 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.5372304916381836
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.6031699180603027
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.8371920585632324
One training iteration takes: 2.1737301349639893 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.539352893829346 seconds
Streaming inaturalist data took 12.567419528961182 seconds
Then, training+dataloading take 12.572700500488281 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5688276290893555
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.5262157917022705
Time for backpropagation: 0.6701011657714844
One training iteration takes: 1.9895684719085693 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 14.993935585021973 MBs for this batch
Executing all posts took 6.098874092102051 seconds
Streaming inaturalist data took 6.105520725250244 seconds
Then, training+dataloading take 6.106673240661621 seconds

Epoch: 0
Time of next(dataloader) is: 0.44214916229248047
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.17688989639282227
Time for backpropagation: 0.5172269344329834
Memory occpied: (1250.0, 3.0)
The whole process took 165.55559086799622 seconds
