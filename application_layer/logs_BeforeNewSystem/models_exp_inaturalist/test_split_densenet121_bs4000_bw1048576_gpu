Namespace(batch_size=4000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.4481721221529 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.   32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119072118.81639482 119072118.81639482
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.79473114013672
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1350.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 4000, post_step 1000

Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 24.948274612426758 seconds
Streaming inaturalist data took 25.093470573425293 seconds
The mode is:  split
Start 4000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.627845048904419
Time for copying to cuda: 0.14453840255737305
Memory occpied: (1734.0, 15.0)
Memory occpied: (1734.0, 756.0)
Memory occpied: (1734.0, 1180.0)
Memory occpied: (8370.0, 6800.0)
Memory occpied: (6676.0, 11440.0)
Memory occpied: (11614.0, 8446.0)
Time for forward pass: 7.31543755531311
Time for backpropagation: 0.09654974937438965
GPU memory for training: 11.62969446182251                          

One training iteration takes: 8.324816703796387 seconds
Index: 0
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Memory occpied: (7758.0, 4138.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 25.2019784450531 seconds
Memory occpied: (7758.0, 4138.0)
Streaming inaturalist data took 25.41010093688965 seconds
Then, training+dataloading take 25.434561252593994 seconds
The mode is:  split
Start 8000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7199258804321289
Time for copying to cuda: 0.10135507583618164
Memory occpied: (7774.0, 4154.0)
Time for forward pass: 0.4167449474334717
Time for backpropagation: 0.013135910034179688
GPU memory for training: 3.712207317352295                          

One training iteration takes: 1.4068889617919922 seconds
Index: 1
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 25.314369678497314 seconds
Streaming inaturalist data took 25.461458444595337 seconds
Then, training+dataloading take 25.485934495925903 seconds
The mode is:  split
Start 12000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8043608665466309
Time for copying to cuda: 0.10161304473876953
Time for forward pass: 0.42938899993896484
Time for backpropagation: 0.012892484664916992
GPU memory for training: 3.712207317352295                          

One training iteration takes: 1.53230619430542 seconds
Index: 2
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 24.65150547027588 seconds
Streaming inaturalist data took 24.877351999282837 seconds
Then, training+dataloading take 24.908002138137817 seconds
The mode is:  split
Start 16000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7667953968048096
Time for copying to cuda: 0.10368871688842773
Time for forward pass: 0.4298057556152344
Time for backpropagation: 0.012171030044555664
GPU memory for training: 3.712207317352295                          

Memory occpied: (7776.0, 4154.0)
One training iteration takes: 1.459301471710205 seconds
Index: 3
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 25.074387788772583 seconds
Streaming inaturalist data took 25.22042155265808 seconds
Then, training+dataloading take 25.245068788528442 seconds
The mode is:  split
Start 20000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7181947231292725
Memory occpied: (7776.0, 4154.0)
Time for copying to cuda: 0.10338258743286133
Time for forward pass: 0.4166994094848633
Time for backpropagation: 0.012636661529541016
GPU memory for training: 3.712207317352295                          

One training iteration takes: 1.401231050491333 seconds
Index: 4
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 25.845048904418945 seconds
Streaming inaturalist data took 25.989698886871338 seconds
Then, training+dataloading take 26.012134790420532 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7344577312469482
Memory occpied: (7776.0, 4154.0)
Time for copying to cuda: 0.10213279724121094
Time for forward pass: 0.43377232551574707
Time for backpropagation: 0.01226186752319336
GPU memory for training: 3.712207317352295                          

One training iteration takes: 1.4277770519256592 seconds
Index: 5
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Memory occpied: (7776.0, 4154.0)
Read 40.78874111175537 MBs for this batch
Executing all posts took 7.40393328666687 seconds
Streaming inaturalist data took 7.4222235679626465 seconds
Then, training+dataloading take 7.42591667175293 seconds

Epoch: 0
Time of next(dataloader) is: 0.5025022029876709
Time for copying to cuda: 0.011176824569702148
Time for forward pass: 0.6465208530426025
Time for backpropagation: 0.02822399139404297
GPU memory for training: 1.9005322456359863                          

Memory occpied: (2728.0, 1608.0)
The whole process took 168.35549592971802 seconds
