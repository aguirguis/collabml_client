Namespace(batch_size=4000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.7445546038974 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [12845056. 12845056.  3211264.  6422528.  6422528.  1605632.  3211264.
  3211264.  3211264.  3211264.   802816.  1605632.  1605632.  1605632.
  1605632.   401408.   401408.   401408.   401408.   401408.   100352.
   100352.    16384.    16384.    16384.    16384.    16384.    16384.
    32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119110966.26104204 119110966.26104204
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.015625
24.5
Total layers size  62.71465301513672
Candidate split  23
Server, client, server+client, vanilla  1246.091796875 1430.21044921875 2676.30224609375 101664.58544921875
Model size  619.236328125
Fixed, scale_with_bsz  619.236328125 25.07421875
Mem usage  1952.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 4000, post_step 1000

Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 25.330538511276245 seconds
Streaming inaturalist data took 25.355305194854736 seconds
The mode is:  split
Start 4000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4507462978363037
Time for copying to cuda: 0.017522096633911133
Time for forward pass: 3.177560567855835
Time for backpropagation: 0.11760473251342773
GPU memory for training: 2.7963194847106934                          

One training iteration takes: 3.8920655250549316 seconds
Index: 0
Memory occpied: (1952.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Memory occpied: (3708.0, 2490.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 24.76807951927185 seconds
Streaming inaturalist data took 24.792714595794678 seconds
Then, training+dataloading take 24.79515552520752 seconds
The mode is:  split
Start 8000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5187926292419434
Time for copying to cuda: 0.017140626907348633
Time for forward pass: 0.17534804344177246
Time for backpropagation: 0.003985881805419922
GPU memory for training: 3.1691222190856934                          

Memory occpied: (4110.0, 2498.0)
One training iteration takes: 0.8458764553070068 seconds
Index: 1
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 26.30878973007202 seconds
Streaming inaturalist data took 26.33406138420105 seconds
Then, training+dataloading take 26.336560487747192 seconds
The mode is:  split
Start 12000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46810054779052734
Time for copying to cuda: 0.016791343688964844
Time for forward pass: 0.17432379722595215
Time for backpropagation: 0.003510713577270508
GPU memory for training: 3.1691222190856934                          

One training iteration takes: 0.7533736228942871 seconds
Index: 2
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 24.66071367263794 seconds
Streaming inaturalist data took 24.685851335525513 seconds
Then, training+dataloading take 24.68840503692627 seconds
The mode is:  split
Start 16000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5247776508331299
Time for copying to cuda: 0.016954898834228516
Memory occpied: (4110.0, 2498.0)
Time for forward pass: 0.1740584373474121
Time for backpropagation: 0.003476381301879883
GPU memory for training: 3.1691222190856934                          

One training iteration takes: 0.8354446887969971 seconds
Index: 3
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 25.082954168319702 seconds
Streaming inaturalist data took 25.107765913009644 seconds
Then, training+dataloading take 25.110288381576538 seconds
The mode is:  split
Start 20000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.48961448669433594
Time for copying to cuda: 0.017038822174072266
Time for forward pass: 0.18718504905700684
Time for backpropagation: 0.003936767578125
GPU memory for training: 3.1691222190856934                          

One training iteration takes: 0.7861142158508301 seconds
Index: 4
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 26.44373321533203 seconds
Streaming inaturalist data took 26.469455242156982 seconds
Then, training+dataloading take 26.47198748588562 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.47309398651123047
Time for copying to cuda: 0.01704120635986328
Time for forward pass: 0.17433547973632812
Time for backpropagation: 0.003537416458129883
GPU memory for training: 3.1691222190856934                          

One training iteration takes: 0.7611958980560303 seconds
Index: 5
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Memory occpied: (4110.0, 2498.0)
Read 6.671088218688965 MBs for this batch
Executing all posts took 9.022188425064087 seconds
Streaming inaturalist data took 9.025403499603271 seconds
Then, training+dataloading take 9.026195764541626 seconds

Epoch: 0
Time of next(dataloader) is: 0.45299744606018066
Time for copying to cuda: 0.002083301544189453
Time for forward pass: 0.10648393630981445
Time for backpropagation: 0.0033109188079833984
GPU memory for training: 2.833087921142578                          

The whole process took 170.96489000320435 seconds
