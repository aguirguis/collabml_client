Namespace(batch_size=4000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Read 1056.3339109420776 MBs for this batch
Streaming inaturalist data took 21.887868404388428 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Memory occpied: (1606.0, 3.0)
Time of next(dataloader) is: 17.475367069244385
Time for copying to cuda: 0.8753817081451416
Memory occpied: (3904.0, 15.0)
Memory occpied: (3904.0, 1556.0)
Memory occpied: (3904.0, 1968.0)
Memory occpied: (5548.0, 12616.0)
Read 1077.8234357833862 MBs for this batch
Streaming inaturalist data took 24.832144737243652 seconds
Memory occpied: (13772.0, 12616.0)
Memory occpied: (13772.0, 12616.0)
Memory occpied: (13772.0, 12616.0)
Time for forward pass: 10.659298419952393
Time for backpropagation: 0.21565628051757812
GPU memory for training: 23.289916515350342                          

One training iteration takes: 29.788399696350098 seconds
Index: 0
Then, training+dataloading take 29.797231912612915 seconds
The mode is:  vanilla

Epoch: 0
Time of next(dataloader) is: 18.313542127609253
Time for copying to cuda: 0.6303887367248535
Time for forward pass: 0.03976607322692871
Time for backpropagation: 0.008916854858398438
GPU memory for training: 12.43333387374878                          

One training iteration takes: 19.569726943969727 seconds
Index: 1
Memory occpied: (5402.0, 12632.0)
Memory occpied: (10542.0, 12632.0)
Read 1050.931586265564 MBs for this batch
Streaming inaturalist data took 22.99231743812561 seconds
Then, training+dataloading take 23.034269094467163 seconds
The mode is:  vanilla

Epoch: 0
Time of next(dataloader) is: 18.70050549507141
Time for copying to cuda: 0.6169934272766113
Time for forward pass: 0.020410776138305664
Time for backpropagation: 0.007905006408691406
GPU memory for training: 12.43333387374878                          

Memory occpied: (10542.0, 12632.0)
One training iteration takes: 20.021840572357178 seconds
Index: 2
Memory occpied: (10542.0, 12632.0)
Memory occpied: (10542.0, 12632.0)
Read 1062.8829288482666 MBs for this batch
Streaming inaturalist data took 24.428802728652954 seconds
Then, training+dataloading take 24.48132061958313 seconds
The mode is:  vanilla

Epoch: 0
Time of next(dataloader) is: 19.364554166793823
Time for copying to cuda: 0.664909839630127
Time for forward pass: 0.02016425132751465
Time for backpropagation: 0.012496709823608398
GPU memory for training: 12.43333387374878                          

One training iteration takes: 20.73038363456726 seconds
Index: 3
Memory occpied: (10542.0, 12632.0)
Memory occpied: (10542.0, 12632.0)
Read 1072.51886844635 MBs for this batch
Streaming inaturalist data took 24.727218866348267 seconds
Then, training+dataloading take 24.774028778076172 seconds
The mode is:  vanilla

Epoch: 0
Memory occpied: (10542.0, 12632.0)
Time of next(dataloader) is: 20.155818700790405
Time for copying to cuda: 0.6611793041229248
Time for forward pass: 0.021667003631591797
Time for backpropagation: 0.012005329132080078
GPU memory for training: 12.43333387374878                          

One training iteration takes: 21.617889404296875 seconds
Index: 4
Memory occpied: (10542.0, 12632.0)
Memory occpied: (10542.0, 12632.0)
Read 1054.4311847686768 MBs for this batch
Streaming inaturalist data took 24.570451259613037 seconds
Then, training+dataloading take 24.61788296699524 seconds
The mode is:  vanilla

Epoch: 0
Read 112.58900165557861 MBs for this batch
Streaming inaturalist data took 6.184457540512085 seconds
Time of next(dataloader) is: 19.358612060546875
Time for copying to cuda: 0.5856027603149414
Time for forward pass: 0.012732505798339844
Time for backpropagation: 0.0030298233032226562
GPU memory for training: 12.43333387374878                          

One training iteration takes: 20.568723917007446 seconds
Index: 5
Then, training+dataloading take 20.588780641555786 seconds

Epoch: 0
Memory occpied: (10542.0, 12632.0)
Memory occpied: (10542.0, 12632.0)
Time of next(dataloader) is: 3.95851731300354
Time for copying to cuda: 0.2678346633911133
Memory occpied: (10542.0, 4254.0)
Time for forward pass: 0.7863099575042725
Time for backpropagation: 0.0029294490814208984
GPU memory for training: 3.553943634033203                          

The whole process took 180.03237223625183 seconds
