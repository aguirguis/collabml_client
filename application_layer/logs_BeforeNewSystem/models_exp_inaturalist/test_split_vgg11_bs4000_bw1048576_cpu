Namespace(batch_size=4000, cpuonly=True, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.1743250462362 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [12845056. 12845056.  3211264.  6422528.  6422528.  1605632.  3211264.
  3211264.  3211264.  3211264.   802816.  1605632.  1605632.  1605632.
  1605632.   401408.   401408.   401408.   401408.   401408.   100352.
   100352.    16384.    16384.    16384.    16384.    16384.    16384.
    32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119036225.13246027 119036225.13246027
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.015625
24.5
Total layers size  62.71465301513672
Candidate split  23
Server, client, server+client, vanilla  626.85546875 810.97412109375 1437.82958984375 101045.34912109375
Model size  0.0
Intermediate:  0.015625
24.5
Total layers size  62.71465301513672
Fixed, scale_with_bsz  0.0 25.07421875
Mem usage  1250.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 4000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 25.679126977920532 seconds
Streaming inaturalist data took 25.74636459350586 seconds
The mode is:  split
Start 4000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.42749547958374023
Time for copying to cuda: 1.0728836059570312e-05
Time for forward pass: 0.49884891510009766
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.1522729396820068
One training iteration takes: 2.165945053100586 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 24.666816473007202 seconds
Streaming inaturalist data took 24.692203760147095 seconds
Then, training+dataloading take 24.694761991500854 seconds
The mode is:  split
Start 8000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4819064140319824
Time for copying to cuda: 1.3113021850585938e-05
Time for forward pass: 0.4782271385192871
Time for backpropagation: 0.9842159748077393
One training iteration takes: 2.159961462020874 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 25.520329236984253 seconds
Streaming inaturalist data took 25.545513153076172 seconds
Then, training+dataloading take 25.547983646392822 seconds
The mode is:  split
Start 12000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.49834561347961426
Time for copying to cuda: 1.3589859008789062e-05
Time for forward pass: 0.47745466232299805
Time for backpropagation: 0.9836821556091309
One training iteration takes: 2.1597683429718018 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 24.97727870941162 seconds
Streaming inaturalist data took 25.002532720565796 seconds
Then, training+dataloading take 25.004998683929443 seconds
The mode is:  split
Start 16000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.440854549407959
Time for copying to cuda: 1.4543533325195312e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.7684283256530762
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.283893346786499
One training iteration takes: 2.6892504692077637 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 24.652536392211914 seconds
Streaming inaturalist data took 24.724326372146606 seconds
Then, training+dataloading take 24.736745357513428 seconds
The mode is:  split
Start 20000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.46604013442993164
Time for copying to cuda: 1.3589859008789062e-05
Time for forward pass: 0.4779808521270752
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.2192339897155762
One training iteration takes: 2.3523809909820557 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 62.638710021972656 MBs for this batch
Executing all posts took 25.070948600769043 seconds
Memory occpied: (1250.0, 3.0)
Streaming inaturalist data took 25.096465349197388 seconds
Then, training+dataloading take 25.100393056869507 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43738794326782227
Time for copying to cuda: 1.3589859008789062e-05
Time for forward pass: 0.5583696365356445
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 1.158233880996704
One training iteration takes: 2.3224732875823975 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 6.671088218688965 MBs for this batch
Executing all posts took 9.053559064865112 seconds
Streaming inaturalist data took 9.056701421737671 seconds
Then, training+dataloading take 9.057377338409424 seconds

Epoch: 0
Time of next(dataloader) is: 0.38879942893981934
Time for copying to cuda: 1.3589859008789062e-05
Time for forward pass: 0.11926555633544922
Time for backpropagation: 0.4069554805755615
Memory occpied: (1250.0, 3.0)
The whole process took 173.45261883735657 seconds
