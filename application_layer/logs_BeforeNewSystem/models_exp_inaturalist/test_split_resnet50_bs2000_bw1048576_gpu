Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=21, model='myresnet50', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.003217909851 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 3.2568000e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119013797.77787998 119013797.77787998
All candidates indexes:  (array([20, 21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 21
Intermediate:  0.0078125
6.125
Total layers size  110.76738739013672
Candidate split  21
Server, client, server+client, vanilla  321.42333984375 293.804931640625 615.228271484375 13676.617431640625
Model size  153.94287109375
Fixed, scale_with_bsz  153.94287109375 6.69921875
Mem usage  1454.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Memory occpied: (1454.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.17369532585144 seconds
Streaming inaturalist data took 14.180908918380737 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3926732540130615
Time for copying to cuda: 0.004734516143798828
Memory occpied: (1454.0, 154.0)
Memory occpied: (1454.0, 620.0)
Memory occpied: (1454.0, 1036.0)
Time for forward pass: 3.488741397857666
Time for backpropagation: 0.0666656494140625
GPU memory for training: 0.7243976593017578                          

One training iteration takes: 4.028775930404663 seconds
Index: 0
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.604173421859741 seconds
Streaming inaturalist data took 13.61192512512207 seconds
Then, training+dataloading take 13.615817070007324 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (1866.0, 1476.0)
Memory occpied: (1866.0, 1476.0)
Time of next(dataloader) is: 0.4598870277404785
Time for copying to cuda: 0.004701852798461914
Time for forward pass: 0.03999924659729004
Time for backpropagation: 0.009350776672363281
GPU memory for training: 0.8476428985595703                          

One training iteration takes: 0.611051082611084 seconds
Index: 1
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.314779043197632 seconds
Streaming inaturalist data took 14.322213888168335 seconds
Then, training+dataloading take 14.323168754577637 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45827651023864746
Time for copying to cuda: 0.004602193832397461
Time for forward pass: 0.04001045227050781
Time for backpropagation: 0.0071659088134765625
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.612581729888916 seconds
Index: 2
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.964466094970703 seconds
Streaming inaturalist data took 13.97175669670105 seconds
Then, training+dataloading take 13.973383903503418 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4622211456298828
Time for copying to cuda: 0.004629611968994141
Time for forward pass: 0.03998756408691406
Time for backpropagation: 0.007210969924926758
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.6101894378662109 seconds
Index: 3
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.31933879852295 seconds
Streaming inaturalist data took 14.324355363845825 seconds
Then, training+dataloading take 14.325282335281372 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.445645809173584
Time for copying to cuda: 0.004698753356933594
Time for forward pass: 0.03996753692626953
Time for backpropagation: 0.007081270217895508
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.5897033214569092 seconds
Index: 4
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.958808898925781 seconds
Streaming inaturalist data took 14.96770167350769 seconds
Then, training+dataloading take 14.971518516540527 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (2002.0, 1516.0)
Time of next(dataloader) is: 0.44228172302246094
Time for copying to cuda: 0.0046575069427490234
Time for forward pass: 0.03986954689025879
Time for backpropagation: 0.006926059722900391
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.5962677001953125 seconds
Index: 5
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.158994913101196 seconds
Streaming inaturalist data took 14.165481090545654 seconds
Then, training+dataloading take 14.167107582092285 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (2002.0, 1516.0)
Time of next(dataloader) is: 0.4407367706298828
Time for copying to cuda: 0.004666566848754883
Time for forward pass: 0.03969001770019531
Time for backpropagation: 0.006870746612548828
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.5850081443786621 seconds
Index: 6
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.66843867301941 seconds
Streaming inaturalist data took 13.673415422439575 seconds
Then, training+dataloading take 13.674312114715576 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4978063106536865
Time for copying to cuda: 0.004616975784301758
Time for forward pass: 0.03980541229248047
Time for backpropagation: 0.006941318511962891
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.693610429763794 seconds
Index: 7
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.191036462783813 seconds
Streaming inaturalist data took 14.19582462310791 seconds
Then, training+dataloading take 14.196686029434204 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.473111629486084
Time for copying to cuda: 0.0046918392181396484
Time for forward pass: 0.040139198303222656
Time for backpropagation: 0.0071108341217041016
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.6696333885192871 seconds
Index: 8
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.744083166122437 seconds
Streaming inaturalist data took 13.749160528182983 seconds
Then, training+dataloading take 13.750062465667725 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4416050910949707
Time for copying to cuda: 0.004591703414916992
Time for forward pass: 0.03967642784118652
Time for backpropagation: 0.0069844722747802734
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.6070258617401123 seconds
Index: 9
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 14.26620888710022 seconds
Streaming inaturalist data took 14.27112865447998 seconds
Then, training+dataloading take 14.27202582359314 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4420444965362549
Time for copying to cuda: 0.004662752151489258
Time for forward pass: 0.03979897499084473
Time for backpropagation: 0.006964921951293945
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.6330628395080566 seconds
Index: 10
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 13.854104280471802 seconds
Streaming inaturalist data took 13.859070777893066 seconds
Then, training+dataloading take 13.859934329986572 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44354963302612305
Time for copying to cuda: 0.0046617984771728516
Time for forward pass: 0.03989529609680176
Time for backpropagation: 0.006963491439819336
GPU memory for training: 0.8472614288330078                          

One training iteration takes: 0.5859150886535645 seconds
Index: 11
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Memory occpied: (2002.0, 1516.0)
Read 3.3441333770751953 MBs for this batch
Executing all posts took 6.8563103675842285 seconds
Streaming inaturalist data took 6.858129262924194 seconds
Then, training+dataloading take 6.858590364456177 seconds

Epoch: 0
Time of next(dataloader) is: 0.47881531715393066
Time for copying to cuda: 0.0012481212615966797
Time for forward pass: 0.030977725982666016
Time for backpropagation: 0.00661015510559082
GPU memory for training: 0.7695574760437012                          

Memory occpied: (2002.0, 1516.0)
The whole process took 184.57965397834778 seconds
