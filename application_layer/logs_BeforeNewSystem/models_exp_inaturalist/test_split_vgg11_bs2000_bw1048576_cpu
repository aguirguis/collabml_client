Namespace(batch_size=2000, cpuonly=True, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.5628688422719 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [12845056. 12845056.  3211264.  6422528.  6422528.  1605632.  3211264.
  3211264.  3211264.  3211264.   802816.  1605632.  1605632.  1605632.
  1605632.   401408.   401408.   401408.   401408.   401408.   100352.
   100352.    16384.    16384.    16384.    16384.    16384.    16384.
    32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119087152.34489426 119087152.34489426
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.015625
24.5
Total layers size  62.71465301513672
Candidate split  23
Server, client, server+client, vanilla  626.85546875 405.487060546875 1032.342529296875 50522.674560546875
Model size  0.0
Intermediate:  0.015625
24.5
Total layers size  62.71465301513672
Fixed, scale_with_bsz  0.0 25.07421875
Mem usage  1250.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.017637968063354 seconds
Streaming inaturalist data took 17.03037142753601 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44265198707580566
Time for copying to cuda: 9.059906005859375e-06
Time for forward pass: 0.2515683174133301
Time for backpropagation: 0.5333347320556641
One training iteration takes: 1.3708572387695312 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.592787265777588 seconds
Streaming inaturalist data took 16.60579562187195 seconds
Then, training+dataloading take 16.606902599334717 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41651368141174316
Time for copying to cuda: 9.5367431640625e-06
Time for forward pass: 0.4606475830078125
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.7725124359130859
One training iteration takes: 1.8563556671142578 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.89083242416382 seconds
Streaming inaturalist data took 16.90394353866577 seconds
Then, training+dataloading take 16.904822826385498 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4454174041748047
Time for copying to cuda: 1.1444091796875e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.41403985023498535
Time for backpropagation: 0.6250693798065186
One training iteration takes: 1.6644721031188965 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.007222175598145 seconds
Streaming inaturalist data took 17.020223379135132 seconds
Then, training+dataloading take 17.021302700042725 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.43799781799316406
Time for copying to cuda: 1.0251998901367188e-05
Time for forward pass: 0.36777305603027344
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.9475350379943848
One training iteration takes: 1.9578912258148193 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.314531087875366 seconds
Streaming inaturalist data took 17.32517170906067 seconds
Then, training+dataloading take 17.32608962059021 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4871859550476074
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.32039976119995117
Time for backpropagation: 0.6672770977020264
One training iteration takes: 1.6825840473175049 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.9203884601593 seconds
Streaming inaturalist data took 16.928950309753418 seconds
Then, training+dataloading take 16.929887294769287 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42290568351745605
Time for copying to cuda: 1.0013580322265625e-05
Time for forward pass: 0.3214097023010254
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.9052798748016357
One training iteration takes: 1.8490562438964844 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.03254723548889 seconds
Streaming inaturalist data took 17.04293417930603 seconds
Then, training+dataloading take 17.04422903060913 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4862852096557617
Time for copying to cuda: 9.775161743164062e-06
Time for forward pass: 0.3067028522491455
Time for backpropagation: 0.6115925312042236
One training iteration takes: 1.6197326183319092 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.917997360229492 seconds
Streaming inaturalist data took 16.9315505027771 seconds
Then, training+dataloading take 16.9325008392334 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4339945316314697
Time for copying to cuda: 9.5367431640625e-06
Time for forward pass: 0.34211230278015137
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.9126420021057129
One training iteration takes: 1.8937652111053467 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.24017858505249 seconds
Streaming inaturalist data took 17.252782106399536 seconds
Then, training+dataloading take 17.253663301467896 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5344107151031494
Time for copying to cuda: 1.0967254638671875e-05
Time for forward pass: 0.3075542449951172
Time for backpropagation: 0.6139628887176514
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.6442835330963135 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.964385747909546 seconds
Streaming inaturalist data took 16.97712802886963 seconds
Then, training+dataloading take 16.978419065475464 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.427537202835083
Time for copying to cuda: 9.298324584960938e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.6068859100341797
Time for backpropagation: 0.6237618923187256
One training iteration takes: 1.843712329864502 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.423927783966064 seconds
Streaming inaturalist data took 17.43706178665161 seconds
Then, training+dataloading take 17.43791937828064 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4303467273712158
Time for copying to cuda: 8.821487426757812e-06
Time for forward pass: 0.34223151206970215
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.977546215057373
One training iteration takes: 1.9294910430908203 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.828232049942017 seconds
Streaming inaturalist data took 16.83878469467163 seconds
Then, training+dataloading take 16.83997368812561 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45131754875183105
Time for copying to cuda: 1.0013580322265625e-05
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.5642924308776855
Time for backpropagation: 0.6185472011566162
One training iteration takes: 1.8050858974456787 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 6.671088218688965 MBs for this batch
Executing all posts took 9.097445726394653 seconds
Streaming inaturalist data took 9.099082708358765 seconds
Then, training+dataloading take 9.099551916122437 seconds

Epoch: 0
Time of next(dataloader) is: 0.43923211097717285
Time for copying to cuda: 9.5367431640625e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.2957420349121094
Time for backpropagation: 0.34650254249572754
The whole process took 226.57780408859253 seconds
