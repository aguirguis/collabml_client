Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='mydensenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.4923498240092 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3211264. 3211264. 3211264.  802816. 3211264. 3211264. 3211264. 1605632.
  401408. 1605632. 1605632. 1605632.  802816.  200704.  802816.  802816.
  802816.  401408.  100352.  200704.  200704.   32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119077909.27613254 119077909.27613254
All candidates indexes:  (array([21]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 20
Intermediate:  0.095703125
6.125
Total layers size  29.79473114013672
Fixed, scale_with_bsz  0 10.27294921875
Mem usage  1350.0 3.0
Using split index: 19
Freezing the lower layers of the model (mydensenet121) till index 20
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Memory occpied: (1350.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.700576305389404 seconds
Streaming inaturalist data took 15.771946430206299 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5600886344909668
Time for copying to cuda: 0.05142521858215332
Time for forward pass: 4.656777858734131
Time for backpropagation: 0.08145976066589355
GPU memory for training: 6.147485733032227                          

One training iteration takes: 5.48736834526062 seconds
Index: 0
Memory occpied: (1350.0, 5280.0)
Memory occpied: (2890.0, 5280.0)
Memory occpied: (2890.0, 5280.0)
Memory occpied: (2890.0, 5280.0)
Memory occpied: (2890.0, 5280.0)
Memory occpied: (2890.0, 5280.0)
Memory occpied: (2890.0, 5280.0)
Memory occpied: (2890.0, 5280.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.09898328781128 seconds
Streaming inaturalist data took 15.170896530151367 seconds
Then, training+dataloading take 15.185006618499756 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6228592395782471
Time for copying to cuda: 0.05043959617614746
Time for forward pass: 0.23792314529418945
Time for backpropagation: 0.013373374938964844
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.1095478534698486 seconds
Index: 1
Memory occpied: (2890.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.817702531814575 seconds
Streaming inaturalist data took 15.890360593795776 seconds
Then, training+dataloading take 15.902207136154175 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5894932746887207
Time for copying to cuda: 0.10465884208679199
Memory occpied: (2908.0, 5296.0)
Time for forward pass: 0.23023462295532227
Time for backpropagation: 0.012610673904418945
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.0560729503631592 seconds
Index: 2
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.078205823898315 seconds
Streaming inaturalist data took 15.150554895401001 seconds
Then, training+dataloading take 15.162360429763794 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6074237823486328
Time for copying to cuda: 0.050672292709350586
Time for forward pass: 0.238616943359375
Time for backpropagation: 0.013028144836425781
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.0498595237731934 seconds
Index: 3
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.756921291351318 seconds
Streaming inaturalist data took 15.828726768493652 seconds
Then, training+dataloading take 15.842942237854004 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5868773460388184
Time for copying to cuda: 0.05082297325134277
Memory occpied: (2908.0, 5296.0)
Time for forward pass: 0.2281494140625
Time for backpropagation: 0.012812137603759766
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.0149223804473877 seconds
Index: 4
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 16.9179584980011 seconds
Streaming inaturalist data took 16.990544080734253 seconds
Then, training+dataloading take 17.001651763916016 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6658484935760498
Time for copying to cuda: 0.05091404914855957
Time for forward pass: 0.22366881370544434
Time for backpropagation: 0.012116670608520508
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.1106009483337402 seconds
Index: 5
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.66960597038269 seconds
Streaming inaturalist data took 15.741301536560059 seconds
Then, training+dataloading take 15.755601406097412 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6418602466583252
Time for copying to cuda: 0.05082416534423828
Memory occpied: (2908.0, 5296.0)
Time for forward pass: 0.34898805618286133
Time for backpropagation: 0.01225423812866211
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.1709120273590088 seconds
Index: 6
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.039197444915771 seconds
Streaming inaturalist data took 15.168990850448608 seconds
Then, training+dataloading take 15.188496828079224 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (2908.0, 5296.0)
Time of next(dataloader) is: 0.5833206176757812
Time for copying to cuda: 0.05102968215942383
Time for forward pass: 0.23013591766357422
Time for backpropagation: 0.012624025344848633
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 0.9944667816162109 seconds
Index: 7
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.942057847976685 seconds
Streaming inaturalist data took 16.01404094696045 seconds
Then, training+dataloading take 16.03146743774414 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6241402626037598
Time for copying to cuda: 0.10486507415771484
Memory occpied: (2908.0, 5296.0)
Time for forward pass: 0.22467732429504395
Time for backpropagation: 0.012679338455200195
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.0882370471954346 seconds
Index: 8
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.181097269058228 seconds
Streaming inaturalist data took 15.253654718399048 seconds
Then, training+dataloading take 15.271135807037354 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5661444664001465
Time for copying to cuda: 0.05091738700866699
Time for forward pass: 0.28222012519836426
Time for backpropagation: 0.013615608215332031
GPU memory for training: 1.9698281288146973                          

Memory occpied: (2908.0, 5296.0)
One training iteration takes: 1.045074224472046 seconds
Index: 9
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.553394317626953 seconds
Streaming inaturalist data took 15.625276565551758 seconds
Then, training+dataloading take 15.637208938598633 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5912125110626221
Time for copying to cuda: 0.10521578788757324
Memory occpied: (2908.0, 5296.0)
Time for forward pass: 0.22453784942626953
Time for backpropagation: 0.012257814407348633
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.07472825050354 seconds
Index: 10
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 15.360875368118286 seconds
Streaming inaturalist data took 15.435330867767334 seconds
Then, training+dataloading take 15.44688630104065 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6159763336181641
Time for copying to cuda: 0.05129599571228027
Memory occpied: (2908.0, 5296.0)
Time for forward pass: 0.2320997714996338
Time for backpropagation: 0.012815713882446289
GPU memory for training: 1.9698281288146973                          

One training iteration takes: 1.032043218612671 seconds
Index: 11
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Memory occpied: (2908.0, 5296.0)
Read 40.78874111175537 MBs for this batch
Executing all posts took 6.973300457000732 seconds
Streaming inaturalist data took 6.991596460342407 seconds
Then, training+dataloading take 6.99600625038147 seconds

Epoch: 0
Time of next(dataloader) is: 0.5469014644622803
Time for copying to cuda: 0.011822223663330078
Time for forward pass: 0.4581937789916992
Time for backpropagation: 0.021843671798706055
GPU memory for training: 1.9008359909057617                          

Memory occpied: (2908.0, 2974.0)
The whole process took 203.88735580444336 seconds
