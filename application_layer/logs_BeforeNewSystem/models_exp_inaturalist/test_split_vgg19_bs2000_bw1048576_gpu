Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.1001976595461 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [12845056. 12845056. 12845056. 12845056.  3211264.  6422528.  6422528.
  6422528.  6422528.  1605632.  3211264.  3211264.  3211264.  3211264.
  3211264.  3211264.  3211264.  3211264.   802816.  1605632.  1605632.
  1605632.  1605632.  1605632.  1605632.  1605632.  1605632.   401408.
   401408.   401408.   401408.   401408.   401408.   401408.   401408.
   401408.   100352.   100352.    16384.    16384.    16384.    16384.
    16384.    16384.    32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119026509.10763203 119026509.10763203
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.37090301513672
Fixed, scale_with_bsz  0 25.07421875
Mem usage  2006.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 29.325127601623535 seconds
Memory occpied: (2006.0, 3.0)
Streaming inaturalist data took 29.729128122329712 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8710272312164307
Memory occpied: (2772.0, 3.0)
Time for copying to cuda: 0.2929689884185791
Memory occpied: (2772.0, 840.0)
Memory occpied: (2772.0, 1302.0)
Memory occpied: (8520.0, 8038.0)
Memory occpied: (8520.0, 8038.0)
Time for forward pass: 5.954874038696289
Time for backpropagation: 0.11578989028930664
GPU memory for training: 13.58687686920166                          

One training iteration takes: 7.444655418395996 seconds
Index: 0
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Memory occpied: (4574.0, 8046.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 35.33179545402527 seconds
Streaming inaturalist data took 35.7634596824646 seconds
Then, training+dataloading take 35.80788612365723 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (4574.0, 8046.0)
Time of next(dataloader) is: 0.9973893165588379
Memory occpied: (4574.0, 8046.0)
Time for copying to cuda: 0.31961607933044434
Time for forward pass: 0.649188756942749
Time for backpropagation: 0.004358768463134766
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.1705377101898193 seconds
Index: 1
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 29.00251293182373 seconds
Memory occpied: (8404.0, 8054.0)
Streaming inaturalist data took 29.35338306427002 seconds
Then, training+dataloading take 29.397573471069336 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0291051864624023
Memory occpied: (8404.0, 8054.0)
Time for copying to cuda: 0.20478320121765137
Time for forward pass: 0.6494631767272949
Time for backpropagation: 0.004454612731933594
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.1020970344543457 seconds
Index: 2
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 35.743942975997925 seconds
Memory occpied: (8404.0, 8054.0)
Streaming inaturalist data took 36.029255390167236 seconds
Then, training+dataloading take 36.088658571243286 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9364771842956543
Memory occpied: (8404.0, 8054.0)
Time for copying to cuda: 0.2039330005645752
Time for forward pass: 0.6908996105194092
Time for backpropagation: 0.004346132278442383
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.0327670574188232 seconds
Index: 3
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 29.337085247039795 seconds
Streaming inaturalist data took 29.76753854751587 seconds
Then, training+dataloading take 29.804729223251343 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (8404.0, 8054.0)
Time of next(dataloader) is: 0.9239680767059326
Time for copying to cuda: 0.20417308807373047
Memory occpied: (8404.0, 8054.0)
Time for forward pass: 0.6627111434936523
Time for backpropagation: 0.004505634307861328
GPU memory for training: 8.388604164123535                          

One training iteration takes: 1.9904766082763672 seconds
Index: 4
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 35.90567898750305 seconds
Memory occpied: (8404.0, 8054.0)
Streaming inaturalist data took 36.33413004875183 seconds
Then, training+dataloading take 36.406694173812866 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9237000942230225
Memory occpied: (8404.0, 8054.0)
Time for copying to cuda: 0.2570819854736328
Time for forward pass: 0.6970367431640625
Time for backpropagation: 0.004402637481689453
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.107736587524414 seconds
Index: 5
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 29.41149926185608 seconds
Memory occpied: (8404.0, 8054.0)
Streaming inaturalist data took 29.843080520629883 seconds
Then, training+dataloading take 29.895803451538086 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9499030113220215
Memory occpied: (8404.0, 8054.0)
Time for copying to cuda: 0.26140666007995605
Time for forward pass: 0.6870956420898438
Time for backpropagation: 0.004408836364746094
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.1000382900238037 seconds
Index: 6
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 35.717870235443115 seconds
Streaming inaturalist data took 36.007563829422 seconds
Then, training+dataloading take 36.079432249069214 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.952916145324707
Time for copying to cuda: 0.2064208984375
Time for forward pass: 0.6521682739257812
Time for backpropagation: 0.004384040832519531
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.0104122161865234 seconds
Index: 7
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 29.554569959640503 seconds
Streaming inaturalist data took 29.846338272094727 seconds
Then, training+dataloading take 29.917767763137817 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (8404.0, 8054.0)
Time of next(dataloader) is: 0.9391913414001465
Time for copying to cuda: 0.2073378562927246
Time for forward pass: 0.6573364734649658
Time for backpropagation: 0.004924297332763672
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.002063512802124 seconds
Index: 8
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 35.884623765945435 seconds
Memory occpied: (8404.0, 8054.0)
Streaming inaturalist data took 36.16639065742493 seconds
Then, training+dataloading take 36.236727476119995 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.9214270114898682
Memory occpied: (8404.0, 8054.0)
Time for copying to cuda: 0.20628762245178223
Time for forward pass: 0.6923501491546631
Time for backpropagation: 0.004422903060913086
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.0156846046447754 seconds
Index: 9
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 29.222830533981323 seconds
Memory occpied: (8404.0, 8054.0)
Streaming inaturalist data took 29.648699283599854 seconds
Then, training+dataloading take 29.71987533569336 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.926602840423584
Memory occpied: (8404.0, 8054.0)
Time for copying to cuda: 0.25622987747192383
Time for forward pass: 0.6719017028808594
Time for backpropagation: 0.00448155403137207
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.073899984359741 seconds
Index: 10
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 36.10511016845703 seconds
Streaming inaturalist data took 36.39131426811218 seconds
Then, training+dataloading take 36.46163296699524 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Memory occpied: (8404.0, 8054.0)
Time of next(dataloader) is: 0.9577946662902832
Time for copying to cuda: 0.2051684856414795
Time for forward pass: 0.691370964050293
Time for backpropagation: 0.004951953887939453
GPU memory for training: 8.388604164123535                          

One training iteration takes: 2.048024892807007 seconds
Index: 11
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Memory occpied: (8404.0, 8054.0)
Read 163.09733486175537 MBs for this batch
Executing all posts took 12.95382285118103 seconds
Streaming inaturalist data took 13.014324188232422 seconds
Then, training+dataloading take 13.028364181518555 seconds

Epoch: 0
Time of next(dataloader) is: 0.6042091846466064
Time for copying to cuda: 0.04579877853393555
Time for forward pass: 0.7585914134979248
Time for backpropagation: 0.008919000625610352
GPU memory for training: 6.722691059112549                          

Memory occpied: (8404.0, 7670.0)
The whole process took 419.9023685455322 seconds
