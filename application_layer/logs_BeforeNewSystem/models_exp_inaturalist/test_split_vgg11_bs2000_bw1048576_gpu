Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=25, model='myvgg11', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2834137820665 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [12845056. 12845056.  3211264.  6422528.  6422528.  1605632.  3211264.
  3211264.  3211264.  3211264.   802816.  1605632.  1605632.  1605632.
  1605632.   401408.   401408.   401408.   401408.   401408.   100352.
   100352.    16384.    16384.    16384.    16384.    16384.    16384.
    32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119050523.61124302 119050523.61124302
All candidates indexes:  (array([22, 23, 24, 25, 26, 27, 28]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 25
Intermediate:  0.015625
24.5
Total layers size  62.71465301513672
Candidate split  23
Server, client, server+client, vanilla  1246.091796875 1024.723388671875 2270.815185546875 51141.910888671875
Model size  619.236328125
Fixed, scale_with_bsz  619.236328125 25.07421875
Mem usage  1952.0 3.0
Using split index: 23
Freezing the lower layers of the model (myvgg11) till index 25
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Memory occpied: (1952.0, 3.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.903677701950073 seconds
Streaming inaturalist data took 16.916358947753906 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.46032047271728516
Time for copying to cuda: 0.009639263153076172
Time for forward pass: 3.0950427055358887
Time for backpropagation: 0.07323718070983887
GPU memory for training: 2.6107091903686523                          

One training iteration takes: 3.765315055847168 seconds
Index: 0
Memory occpied: (1952.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Memory occpied: (3298.0, 2378.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.485245943069458 seconds
Streaming inaturalist data took 17.49820876121521 seconds
Then, training+dataloading take 17.499326467514038 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.546372652053833
Time for copying to cuda: 0.00897979736328125
Time for forward pass: 0.13544702529907227
Time for backpropagation: 0.003501415252685547
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.8676350116729736 seconds
Index: 1
Memory occpied: (3298.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.958077907562256 seconds
Streaming inaturalist data took 16.971250534057617 seconds
Then, training+dataloading take 16.972387075424194 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5121679306030273
Time for copying to cuda: 0.009261846542358398
Time for forward pass: 0.14883208274841309
Time for backpropagation: 0.003910541534423828
GPU memory for training: 2.9835119247436523                          

Memory occpied: (3700.0, 2386.0)
One training iteration takes: 0.8067774772644043 seconds
Index: 2
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 18.116599321365356 seconds
Streaming inaturalist data took 18.129819631576538 seconds
Then, training+dataloading take 18.130715370178223 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5334045886993408
Time for copying to cuda: 0.009127378463745117
Memory occpied: (3700.0, 2386.0)
Time for forward pass: 0.13541865348815918
Time for backpropagation: 0.003412485122680664
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7809324264526367 seconds
Index: 3
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.797768592834473 seconds
Streaming inaturalist data took 16.80638837814331 seconds
Then, training+dataloading take 16.80761408805847 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5063972473144531
Time for copying to cuda: 0.009011268615722656
Time for forward pass: 0.13525104522705078
Time for backpropagation: 0.003448009490966797
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7964053153991699 seconds
Index: 4
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.494736909866333 seconds
Streaming inaturalist data took 17.50796627998352 seconds
Then, training+dataloading take 17.509652376174927 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45411157608032227
Time for copying to cuda: 0.008929967880249023
Time for forward pass: 0.13523578643798828
Time for backpropagation: 0.0034656524658203125
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.6958403587341309 seconds
Index: 5
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.90143084526062 seconds
Streaming inaturalist data took 16.910008907318115 seconds
Then, training+dataloading take 16.911231756210327 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45445680618286133
Time for copying to cuda: 0.009108304977416992
Time for forward pass: 0.1359574794769287
Time for backpropagation: 0.0034482479095458984
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7048590183258057 seconds
Index: 6
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.185171604156494 seconds
Streaming inaturalist data took 17.198412656784058 seconds
Then, training+dataloading take 17.199361085891724 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5047881603240967
Time for copying to cuda: 0.009010791778564453
Time for forward pass: 0.13530254364013672
Time for backpropagation: 0.0034134387969970703
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7973320484161377 seconds
Index: 7
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.928341388702393 seconds
Streaming inaturalist data took 16.93700408935547 seconds
Then, training+dataloading take 16.93819761276245 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5290398597717285
Time for copying to cuda: 0.009141683578491211
Memory occpied: (3700.0, 2386.0)
Time for forward pass: 0.13546156883239746
Time for backpropagation: 0.0034568309783935547
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7676262855529785 seconds
Index: 8
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.378077030181885 seconds
Streaming inaturalist data took 17.391274213790894 seconds
Then, training+dataloading take 17.392203330993652 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4536020755767822
Time for copying to cuda: 0.009086847305297852
Time for forward pass: 0.13561129570007324
Time for backpropagation: 0.0034363269805908203
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7102110385894775 seconds
Index: 9
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 16.901564121246338 seconds
Streaming inaturalist data took 16.910125970840454 seconds
Then, training+dataloading take 16.911359786987305 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45103025436401367
Time for copying to cuda: 0.009033441543579102
Time for forward pass: 0.13609099388122559
Time for backpropagation: 0.003871440887451172
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7337470054626465 seconds
Index: 10
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 31.319355010986328 MBs for this batch
Executing all posts took 17.590375423431396 seconds
Streaming inaturalist data took 17.603476524353027 seconds
Then, training+dataloading take 17.604401350021362 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4604918956756592
Time for copying to cuda: 0.009116888046264648
Time for forward pass: 0.13544702529907227
Time for backpropagation: 0.003504037857055664
GPU memory for training: 2.9835119247436523                          

One training iteration takes: 0.7155354022979736 seconds
Index: 11
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Memory occpied: (3700.0, 2386.0)
Read 6.671088218688965 MBs for this batch
Executing all posts took 9.064355373382568 seconds
Streaming inaturalist data took 9.067629337310791 seconds
Then, training+dataloading take 9.068416357040405 seconds

Epoch: 0
Time of next(dataloader) is: 0.4577460289001465
Time for copying to cuda: 0.0021848678588867188
Time for forward pass: 0.10648274421691895
Time for backpropagation: 0.0034363269805908203
GPU memory for training: 2.8331379890441895                          

Memory occpied: (3700.0, 2386.0)
The whole process took 226.2960913181305 seconds
