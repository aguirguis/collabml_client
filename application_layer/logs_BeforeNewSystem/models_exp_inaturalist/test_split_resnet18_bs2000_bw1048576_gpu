Namespace(batch_size=2000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.580416507955 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 3.256800e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119089452.35253067 119089452.35253067
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.21269989013672
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1352.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.647238731384277 seconds
Memory occpied: (1352.0, 3.0)
Streaming inaturalist data took 13.71951961517334 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5103743076324463
Time for copying to cuda: 0.05133318901062012
Memory occpied: (1544.0, 356.0)
Memory occpied: (1544.0, 824.0)
Memory occpied: (1544.0, 1246.0)
Time for forward pass: 4.263259649276733
Memory occpied: (12328.0, 12200.0)
Memory occpied: (12328.0, 6820.0)
Time for backpropagation: 1.5755608081817627
GPU memory for training: 11.622561931610107                          

One training iteration takes: 6.510184049606323 seconds
Index: 0
Memory occpied: (6996.0, 6610.0)
Memory occpied: (6996.0, 6610.0)
Memory occpied: (6996.0, 6610.0)
Memory occpied: (6996.0, 6610.0)
Memory occpied: (6996.0, 6610.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.828696966171265 seconds
Streaming inaturalist data took 13.960524082183838 seconds
Then, training+dataloading take 13.97165060043335 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (6996.0, 6610.0)
Memory occpied: (6996.0, 6610.0)
Time of next(dataloader) is: 0.5747730731964111
Time for copying to cuda: 0.05102181434631348
Time for forward pass: 0.10003542900085449
Time for backpropagation: 0.00497746467590332
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.850684404373169 seconds
Index: 1
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.613518714904785 seconds
Streaming inaturalist data took 13.686070203781128 seconds
Then, training+dataloading take 13.700355768203735 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6404342651367188
Time for copying to cuda: 0.05172538757324219
Time for forward pass: 0.10013937950134277
Time for backpropagation: 0.005358695983886719
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.9546773433685303 seconds
Index: 2
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 14.065574884414673 seconds
Streaming inaturalist data took 14.137892246246338 seconds
Then, training+dataloading take 14.152535915374756 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.588615894317627
Time for copying to cuda: 0.05127263069152832
Time for forward pass: 0.10007572174072266
Time for backpropagation: 0.0051462650299072266
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.8632616996765137 seconds
Index: 3
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.805410385131836 seconds
Streaming inaturalist data took 13.937110185623169 seconds
Then, training+dataloading take 13.949418306350708 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (7012.0, 6626.0)
Time of next(dataloader) is: 0.5745353698730469
Time for copying to cuda: 0.05143165588378906
Time for forward pass: 0.10411667823791504
Time for backpropagation: 0.004974842071533203
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.8556063175201416 seconds
Index: 4
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.887675523757935 seconds
Streaming inaturalist data took 13.961516618728638 seconds
Then, training+dataloading take 13.97586178779602 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.62335205078125
Time for copying to cuda: 0.050904273986816406
Time for forward pass: 0.10003352165222168
Time for backpropagation: 0.004909515380859375
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.9371237754821777 seconds
Index: 5
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.532917499542236 seconds
Streaming inaturalist data took 13.604582786560059 seconds
Then, training+dataloading take 13.615770816802979 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (7012.0, 6626.0)
Time of next(dataloader) is: 0.7111375331878662
Time for copying to cuda: 0.05124855041503906
Time for forward pass: 0.10017132759094238
Time for backpropagation: 0.0049152374267578125
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.9858863353729248 seconds
Index: 6
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.922796726226807 seconds
Streaming inaturalist data took 13.995358228683472 seconds
Then, training+dataloading take 14.01018738746643 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.568840742111206
Time for copying to cuda: 0.0514836311340332
Time for forward pass: 0.10594749450683594
Time for backpropagation: 0.005423307418823242
GPU memory for training: 2.4495320320129395                          

Memory occpied: (7012.0, 6626.0)
One training iteration takes: 0.8613708019256592 seconds
Index: 7
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.786231756210327 seconds
Streaming inaturalist data took 13.858389377593994 seconds
Then, training+dataloading take 13.87339186668396 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5666325092315674
Time for copying to cuda: 0.05139040946960449
Time for forward pass: 0.10022139549255371
Time for backpropagation: 0.005009651184082031
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.8425323963165283 seconds
Index: 8
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 14.139356851577759 seconds
Streaming inaturalist data took 14.21147346496582 seconds
Then, training+dataloading take 14.226454019546509 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5673923492431641
Time for copying to cuda: 0.05096578598022461
Time for forward pass: 0.1001443862915039
Time for backpropagation: 0.0049817562103271484
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.8741989135742188 seconds
Index: 9
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 13.497753858566284 seconds
Streaming inaturalist data took 13.570403814315796 seconds
Then, training+dataloading take 13.58471965789795 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6420824527740479
Time for copying to cuda: 0.05134296417236328
Time for forward pass: 0.10007452964782715
Time for backpropagation: 0.004923820495605469
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.9535527229309082 seconds
Index: 10
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 14.006019592285156 seconds
Memory occpied: (7012.0, 6626.0)
Streaming inaturalist data took 14.078179836273193 seconds
Then, training+dataloading take 14.092812538146973 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.5713307857513428
Time for copying to cuda: 0.05146312713623047
Time for forward pass: 0.10002684593200684
Time for backpropagation: 0.0048828125
GPU memory for training: 2.4495320320129395                          

One training iteration takes: 0.8492448329925537 seconds
Index: 11
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Read 40.78874111175537 MBs for this batch
Executing all posts took 6.222922086715698 seconds
Streaming inaturalist data took 6.309963226318359 seconds
Then, training+dataloading take 6.313040256500244 seconds

Epoch: 0
Memory occpied: (7012.0, 6626.0)
Memory occpied: (7012.0, 6626.0)
Time of next(dataloader) is: 0.5111238956451416
Time for copying to cuda: 0.011353254318237305
Time for forward pass: 0.30225610733032227
Time for backpropagation: 0.2905905246734619
GPU memory for training: 4.297852039337158                          

Memory occpied: (7012.0, 6626.0)
The whole process took 182.0377540588379 seconds
