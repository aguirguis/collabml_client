Namespace(batch_size=4000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3884092606218 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 3.256800e+04]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119064285.57860821 119064285.57860821
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.21269989013672
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1352.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 4000, post_step 1000

Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Memory occpied: (1352.0, 3.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 30.966577768325806 seconds
Streaming inaturalist data took 31.109840631484985 seconds
The mode is:  split
Start 4000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.664470911026001
Time for copying to cuda: 0.144761323928833
Memory occpied: (1736.0, 5.0)
Memory occpied: (1736.0, 654.0)
Memory occpied: (1736.0, 1142.0)
Memory occpied: (11558.0, 11296.0)
Time for forward pass: 4.868200302124023
Memory occpied: (11528.0, 11304.0)
Memory occpied: (11528.0, 11262.0)
Time for backpropagation: 2.2928667068481445
GPU memory for training: 19.778080940246582                          

One training iteration takes: 8.117720365524292 seconds
Index: 0
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Memory occpied: (11534.0, 10860.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 26.42312002182007 seconds
Memory occpied: (11534.0, 10860.0)
Streaming inaturalist data took 26.566089391708374 seconds
Then, training+dataloading take 26.593032360076904 seconds
The mode is:  split
Start 8000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6892580986022949
Time for copying to cuda: 0.10013151168823242
Time for forward pass: 0.23707079887390137
Time for backpropagation: 0.006152629852294922
GPU memory for training: 4.636505603790283                          

One training iteration takes: 1.1632671356201172 seconds
Index: 1
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 25.75579023361206 seconds
Streaming inaturalist data took 25.902542114257812 seconds
Then, training+dataloading take 25.929031372070312 seconds
The mode is:  split
Start 12000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6927716732025146
Time for copying to cuda: 0.15327811241149902
Memory occpied: (11550.0, 10876.0)
Time for forward pass: 0.18823504447937012
Time for backpropagation: 0.005238771438598633
GPU memory for training: 4.636505603790283                          

One training iteration takes: 1.177581787109375 seconds
Index: 2
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 25.80787682533264 seconds
Streaming inaturalist data took 25.955109357833862 seconds
Then, training+dataloading take 25.981759071350098 seconds
The mode is:  split
Start 16000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7293198108673096
Memory occpied: (11550.0, 10876.0)
Time for copying to cuda: 0.10111522674560547
Time for forward pass: 0.18529176712036133
Time for backpropagation: 0.005214691162109375
GPU memory for training: 4.636505603790283                          

One training iteration takes: 1.1626479625701904 seconds
Index: 3
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 26.235387563705444 seconds
Streaming inaturalist data took 26.52236580848694 seconds
Then, training+dataloading take 26.545992374420166 seconds
The mode is:  split
Start 20000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (11550.0, 10876.0)
Time of next(dataloader) is: 0.7042486667633057
Time for copying to cuda: 0.1005408763885498
Time for forward pass: 0.1877737045288086
Time for backpropagation: 0.005239248275756836
GPU memory for training: 4.636505603790283                          

One training iteration takes: 1.151247501373291 seconds
Index: 4
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Read 382.9922523498535 MBs for this batch
Executing all posts took 26.66826343536377 seconds
Streaming inaturalist data took 26.810391426086426 seconds
Then, training+dataloading take 26.838107347488403 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Memory occpied: (11550.0, 10876.0)
Time of next(dataloader) is: 0.8201961517333984
Time for copying to cuda: 0.10009980201721191
Time for forward pass: 0.18325018882751465
Time for backpropagation: 0.0050868988037109375
GPU memory for training: 4.636505603790283                          

One training iteration takes: 1.260995864868164 seconds
Index: 5
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Memory occpied: (11550.0, 10876.0)
Read 40.78874111175537 MBs for this batch
Executing all posts took 6.187255144119263 seconds
Streaming inaturalist data took 6.205451488494873 seconds
Then, training+dataloading take 6.215086221694946 seconds

Epoch: 0
Time of next(dataloader) is: 0.47817468643188477
Time for copying to cuda: 0.011159420013427734
Memory occpied: (11550.0, 10876.0)
Time for forward pass: 0.3400428295135498
Time for backpropagation: 0.2906808853149414
GPU memory for training: 4.298344135284424                          

The whole process took 177.4028823375702 seconds
