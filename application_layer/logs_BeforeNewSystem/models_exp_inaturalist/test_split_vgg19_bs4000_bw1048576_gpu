Namespace(batch_size=4000, cpuonly=False, dataset='inaturalist', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.6594028045981 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [12845056. 12845056. 12845056. 12845056.  3211264.  6422528.  6422528.
  6422528.  6422528.  1605632.  3211264.  3211264.  3211264.  3211264.
  3211264.  3211264.  3211264.  3211264.   802816.  1605632.  1605632.
  1605632.  1605632.  1605632.  1605632.  1605632.  1605632.   401408.
   401408.   401408.   401408.   401408.   401408.   401408.   401408.
   401408.   100352.   100352.    16384.    16384.    16384.    16384.
    16384.    16384.    32568.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 119099805.24440429 119099805.24440429
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.37090301513672
Fixed, scale_with_bsz  0 25.07421875
Mem usage  2006.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 4000, post_step 1000

Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Memory occpied: (2006.0, 3.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 51.48423528671265 seconds
Memory occpied: (2006.0, 3.0)
Streaming inaturalist data took 52.12206196784973 seconds
The mode is:  split
Start 4000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (2006.0, 3.0)
Time of next(dataloader) is: 1.4366121292114258
Time for copying to cuda: 0.4602339267730713
Memory occpied: (3538.0, 880.0)
Memory occpied: (3538.0, 1326.0)
Memory occpied: (3538.0, 1780.0)
Memory occpied: (14302.0, 13052.0)
Memory occpied: (14302.0, 13052.0)
Memory occpied: (14302.0, 13052.0)
Memory occpied: (4268.0, 13060.0)
Time for forward pass: 8.605044603347778
Time for backpropagation: 0.18625855445861816
GPU memory for training: 23.758339405059814                          

One training iteration takes: 11.000189542770386 seconds
Index: 0
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Memory occpied: (5436.0, 13060.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 51.73838663101196 seconds
Memory occpied: (5436.0, 13060.0)
Streaming inaturalist data took 52.39777207374573 seconds
Then, training+dataloading take 52.49568152427673 seconds
The mode is:  split
Start 8000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (5436.0, 13060.0)
Time of next(dataloader) is: 1.5106513500213623
Time for copying to cuda: 0.39574599266052246
Memory occpied: (12284.0, 13068.0)
Time for forward pass: 1.088721513748169
Time for backpropagation: 0.004809141159057617
GPU memory for training: 13.20520830154419                          

One training iteration takes: 3.363710403442383 seconds
Index: 1
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 52.5578248500824 seconds
Streaming inaturalist data took 53.12151503562927 seconds
Then, training+dataloading take 53.21917152404785 seconds
The mode is:  split
Start 12000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (12284.0, 13068.0)
Time of next(dataloader) is: 1.5826687812805176
Time for copying to cuda: 0.5277390480041504
Memory occpied: (12284.0, 13068.0)
Time for forward pass: 1.1458194255828857
Time for backpropagation: 0.005401134490966797
GPU memory for training: 13.20520830154419                          

One training iteration takes: 3.551362991333008 seconds
Index: 2
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 52.48147463798523 seconds
Memory occpied: (12284.0, 13068.0)
Streaming inaturalist data took 53.14868402481079 seconds
Then, training+dataloading take 53.248509883880615 seconds
The mode is:  split
Start 16000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (12284.0, 13068.0)
Time of next(dataloader) is: 1.453418493270874
Time for copying to cuda: 0.405179500579834
Memory occpied: (12284.0, 13068.0)
Time for forward pass: 1.075798511505127
Time for backpropagation: 0.0049288272857666016
GPU memory for training: 13.20520830154419                          

One training iteration takes: 3.2862706184387207 seconds
Index: 3
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 52.808063983917236 seconds
Streaming inaturalist data took 53.48335123062134 seconds
Then, training+dataloading take 53.600133180618286 seconds
The mode is:  split
Start 20000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (12284.0, 13068.0)
Time of next(dataloader) is: 1.5331201553344727
Memory occpied: (12284.0, 13068.0)
Time for copying to cuda: 0.39958930015563965
Memory occpied: (12284.0, 13068.0)
Time for forward pass: 1.1419122219085693
Time for backpropagation: 0.005019187927246094
GPU memory for training: 13.20520830154419                          

One training iteration takes: 3.3919098377227783 seconds
Index: 4
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Read 1531.4297523498535 MBs for this batch
Executing all posts took 53.361966371536255 seconds
Streaming inaturalist data took 54.01657009124756 seconds
Then, training+dataloading take 54.07221698760986 seconds
The mode is:  split
Start 24000, end 24426, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.5233347415924072
Time for copying to cuda: 0.3986670970916748
Time for forward pass: 1.1273176670074463
Time for backpropagation: 0.004926443099975586
GPU memory for training: 13.20520830154419                          

Memory occpied: (12284.0, 13068.0)
One training iteration takes: 3.3519248962402344 seconds
Index: 5
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Memory occpied: (12284.0, 13068.0)
Read 163.09733486175537 MBs for this batch
Executing all posts took 12.961262226104736 seconds
Streaming inaturalist data took 13.02398157119751 seconds
Then, training+dataloading take 13.036283731460571 seconds

Epoch: 0
Time of next(dataloader) is: 0.688246488571167
Time for copying to cuda: 0.0437932014465332
Time for forward pass: 0.6593596935272217
Time for backpropagation: 0.004363536834716797
GPU memory for training: 6.721958637237549                          

Memory occpied: (12284.0, 12302.0)
The whole process took 343.10305857658386 seconds
