Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (2157.0, 3.0)
Memory occpied: (2563.0, 3.0)
Memory occpied: (2985.0, 3.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (2985.0, 3.0)
Streaming imagenet data took 4.2384302616119385 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (2985.0, 3.0)
Time of next(dataloader) is: 1.09419584274292
Time for copying to cuda: 0.2993288040161133
Memory occpied: (4135.0, 914.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (5285.0, 2265.0)
Streaming imagenet data took 4.316927909851074 seconds
Memory occpied: (10381.0, 8227.0)
Memory occpied: (10227.0, 12943.0)
Memory occpied: (10227.0, 8739.0)
Time for forward pass: 6.860030174255371
Time for backpropagation: 0.09865641593933105
GPU memory for training: 12.220680236816406                          

One training iteration takes: 8.561384201049805 seconds
Index: 0
Then, training+dataloading take 8.563956022262573 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (10987.0, 15013.0)
Time of next(dataloader) is: 1.1970272064208984
Time for copying to cuda: 0.3011362552642822
Time for forward pass: 0.013000249862670898
Time for backpropagation: 0.0027527809143066406
GPU memory for training: 6.347530364990234                          

One training iteration takes: 1.787092924118042 seconds
Index: 1
Memory occpied: (14071.0, 14281.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (9889.0, 14289.0)
Streaming imagenet data took 4.192502975463867 seconds
Then, training+dataloading take 4.269592761993408 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (9889.0, 14297.0)
Time of next(dataloader) is: 1.5076873302459717
Time for copying to cuda: 0.3090779781341553
Time for forward pass: 0.006453752517700195
Time for backpropagation: 0.002691984176635742
GPU memory for training: 6.347530364990234                          

One training iteration takes: 2.145068407058716 seconds
Index: 2
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.490296363830566 seconds
Then, training+dataloading take 4.547482013702393 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.4218688011169434
Time for copying to cuda: 0.2993929386138916
Time for forward pass: 0.007842779159545898
Time for backpropagation: 0.002763032913208008
GPU memory for training: 6.347530364990234                          

One training iteration takes: 2.084160566329956 seconds
Index: 3
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.488140821456909 seconds
Then, training+dataloading take 4.594434976577759 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.2634122371673584
Time for copying to cuda: 0.3210866451263428
Time for forward pass: 0.0063474178314208984
Time for backpropagation: 0.002941608428955078
GPU memory for training: 6.347530364990234                          

One training iteration takes: 1.91064453125 seconds
Index: 4
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.331346750259399 seconds
Then, training+dataloading take 4.387571811676025 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.468832015991211
Time for copying to cuda: 0.3112936019897461
Time for forward pass: 0.006405830383300781
Time for backpropagation: 0.002826690673828125
GPU memory for training: 6.347530364990234                          

One training iteration takes: 2.1356313228607178 seconds
Index: 5
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.2108025550842285 seconds
Then, training+dataloading take 4.2706544399261475 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.447380781173706
Time for copying to cuda: 0.30423474311828613
Time for forward pass: 0.0064809322357177734
Time for backpropagation: 0.002710580825805664
GPU memory for training: 6.347530364990234                          

One training iteration takes: 2.1339941024780273 seconds
Index: 6
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.398000001907349 seconds
Then, training+dataloading take 4.466839551925659 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.3813304901123047
Time for copying to cuda: 0.305342435836792
Time for forward pass: 0.0061283111572265625
Time for backpropagation: 0.0026586055755615234
GPU memory for training: 6.347530364990234                          

One training iteration takes: 2.037308931350708 seconds
Index: 7
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.409511089324951 seconds
Then, training+dataloading take 4.47203254699707 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.4809658527374268
Time for copying to cuda: 0.3127434253692627
Time for forward pass: 0.0068645477294921875
Time for backpropagation: 0.002744436264038086
GPU memory for training: 6.347530364990234                          

One training iteration takes: 2.155505657196045 seconds
Index: 8
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.389880418777466 seconds
Then, training+dataloading take 4.4512574672698975 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.4825286865234375
Time for copying to cuda: 0.305234432220459
Time for forward pass: 0.0071408748626708984
Time for backpropagation: 0.0028922557830810547
GPU memory for training: 6.347530364990234                          

One training iteration takes: 2.084049940109253 seconds
Index: 9
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.396512031555176 seconds
Then, training+dataloading take 4.457533597946167 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Time of next(dataloader) is: 1.3430695533752441
Time for copying to cuda: 0.3158695697784424
Time for forward pass: 0.0063610076904296875
Time for backpropagation: 0.002744436264038086
GPU memory for training: 6.347530364990234                          

One training iteration takes: 2.0143628120422363 seconds
Index: 10
Memory occpied: (12973.0, 14297.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (12973.0, 14297.0)
Streaming imagenet data took 4.568227767944336 seconds
Then, training+dataloading take 4.638197898864746 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Memory occpied: (12973.0, 14297.0)
Read 183.76415348052979 MBs for this batch
Time of next(dataloader) is: 1.4961259365081787
Streaming imagenet data took 1.510479211807251 seconds
Time for copying to cuda: 0.3101184368133545
Time for forward pass: 0.005929708480834961
Time for backpropagation: 0.002918720245361328
GPU memory for training: 6.347530364990234                          

One training iteration takes: 2.140026092529297 seconds
Index: 11
Then, training+dataloading take 2.14286732673645 seconds

Epoch: 0
Time of next(dataloader) is: 0.6978528499603271
Time for copying to cuda: 0.05378603935241699
Time for forward pass: 0.48117852210998535
Time for backpropagation: 0.0028192996978759766
GPU memory for training: 2.6385855674743652                          

Memory occpied: (12973.0, 9367.0)
The whole process took 202.10770750045776seconds