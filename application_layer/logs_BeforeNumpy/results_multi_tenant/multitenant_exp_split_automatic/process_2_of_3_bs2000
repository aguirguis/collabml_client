Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3147309434006 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119054628.4142134 119054628.4142134
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.2257080078125 seconds
Streaming imagenet data took 2.2752835750579834 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Time of next(dataloader) is: 0.2753715515136719
Time for copying to cuda: 0.01916193962097168
Memory occpied: (1586.0, 412.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.047389507293701 seconds
Streaming imagenet data took 2.075310468673706 seconds
Memory occpied: (1586.0, 818.0)
Memory occpied: (1586.0, 1252.0)
Time for forward pass: 3.403796434402466
Time for backpropagation: 0.05841779708862305
GPU memory for training: 1.102445125579834                          

One training iteration takes: 3.8159477710723877 seconds
Index: 0
Then, training+dataloading take 3.816202163696289 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.27178454399108887
Time for copying to cuda: 0.018950939178466797
Time for forward pass: 0.07540249824523926
Time for backpropagation: 0.0037779808044433594
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.43546295166015625 seconds
Index: 1
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.56758713722229 seconds
Streaming imagenet data took 2.5951383113861084 seconds
Then, training+dataloading take 2.598691701889038 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2840158939361572
Time for copying to cuda: 0.01838994026184082
Time for forward pass: 0.07541656494140625
Time for backpropagation: 0.0027000904083251953
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.44261646270751953 seconds
Index: 2
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.320768356323242 seconds
Streaming imagenet data took 2.34812331199646 seconds
Then, training+dataloading take 2.3519437313079834 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28328919410705566
Time for copying to cuda: 0.018561363220214844
Time for forward pass: 0.09120678901672363
Time for backpropagation: 0.003161907196044922
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.47498130798339844 seconds
Index: 3
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.8004915714263916 seconds
Streaming imagenet data took 2.8573083877563477 seconds
Then, training+dataloading take 2.864786148071289 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (2326.0, 1632.0)
Time of next(dataloader) is: 0.28856372833251953
Time for copying to cuda: 0.01845073699951172
Time for forward pass: 0.0754239559173584
Time for backpropagation: 0.002701282501220703
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.45477724075317383 seconds
Index: 4
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.5908825397491455 seconds
Streaming imagenet data took 2.6187422275543213 seconds
Then, training+dataloading take 2.623964309692383 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28806400299072266
Time for copying to cuda: 0.01866745948791504
Time for forward pass: 0.07557201385498047
Time for backpropagation: 0.0028076171875
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.45682382583618164 seconds
Index: 5
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.4359848499298096 seconds
Streaming imagenet data took 2.463503837585449 seconds
Then, training+dataloading take 2.468324661254883 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28053903579711914
Time for copying to cuda: 0.018260478973388672
Time for forward pass: 0.07532858848571777
Time for backpropagation: 0.0026047229766845703
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.44771242141723633 seconds
Index: 6
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.2924275398254395 seconds
Streaming imagenet data took 2.31939697265625 seconds
Then, training+dataloading take 2.3244502544403076 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2863006591796875
Time for copying to cuda: 0.018767356872558594
Time for forward pass: 0.07539749145507812
Time for backpropagation: 0.002576589584350586
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4537849426269531 seconds
Index: 7
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.3273766040802 seconds
Streaming imagenet data took 2.3557446002960205 seconds
Then, training+dataloading take 2.3595032691955566 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28668975830078125
Time for copying to cuda: 0.018505096435546875
Time for forward pass: 0.07542681694030762
Time for backpropagation: 0.0026836395263671875
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.45707249641418457 seconds
Index: 8
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.4249038696289062 seconds
Streaming imagenet data took 2.452103614807129 seconds
Then, training+dataloading take 2.456026077270508 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2835824489593506
Time for copying to cuda: 0.01842045783996582
Time for forward pass: 0.07536768913269043
Time for backpropagation: 0.0026628971099853516
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4460165500640869 seconds
Index: 9
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.1173267364501953 seconds
Streaming imagenet data took 2.1452975273132324 seconds
Then, training+dataloading take 2.14998722076416 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28842830657958984
Time for copying to cuda: 0.018525123596191406
Time for forward pass: 0.07543015480041504
Time for backpropagation: 0.002718687057495117
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.45108628273010254 seconds
Index: 10
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.4437105655670166 seconds
Streaming imagenet data took 2.470989465713501 seconds
Then, training+dataloading take 2.475910186767578 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.28782200813293457
Time for copying to cuda: 0.018420934677124023
Time for forward pass: 0.07540535926818848
Time for backpropagation: 0.0026645660400390625
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.45065784454345703 seconds
Index: 11
Memory occpied: (2326.0, 1632.0)
Read 11.263076782226562 MBs for this batch
Executing all posts took 0.6335794925689697 seconds
Streaming imagenet data took 0.6392369270324707 seconds
Then, training+dataloading take 0.6398966312408447 seconds

Epoch: 0
Time of next(dataloader) is: 0.24561214447021484
Time for copying to cuda: 0.0032701492309570312
Time for forward pass: 0.03238654136657715
Time for backpropagation: 0.0027022361755371094
GPU memory for training: 1.0984325408935547                          

The whole process took 38.94697713851929 seconds
