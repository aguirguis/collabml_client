Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.4992889604766 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119078818.8026276 119078818.8026276
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 647.1533203125 931.89208984375 4679.3798828125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 7.931805610656738 seconds
Streaming imagenet data took 7.959122180938721 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.23676323890686035
Time for copying to cuda: 0.018867015838623047
Memory occpied: (1586.0, 388.0)
Memory occpied: (1586.0, 812.0)
Memory occpied: (1586.0, 1218.0)
Time for forward pass: 3.3322689533233643
Time for backpropagation: 0.0491948127746582
GPU memory for training: 1.102445125579834                          

One training iteration takes: 3.6981780529022217 seconds
Index: 0
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.465433120727539 seconds
Memory occpied: (2100.0, 1624.0)
Streaming imagenet data took 4.493378639221191 seconds
Then, training+dataloading take 4.498148202896118 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26413440704345703
Time for copying to cuda: 0.018215179443359375
Time for forward pass: 0.07544255256652832
Time for backpropagation: 0.0037064552307128906
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4343447685241699 seconds
Index: 1
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 3.836963415145874 seconds
Streaming imagenet data took 3.864182233810425 seconds
Then, training+dataloading take 3.8681962490081787 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2647383213043213
Time for copying to cuda: 0.017882823944091797
Time for forward pass: 0.07534456253051758
Time for backpropagation: 0.0025403499603271484
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.42826032638549805 seconds
Index: 2
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 5.1502768993377686 seconds
Streaming imagenet data took 5.20513129234314 seconds
Then, training+dataloading take 5.213001012802124 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Time of next(dataloader) is: 0.29353857040405273
Time for copying to cuda: 0.018223285675048828
Time for forward pass: 0.07549381256103516
Time for backpropagation: 0.0026998519897460938
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4547388553619385 seconds
Index: 3
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 5.240999937057495 seconds
Streaming imagenet data took 5.268723964691162 seconds
Then, training+dataloading take 5.272636651992798 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2678837776184082
Time for copying to cuda: 0.018154144287109375
Time for forward pass: 0.07557916641235352
Time for backpropagation: 0.002705812454223633
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4354383945465088 seconds
Index: 4
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 4.205124855041504 seconds
Streaming imagenet data took 4.233387231826782 seconds
Then, training+dataloading take 4.238007545471191 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26761913299560547
Time for copying to cuda: 0.01816582679748535
Time for forward pass: 0.07535743713378906
Time for backpropagation: 0.002639293670654297
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.4357147216796875 seconds
Index: 5
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 14.180789709091187 seconds
Streaming imagenet data took 14.208635091781616 seconds
Then, training+dataloading take 14.212597608566284 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2679920196533203
Time for copying to cuda: 0.018152713775634766
Time for forward pass: 0.07661271095275879
Time for backpropagation: 0.003232240676879883
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.42960047721862793 seconds
Index: 6
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.298104047775269 seconds
Streaming imagenet data took 9.325936317443848 seconds
Then, training+dataloading take 9.329830408096313 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3019716739654541
Time for copying to cuda: 0.01798701286315918
Time for forward pass: 0.07534170150756836
Time for backpropagation: 0.002544879913330078
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.48184943199157715 seconds
Index: 7
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 13.989248752593994 seconds
Streaming imagenet data took 14.01682448387146 seconds
Then, training+dataloading take 14.020699262619019 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.29532408714294434
Time for copying to cuda: 0.018300771713256836
Time for forward pass: 0.07544565200805664
Time for backpropagation: 0.002689361572265625
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.48784971237182617 seconds
Index: 8
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 11.641595840454102 seconds
Streaming imagenet data took 11.66931414604187 seconds
Then, training+dataloading take 11.673173666000366 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.2999117374420166
Time for copying to cuda: 0.01808333396911621
Memory occpied: (2326.0, 1632.0)
Time for forward pass: 0.07542872428894043
Time for backpropagation: 0.002550840377807617
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.46312713623046875 seconds
Index: 9
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 7.47345757484436 seconds
Streaming imagenet data took 7.500869274139404 seconds
Then, training+dataloading take 7.505566358566284 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26534199714660645
Time for copying to cuda: 0.01803421974182129
Time for forward pass: 0.07538437843322754
Time for backpropagation: 0.002605438232421875
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.43366193771362305 seconds
Index: 10
Memory occpied: (2326.0, 1632.0)
Memory occpied: (2326.0, 1632.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 2.2626800537109375 seconds
Streaming imagenet data took 2.290207862854004 seconds
Then, training+dataloading take 2.2950358390808105 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.26688385009765625
Time for copying to cuda: 0.01808643341064453
Time for forward pass: 0.07544875144958496
Time for backpropagation: 0.002791166305541992
GPU memory for training: 1.2580008506774902                          

One training iteration takes: 0.42994213104248047 seconds
Index: 11
Memory occpied: (2326.0, 1632.0)
Read 11.263076782226562 MBs for this batch
Executing all posts took 0.9061033725738525 seconds
Streaming imagenet data took 0.9110264778137207 seconds
Then, training+dataloading take 0.9116830825805664 seconds

Epoch: 0
Time of next(dataloader) is: 0.22596001625061035
Time for copying to cuda: 0.003208160400390625
Time for forward pass: 0.031855106353759766
Time for backpropagation: 0.0025458335876464844
GPU memory for training: 1.0984325408935547                          

The whole process took 98.40914702415466 seconds
