Namespace(batch_size=250, cpuonly=False, dataset='plantleave', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 898.2266906409269 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 8.800000e+01]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 117732368.79568757 117732368.79568757
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.181724548339844
Server, client, server+client, vanilla  210.21044921875 115.52584838867188 325.7362976074219 1766.4047546386719
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1336.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 250, post_step 50

Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Memory occpied: (1336.0, 3.0)
Read 23.9375638961792 MBs for this batch
Executing all posts took 5.512343168258667 seconds
Streaming plantleave data took 5.521933078765869 seconds
The mode is:  split
Start 250, end 500, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.3092207908630371
Time for copying to cuda: 0.007013082504272461
Memory occpied: (1360.0, 122.0)
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6487209796905518 seconds
Streaming plantleave data took 0.6584429740905762 seconds
Memory occpied: (1360.0, 550.0)
Memory occpied: (1360.0, 1012.0)
Time for forward pass: 3.431072473526001
Time for backpropagation: 0.35938453674316406
GPU memory for training: 3.352717399597168                          

Memory occpied: (3012.0, 2904.0)
One training iteration takes: 4.166064262390137 seconds
Index: 0
Then, training+dataloading take 4.1661376953125 seconds
The mode is:  split
Start 500, end 750, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.3690917491912842
Time for copying to cuda: 0.006814718246459961
Time for forward pass: 0.01685476303100586
Time for backpropagation: 0.00551295280456543
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.48119592666625977 seconds
Index: 1
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.64298415184021 seconds
Streaming plantleave data took 0.6525766849517822 seconds
Then, training+dataloading take 0.6529262065887451 seconds
The mode is:  split
Start 750, end 1000, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.3941152095794678
Time for copying to cuda: 0.00738215446472168
Time for forward pass: 0.013857603073120117
Time for backpropagation: 0.005124092102050781
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.5401890277862549 seconds
Index: 2
Memory occpied: (3028.0, 2920.0)
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6813497543334961 seconds
Streaming plantleave data took 0.6914284229278564 seconds
Then, training+dataloading take 0.6918196678161621 seconds
The mode is:  split
Start 1000, end 1250, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.37007808685302734
Time for copying to cuda: 0.006946563720703125
Time for forward pass: 0.01844954490661621
Time for backpropagation: 0.010126352310180664
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.5003457069396973 seconds
Index: 3
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.5928554534912109 seconds
Streaming plantleave data took 0.5987961292266846 seconds
Then, training+dataloading take 0.5994465351104736 seconds
The mode is:  split
Start 1250, end 1500, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.4000239372253418
Time for copying to cuda: 0.008087158203125
Time for forward pass: 0.01899433135986328
Time for backpropagation: 0.0053005218505859375
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.534900426864624 seconds
Index: 4
Memory occpied: (3028.0, 2920.0)
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.675584077835083 seconds
Streaming plantleave data took 0.6815721988677979 seconds
Then, training+dataloading take 0.6819438934326172 seconds
The mode is:  split
Start 1500, end 1750, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.37173986434936523
Time for copying to cuda: 0.0072634220123291016
Time for forward pass: 0.018873929977416992
Time for backpropagation: 0.004717111587524414
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.49427056312561035 seconds
Index: 5
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6045763492584229 seconds
Streaming plantleave data took 0.6104731559753418 seconds
Then, training+dataloading take 0.6108593940734863 seconds
The mode is:  split
Start 1750, end 2000, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.44971466064453125
Time for copying to cuda: 0.007130622863769531
Time for forward pass: 0.022676944732666016
Time for backpropagation: 0.010986328125
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.6242146492004395 seconds
Index: 6
Memory occpied: (3028.0, 2920.0)
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6945834159851074 seconds
Streaming plantleave data took 0.7005171775817871 seconds
Then, training+dataloading take 0.7008922100067139 seconds
The mode is:  split
Start 2000, end 2250, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.36600542068481445
Time for copying to cuda: 0.00873708724975586
Time for forward pass: 0.020831823348999023
Time for backpropagation: 0.0050048828125
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.4887583255767822 seconds
Index: 7
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.5977025032043457 seconds
Streaming plantleave data took 0.6037461757659912 seconds
Then, training+dataloading take 0.6041064262390137 seconds
The mode is:  split
Start 2250, end 2500, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.38839197158813477
Time for copying to cuda: 0.00748443603515625
Time for forward pass: 0.018247604370117188
Time for backpropagation: 0.00523066520690918
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.5291664600372314 seconds
Index: 8
Memory occpied: (3028.0, 2920.0)
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.7456858158111572 seconds
Streaming plantleave data took 0.7558283805847168 seconds
Then, training+dataloading take 0.7562499046325684 seconds
The mode is:  split
Start 2500, end 2750, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.36470508575439453
Time for copying to cuda: 0.007416486740112305
Time for forward pass: 0.018210411071777344
Time for backpropagation: 0.00472712516784668
GPU memory for training: 0.45378971099853516                          

Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6195070743560791 seconds
Streaming plantleave data took 0.6292283535003662 seconds
Memory occpied: (3028.0, 2920.0)
Memory occpied: (3028.0, 2920.0)
Memory occpied: (3028.0, 2920.0)
Memory occpied: (3028.0, 2920.0)
One training iteration takes: 5.4082722663879395 seconds
Index: 9
Then, training+dataloading take 5.408348560333252 seconds
The mode is:  split
Start 2750, end 3000, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.4291863441467285
Time for copying to cuda: 0.006864786148071289
Time for forward pass: 0.021396636962890625
Time for backpropagation: 0.0054247379302978516
GPU memory for training: 0.45378971099853516                          

Memory occpied: (3028.0, 2920.0)
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6593210697174072 seconds
Streaming plantleave data took 0.6692454814910889 seconds
Memory occpied: (3028.0, 2920.0)
Memory occpied: (3028.0, 2920.0)
Memory occpied: (3028.0, 2920.0)
One training iteration takes: 5.478632211685181 seconds
Index: 10
Then, training+dataloading take 5.4788734912872314 seconds
The mode is:  split
Start 3000, end 3250, post_step 50


Epoch: 0
Memory occpied: (3028.0, 2920.0)
Time of next(dataloader) is: 0.37209105491638184
Time for copying to cuda: 0.007326364517211914
Time for forward pass: 0.01834893226623535
Time for backpropagation: 0.005022764205932617
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.4802677631378174 seconds
Index: 11
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6187429428100586 seconds
Streaming plantleave data took 0.6288752555847168 seconds
Then, training+dataloading take 0.6292853355407715 seconds
The mode is:  split
Start 3250, end 3500, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.3794689178466797
Time for copying to cuda: 0.007508754730224609
Time for forward pass: 0.017972469329833984
Time for backpropagation: 0.004914999008178711
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.5038337707519531 seconds
Index: 12
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6386876106262207 seconds
Streaming plantleave data took 0.6490120887756348 seconds
Then, training+dataloading take 0.6501610279083252 seconds
The mode is:  split
Start 3500, end 3750, post_step 50


Epoch: 0
Memory occpied: (3028.0, 2920.0)
Memory occpied: (3028.0, 2920.0)
Time of next(dataloader) is: 0.4092838764190674
Time for copying to cuda: 0.008240222930908203
Time for forward pass: 0.018587350845336914
Time for backpropagation: 0.005503416061401367
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.5190408229827881 seconds
Index: 13
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6141314506530762 seconds
Streaming plantleave data took 0.6205589771270752 seconds
Then, training+dataloading take 0.6213498115539551 seconds
The mode is:  split
Start 3750, end 4000, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.37630796432495117
Time for copying to cuda: 0.007136821746826172
Time for forward pass: 0.019676923751831055
Time for backpropagation: 0.006403923034667969
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.5083069801330566 seconds
Index: 14
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6547458171844482 seconds
Streaming plantleave data took 0.6650030612945557 seconds
Then, training+dataloading take 0.6658973693847656 seconds
The mode is:  split
Start 4000, end 4250, post_step 50


Epoch: 0
Memory occpied: (3028.0, 2920.0)
Time of next(dataloader) is: 0.3852047920227051
Time for copying to cuda: 0.006685018539428711
Time for forward pass: 0.01745891571044922
Time for backpropagation: 0.008748531341552734
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.4917576313018799 seconds
Index: 15
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6156699657440186 seconds
Streaming plantleave data took 0.6220660209655762 seconds
Then, training+dataloading take 0.6227350234985352 seconds
The mode is:  split
Start 4250, end 4500, post_step 50


Epoch: 0
Time of next(dataloader) is: 0.39908432960510254
Time for copying to cuda: 0.007550477981567383
Time for forward pass: 0.01997828483581543
Time for backpropagation: 0.004998445510864258
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.5329973697662354 seconds
Index: 16
Read 23.9375638961792 MBs for this batch
Executing all posts took 0.6620595455169678 seconds
Streaming plantleave data took 0.6723780632019043 seconds
Then, training+dataloading take 0.6733391284942627 seconds
The mode is:  split
Start 4500, end 4502, post_step 50


Epoch: 0
Memory occpied: (3028.0, 2920.0)
Read 0.19161128997802734 MBs for this batch
Executing all posts took 0.1835014820098877 seconds
Streaming plantleave data took 0.2278299331665039 seconds
Read 0.19161128997802734 MBs for this batch
Executing all posts took 0.1835014820098877 seconds
Time of next(dataloader) is: 0.37981414794921875
Time for copying to cuda: 0.006561994552612305
Time for forward pass: 0.016299962997436523
Time for backpropagation: 0.004247188568115234
GPU memory for training: 0.45378971099853516                          

One training iteration takes: 0.49571871757507324 seconds
Index: 17
Then, training+dataloading take 0.4960041046142578 seconds

Epoch: 0
Time of next(dataloader) is: 0.37926673889160156
Time for copying to cuda: 0.0003025531768798828
Time for forward pass: 0.033576011657714844
Time for backpropagation: 0.03533625602722168
GPU memory for training: 2.252800464630127                          

The whole process took 37.003146171569824 seconds
