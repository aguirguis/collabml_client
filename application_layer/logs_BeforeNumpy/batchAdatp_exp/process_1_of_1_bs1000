Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.3201794097365 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119055342.55559298 119055342.55559298
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 17
Intermediate:  0.03515625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 440.30517578125 725.0439453125 2456.41845703125
Candidate split  13
Server, client, server+client, vanilla  284.73876953125 440.30517578125 725.0439453125 2456.41845703125
Model size  233.45703125
Fixed, scale_with_bsz  233.45703125 2.05126953125
Mem usage  1514.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5879476070404053 seconds
Streaming imagenet data took 1.6017177104949951 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3059425354003906
Time for copying to cuda: 0.01008152961730957
Memory occpied: (1550.0, 302.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4586994647979736 seconds
Streaming imagenet data took 1.47298002243042 seconds
Memory occpied: (1550.0, 750.0)
Memory occpied: (1550.0, 1198.0)
Time for forward pass: 3.264029026031494
Time for backpropagation: 0.050826072692871094
GPU memory for training: 1.0087966918945312                          

One training iteration takes: 3.689465045928955 seconds
Index: 0
Then, training+dataloading take 3.689690589904785 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.35341930389404297
Time for copying to cuda: 0.009521961212158203
Time for forward pass: 0.04992341995239258
Time for backpropagation: 0.0034837722778320312
GPU memory for training: 1.1635355949401855                          

One training iteration takes: 0.5011496543884277 seconds
Index: 1
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5357491970062256 seconds
Streaming imagenet data took 1.5496876239776611 seconds
Then, training+dataloading take 1.5519208908081055 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4379003047943115
Time for copying to cuda: 0.010764122009277344
Time for forward pass: 0.04983234405517578
Time for backpropagation: 0.0030281543731689453
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5869741439819336 seconds
Index: 2
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.46270751953125 seconds
Streaming imagenet data took 1.4766290187835693 seconds
Then, training+dataloading take 1.4789037704467773 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.409151554107666
Time for copying to cuda: 0.009388208389282227
Time for forward pass: 0.04935908317565918
Time for backpropagation: 0.0027587413787841797
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.599933385848999 seconds
Index: 3
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4470415115356445 seconds
Streaming imagenet data took 1.461191177368164 seconds
Then, training+dataloading take 1.4633982181549072 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4084160327911377
Time for copying to cuda: 0.009506464004516602
Time for forward pass: 0.04931449890136719
Time for backpropagation: 0.0026586055755615234
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5833642482757568 seconds
Index: 4
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4958751201629639 seconds
Streaming imagenet data took 1.5100672245025635 seconds
Then, training+dataloading take 1.512359857559204 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.45645999908447266
Time for copying to cuda: 0.00947427749633789
Time for forward pass: 0.04958295822143555
Time for backpropagation: 0.002589702606201172
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6016473770141602 seconds
Index: 5
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4880778789520264 seconds
Streaming imagenet data took 1.5018162727355957 seconds
Then, training+dataloading take 1.5040268898010254 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.42084383964538574
Time for copying to cuda: 0.009432792663574219
Time for forward pass: 0.04935407638549805
Time for backpropagation: 0.0026955604553222656
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5951433181762695 seconds
Index: 6
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4622485637664795 seconds
Streaming imagenet data took 1.4762814044952393 seconds
Then, training+dataloading take 1.4785425662994385 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4160494804382324
Time for copying to cuda: 0.009332418441772461
Time for forward pass: 0.0493624210357666
Time for backpropagation: 0.002595663070678711
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.588925838470459 seconds
Index: 7
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4925367832183838 seconds
Streaming imagenet data took 1.50636887550354 seconds
Then, training+dataloading take 1.5086748600006104 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4050414562225342
Time for copying to cuda: 0.009408712387084961
Time for forward pass: 0.049329280853271484
Time for backpropagation: 0.0026590824127197266
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5983195304870605 seconds
Index: 8
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5250589847564697 seconds
Streaming imagenet data took 1.5390756130218506 seconds
Then, training+dataloading take 1.5413742065429688 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4066128730773926
Time for copying to cuda: 0.009512186050415039
Time for forward pass: 0.0494532585144043
Time for backpropagation: 0.0026450157165527344
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5870780944824219 seconds
Index: 9
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4702398777008057 seconds
Streaming imagenet data took 1.4842922687530518 seconds
Then, training+dataloading take 1.4866676330566406 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4618401527404785
Time for copying to cuda: 0.009406566619873047
Time for forward pass: 0.04938483238220215
Time for backpropagation: 0.0030035972595214844
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6179485321044922 seconds
Index: 10
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.5174119472503662 seconds
Streaming imagenet data took 1.5314886569976807 seconds
Then, training+dataloading take 1.534104347229004 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41361427307128906
Time for copying to cuda: 0.009623289108276367
Time for forward pass: 0.04945540428161621
Time for backpropagation: 0.002717256546020508
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6059627532958984 seconds
Index: 11
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4917895793914795 seconds
Streaming imagenet data took 1.5057337284088135 seconds
Then, training+dataloading take 1.508030652999878 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44399356842041016
Time for copying to cuda: 0.00949239730834961
Time for forward pass: 0.0494389533996582
Time for backpropagation: 0.0027511119842529297
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6339147090911865 seconds
Index: 12
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4531476497650146 seconds
Streaming imagenet data took 1.4672703742980957 seconds
Then, training+dataloading take 1.4695744514465332 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4691774845123291
Time for copying to cuda: 0.009521484375
Time for forward pass: 0.04947686195373535
Time for backpropagation: 0.002744913101196289
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6271836757659912 seconds
Index: 13
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4853849411010742 seconds
Streaming imagenet data took 1.4996390342712402 seconds
Then, training+dataloading take 1.5020380020141602 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41206932067871094
Time for copying to cuda: 0.009374618530273438
Time for forward pass: 0.049356698989868164
Time for backpropagation: 0.00273895263671875
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5836820602416992 seconds
Index: 14
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4503626823425293 seconds
Streaming imagenet data took 1.4643683433532715 seconds
Then, training+dataloading take 1.466667652130127 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4131510257720947
Time for copying to cuda: 0.009440422058105469
Time for forward pass: 0.04948878288269043
Time for backpropagation: 0.0026488304138183594
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6030430793762207 seconds
Index: 15
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.555553674697876 seconds
Streaming imagenet data took 1.5693144798278809 seconds
Then, training+dataloading take 1.5715968608856201 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4304380416870117
Time for copying to cuda: 0.009652853012084961
Time for forward pass: 0.049285888671875
Time for backpropagation: 0.002546072006225586
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.6039555072784424 seconds
Index: 16
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4799256324768066 seconds
Streaming imagenet data took 1.4938294887542725 seconds
Then, training+dataloading take 1.4961214065551758 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4211399555206299
Time for copying to cuda: 0.009583473205566406
Time for forward pass: 0.049592018127441406
Time for backpropagation: 0.002692699432373047
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.5884895324707031 seconds
Index: 17
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4950087070465088 seconds
Streaming imagenet data took 1.5502924919128418 seconds
Then, training+dataloading take 1.5546095371246338 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (2290.0, 1578.0)
Time of next(dataloader) is: 0.4060852527618408
Time for copying to cuda: 0.009550809860229492
Time for forward pass: 0.04933452606201172
Time for backpropagation: 0.0026128292083740234
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5565903186798096 seconds
Index: 18
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.557307481765747 seconds
Memory occpied: (2290.0, 1578.0)
Streaming imagenet data took 1.5710606575012207 seconds
Then, training+dataloading take 1.5736331939697266 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.363753080368042
Time for copying to cuda: 0.009469270706176758
Time for forward pass: 0.04933452606201172
Time for backpropagation: 0.0026547908782958984
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5113885402679443 seconds
Index: 19
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4567277431488037 seconds
Streaming imagenet data took 1.4706811904907227 seconds
Then, training+dataloading take 1.4732773303985596 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36345386505126953
Time for copying to cuda: 0.009501934051513672
Time for forward pass: 0.04940223693847656
Time for backpropagation: 0.00263214111328125
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.5164394378662109 seconds
Index: 20
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.4624102115631104 seconds
Streaming imagenet data took 1.476595401763916 seconds
Then, training+dataloading take 1.4791126251220703 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36364316940307617
Time for copying to cuda: 0.009455442428588867
Time for forward pass: 0.04935646057128906
Time for backpropagation: 0.0026509761810302734
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.523169994354248 seconds
Index: 21
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.536778450012207 seconds
Streaming imagenet data took 1.5506906509399414 seconds
Then, training+dataloading take 1.5530998706817627 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.433582067489624
Time for copying to cuda: 0.009477615356445312
Time for forward pass: 0.04941296577453613
Time for backpropagation: 0.002653837203979492
GPU memory for training: 1.1639018058776855                          

One training iteration takes: 0.617389440536499 seconds
Index: 22
Memory occpied: (2290.0, 1578.0)
Read 35.1968879699707 MBs for this batch
Executing all posts took 1.460719108581543 seconds
Streaming imagenet data took 1.4744784832000732 seconds
Then, training+dataloading take 1.4769363403320312 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4057779312133789
Time for copying to cuda: 0.04887533187866211
Time for forward pass: 0.04968404769897461
Time for backpropagation: 0.0037491321563720703
GPU memory for training: 1.1639018058776855                          

Memory occpied: (2290.0, 1578.0)
One training iteration takes: 0.6038327217102051 seconds
Index: 23
Read 11.263076782226562 MBs for this batch
Executing all posts took 0.6094677448272705 seconds
Streaming imagenet data took 0.614577054977417 seconds
Then, training+dataloading take 0.6151316165924072 seconds

Epoch: 0
Time of next(dataloader) is: 0.34284186363220215
Time for copying to cuda: 0.0032320022583007812
Time for forward pass: 0.032470703125
Time for backpropagation: 0.0026102066040039062
GPU memory for training: 1.0986590385437012                          

The whole process took 46.48866009712219 seconds
