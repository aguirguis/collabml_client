Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='to_freeze', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 16664.826412600454 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 2184292127.5523667 1505280000.0
All candidates indexes:  (array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  to_freeze 100 17
Intermediate:  0.015625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 350.46142578125 635.2001953125 2386.10595703125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Using split index: 17
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.3316645622253418 seconds
Streaming imagenet data took 1.3384332656860352 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30339598655700684
Time for copying to cuda: 0.004843711853027344
Memory occpied: (1530.0, 394.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.326744556427002 seconds
Streaming imagenet data took 1.3492240905761719 seconds
Memory occpied: (1530.0, 804.0)
Memory occpied: (2001.0, 1242.0)
Time for forward pass: 3.3103983402252197
Time for backpropagation: 0.05208277702331543
GPU memory for training: 0.9570660591125488                          

One training iteration takes: 3.7387585639953613 seconds
Index: 0
Then, training+dataloading take 3.7388341426849365 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3165397644042969
Time for copying to cuda: 0.004422903060913086
Time for forward pass: 0.03268599510192871
Time for backpropagation: 0.0036249160766601562
GPU memory for training: 1.1122322082519531                          

One training iteration takes: 0.43416547775268555 seconds
Index: 1
Memory occpied: (3119.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2764582633972168 seconds
Streaming imagenet data took 1.2831571102142334 seconds
Then, training+dataloading take 1.2837791442871094 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31400322914123535
Time for copying to cuda: 0.004551410675048828
Time for forward pass: 0.0328981876373291
Time for backpropagation: 0.0027418136596679688
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.44542574882507324 seconds
Index: 2
Memory occpied: (3681.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2563536167144775 seconds
Streaming imagenet data took 1.2630484104156494 seconds
Then, training+dataloading take 1.2636351585388184 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.307147741317749
Time for copying to cuda: 0.004601240158081055
Time for forward pass: 0.03117537498474121
Time for backpropagation: 0.0026764869689941406
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4235682487487793 seconds
Index: 3
Memory occpied: (3761.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.3497951030731201 seconds
Streaming imagenet data took 1.3564541339874268 seconds
Then, training+dataloading take 1.3570621013641357 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3096120357513428
Time for copying to cuda: 0.0044803619384765625
Time for forward pass: 0.031186342239379883
Time for backpropagation: 0.002689838409423828
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.42576003074645996 seconds
Index: 4
Memory occpied: (3781.0, 1688.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.1989634037017822 seconds
Streaming imagenet data took 1.2033441066741943 seconds
Then, training+dataloading take 1.2039637565612793 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3287365436553955
Time for copying to cuda: 0.0044097900390625
Time for forward pass: 0.032820701599121094
Time for backpropagation: 0.002886056900024414
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.46222758293151855 seconds
Index: 5
Memory occpied: (3797.0, 2053.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.3331270217895508 seconds
Streaming imagenet data took 1.3375434875488281 seconds
Then, training+dataloading take 1.3381614685058594 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3466796875
Time for copying to cuda: 0.0043985843658447266
Time for forward pass: 0.03215384483337402
Time for backpropagation: 0.002904653549194336
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.46910905838012695 seconds
Index: 6
Memory occpied: (3797.0, 2493.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2815744876861572 seconds
Streaming imagenet data took 1.2859327793121338 seconds
Then, training+dataloading take 1.2865064144134521 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3944108486175537
Time for copying to cuda: 0.004349946975708008
Time for forward pass: 0.03181004524230957
Time for backpropagation: 0.002856016159057617
GPU memory for training: 1.1125984191894531                          

Memory occpied: (3797.0, 2915.0)
One training iteration takes: 0.5195298194885254 seconds
Index: 7
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.208909511566162 seconds
Streaming imagenet data took 1.2130651473999023 seconds
Then, training+dataloading take 1.2135989665985107 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36585164070129395
Time for copying to cuda: 0.004815578460693359
Time for forward pass: 0.041785240173339844
Time for backpropagation: 0.0030863285064697266
GPU memory for training: 1.1125984191894531                          

Memory occpied: (4537.0, 3373.0)
One training iteration takes: 0.49584460258483887 seconds
Index: 8
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.8677940368652344 seconds
Streaming imagenet data took 1.872164011001587 seconds
Then, training+dataloading take 1.8727307319641113 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3114192485809326
Time for copying to cuda: 0.004491567611694336
Time for forward pass: 0.03108835220336914
Time for backpropagation: 0.002720355987548828
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4292471408843994 seconds
Index: 9
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.3725707530975342 seconds
Streaming imagenet data took 1.376993179321289 seconds
Then, training+dataloading take 1.377608060836792 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33670759201049805
Time for copying to cuda: 0.004564046859741211
Time for forward pass: 0.031079769134521484
Time for backpropagation: 0.002675294876098633
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4583885669708252 seconds
Index: 10
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.7889964580535889 seconds
Streaming imagenet data took 1.7932708263397217 seconds
Then, training+dataloading take 1.793870449066162 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43730854988098145
Time for copying to cuda: 0.004559993743896484
Time for forward pass: 0.03095531463623047
Time for backpropagation: 0.0027768611907958984
GPU memory for training: 1.1125984191894531                          

Memory occpied: (4537.0, 3373.0)
One training iteration takes: 0.5508465766906738 seconds
Index: 11
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.7817604541778564 seconds
Memory occpied: (4537.0, 3373.0)
Streaming imagenet data took 1.7860989570617676 seconds
Then, training+dataloading take 1.7866523265838623 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.30648279190063477
Time for copying to cuda: 0.004502534866333008
Time for forward pass: 0.03099799156188965
Time for backpropagation: 0.002750873565673828
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4251396656036377 seconds
Index: 12
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.1309452056884766 seconds
Streaming imagenet data took 2.1351616382598877 seconds
Then, training+dataloading take 2.1357672214508057 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3515033721923828
Time for copying to cuda: 0.004452943801879883
Time for forward pass: 0.03097391128540039
Time for backpropagation: 0.002537965774536133
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.48394203186035156 seconds
Index: 13
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6171400547027588 seconds
Streaming imagenet data took 1.6244423389434814 seconds
Then, training+dataloading take 1.625138521194458 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3456900119781494
Time for copying to cuda: 0.004433870315551758
Time for forward pass: 0.031135082244873047
Time for backpropagation: 0.002614736557006836
GPU memory for training: 1.1125984191894531                          

Memory occpied: (4537.0, 3373.0)
One training iteration takes: 0.4676051139831543 seconds
Index: 14
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.4617722034454346 seconds
Streaming imagenet data took 1.5051953792572021 seconds
Then, training+dataloading take 1.5086686611175537 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3703126907348633
Time for copying to cuda: 0.00461578369140625
Time for forward pass: 0.03105473518371582
Time for backpropagation: 0.002640247344970703
GPU memory for training: 1.1125984191894531                          

Memory occpied: (4537.0, 3373.0)
One training iteration takes: 0.486194372177124 seconds
Index: 15
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.0448713302612305 seconds
Streaming imagenet data took 2.049044370651245 seconds
Then, training+dataloading take 2.049793004989624 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3138599395751953
Time for copying to cuda: 0.0044939517974853516
Time for forward pass: 0.031124591827392578
Time for backpropagation: 0.002713441848754883
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.43572092056274414 seconds
Index: 16
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.630387783050537 seconds
Streaming imagenet data took 2.6347696781158447 seconds
Then, training+dataloading take 2.635390520095825 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3950803279876709
Time for copying to cuda: 0.004513263702392578
Time for forward pass: 0.03142905235290527
Time for backpropagation: 0.0028533935546875
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.514885663986206 seconds
Index: 17
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6510746479034424 seconds
Streaming imagenet data took 1.6591811180114746 seconds
Then, training+dataloading take 1.6599397659301758 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (4537.0, 3373.0)
Time of next(dataloader) is: 0.38553857803344727
Time for copying to cuda: 0.004343986511230469
Time for forward pass: 0.04978346824645996
Time for backpropagation: 0.0034410953521728516
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.5287754535675049 seconds
Index: 18
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.2365727424621582 seconds
Streaming imagenet data took 1.2409846782684326 seconds
Then, training+dataloading take 1.2415969371795654 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3587219715118408
Time for copying to cuda: 0.004628896713256836
Time for forward pass: 0.031126737594604492
Time for backpropagation: 0.0027234554290771484
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4935891628265381 seconds
Index: 19
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.7207684516906738 seconds
Streaming imagenet data took 1.7291629314422607 seconds
Then, training+dataloading take 1.7298853397369385 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (4537.0, 3373.0)
Time of next(dataloader) is: 0.3150599002838135
Time for copying to cuda: 0.0045261383056640625
Time for forward pass: 0.031048059463500977
Time for backpropagation: 0.0027348995208740234
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4277169704437256 seconds
Index: 20
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.6257305145263672 seconds
Streaming imagenet data took 1.6301374435424805 seconds
Then, training+dataloading take 1.6307971477508545 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.31116151809692383
Time for copying to cuda: 0.00457453727722168
Time for forward pass: 0.031087636947631836
Time for backpropagation: 0.0027632713317871094
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.4302074909210205 seconds
Index: 21
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 1.7619552612304688 seconds
Streaming imagenet data took 1.7661898136138916 seconds
Then, training+dataloading take 1.766793966293335 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3510468006134033
Time for copying to cuda: 0.004587650299072266
Time for forward pass: 0.03132963180541992
Time for backpropagation: 0.0027756690979003906
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.49533772468566895 seconds
Index: 22
Memory occpied: (4537.0, 3373.0)
Memory occpied: (4537.0, 3373.0)
Read 15.659677505493164 MBs for this batch
Executing all posts took 2.379241943359375 seconds
Streaming imagenet data took 2.383694887161255 seconds
Then, training+dataloading take 2.384307384490967 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34801244735717773
Time for copying to cuda: 0.004515647888183594
Time for forward pass: 0.06109905242919922
Time for backpropagation: 0.0034317970275878906
GPU memory for training: 1.1125984191894531                          

One training iteration takes: 0.5402085781097412 seconds
Index: 23
Memory occpied: (4537.0, 3373.0)
Read 5.01116943359375 MBs for this batch
Executing all posts took 0.6255893707275391 seconds
Streaming imagenet data took 0.6281633377075195 seconds
Then, training+dataloading take 0.6285808086395264 seconds

Epoch: 0
Time of next(dataloader) is: 0.31328463554382324
Time for copying to cuda: 0.0018568038940429688
Time for forward pass: 0.025977611541748047
Time for backpropagation: 0.0029044151306152344
GPU memory for training: 1.0834174156188965                          

The whole process took 49.28193640708923 seconds
