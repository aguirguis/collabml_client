Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=20, model='densenet121', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (densenet121) till index 20
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Read 252.732816696167 MBs for this batch
Streaming imagenet data took 9.74568796157837 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Memory occpied: (1294.0, 3.0)
Time of next(dataloader) is: 6.476153612136841
Memory occpied: (2444.0, 3.0)
Time for copying to cuda: 0.38442230224609375
Memory occpied: (2444.0, 1036.0)
Memory occpied: (2444.0, 1464.0)
Read 244.98475742340088 MBs for this batch
Streaming imagenet data took 9.456790447235107 seconds
Memory occpied: (5520.0, 11974.0)
Memory occpied: (12556.0, 11974.0)
Memory occpied: (12556.0, 11974.0)
Memory occpied: (14472.0, 13890.0)
Memory occpied: (14472.0, 10300.0)
Memory occpied: (10216.0, 9634.0)
Memory occpied: (14262.0, 13680.0)
Memory occpied: (14862.0, 9784.0)
Memory occpied: (6770.0, 6188.0)
Memory occpied: (6770.0, 6188.0)
Memory occpied: (13594.0, 13012.0)
Memory occpied: (12316.0, 7194.0)
Memory occpied: (10324.0, 9902.0)
Time for forward pass: 19.079281091690063
Time for backpropagation: 0.10580039024353027
GPU memory for training: 22.67752742767334                          

One training iteration takes: 26.267282485961914 seconds
Index: 0
Then, training+dataloading take 26.270146131515503 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (5992.0, 7870.0)
Memory occpied: (5992.0, 7870.0)
Memory occpied: (5992.0, 7870.0)
Memory occpied: (5992.0, 7870.0)
Memory occpied: (5992.0, 7870.0)
Time of next(dataloader) is: 6.706073760986328
Memory occpied: (5992.0, 7870.0)
Time for copying to cuda: 0.356412410736084
Time for forward pass: 0.0921177864074707
Time for backpropagation: 0.9331181049346924
GPU memory for training: 20.449523448944092                          

Memory occpied: (14816.0, 14014.0)
One training iteration takes: 8.362789869308472 seconds
Index: 1
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Read 248.08854579925537 MBs for this batch
Streaming imagenet data took 10.932074785232544 seconds
Then, training+dataloading take 10.947593927383423 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Time of next(dataloader) is: 6.922573566436768
Time for copying to cuda: 0.31015896797180176
Time for forward pass: 0.06653165817260742
Memory occpied: (14816.0, 14014.0)
Time for backpropagation: 0.9154505729675293
GPU memory for training: 20.449218273162842                          

One training iteration takes: 8.469940185546875 seconds
Index: 2
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Read 242.9953956604004 MBs for this batch
Streaming imagenet data took 10.803761720657349 seconds
Then, training+dataloading take 10.819133996963501 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Time of next(dataloader) is: 6.6773693561553955
Time for copying to cuda: 0.30031394958496094
Time for forward pass: 0.06458425521850586
Memory occpied: (14816.0, 14014.0)
Time for backpropagation: 0.9095416069030762
GPU memory for training: 20.449218273162842                          

One training iteration takes: 8.229820489883423 seconds
Index: 3
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Read 252.47015571594238 MBs for this batch
Streaming imagenet data took 11.422388315200806 seconds
Then, training+dataloading take 11.439012050628662 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 6.996286392211914
Time for copying to cuda: 0.3027355670928955
Time for forward pass: 0.06826114654541016
Time for backpropagation: 0.9196681976318359
GPU memory for training: 20.449218273162842                          

Memory occpied: (14816.0, 14014.0)
One training iteration takes: 8.557069778442383 seconds
Index: 4
Memory occpied: (14816.0, 14014.0)
Read 251.06946277618408 MBs for this batch
Streaming imagenet data took 10.355525016784668 seconds
Then, training+dataloading take 10.373236656188965 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Time of next(dataloader) is: 6.991572856903076
Memory occpied: (14816.0, 14014.0)
Time for copying to cuda: 0.374924898147583
Time for forward pass: 0.0642247200012207
Time for backpropagation: 0.9249575138092041
GPU memory for training: 20.449218273162842                          

One training iteration takes: 8.645216464996338 seconds
Index: 5
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Read 260.5531940460205 MBs for this batch
Streaming imagenet data took 12.364871263504028 seconds
Then, training+dataloading take 12.392948865890503 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Time of next(dataloader) is: 7.007196664810181
Memory occpied: (14816.0, 14014.0)
Time for copying to cuda: 0.2934880256652832
Time for forward pass: 0.06380891799926758
Time for backpropagation: 0.9274342060089111
GPU memory for training: 20.449218273162842                          

One training iteration takes: 8.515084266662598 seconds
Index: 6
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Read 260.36000633239746 MBs for this batch
Streaming imagenet data took 11.554152011871338 seconds
Then, training+dataloading take 11.57652473449707 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Time of next(dataloader) is: 6.959547758102417
Time for copying to cuda: 0.297680139541626
Time for forward pass: 0.06476116180419922
Memory occpied: (14816.0, 14014.0)
Time for backpropagation: 0.9132645130157471
GPU memory for training: 20.449218273162842                          

One training iteration takes: 8.539777755737305 seconds
Index: 7
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Read 261.12704849243164 MBs for this batch
Streaming imagenet data took 12.222959756851196 seconds
Then, training+dataloading take 12.23943829536438 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Time of next(dataloader) is: 7.206259489059448
Time for copying to cuda: 0.30134105682373047
Time for forward pass: 0.06680512428283691
Memory occpied: (14816.0, 14014.0)
Time for backpropagation: 0.9088578224182129
GPU memory for training: 20.449218273162842                          

One training iteration takes: 8.823196172714233 seconds
Index: 8
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Read 260.28413105010986 MBs for this batch
Streaming imagenet data took 11.751742362976074 seconds
Then, training+dataloading take 11.770557165145874 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 7.244433879852295
Time for copying to cuda: 0.2973182201385498
Time for forward pass: 0.0653378963470459
Time for backpropagation: 0.926044225692749
GPU memory for training: 20.449218273162842                          

One training iteration takes: 8.768813848495483 seconds
Index: 9
Memory occpied: (14816.0, 14014.0)
Read 248.79518508911133 MBs for this batch
Streaming imagenet data took 10.029041528701782 seconds
Then, training+dataloading take 10.062766075134277 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 7.138281345367432
Time for copying to cuda: 0.3023033142089844
Time for forward pass: 0.06609749794006348
Time for backpropagation: 0.9051499366760254
GPU memory for training: 20.449218273162842                          

Memory occpied: (14816.0, 14014.0)
One training iteration takes: 8.731100082397461 seconds
Index: 10
Memory occpied: (14816.0, 14014.0)
Read 257.3747863769531 MBs for this batch
Streaming imagenet data took 10.468494892120361 seconds
Then, training+dataloading take 10.488286256790161 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Read 41.159770011901855 MBs for this batch
Streaming imagenet data took 2.2261698246002197 seconds
Time of next(dataloader) is: 6.977095127105713
Time for copying to cuda: 0.2889838218688965
Time for forward pass: 0.05545353889465332
Time for backpropagation: 0.9203081130981445
GPU memory for training: 20.449218273162842                          

One training iteration takes: 8.48175859451294 seconds
Index: 11
Then, training+dataloading take 8.507104396820068 seconds

Epoch: 0
Memory occpied: (14816.0, 14014.0)
Memory occpied: (14816.0, 14014.0)
Time of next(dataloader) is: 1.6676380634307861
Time for copying to cuda: 0.29605579376220703
Memory occpied: (5554.0, 6460.0)
Memory occpied: (5838.0, 2450.0)
Time for forward pass: 3.2159595489501953
Time for backpropagation: 0.019124984741210938
GPU memory for training: 7.3970441818237305                          

Memory occpied: (4092.0, 1922.0)
The whole process took 167.9702184200287 seconds
