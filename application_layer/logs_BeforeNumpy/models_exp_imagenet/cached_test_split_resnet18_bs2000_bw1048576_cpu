Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='myresnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.4738939022976 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.211264e+06 3.211264e+06 3.211264e+06 8.028160e+05 4.816896e+06
 4.816896e+06 2.408448e+06 2.408448e+06 1.204224e+06 1.204224e+06
 6.021120e+05 6.021120e+05 2.048000e+03 4.000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119075490.22156195 119075490.22156195
All candidates indexes:  (array([12, 13]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 11
Intermediate:  0.095703125
6.125
Total layers size  27.185455322265625
Server, client, server+client, vanilla  167.48046875 597.2900390625 764.7705078125 13804.3212890625
Fixed, scale_with_bsz  0 6.69921875
Mem usage  1250.0 3.0
Using split index: 11
Freezing the lower layers of the model (myresnet18) till index 11
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8920791149139404 seconds
Streaming imagenet data took 3.9634106159210205 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3560800552368164
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.2647719383239746
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.087724685668945 seconds
Streaming imagenet data took 4.1821348667144775 seconds
Time for backpropagation: 2.7952187061309814
One training iteration takes: 4.498771667480469 seconds
Index: 0
Then, training+dataloading take 4.499282598495483 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3843879699707031
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 1.1848104000091553
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.7386634349823 seconds
Streaming imagenet data took 3.833432912826538 seconds
Time for backpropagation: 2.4473206996917725
One training iteration takes: 4.134644508361816 seconds
Index: 1
Then, training+dataloading take 4.134957313537598 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.37575745582580566
Time for copying to cuda: 7.867813110351562e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3331375122070312
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.8374600410461426 seconds
Streaming imagenet data took 4.00419020652771 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.6750707626342773
One training iteration takes: 4.491236925125122 seconds
Index: 2
Then, training+dataloading take 4.495344161987305 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3827493190765381
Time for copying to cuda: 8.106231689453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3352110385894775
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.126291036605835 seconds
Streaming imagenet data took 4.221441745758057 seconds
Time for backpropagation: 2.8276970386505127
One training iteration takes: 4.649193525314331 seconds
Index: 3
Then, training+dataloading take 4.649697780609131 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4148099422454834
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 1.154191493988037
Read 191.49612617492676 MBs for this batch
Executing all posts took 3.91439151763916 seconds
Streaming imagenet data took 4.005304336547852 seconds
Time for backpropagation: 2.605510950088501
One training iteration takes: 4.30473780632019 seconds
Index: 4
Then, training+dataloading take 4.305776834487915 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.38744664192199707
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3160645961761475
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.500267505645752 seconds
Time for backpropagation: 2.8230860233306885
Streaming imagenet data took 4.586253881454468 seconds
One training iteration takes: 4.6372363567352295 seconds
Index: 5
Then, training+dataloading take 4.6439642906188965 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37648963928222656
Time for copying to cuda: 7.3909759521484375e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3066246509552002
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.125340461730957 seconds
Streaming imagenet data took 4.219424724578857 seconds
Time for backpropagation: 2.7854411602020264
One training iteration takes: 4.581851482391357 seconds
Index: 6
Then, training+dataloading take 4.582367897033691 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3877229690551758
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.284198522567749
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.279918670654297 seconds
Streaming imagenet data took 4.366840600967407 seconds
Time for backpropagation: 2.8285768032073975
One training iteration takes: 4.623544216156006 seconds
Index: 7
Then, training+dataloading take 4.6259706020355225 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4181349277496338
Time for copying to cuda: 7.152557373046875e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3296003341674805
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.131706237792969 seconds
Streaming imagenet data took 4.300955295562744 seconds
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.848766565322876
One training iteration takes: 4.700926065444946 seconds
Index: 8
Then, training+dataloading take 4.701467752456665 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39215755462646484
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.3058879375457764
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.158898591995239 seconds
Streaming imagenet data took 4.2541279792785645 seconds
Time for backpropagation: 2.7570087909698486
One training iteration takes: 4.561537981033325 seconds
Index: 9
Then, training+dataloading take 4.567716360092163 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.428117036819458
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 1.1371941566467285
Read 191.49612617492676 MBs for this batch
Executing all posts took 4.065299034118652 seconds
Streaming imagenet data took 4.153544187545776 seconds
Time for backpropagation: 2.7043168544769287
One training iteration takes: 4.382818937301636 seconds
Index: 10
Then, training+dataloading take 4.385185956954956 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.385286808013916
Time for copying to cuda: 7.152557373046875e-06
Read 30.639458656311035 MBs for this batch
Executing all posts took 1.231794834136963 seconds
Streaming imagenet data took 1.249863624572754 seconds
Memory occpied: (1250.0, 3.0)
Time for forward pass: 1.5152411460876465
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 2.450763702392578
One training iteration takes: 4.448124170303345 seconds
Index: 11
Then, training+dataloading take 4.448662519454956 seconds

Epoch: 0
Time of next(dataloader) is: 0.2715024948120117
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.2079455852508545
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.47526073455810547
The whole process took 66.05340886116028 seconds
