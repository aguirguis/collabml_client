Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='resnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet18) till index 11
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Read 252.732816696167 MBs for this batch
Streaming imagenet data took 10.14719295501709 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 6.43107795715332
Time for copying to cuda: 0.2898094654083252
Read 244.98475742340088 MBs for this batch
Streaming imagenet data took 8.661505937576294 seconds
Time for forward pass: 8.0760977268219
Time for backpropagation: 1.5035314559936523
GPU memory for training: 21.49008321762085                          

One training iteration takes: 16.534040212631226 seconds
Index: 0
Then, training+dataloading take 16.537107467651367 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (1312.0, 8418.0)
Memory occpied: (3686.0, 8418.0)
Memory occpied: (3686.0, 8418.0)
Memory occpied: (3686.0, 8418.0)
Memory occpied: (3686.0, 8418.0)
Memory occpied: (3686.0, 8418.0)
Time of next(dataloader) is: 6.6372551918029785
Time for copying to cuda: 0.3001596927642822
Time for forward pass: 0.044661521911621094
Time for backpropagation: 0.0059430599212646484
GPU memory for training: 14.172714710235596                          

One training iteration takes: 7.247320890426636 seconds
Index: 1
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 248.08854579925537 MBs for this batch
Streaming imagenet data took 10.347564458847046 seconds
Then, training+dataloading take 10.36231517791748 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 6.664034605026245
Time for copying to cuda: 0.30028247833251953
Time for forward pass: 0.04038405418395996
Time for backpropagation: 0.007191658020019531
GPU memory for training: 14.172714710235596                          

One training iteration takes: 7.218544244766235 seconds
Index: 2
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 242.9953956604004 MBs for this batch
Streaming imagenet data took 10.452771186828613 seconds
Then, training+dataloading take 10.467628479003906 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 6.7113587856292725
Time for copying to cuda: 0.29953861236572266
Time for forward pass: 0.03164482116699219
Time for backpropagation: 0.06818985939025879
GPU memory for training: 14.172714710235596                          

One training iteration takes: 7.353147268295288 seconds
Index: 3
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 252.47015571594238 MBs for this batch
Streaming imagenet data took 10.934811115264893 seconds
Then, training+dataloading take 10.951002836227417 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 6.863062620162964
Time for copying to cuda: 0.30486035346984863
Time for forward pass: 0.04480624198913574
Time for backpropagation: 0.006275177001953125
GPU memory for training: 14.172714710235596                          

One training iteration takes: 7.447779417037964 seconds
Index: 4
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 251.06946277618408 MBs for this batch
Streaming imagenet data took 9.740164041519165 seconds
Then, training+dataloading take 9.757360935211182 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 6.950746059417725
Time for copying to cuda: 0.3057560920715332
Time for forward pass: 0.03112316131591797
Time for backpropagation: 0.0057528018951416016
GPU memory for training: 14.172714710235596                          

Memory occpied: (9830.0, 11498.0)
One training iteration takes: 7.610380172729492 seconds
Index: 5
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 260.5531940460205 MBs for this batch
Streaming imagenet data took 10.881868600845337 seconds
Then, training+dataloading take 10.899616479873657 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 7.207582712173462
Time for copying to cuda: 0.3009219169616699
Time for forward pass: 0.03327202796936035
Time for backpropagation: 0.007910966873168945
GPU memory for training: 14.172714710235596                          

One training iteration takes: 7.811397075653076 seconds
Index: 6
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 260.36000633239746 MBs for this batch
Streaming imagenet data took 11.260368585586548 seconds
Then, training+dataloading take 11.280250072479248 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 6.795456647872925
Time for copying to cuda: 0.3633911609649658
Time for forward pass: 0.03180885314941406
Time for backpropagation: 0.005234718322753906
GPU memory for training: 14.172714710235596                          

One training iteration takes: 7.481321573257446 seconds
Index: 7
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 261.12704849243164 MBs for this batch
Streaming imagenet data took 11.459997177124023 seconds
Then, training+dataloading take 11.48890209197998 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 7.154570579528809
Time for copying to cuda: 0.30602312088012695
Time for forward pass: 0.039188385009765625
Time for backpropagation: 0.0049591064453125
GPU memory for training: 14.172714710235596                          

Memory occpied: (9830.0, 11498.0)
One training iteration takes: 7.775781631469727 seconds
Index: 8
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 260.28413105010986 MBs for this batch
Streaming imagenet data took 10.599574089050293 seconds
Then, training+dataloading take 10.617457151412964 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 6.806551933288574
Time for copying to cuda: 0.2972598075866699
Time for forward pass: 0.03224015235900879
Time for backpropagation: 0.005357980728149414
GPU memory for training: 14.172714710235596                          

One training iteration takes: 7.435022592544556 seconds
Index: 9
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 248.79518508911133 MBs for this batch
Streaming imagenet data took 10.677200317382812 seconds
Then, training+dataloading take 10.696070194244385 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 6.845814943313599
Time for copying to cuda: 0.2890350818634033
Time for forward pass: 0.029818058013916016
Time for backpropagation: 0.005730152130126953
GPU memory for training: 14.172714710235596                          

One training iteration takes: 7.446264743804932 seconds
Index: 10
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Read 257.3747863769531 MBs for this batch
Streaming imagenet data took 11.36414623260498 seconds
Then, training+dataloading take 11.384962797164917 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Read 41.159770011901855 MBs for this batch
Streaming imagenet data took 2.225978374481201 seconds
Time of next(dataloader) is: 6.9238035678863525
Time for copying to cuda: 0.28902220726013184
Time for forward pass: 0.027060747146606445
Time for backpropagation: 0.004273176193237305
GPU memory for training: 14.172714710235596                          

One training iteration takes: 7.480564832687378 seconds
Index: 11
Then, training+dataloading take 7.50325870513916 seconds

Epoch: 0
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Memory occpied: (9830.0, 11498.0)
Time of next(dataloader) is: 1.611908197402954
Time for copying to cuda: 0.047548532485961914
Time for forward pass: 0.9139604568481445
Memory occpied: (5468.0, 1882.0)
Time for backpropagation: 0.2872049808502197
GPU memory for training: 3.986402988433838                          

The whole process took 150.6640214920044 seconds
