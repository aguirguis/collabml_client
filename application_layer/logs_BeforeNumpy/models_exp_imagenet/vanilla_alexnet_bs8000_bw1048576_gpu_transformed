Namespace(batch_size=8000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 8000, post_step 1000

Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Read 1231.3178148269653 MBs for this batch
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Streaming imagenet data took 34.501018047332764 seconds
The mode is:  vanilla
Start 8000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (1494.0, 3.0)
Memory occpied: (1494.0, 3.0)
Time of next(dataloader) is: 3.052694797515869
Memory occpied: (6088.0, 3.0)
Time for copying to cuda: 1.368443250656128
Memory occpied: (6088.0, 18.0)
Memory occpied: (6088.0, 2768.0)
Memory occpied: (6088.0, 3160.0)
Memory occpied: (6088.0, 3516.0)
Memory occpied: (12166.0, 9708.0)
Memory occpied: (12166.0, 9708.0)
Memory occpied: (12012.0, 9708.0)
Memory occpied: (9056.0, 14010.0)
Memory occpied: (9056.0, 14010.0)
Memory occpied: (9056.0, 14010.0)
Memory occpied: (9056.0, 14010.0)
Memory occpied: (14506.0, 11054.0)
Memory occpied: (14506.0, 11054.0)
Memory occpied: (14506.0, 11054.0)
Time for forward pass: 17.47762370109558
Memory occpied: (14506.0, 6760.0)
Time for backpropagation: 0.28275203704833984
GPU memory for training: 19.97019052505493                          

One training iteration takes: 22.73024892807007 seconds
Index: 0
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Read 1233.9197416305542 MBs for this batch
Memory occpied: (14514.0, 6760.0)
Streaming imagenet data took 34.64105010032654 seconds
Then, training+dataloading take 34.70890522003174 seconds
The mode is:  vanilla
Start 16000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (14514.0, 6760.0)
Memory occpied: (14514.0, 6760.0)
Time of next(dataloader) is: 3.314310073852539
Memory occpied: (14514.0, 6760.0)
Time for copying to cuda: 1.36372971534729
Time for forward pass: 0.029146909713745117
Time for backpropagation: 0.004938602447509766
GPU memory for training: 20.09377908706665                          

Memory occpied: (14514.0, 14026.0)
One training iteration takes: 5.323165655136108 seconds
Index: 1
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Read 1228.6364126205444 MBs for this batch
Memory occpied: (14522.0, 14026.0)
Memory occpied: (14522.0, 14026.0)
Streaming imagenet data took 36.333961725234985 seconds
Then, training+dataloading take 36.40521574020386 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Memory occpied: (14522.0, 14026.0)
Read 49.485840797424316 MBs for this batch
Streaming imagenet data took 1.9877264499664307 seconds
Memory occpied: (14522.0, 14026.0)
Time of next(dataloader) is: 3.234924554824829
Memory occpied: (14522.0, 14026.0)
Time for copying to cuda: 1.2793595790863037
Time for forward pass: 0.005756378173828125
Time for backpropagation: 0.002916097640991211
GPU memory for training: 20.09377908706665                          

One training iteration takes: 5.1080193519592285 seconds
Index: 2
Then, training+dataloading take 5.117908477783203 seconds

Epoch: 0
Time of next(dataloader) is: 0.6487212181091309
Time for copying to cuda: 0.32723379135131836
Time for forward pass: 0.48373889923095703
Time for backpropagation: 0.0026497840881347656
GPU memory for training: 2.636568069458008                          

Memory occpied: (14522.0, 3812.0)
The whole process took 118.6407105922699 seconds
