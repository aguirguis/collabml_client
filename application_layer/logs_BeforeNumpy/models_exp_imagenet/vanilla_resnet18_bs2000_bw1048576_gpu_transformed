Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=11, model='resnet18', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (resnet18) till index 11
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Memory occpied: (1312.0, 3.0)
Read 308.89431381225586 MBs for this batch
Memory occpied: (1312.0, 3.0)
Streaming imagenet data took 10.587863445281982 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8978211879730225
Memory occpied: (2462.0, 3.0)
Time for copying to cuda: 0.34584569931030273
Memory occpied: (2462.0, 1032.0)
Memory occpied: (2462.0, 1422.0)
Memory occpied: (5572.0, 12004.0)
Memory occpied: (12574.0, 12004.0)
Memory occpied: (5538.0, 4968.0)
Memory occpied: (6738.0, 6168.0)
Read 306.5873851776123 MBs for this batch
Streaming imagenet data took 8.778743505477905 seconds
Memory occpied: (9012.0, 12174.0)
Time for forward pass: 8.45470643043518
Memory occpied: (9020.0, 8416.0)
Time for backpropagation: 1.5135533809661865
GPU memory for training: 21.49008321762085                          

One training iteration takes: 11.382230758666992 seconds
Index: 0
Then, training+dataloading take 11.384812116622925 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (9024.0, 2484.0)
Time of next(dataloader) is: 1.0343708992004395
Time for copying to cuda: 0.3011157512664795
Time for forward pass: 0.05551648139953613
Time for backpropagation: 0.0051157474517822266
GPU memory for training: 14.57456922531128                          

One training iteration takes: 1.5532338619232178 seconds
Index: 1
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 309.1082601547241 MBs for this batch
Streaming imagenet data took 9.847524881362915 seconds
Then, training+dataloading take 9.89786148071289 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 12102.0)
Time of next(dataloader) is: 0.9815647602081299
Time for copying to cuda: 0.3094463348388672
Time for forward pass: 0.03128957748413086
Time for backpropagation: 0.0053980350494384766
GPU memory for training: 14.57456922531128                          

One training iteration takes: 1.5212607383728027 seconds
Index: 2
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 306.72785568237305 MBs for this batch
Streaming imagenet data took 9.727929592132568 seconds
Then, training+dataloading take 9.761308670043945 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 12102.0)
Time of next(dataloader) is: 1.0143587589263916
Time for copying to cuda: 0.3056364059448242
Time for forward pass: 0.03010416030883789
Time for backpropagation: 0.005404233932495117
GPU memory for training: 14.57456922531128                          

One training iteration takes: 1.551055908203125 seconds
Index: 3
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 308.3348731994629 MBs for this batch
Streaming imagenet data took 9.812200546264648 seconds
Then, training+dataloading take 9.833214282989502 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 12102.0)
Time of next(dataloader) is: 1.0396735668182373
Time for copying to cuda: 0.30686044692993164
Time for forward pass: 0.031141996383666992
Time for backpropagation: 0.0056264400482177734
GPU memory for training: 14.57456922531128                          

One training iteration takes: 1.5866057872772217 seconds
Index: 4
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 308.5798740386963 MBs for this batch
Streaming imagenet data took 9.148664951324463 seconds
Then, training+dataloading take 9.171388387680054 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1101229190826416
Time for copying to cuda: 0.29740142822265625
Time for forward pass: 0.030920982360839844
Time for backpropagation: 0.0051882266998291016
GPU memory for training: 14.57456922531128                          

Memory occpied: (12104.0, 12102.0)
One training iteration takes: 1.6458408832550049 seconds
Index: 5
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 308.1223955154419 MBs for this batch
Streaming imagenet data took 8.846115112304688 seconds
Then, training+dataloading take 8.872430086135864 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0722405910491943
Time for copying to cuda: 0.3206636905670166
Time for forward pass: 0.03144240379333496
Time for backpropagation: 0.006016254425048828
GPU memory for training: 14.57456922531128                          

Memory occpied: (12104.0, 12102.0)
One training iteration takes: 1.6831376552581787 seconds
Index: 6
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 308.8825988769531 MBs for this batch
Streaming imagenet data took 9.792238712310791 seconds
Then, training+dataloading take 9.813672065734863 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0862443447113037
Time for copying to cuda: 0.3006422519683838
Time for forward pass: 0.029858827590942383
Time for backpropagation: 0.00517582893371582
GPU memory for training: 14.57456922531128                          

One training iteration takes: 1.5965607166290283 seconds
Index: 7
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 306.2924919128418 MBs for this batch
Streaming imagenet data took 8.878079414367676 seconds
Then, training+dataloading take 8.902392625808716 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.0833024978637695
Time for copying to cuda: 0.3043043613433838
Time for forward pass: 0.03148484230041504
Time for backpropagation: 0.005194902420043945
GPU memory for training: 14.57456922531128                          

One training iteration takes: 1.5720205307006836 seconds
Index: 8
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 308.42155838012695 MBs for this batch
Memory occpied: (12104.0, 12102.0)
Streaming imagenet data took 9.315401077270508 seconds
Then, training+dataloading take 9.336645603179932 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1152691841125488
Memory occpied: (12104.0, 12102.0)
Time for copying to cuda: 0.3103954792022705
Time for forward pass: 0.06210517883300781
Time for backpropagation: 0.0054094791412353516
GPU memory for training: 14.57456922531128                          

One training iteration takes: 1.6962573528289795 seconds
Index: 9
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 304.9983148574829 MBs for this batch
Streaming imagenet data took 9.566207647323608 seconds
Then, training+dataloading take 9.587753057479858 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (12104.0, 12102.0)
Time of next(dataloader) is: 1.0918512344360352
Time for copying to cuda: 0.305217981338501
Time for forward pass: 0.030744314193725586
Time for backpropagation: 0.005940437316894531
GPU memory for training: 14.57456922531128                          

One training iteration takes: 1.6584835052490234 seconds
Index: 10
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Memory occpied: (12104.0, 12102.0)
Read 308.9240474700928 MBs for this batch
Memory occpied: (12104.0, 12102.0)
Streaming imagenet data took 9.693050146102905 seconds
Then, training+dataloading take 9.714709997177124 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.1331090927124023
Memory occpied: (12104.0, 12102.0)
Time for copying to cuda: 0.309248685836792
Time for forward pass: 0.0327143669128418
Time for backpropagation: 0.005735158920288086
GPU memory for training: 14.57456922531128                          

One training iteration takes: 1.6999843120574951 seconds
Index: 11
Read 49.485840797424316 MBs for this batch
Streaming imagenet data took 2.076965093612671 seconds
Then, training+dataloading take 2.081695079803467 seconds

Epoch: 0
Time of next(dataloader) is: 0.5739188194274902
Time for copying to cuda: 0.0482630729675293
Time for forward pass: 0.8429532051086426
Time for backpropagation: 0.2547750473022461
GPU memory for training: 3.986402988433838                          

Memory occpied: (12104.0, 2500.0)
The whole process took 126.6602954864502 seconds
