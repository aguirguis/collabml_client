Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=36, model='myvgg19', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 908.2587490736968 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [1.2845056e+07 1.2845056e+07 1.2845056e+07 1.2845056e+07 3.2112640e+06
 6.4225280e+06 6.4225280e+06 6.4225280e+06 6.4225280e+06 1.6056320e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06 3.2112640e+06
 3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.6056320e+06
 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06 1.6056320e+06
 1.6056320e+06 1.6056320e+06 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05 4.0140800e+05
 4.0140800e+05 1.0035200e+05 1.0035200e+05 1.6384000e+04 1.6384000e+04
 1.6384000e+04 1.6384000e+04 1.6384000e+04 1.6384000e+04 4.0000000e+03]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
350755662506666.6 119047290.75858758 119047290.75858758
All candidates indexes:  (array([38, 39, 40, 41, 42, 43, 44]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  automatic 100 36
Intermediate:  0.3828125
24.5
Total layers size  119.34365844726562
Server, client, server+client, vanilla  1175.2783203125 4001.181640625 5176.4599609375 53383.994140625
Fixed, scale_with_bsz  0 25.07421875
Mem usage  1894.0 3.0
Using split index: 28
Freezing the lower layers of the model (myvgg19) till index 36
The mode is:  split
Start 0, end 2000, post_step 1000

Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Memory occpied: (1894.0, 3.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.882039785385132 seconds
Streaming imagenet data took 19.171478748321533 seconds
The mode is:  split
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.6969308853149414
Memory occpied: (2660.0, 3.0)
Time for copying to cuda: 0.22371578216552734
Memory occpied: (2660.0, 838.0)
Memory occpied: (2660.0, 1254.0)
Memory occpied: (8408.0, 7926.0)
Memory occpied: (8408.0, 7926.0)
Time for forward pass: 5.494779825210571
Time for backpropagation: 0.06709957122802734
GPU memory for training: 13.368073463439941                          

One training iteration takes: 6.66728663444519 seconds
Index: 0
Memory occpied: (8368.0, 6016.0)
Memory occpied: (8368.0, 6016.0)
Memory occpied: (8368.0, 6016.0)
Memory occpied: (8368.0, 6016.0)
Memory occpied: (8368.0, 6016.0)
Memory occpied: (8368.0, 6016.0)
Memory occpied: (8368.0, 6016.0)
Memory occpied: (8368.0, 6016.0)
Memory occpied: (8368.0, 6016.0)
Memory occpied: (8368.0, 6016.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.649248123168945 seconds
Memory occpied: (8368.0, 6016.0)
Streaming imagenet data took 18.984509706497192 seconds
Then, training+dataloading take 19.020368337631226 seconds
The mode is:  split
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7453124523162842
Time for copying to cuda: 0.2668881416320801
Memory occpied: (8368.0, 6016.0)
Time for forward pass: 0.5816974639892578
Time for backpropagation: 0.004120826721191406
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.758392333984375 seconds
Index: 1
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.77216124534607 seconds
Memory occpied: (8376.0, 6024.0)
Streaming imagenet data took 19.153270721435547 seconds
Then, training+dataloading take 19.190919160842896 seconds
The mode is:  split
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7507014274597168
Time for copying to cuda: 0.2300255298614502
Memory occpied: (8376.0, 6024.0)
Time for forward pass: 0.5739595890045166
Time for backpropagation: 0.004181385040283203
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7154698371887207 seconds
Index: 2
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.68237853050232 seconds
Streaming imagenet data took 19.01885223388672 seconds
Then, training+dataloading take 19.051973581314087 seconds
The mode is:  split
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7847447395324707
Time for copying to cuda: 0.19545245170593262
Time for forward pass: 0.5810971260070801
Time for backpropagation: 0.004399538040161133
GPU memory for training: 7.951027870178223                          

Memory occpied: (8376.0, 6024.0)
One training iteration takes: 1.7304837703704834 seconds
Index: 3
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.88002371788025 seconds
Streaming imagenet data took 19.166776418685913 seconds
Then, training+dataloading take 19.202698230743408 seconds
The mode is:  split
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (8376.0, 6024.0)
Time of next(dataloader) is: 0.751636266708374
Time for copying to cuda: 0.19616985321044922
Time for forward pass: 0.5428283214569092
Time for backpropagation: 0.0042955875396728516
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.651993751525879 seconds
Index: 4
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.798437356948853 seconds
Memory occpied: (8376.0, 6024.0)
Streaming imagenet data took 19.177165985107422 seconds
Then, training+dataloading take 19.21331262588501 seconds
The mode is:  split
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.748591423034668
Time for copying to cuda: 0.26467204093933105
Memory occpied: (8376.0, 6024.0)
Time for forward pass: 0.5485260486602783
Time for backpropagation: 0.004174947738647461
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7301726341247559 seconds
Index: 5
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.798377990722656 seconds
Memory occpied: (8376.0, 6024.0)
Streaming imagenet data took 19.172284603118896 seconds
Then, training+dataloading take 19.20867896080017 seconds
The mode is:  split
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7485723495483398
Time for copying to cuda: 0.1965787410736084
Memory occpied: (8376.0, 6024.0)
Time for forward pass: 0.5918996334075928
Time for backpropagation: 0.004499197006225586
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7003114223480225 seconds
Index: 6
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.703664779663086 seconds
Streaming imagenet data took 19.040570974349976 seconds
Then, training+dataloading take 19.060413599014282 seconds
The mode is:  split
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.8088102340698242
Time for copying to cuda: 0.19486379623413086
Time for forward pass: 0.5796284675598145
Time for backpropagation: 0.004135608673095703
GPU memory for training: 7.951027870178223                          

Memory occpied: (8376.0, 6024.0)
One training iteration takes: 1.7538785934448242 seconds
Index: 7
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.496726751327515 seconds
Memory occpied: (8376.0, 6024.0)
Streaming imagenet data took 18.878309965133667 seconds
Then, training+dataloading take 18.91496706008911 seconds
The mode is:  split
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7457711696624756
Time for copying to cuda: 0.2650878429412842
Memory occpied: (8376.0, 6024.0)
Time for forward pass: 0.556922435760498
Time for backpropagation: 0.004125118255615234
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.740790843963623 seconds
Index: 8
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.80820918083191 seconds
Memory occpied: (8376.0, 6024.0)
Streaming imagenet data took 19.188608646392822 seconds
Then, training+dataloading take 19.225024700164795 seconds
The mode is:  split
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7518742084503174
Time for copying to cuda: 0.22887468338012695
Memory occpied: (8376.0, 6024.0)
Time for forward pass: 0.5896666049957275
Time for backpropagation: 0.004177093505859375
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7341833114624023 seconds
Index: 9
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.689146518707275 seconds
Streaming imagenet data took 19.020146131515503 seconds
Then, training+dataloading take 19.039769887924194 seconds
The mode is:  split
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Time of next(dataloader) is: 0.7894594669342041
Time for copying to cuda: 0.1944115161895752
Memory occpied: (8376.0, 6024.0)
Time for forward pass: 0.5963096618652344
Time for backpropagation: 0.004276275634765625
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7459213733673096 seconds
Index: 10
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 765.7148761749268 MBs for this batch
Executing all posts took 18.422306299209595 seconds
Memory occpied: (8376.0, 6024.0)
Streaming imagenet data took 18.79259729385376 seconds
Then, training+dataloading take 18.829269409179688 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.7498123645782471
Time for copying to cuda: 0.2637333869934082
Memory occpied: (8376.0, 6024.0)
Time for forward pass: 0.5957584381103516
Time for backpropagation: 0.0040891170501708984
GPU memory for training: 7.951027870178223                          

One training iteration takes: 1.7741856575012207 seconds
Index: 11
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Memory occpied: (8376.0, 6024.0)
Read 122.51445865631104 MBs for this batch
Executing all posts took 4.8815155029296875 seconds
Streaming imagenet data took 4.927807807922363 seconds
Then, training+dataloading take 4.9355247020721436 seconds

Epoch: 0
Time of next(dataloader) is: 0.36666011810302734
Time for copying to cuda: 0.03171086311340332
Memory occpied: (8376.0, 3988.0)
Time for forward pass: 0.542823076248169
Time for backpropagation: 0.003991603851318359
GPU memory for training: 5.746119976043701                          

The whole process took 244.07136797904968 seconds
