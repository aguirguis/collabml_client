Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=9, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 16474.06680909101 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 2159288884.801177 1505280000.0
All candidates indexes:  (array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 9 17
Intermediate:  0.1650390625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 829.95361328125 1114.6923828125 2716.18408203125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  1514.0 3.0
Using split index: 9
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (1514.0, 3.0)
Memory occpied: (1514.0, 3.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7383670806884766 seconds
Streaming imagenet data took 1.7995219230651855 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3561668395996094
Time for copying to cuda: 0.0428926944732666
Memory occpied: (1680.0, 236.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8716540336608887 seconds
Streaming imagenet data took 1.9781579971313477 seconds
Memory occpied: (1680.0, 718.0)
Memory occpied: (1680.0, 1142.0)
Time for forward pass: 3.66606068611145
Time for backpropagation: 0.05083179473876953
GPU memory for training: 3.466838836669922                          

One training iteration takes: 4.18734884262085 seconds
Index: 0
Then, training+dataloading take 4.187804460525513 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4321770668029785
Time for copying to cuda: 0.04316091537475586
Time for forward pass: 0.05241799354553223
Time for backpropagation: 0.002682209014892578
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6296737194061279 seconds
Index: 1
Memory occpied: (2204.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8315792083740234 seconds
Streaming imagenet data took 1.8951997756958008 seconds
Then, training+dataloading take 1.9070558547973633 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (2794.0, 3018.0)
Time of next(dataloader) is: 0.44127440452575684
Time for copying to cuda: 0.043054819107055664
Time for forward pass: 0.07589077949523926
Time for backpropagation: 0.0026946067810058594
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6533353328704834 seconds
Index: 2
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8400161266326904 seconds
Streaming imagenet data took 1.9021210670471191 seconds
Then, training+dataloading take 1.9107379913330078 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40108799934387207
Time for copying to cuda: 0.07769250869750977
Time for forward pass: 0.0846099853515625
Time for backpropagation: 0.0032138824462890625
GPU memory for training: 2.005207061767578                          

Memory occpied: (2794.0, 3018.0)
One training iteration takes: 0.673846960067749 seconds
Index: 3
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.6435606479644775 seconds
Streaming imagenet data took 1.744896411895752 seconds
Then, training+dataloading take 1.7563228607177734 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (2794.0, 3018.0)
Time of next(dataloader) is: 0.44198036193847656
Time for copying to cuda: 0.04279637336730957
Time for forward pass: 0.07585811614990234
Time for backpropagation: 0.0027256011962890625
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6691339015960693 seconds
Index: 4
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7145650386810303 seconds
Streaming imagenet data took 1.7767136096954346 seconds
Then, training+dataloading take 1.7873799800872803 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4041721820831299
Time for copying to cuda: 0.04272103309631348
Time for forward pass: 0.07617902755737305
Time for backpropagation: 0.002703428268432617
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6224105358123779 seconds
Index: 5
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7525079250335693 seconds
Streaming imagenet data took 1.8529601097106934 seconds
Then, training+dataloading take 1.8605406284332275 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (2794.0, 3018.0)
Time of next(dataloader) is: 0.45285677909851074
Time for copying to cuda: 0.042600154876708984
Time for forward pass: 0.07620930671691895
Time for backpropagation: 0.0026962757110595703
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6699297428131104 seconds
Index: 6
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.6159656047821045 seconds
Streaming imagenet data took 1.6776602268218994 seconds
Then, training+dataloading take 1.6878821849822998 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41045475006103516
Time for copying to cuda: 0.04292654991149902
Time for forward pass: 0.07572650909423828
Time for backpropagation: 0.0026748180389404297
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6345632076263428 seconds
Index: 7
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.829418420791626 seconds
Streaming imagenet data took 1.8913202285766602 seconds
Then, training+dataloading take 1.902151107788086 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44397830963134766
Time for copying to cuda: 0.04299426078796387
Time for forward pass: 0.07588481903076172
Time for backpropagation: 0.002696514129638672
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6804413795471191 seconds
Index: 8
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.901843786239624 seconds
Streaming imagenet data took 2.002807378768921 seconds
Then, training+dataloading take 2.0142247676849365 seconds
Memory occpied: (2794.0, 3018.0)
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40082883834838867
Time for copying to cuda: 0.04293036460876465
Time for forward pass: 0.07622289657592773
Time for backpropagation: 0.0026960372924804688
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6209878921508789 seconds
Index: 9
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.6366851329803467 seconds
Streaming imagenet data took 1.6978402137756348 seconds
Then, training+dataloading take 1.7044117450714111 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40737199783325195
Time for copying to cuda: 0.04247426986694336
Time for forward pass: 0.07761359214782715
Time for backpropagation: 0.003114938735961914
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.650886058807373 seconds
Index: 10
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7382643222808838 seconds
Streaming imagenet data took 1.850745439529419 seconds
Then, training+dataloading take 1.8627915382385254 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Memory occpied: (2794.0, 3018.0)
Time of next(dataloader) is: 0.44228124618530273
Time for copying to cuda: 0.043045997619628906
Time for forward pass: 0.07586073875427246
Time for backpropagation: 0.0026705265045166016
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6721594333648682 seconds
Index: 11
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.611281394958496 seconds
Streaming imagenet data took 1.674412488937378 seconds
Then, training+dataloading take 1.681528091430664 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41350436210632324
Time for copying to cuda: 0.04224586486816406
Time for forward pass: 0.07626891136169434
Time for backpropagation: 0.0026786327362060547
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.642280101776123 seconds
Index: 12
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.6896553039550781 seconds
Streaming imagenet data took 1.7510137557983398 seconds
Then, training+dataloading take 1.7618284225463867 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4859123229980469
Time for copying to cuda: 0.04311013221740723
Time for forward pass: 0.07579827308654785
Time for backpropagation: 0.002707242965698242
GPU memory for training: 2.005207061767578                          

Memory occpied: (2794.0, 3018.0)
One training iteration takes: 0.6953864097595215 seconds
Index: 13
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8334648609161377 seconds
Streaming imagenet data took 1.8968138694763184 seconds
Then, training+dataloading take 1.9085006713867188 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (2794.0, 3018.0)
Time of next(dataloader) is: 0.4420738220214844
Time for copying to cuda: 0.04281926155090332
Time for forward pass: 0.07585382461547852
Time for backpropagation: 0.0027899742126464844
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6564037799835205 seconds
Index: 14
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7684528827667236 seconds
Streaming imagenet data took 1.8297014236450195 seconds
Then, training+dataloading take 1.8399429321289062 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4089522361755371
Time for copying to cuda: 0.04270362854003906
Time for forward pass: 0.09527015686035156
Time for backpropagation: 0.003236532211303711
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6618874073028564 seconds
Index: 15
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.756932020187378 seconds
Streaming imagenet data took 1.8589105606079102 seconds
Then, training+dataloading take 1.8703172206878662 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (2794.0, 3018.0)
Time of next(dataloader) is: 0.4450869560241699
Time for copying to cuda: 0.04241824150085449
Time for forward pass: 0.0758671760559082
Time for backpropagation: 0.0026781558990478516
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6631202697753906 seconds
Index: 16
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7485260963439941 seconds
Streaming imagenet data took 1.8102977275848389 seconds
Then, training+dataloading take 1.8168120384216309 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41390228271484375
Time for copying to cuda: 0.042307138442993164
Time for forward pass: 0.07652831077575684
Time for backpropagation: 0.0031549930572509766
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6571125984191895 seconds
Index: 17
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.6971969604492188 seconds
Streaming imagenet data took 1.7992701530456543 seconds
Then, training+dataloading take 1.8068671226501465 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44779276847839355
Time for copying to cuda: 0.04303598403930664
Time for forward pass: 0.07584047317504883
Time for backpropagation: 0.0026857852935791016
GPU memory for training: 2.005207061767578                          

Memory occpied: (2794.0, 3018.0)
One training iteration takes: 0.6831746101379395 seconds
Index: 18
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8426437377929688 seconds
Streaming imagenet data took 1.9055988788604736 seconds
Then, training+dataloading take 1.913020133972168 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Memory occpied: (2794.0, 3018.0)
Time of next(dataloader) is: 0.4555492401123047
Time for copying to cuda: 0.04237866401672363
Time for forward pass: 0.07618331909179688
Time for backpropagation: 0.002644777297973633
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6743779182434082 seconds
Index: 19
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.705188512802124 seconds
Streaming imagenet data took 1.7675800323486328 seconds
Then, training+dataloading take 1.777967929840088 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4194517135620117
Time for copying to cuda: 0.04273581504821777
Time for forward pass: 0.07578802108764648
Time for backpropagation: 0.0027425289154052734
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6355953216552734 seconds
Index: 20
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.6390862464904785 seconds
Streaming imagenet data took 1.7016453742980957 seconds
Then, training+dataloading take 1.7118313312530518 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.488466739654541
Time for copying to cuda: 0.04321002960205078
Time for forward pass: 0.07577753067016602
Time for backpropagation: 0.0027112960815429688
GPU memory for training: 2.005207061767578                          

Memory occpied: (2794.0, 3018.0)
One training iteration takes: 0.7130544185638428 seconds
Index: 21
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.9107744693756104 seconds
Streaming imagenet data took 1.9755935668945312 seconds
Then, training+dataloading take 1.9872081279754639 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (2794.0, 3018.0)
Time of next(dataloader) is: 0.44176197052001953
Time for copying to cuda: 0.04268789291381836
Time for forward pass: 0.07619953155517578
Time for backpropagation: 0.0027213096618652344
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6444909572601318 seconds
Index: 22
Memory occpied: (2794.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7145299911499023 seconds
Streaming imagenet data took 1.7759835720062256 seconds
Then, training+dataloading take 1.7866215705871582 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4073774814605713
Time for copying to cuda: 0.042724609375
Time for forward pass: 0.07575774192810059
Time for backpropagation: 0.0026950836181640625
GPU memory for training: 2.005207061767578                          

One training iteration takes: 0.6123380661010742 seconds
Index: 23
Read 52.826958656311035 MBs for this batch
Executing all posts took 0.7922303676605225 seconds
Memory occpied: (2794.0, 3018.0)
Streaming imagenet data took 0.8123726844787598 seconds
Then, training+dataloading take 0.8155720233917236 seconds

Epoch: 0
Time of next(dataloader) is: 0.34749317169189453
Time for copying to cuda: 0.014043331146240234
Time for forward pass: 0.15704584121704102
Time for backpropagation: 0.005776166915893555
GPU memory for training: 1.9363274574279785                          

The whole process took 54.49309825897217 seconds
