Namespace(batch_size=1000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='myalexnet', num_epochs=1, sequential=False, split_choice='manual', split_idx=9, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
IN SPLITTING ALGO
Recorded bandwidth: 15889.738173800795 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  0.57421875
TESTING *****************************
Input size, BW, MIN:
1505280000.0 2082699761.9164178 1505280000.0
All candidates indexes:  (array([ 2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
       19, 20]),)
SPLIT IDX CHOICE, split idx manual, freeze_idx:  manual 9 17
Intermediate:  0.1650390625
1.47705078125
Total layers size  4.189361572265625
Server, client, server+client, vanilla  284.73876953125 829.95361328125 1114.6923828125 2716.18408203125
Fixed, scale_with_bsz  0 2.05126953125
Mem usage  4707.0 2110.0
Using split index: 9
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
Start 0, end 1000, post_step 1000

Memory occpied: (4707.0, 2110.0)
Memory occpied: (4707.0, 2110.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8075509071350098 seconds
Streaming imagenet data took 1.8705554008483887 seconds
The mode is:  split
Start 1000, end 2000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33803868293762207
Time for copying to cuda: 0.04380154609680176
Memory occpied: (4873.0, 2299.0)
Memory occpied: (4873.0, 2749.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8525116443634033 seconds
Streaming imagenet data took 1.9161946773529053 seconds
Memory occpied: (4873.0, 3123.0)
Memory occpied: (6371.0, 5109.0)
Time for forward pass: 3.7375564575195312
Time for backpropagation: 0.0510869026184082
GPU memory for training: 3.466838836669922                          

One training iteration takes: 4.248664379119873 seconds
Index: 0
Then, training+dataloading take 4.24918532371521 seconds
The mode is:  split
Start 2000, end 3000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36077117919921875
Time for copying to cuda: 0.04234790802001953
Time for forward pass: 0.05685234069824219
Time for backpropagation: 0.0026345252990722656
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5530638694763184 seconds
Index: 1
Memory occpied: (6145.0, 5125.0)
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.305347442626953 seconds
Streaming imagenet data took 2.366516590118408 seconds
Then, training+dataloading take 2.376418352127075 seconds
The mode is:  split
Start 3000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3646862506866455
Time for copying to cuda: 0.04227137565612793
Time for forward pass: 0.08046698570251465
Time for backpropagation: 0.0026988983154296875
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5578434467315674 seconds
Index: 2
Memory occpied: (6145.0, 5125.0)
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.706127166748047 seconds
Streaming imagenet data took 2.7693846225738525 seconds
Then, training+dataloading take 2.7792739868164062 seconds
The mode is:  split
Start 4000, end 5000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.371934175491333
Time for copying to cuda: 0.04340624809265137
Time for forward pass: 0.1105198860168457
Time for backpropagation: 0.003290414810180664
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.6194138526916504 seconds
Index: 3
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.675525426864624 seconds
Streaming imagenet data took 1.7726266384124756 seconds
Then, training+dataloading take 1.78220534324646 seconds
The mode is:  split
Start 5000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4042959213256836
Time for copying to cuda: 0.042215585708618164
Time for forward pass: 0.08080339431762695
Time for backpropagation: 0.0027985572814941406
GPU memory for training: 2.005695343017578                          

Memory occpied: (6145.0, 5125.0)
One training iteration takes: 0.6165173053741455 seconds
Index: 4
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.908137559890747 seconds
Streaming imagenet data took 1.970142126083374 seconds
Then, training+dataloading take 1.9802320003509521 seconds
The mode is:  split
Start 6000, end 7000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.36739277839660645
Time for copying to cuda: 0.042105913162231445
Time for forward pass: 0.08086466789245605
Time for backpropagation: 0.0027670860290527344
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5869581699371338 seconds
Index: 5
Memory occpied: (6145.0, 5125.0)
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.4903717041015625 seconds
Streaming imagenet data took 2.55993390083313 seconds
Then, training+dataloading take 2.5681986808776855 seconds
The mode is:  split
Start 7000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3649885654449463
Time for copying to cuda: 0.04222583770751953
Time for forward pass: 0.08077502250671387
Time for backpropagation: 0.0028040409088134766
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5789625644683838 seconds
Index: 6
Memory occpied: (6145.0, 5125.0)
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.396289825439453 seconds
Streaming imagenet data took 2.4593522548675537 seconds
Then, training+dataloading take 2.4718682765960693 seconds
The mode is:  split
Start 8000, end 9000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3903377056121826
Time for copying to cuda: 0.04303169250488281
Time for forward pass: 0.14758563041687012
Time for backpropagation: 0.044315338134765625
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.7400248050689697 seconds
Index: 7
Memory occpied: (6145.0, 5125.0)
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.7666430473327637 seconds
Streaming imagenet data took 2.8284904956817627 seconds
Then, training+dataloading take 2.8380467891693115 seconds
The mode is:  split
Start 9000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (6145.0, 5125.0)
Time of next(dataloader) is: 0.44748830795288086
Time for copying to cuda: 0.04241490364074707
Time for forward pass: 0.1691296100616455
Time for backpropagation: 0.0027742385864257812
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.7628164291381836 seconds
Index: 8
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.5848052501678467 seconds
Streaming imagenet data took 2.7146244049072266 seconds
Then, training+dataloading take 2.7221832275390625 seconds
The mode is:  split
Start 10000, end 11000, post_step 1000


Epoch: 0
Memory occpied: (6145.0, 5125.0)
Time of next(dataloader) is: 0.36031579971313477
Time for copying to cuda: 0.0425412654876709
Time for forward pass: 0.0776679515838623
Time for backpropagation: 0.0027174949645996094
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5689983367919922 seconds
Index: 9
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.723240852355957 seconds
Streaming imagenet data took 1.7856204509735107 seconds
Then, training+dataloading take 1.7946925163269043 seconds
The mode is:  split
Start 11000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3651139736175537
Time for copying to cuda: 0.04273271560668945
Time for forward pass: 0.0806276798248291
Time for backpropagation: 0.03451967239379883
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.6343162059783936 seconds
Index: 10
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.7800073623657227 seconds
Streaming imagenet data took 1.923109531402588 seconds
Then, training+dataloading take 1.9302566051483154 seconds
The mode is:  split
Start 12000, end 13000, post_step 1000


Epoch: 0
Memory occpied: (6145.0, 5125.0)
Memory occpied: (6145.0, 5125.0)
Time of next(dataloader) is: 0.3783869743347168
Time for copying to cuda: 0.042603492736816406
Time for forward pass: 0.08073210716247559
Time for backpropagation: 0.0027074813842773438
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.58866286277771 seconds
Index: 11
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.1198322772979736 seconds
Streaming imagenet data took 2.1877782344818115 seconds
Then, training+dataloading take 2.1979103088378906 seconds
The mode is:  split
Start 13000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.43082141876220703
Time for copying to cuda: 0.04244375228881836
Time for forward pass: 0.0807034969329834
Time for backpropagation: 0.0027093887329101562
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.6654050350189209 seconds
Index: 12
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.898162841796875 seconds
Memory occpied: (6145.0, 5125.0)
Streaming imagenet data took 1.9940650463104248 seconds
Then, training+dataloading take 2.004359006881714 seconds
The mode is:  split
Start 14000, end 15000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3880133628845215
Time for copying to cuda: 0.042669057846069336
Time for forward pass: 0.05958223342895508
Time for backpropagation: 0.003313779830932617
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5825424194335938 seconds
Index: 13
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8820416927337646 seconds
Streaming imagenet data took 1.9432179927825928 seconds
Then, training+dataloading take 1.9521615505218506 seconds
The mode is:  split
Start 15000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41655540466308594
Memory occpied: (6145.0, 5125.0)
Time for copying to cuda: 0.04491257667541504
Time for forward pass: 0.0808420181274414
Time for backpropagation: 0.0030393600463867188
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.6358027458190918 seconds
Index: 14
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.0377259254455566 seconds
Streaming imagenet data took 2.101613998413086 seconds
Then, training+dataloading take 2.109975814819336 seconds
The mode is:  split
Start 16000, end 17000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3850243091583252
Time for copying to cuda: 0.04349803924560547
Time for forward pass: 0.09203124046325684
Time for backpropagation: 0.0034580230712890625
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.6291751861572266 seconds
Index: 15
Memory occpied: (6145.0, 5125.0)
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.1961259841918945 seconds
Streaming imagenet data took 2.2595818042755127 seconds
Then, training+dataloading take 2.2716567516326904 seconds
The mode is:  split
Start 17000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39464354515075684
Time for copying to cuda: 0.04317831993103027
Time for forward pass: 0.08075189590454102
Time for backpropagation: 0.0028467178344726562
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.6293184757232666 seconds
Index: 16
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.0007009506225586 seconds
Streaming imagenet data took 2.1092166900634766 seconds
Then, training+dataloading take 2.1152753829956055 seconds
The mode is:  split
Start 18000, end 19000, post_step 1000


Epoch: 0
Memory occpied: (6145.0, 5125.0)
Time of next(dataloader) is: 0.3853147029876709
Time for copying to cuda: 0.04241681098937988
Time for forward pass: 0.0807650089263916
Time for backpropagation: 0.0027320384979248047
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5979681015014648 seconds
Index: 17
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.6745374202728271 seconds
Streaming imagenet data took 1.7358646392822266 seconds
Then, training+dataloading take 1.7456128597259521 seconds
The mode is:  split
Start 19000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3621973991394043
Time for copying to cuda: 0.042233943939208984
Time for forward pass: 0.06580233573913574
Time for backpropagation: 0.002756357192993164
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5858855247497559 seconds
Index: 18
Memory occpied: (6145.0, 5125.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.6745007038116455 seconds
Streaming imagenet data took 1.775977373123169 seconds
Then, training+dataloading take 1.7819373607635498 seconds
The mode is:  split
Start 20000, end 21000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.44077205657958984
Time for copying to cuda: 0.045877933502197266
Time for forward pass: 0.08418130874633789
Time for backpropagation: 0.0027484893798828125
GPU memory for training: 2.005695343017578                          

Memory occpied: (6145.0, 5125.0)
One training iteration takes: 0.6626574993133545 seconds
Index: 19
Memory occpied: (2952.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.0476410388946533 seconds
Streaming imagenet data took 2.1098828315734863 seconds
Then, training+dataloading take 2.1226284503936768 seconds
The mode is:  split
Start 21000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3740658760070801
Time for copying to cuda: 0.04395461082458496
Time for forward pass: 0.07902646064758301
Time for backpropagation: 0.0027632713317871094
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5899007320404053 seconds
Index: 20
Memory occpied: (2952.0, 3018.0)
Memory occpied: (2952.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 2.2901060581207275 seconds
Streaming imagenet data took 2.3524105548858643 seconds
Then, training+dataloading take 2.365027666091919 seconds
The mode is:  split
Start 22000, end 23000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3805058002471924
Time for copying to cuda: 0.0442807674407959
Time for forward pass: 0.08075618743896484
Time for backpropagation: 0.0028018951416015625
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5992965698242188 seconds
Index: 21
Memory occpied: (2952.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.8965480327606201 seconds
Streaming imagenet data took 2.029550790786743 seconds
Then, training+dataloading take 2.0360522270202637 seconds
The mode is:  split
Start 23000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (2952.0, 3018.0)
Time of next(dataloader) is: 0.3752121925354004
Time for copying to cuda: 0.043065547943115234
Time for forward pass: 0.0808875560760498
Time for backpropagation: 0.002871990203857422
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.5986876487731934 seconds
Index: 22
Memory occpied: (2952.0, 3018.0)
Read 165.08400058746338 MBs for this batch
Executing all posts took 1.693232774734497 seconds
Streaming imagenet data took 1.7551302909851074 seconds
Then, training+dataloading take 1.7680118083953857 seconds
The mode is:  split
Start 24000, end 24320, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37410736083984375
Time for copying to cuda: 0.044564008712768555
Time for forward pass: 0.08065962791442871
Time for backpropagation: 0.002749919891357422
GPU memory for training: 2.005695343017578                          

One training iteration takes: 0.6107048988342285 seconds
Index: 23
Memory occpied: (2952.0, 3018.0)
Read 52.826958656311035 MBs for this batch
Executing all posts took 0.7443866729736328 seconds
Streaming imagenet data took 0.765484094619751 seconds
Then, training+dataloading take 0.7692220211029053 seconds

Epoch: 0
Time of next(dataloader) is: 0.3080008029937744
Time for copying to cuda: 0.01493978500366211
Time for forward pass: 0.15900254249572754
Time for backpropagation: 0.0052564144134521484
GPU memory for training: 1.9363274574279785                          

The whole process took 60.99547004699707 seconds
