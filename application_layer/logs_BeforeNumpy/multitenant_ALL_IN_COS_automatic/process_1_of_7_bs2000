Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (2985.0, 3.0)
Memory occpied: (2985.0, 3.0)
Memory occpied: (2985.0, 3.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (4135.0, 15.0)
Streaming imagenet data took 4.224635124206543 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (4135.0, 1046.0)
Time of next(dataloader) is: 1.0819671154022217
Time for copying to cuda: 0.3045065402984619
Memory occpied: (5285.0, 2241.0)
Memory occpied: (5285.0, 4025.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.496337890625 seconds
Memory occpied: (14677.0, 12947.0)
Memory occpied: (10227.0, 8743.0)
Memory occpied: (11247.0, 14013.0)
Memory occpied: (14331.0, 14021.0)
Time for forward pass: 7.846651315689087
Time for backpropagation: 0.08692049980163574
GPU memory for training: 11.991612911224365                          

One training iteration takes: 9.513454914093018 seconds
Index: 0
Then, training+dataloading take 9.516183853149414 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.2769591808319092
Time for copying to cuda: 0.3014378547668457
Time for forward pass: 0.015116453170776367
Time for backpropagation: 0.0036895275115966797
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.832921028137207 seconds
Index: 1
Memory occpied: (14339.0, 12183.0)
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.523603677749634 seconds
Then, training+dataloading take 4.60969614982605 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (14347.0, 12183.0)
Time of next(dataloader) is: 1.3890774250030518
Memory occpied: (14347.0, 12183.0)
Time for copying to cuda: 0.36275243759155273
Time for forward pass: 0.006386756896972656
Time for backpropagation: 0.0027151107788085938
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 2.0785164833068848 seconds
Index: 2
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.321061611175537 seconds
Then, training+dataloading take 4.417449712753296 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 1.2354168891906738
Time for copying to cuda: 0.3104686737060547
Time for forward pass: 0.009554624557495117
Time for backpropagation: 0.0030031204223632812
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.805142879486084 seconds
Index: 3
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14347.0, 12183.0)
Streaming imagenet data took 4.2722108364105225 seconds
Then, training+dataloading take 4.328486680984497 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (14347.0, 12183.0)
Time of next(dataloader) is: 1.351365089416504
Time for copying to cuda: 0.3056511878967285
Time for forward pass: 0.006310701370239258
Time for backpropagation: 0.002862215042114258
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.9817888736724854 seconds
Index: 4
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14347.0, 12183.0)
Streaming imagenet data took 4.42900013923645 seconds
Then, training+dataloading take 4.487206220626831 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (14347.0, 12183.0)
Time of next(dataloader) is: 1.2510147094726562
Time for copying to cuda: 0.30452585220336914
Time for forward pass: 0.006594657897949219
Time for backpropagation: 0.003720521926879883
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.904853105545044 seconds
Index: 5
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14347.0, 12183.0)
Streaming imagenet data took 4.146243572235107 seconds
Then, training+dataloading take 4.211523056030273 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (14347.0, 12183.0)
Time of next(dataloader) is: 1.2169005870819092
Time for copying to cuda: 0.30757856369018555
Time for forward pass: 0.0062749385833740234
Time for backpropagation: 0.0026826858520507812
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.844269037246704 seconds
Index: 6
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14347.0, 12183.0)
Streaming imagenet data took 4.358874559402466 seconds
Then, training+dataloading take 4.4119837284088135 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (14347.0, 12183.0)
Time of next(dataloader) is: 1.270324468612671
Time for copying to cuda: 0.30907583236694336
Time for forward pass: 0.006214141845703125
Time for backpropagation: 0.0027418136596679688
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.9732367992401123 seconds
Index: 7
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14347.0, 12183.0)
Streaming imagenet data took 4.243791580200195 seconds
Then, training+dataloading take 4.342398166656494 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (14347.0, 12183.0)
Time of next(dataloader) is: 1.15673828125
Time for copying to cuda: 0.3126096725463867
Time for forward pass: 0.007633686065673828
Time for backpropagation: 0.002828359603881836
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.7667386531829834 seconds
Index: 8
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14347.0, 12183.0)
Streaming imagenet data took 4.382882356643677 seconds
Then, training+dataloading take 4.442021369934082 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (14347.0, 12183.0)
Time of next(dataloader) is: 1.3498947620391846
Time for copying to cuda: 0.31530022621154785
Time for forward pass: 0.006340742111206055
Time for backpropagation: 0.002793550491333008
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 2.0309054851531982 seconds
Index: 9
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14347.0, 12183.0)
Streaming imagenet data took 4.2528016567230225 seconds
Then, training+dataloading take 4.314830303192139 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (14347.0, 12183.0)
Time of next(dataloader) is: 1.3129489421844482
Time for copying to cuda: 0.34311914443969727
Time for forward pass: 0.006249427795410156
Time for backpropagation: 0.0026237964630126953
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.9850172996520996 seconds
Index: 10
Memory occpied: (14347.0, 12183.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (11695.0, 7253.0)
Streaming imagenet data took 4.282029628753662 seconds
Then, training+dataloading take 4.373526573181152 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Read 183.76415348052979 MBs for this batch
Memory occpied: (7862.0, 5166.0)
Streaming imagenet data took 1.193737506866455 seconds
Time of next(dataloader) is: 1.218707799911499
Time for copying to cuda: 0.3155238628387451
Time for forward pass: 0.005586862564086914
Time for backpropagation: 0.002669811248779297
GPU memory for training: 6.7999114990234375                          

One training iteration takes: 1.8209872245788574 seconds
Index: 11
Then, training+dataloading take 1.823509693145752 seconds

Epoch: 0
Time of next(dataloader) is: 0.5685575008392334
Time for copying to cuda: 0.0494685173034668
Time for forward pass: 0.4903092384338379
Time for backpropagation: 0.0027108192443847656
GPU memory for training: 2.6376090049743652                          

Memory occpied: (7874.0, 2090.0)
The whole process took 69.44897294044495 seconds