Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, model='alexnet', num_epochs=1, sequential=False, split_choice='automatic', split_idx=100, start=0, testonly=False, use_intermediate=False)
==> Preparing data..
==> Building model..
Using split index: 100
Freezing the lower layers of the model (alexnet) till index 17
The mode is:  vanilla
Start 0, end 2000, post_step 1000

Memory occpied: (2985.0, 3.0)
Memory occpied: (2985.0, 3.0)
Memory occpied: (2985.0, 3.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (2985.0, 3.0)
Streaming imagenet data took 4.0862932205200195 seconds
The mode is:  vanilla
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (4135.0, 784.0)
Time of next(dataloader) is: 1.1658434867858887
Time for copying to cuda: 0.3120083808898926
Memory occpied: (5285.0, 1999.0)
Memory occpied: (5285.0, 2971.0)
Read 1148.525468826294 MBs for this batch
Streaming imagenet data took 4.646204233169556 seconds
Memory occpied: (14677.0, 13071.0)
Memory occpied: (11873.0, 15005.0)
Memory occpied: (12575.0, 14265.0)
Memory occpied: (14813.0, 10083.0)
Time for forward pass: 8.562053918838501
Memory occpied: (10995.0, 10091.0)
Time for backpropagation: 0.07482481002807617
GPU memory for training: 9.75848388671875                          

One training iteration takes: 10.373629808425903 seconds
Index: 0
Then, training+dataloading take 10.37685513496399 seconds
The mode is:  vanilla
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (11003.0, 12435.0)
Time of next(dataloader) is: 1.2062394618988037
Time for copying to cuda: 0.29435133934020996
Time for forward pass: 0.013131856918334961
Time for backpropagation: 0.003910541534423828
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.7770590782165527 seconds
Index: 1
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.239791393280029 seconds
Then, training+dataloading take 4.325604677200317 seconds
The mode is:  vanilla
Start 6000, end 8000, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Time of next(dataloader) is: 1.290102481842041
Time for copying to cuda: 0.29437685012817383
Time for forward pass: 0.005975961685180664
Time for backpropagation: 0.002716064453125
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.8873398303985596 seconds
Index: 2
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.177828073501587 seconds
Then, training+dataloading take 4.235383749008179 seconds
The mode is:  vanilla
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Time of next(dataloader) is: 1.3260807991027832
Time for copying to cuda: 0.3035106658935547
Time for forward pass: 0.007485389709472656
Time for backpropagation: 0.0036630630493164062
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.9329948425292969 seconds
Index: 3
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.249301433563232 seconds
Then, training+dataloading take 4.349917650222778 seconds
The mode is:  vanilla
Start 10000, end 12000, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Time of next(dataloader) is: 1.1924240589141846
Time for copying to cuda: 0.3063933849334717
Time for forward pass: 0.0064127445220947266
Time for backpropagation: 0.002706766128540039
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.7690832614898682 seconds
Index: 4
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.346288204193115 seconds
Then, training+dataloading take 4.408300399780273 seconds
The mode is:  vanilla
Start 12000, end 14000, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Time of next(dataloader) is: 1.2750914096832275
Time for copying to cuda: 0.3177156448364258
Time for forward pass: 0.006356000900268555
Time for backpropagation: 0.003681659698486328
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.8810408115386963 seconds
Index: 5
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.2259321212768555 seconds
Then, training+dataloading take 4.304322242736816 seconds
The mode is:  vanilla
Start 14000, end 16000, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Time of next(dataloader) is: 1.22806715965271
Time for copying to cuda: 0.30059027671813965
Time for forward pass: 0.006642341613769531
Time for backpropagation: 0.0027480125427246094
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.8329813480377197 seconds
Index: 6
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.203751802444458 seconds
Then, training+dataloading take 4.3174145221710205 seconds
The mode is:  vanilla
Start 16000, end 18000, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Time of next(dataloader) is: 1.204073429107666
Time for copying to cuda: 0.3055734634399414
Time for forward pass: 0.006179332733154297
Time for backpropagation: 0.0033245086669921875
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.7956247329711914 seconds
Index: 7
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.331695556640625 seconds
Then, training+dataloading take 4.391807556152344 seconds
The mode is:  vanilla
Start 18000, end 20000, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Time of next(dataloader) is: 1.3342597484588623
Time for copying to cuda: 0.3030259609222412
Time for forward pass: 0.0060846805572509766
Time for backpropagation: 0.0031774044036865234
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.9836342334747314 seconds
Index: 8
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.088802814483643 seconds
Then, training+dataloading take 4.186531066894531 seconds
The mode is:  vanilla
Start 20000, end 22000, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Time of next(dataloader) is: 1.2513453960418701
Time for copying to cuda: 0.3080434799194336
Time for forward pass: 0.006651163101196289
Time for backpropagation: 0.002685070037841797
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.867549180984497 seconds
Index: 9
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.459826469421387 seconds
Then, training+dataloading take 4.520202875137329 seconds
The mode is:  vanilla
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Time of next(dataloader) is: 1.2937066555023193
Time for copying to cuda: 0.3201732635498047
Time for forward pass: 0.006064891815185547
Time for backpropagation: 0.0026481151580810547
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.904493808746338 seconds
Index: 10
Memory occpied: (14087.0, 12443.0)
Read 1148.525468826294 MBs for this batch
Memory occpied: (14087.0, 12443.0)
Streaming imagenet data took 4.617593765258789 seconds
Then, training+dataloading take 4.71479344367981 seconds
The mode is:  vanilla
Start 24000, end 24320, post_step 1000


Epoch: 0
Memory occpied: (14087.0, 12443.0)
Read 183.76415348052979 MBs for this batch
Streaming imagenet data took 1.0945706367492676 seconds
Time of next(dataloader) is: 1.197761058807373
Time for copying to cuda: 0.3059201240539551
Time for forward pass: 0.005823850631713867
Time for backpropagation: 0.002679586410522461
GPU memory for training: 6.712249755859375                          

One training iteration takes: 1.808440923690796 seconds
Index: 11
Then, training+dataloading take 1.8110699653625488 seconds

Epoch: 0
Time of next(dataloader) is: 0.624497652053833
Time for copying to cuda: 0.05217885971069336
Time for forward pass: 0.5592432022094727
Time for backpropagation: 0.0026972293853759766
GPU memory for training: 2.6385855674743652                          

Memory occpied: (14087.0, 10107.0)
The whole process took 70.32827925682068 seconds