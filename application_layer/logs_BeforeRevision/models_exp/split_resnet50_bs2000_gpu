Namespace(batch_size=2000, cpuonly=False, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=21, manual_split=False, model='myresnet50', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Error of iperf: unable to connect to server: 
Recorded bandwidth: 908.2855256674147 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [3.2112640e+06 3.2112640e+06 3.2112640e+06 8.0281600e+05 1.4450688e+07
 1.4450688e+07 1.4450688e+07 1.0838016e+07 7.2253440e+06 7.2253440e+06
 7.2253440e+06 5.4190080e+06 3.6126720e+06 3.6126720e+06 3.6126720e+06
 3.6126720e+06 3.6126720e+06 2.7095040e+06 1.8063360e+06 1.8063360e+06
 8.1920000e+03 4.0000000e+03]
Input_size  133802.66666666666
All candidates indexes:  (array([20, 21]),)
Intermediate:  15.625
110.736328125
Total layers size  110.74014282226562
Candidate split  21
Server, client, server+client, vanilla  2880.2560119628906 128.37612915039062 3008.6321411132812 222733.8448791504
Model size  97.49234008789062
Fixed, scale_with_bsz  97.49234008789062 111.310546875
Mem usage  1250.0 3.0
Using split index: 21
Freezing the lower layers of the model (myresnet50) till index 21
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Memory occpied: (1366.0, 3.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 25.385411500930786 seconds
Streaming imagenet data took 25.39272689819336 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3540525436401367
Time for copying to cuda: 0.005173921585083008
Time for forward pass: 3.0256214141845703
Time for backpropagation: 0.06604790687561035
GPU memory for training: 0.4394540786743164                          

One training iteration takes: 3.5493998527526855 seconds
Index: 0
Memory occpied: (1382.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Memory occpied: (1616.0, 1408.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 23.829322814941406 seconds
Streaming imagenet data took 23.873756408691406 seconds
Then, training+dataloading take 23.880379676818848 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Memory occpied: (1616.0, 1408.0)
Time of next(dataloader) is: 0.32158923149108887
Time for copying to cuda: 0.004431724548339844
Time for forward pass: 0.020532846450805664
Time for backpropagation: 0.00739598274230957
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4255855083465576 seconds
Index: 1
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 24.762553691864014 seconds
Streaming imagenet data took 24.76970624923706 seconds
Then, training+dataloading take 24.770657062530518 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3565356731414795
Time for copying to cuda: 0.004391670227050781
Time for forward pass: 0.020948410034179688
Time for backpropagation: 0.006911516189575195
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4802968502044678 seconds
Index: 2
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 11.127015113830566 seconds
Streaming imagenet data took 11.172974586486816 seconds
Then, training+dataloading take 11.179435729980469 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.36423397064208984
Time for copying to cuda: 0.004357099533081055
Time for forward pass: 0.02053666114807129
Time for backpropagation: 0.006615161895751953
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4828333854675293 seconds
Index: 3
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.129337072372437 seconds
Streaming imagenet data took 10.134282350540161 seconds
Then, training+dataloading take 10.135265111923218 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33614206314086914
Time for copying to cuda: 0.00439143180847168
Time for forward pass: 0.021256208419799805
Time for backpropagation: 0.007153987884521484
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.45211338996887207 seconds
Index: 4
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.123291015625 seconds
Streaming imagenet data took 10.128714084625244 seconds
Then, training+dataloading take 10.12957239151001 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.37086915969848633
Time for copying to cuda: 0.004342317581176758
Time for forward pass: 0.02036905288696289
Time for backpropagation: 0.006494283676147461
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5089221000671387 seconds
Index: 5
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.421806812286377 seconds
Streaming imagenet data took 10.426782369613647 seconds
Then, training+dataloading take 10.427627563476562 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3287503719329834
Time for copying to cuda: 0.004422903060913086
Time for forward pass: 0.020488500595092773
Time for backpropagation: 0.006575584411621094
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4448399543762207 seconds
Index: 6
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.758188962936401 seconds
Streaming imagenet data took 7.763565301895142 seconds
Then, training+dataloading take 7.764528274536133 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3991069793701172
Time for copying to cuda: 0.0044896602630615234
Time for forward pass: 0.02094101905822754
Time for backpropagation: 0.0068628787994384766
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
One training iteration takes: 0.5048341751098633 seconds
Index: 7
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.347264766693115 seconds
Streaming imagenet data took 10.352119207382202 seconds
Then, training+dataloading take 10.35299825668335 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32115888595581055
Time for copying to cuda: 0.00436854362487793
Time for forward pass: 0.020474910736083984
Time for backpropagation: 0.006426811218261719
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4365274906158447 seconds
Index: 8
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.253474712371826 seconds
Streaming imagenet data took 10.258943557739258 seconds
Then, training+dataloading take 10.259795188903809 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3635547161102295
Time for copying to cuda: 0.0043430328369140625
Time for forward pass: 0.020511388778686523
Time for backpropagation: 0.006565570831298828
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5133979320526123 seconds
Index: 9
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.117208242416382 seconds
Streaming imagenet data took 10.126089811325073 seconds
Then, training+dataloading take 10.127177000045776 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.32607388496398926
Time for copying to cuda: 0.004397392272949219
Time for forward pass: 0.020524978637695312
Time for backpropagation: 0.006404399871826172
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4377095699310303 seconds
Index: 10
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.8103556632995605 seconds
Streaming imagenet data took 7.815837383270264 seconds
Then, training+dataloading take 7.816765785217285 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32413172721862793
Time for copying to cuda: 0.004411458969116211
Time for forward pass: 0.02044534683227539
Time for backpropagation: 0.006474494934082031
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.44345736503601074 seconds
Index: 11
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.467768669128418 seconds
Streaming imagenet data took 10.474567413330078 seconds
Then, training+dataloading take 10.47578763961792 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3260970115661621
Time for copying to cuda: 0.004380464553833008
Time for forward pass: 0.020500898361206055
Time for backpropagation: 0.0064165592193603516
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.42694091796875 seconds
Index: 12
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.436509132385254 seconds
Streaming imagenet data took 10.446136713027954 seconds
Then, training+dataloading take 10.447193622589111 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.37780261039733887
Time for copying to cuda: 0.004429817199707031
Time for forward pass: 0.02045583724975586
Time for backpropagation: 0.006502628326416016
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.49709010124206543 seconds
Index: 13
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.528016567230225 seconds
Streaming imagenet data took 10.533000946044922 seconds
Then, training+dataloading take 10.533949613571167 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3687753677368164
Time for copying to cuda: 0.004494190216064453
Time for forward pass: 0.02082371711730957
Time for backpropagation: 0.006784677505493164
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5005152225494385 seconds
Index: 14
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.703583478927612 seconds
Streaming imagenet data took 7.712987899780273 seconds
Then, training+dataloading take 7.713986873626709 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Memory occpied: (1644.0, 1416.0)
Time of next(dataloader) is: 0.33549022674560547
Time for copying to cuda: 0.004418849945068359
Time for forward pass: 0.020534992218017578
Time for backpropagation: 0.006635189056396484
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.44046640396118164 seconds
Index: 15
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.331497192382812 seconds
Streaming imagenet data took 10.336735725402832 seconds
Then, training+dataloading take 10.337738990783691 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3434741497039795
Time for copying to cuda: 0.00444793701171875
Time for forward pass: 0.020940303802490234
Time for backpropagation: 0.006728649139404297
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4622623920440674 seconds
Index: 16
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.40026330947876 seconds
Streaming imagenet data took 10.40580153465271 seconds
Then, training+dataloading take 10.406704664230347 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32695722579956055
Time for copying to cuda: 0.004431247711181641
Time for forward pass: 0.020707368850708008
Time for backpropagation: 0.006574153900146484
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.43110227584838867 seconds
Index: 17
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.539584159851074 seconds
Streaming imagenet data took 10.544620275497437 seconds
Then, training+dataloading take 10.545614004135132 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.33206748962402344
Time for copying to cuda: 0.004408359527587891
Time for forward pass: 0.020441770553588867
Time for backpropagation: 0.0064296722412109375
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.43199634552001953 seconds
Index: 18
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.868887662887573 seconds
Streaming imagenet data took 7.874129295349121 seconds
Then, training+dataloading take 7.8749988079071045 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3660469055175781
Time for copying to cuda: 0.040108680725097656
Time for forward pass: 0.02118206024169922
Time for backpropagation: 0.0067980289459228516
GPU memory for training: 0.45486021041870117                          

Memory occpied: (1644.0, 1416.0)
One training iteration takes: 0.5060520172119141 seconds
Index: 19
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.318684816360474 seconds
Streaming imagenet data took 10.323432922363281 seconds
Then, training+dataloading take 10.324328184127808 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32363176345825195
Time for copying to cuda: 0.004401206970214844
Time for forward pass: 0.02066659927368164
Time for backpropagation: 0.0065135955810546875
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.4378795623779297 seconds
Index: 20
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.250503540039062 seconds
Streaming imagenet data took 10.255864381790161 seconds
Then, training+dataloading take 10.2567138671875 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3682372570037842
Time for copying to cuda: 0.004388332366943359
Time for forward pass: 0.020383596420288086
Time for backpropagation: 0.006407737731933594
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.5175588130950928 seconds
Index: 21
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.257212162017822 seconds
Streaming imagenet data took 10.262048482894897 seconds
Then, training+dataloading take 10.262912273406982 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3405470848083496
Time for copying to cuda: 0.004555702209472656
Time for forward pass: 0.020623207092285156
Time for backpropagation: 0.006566286087036133
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.45520877838134766 seconds
Index: 22
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 7.714608192443848 seconds
Streaming imagenet data took 7.721947193145752 seconds
Then, training+dataloading take 7.722825527191162 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.32418394088745117
Time for copying to cuda: 0.0044519901275634766
Time for forward pass: 0.02054738998413086
Time for backpropagation: 0.00651860237121582
GPU memory for training: 0.45486021041870117                          

One training iteration takes: 0.45734095573425293 seconds
Index: 23
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Memory occpied: (1644.0, 1416.0)
Read 15.699838638305664 MBs for this batch
Executing all posts took 10.495792388916016 seconds
Streaming imagenet data took 10.501083374023438 seconds
Then, training+dataloading take 10.501915693283081 seconds

Epoch: 0
Time of next(dataloader) is: 0.32704591751098633
Time for copying to cuda: 0.00442051887512207
Time for forward pass: 0.02062678337097168
Time for backpropagation: 0.007466793060302734
GPU memory for training: 0.45486021041870117                          

The whole process took 296.53461742401123 seconds
