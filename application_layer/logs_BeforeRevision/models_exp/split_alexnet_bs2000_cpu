Namespace(batch_size=2000, cpuonly=True, dataset='imagenet', downloadall=False, end=10000, freeze=True, freeze_idx=17, manual_split=False, model='myalexnet', num_epochs=1, sequential=False, split_idx=100, start=0, testonly=False, use_intermediate=True)
==> Preparing data..
==> Building model..
INIT  104.0 3.0
Error of iperf: unable to connect to server: 
Recorded bandwidth: 908.2855256674147 Mbps
In _get_intermediate_outputs_and_time
Done intermediate outputs and time
Sizes  [774400. 774400. 186624. 559872. 559872. 129792. 259584. 259584. 173056.
 173056. 173056. 173056.  36864.  36864.  36864.  16384.  16384.  16384.
  16384.  16384.   4000.]
Input_size  133802.66666666666
All candidates indexes:  (array([12, 13, 14, 15, 16, 17, 18, 19, 20]),)
Intermediate:  70.3125
4.037109375
Total layers size  4.189361572265625
Candidate split  13
Server, client, server+client, vanilla  348.3644104003906 709.2774963378906 1057.6419067382812 9861.62124633789
Model size  233.08120727539062
Fixed, scale_with_bsz  233.08120727539062 4.611328125
Mem usage  1250.0 3.0
Using split index: 13
Freezing the lower layers of the model (myalexnet) till index 17
The mode is:  split
2
Start 0, end 2000, post_step 1000

Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 14.133056402206421 seconds
Streaming imagenet data took 14.161477088928223 seconds
The mode is:  split
2
Start 2000, end 4000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.40116381645202637
Time for copying to cuda: 1.2159347534179688e-05
Time for forward pass: 0.3452479839324951
Time for backpropagation: 0.17275094985961914
One training iteration takes: 0.9984302520751953 seconds
Index: 0
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.985286474227905 seconds
Streaming imagenet data took 13.012536525726318 seconds
Then, training+dataloading take 13.016682863235474 seconds
The mode is:  split
2
Start 4000, end 6000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3936338424682617
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3404815196990967
Time for backpropagation: 0.23191547393798828
One training iteration takes: 1.1138556003570557 seconds
Index: 1
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.84846305847168 seconds
Streaming imagenet data took 12.875536918640137 seconds
Then, training+dataloading take 12.879424333572388 seconds
The mode is:  split
2
Start 6000, end 8000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3828611373901367
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.35365867614746094
Time for backpropagation: 0.2601299285888672
One training iteration takes: 1.1284723281860352 seconds
Index: 2
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 12.841148853302002 seconds
Streaming imagenet data took 12.868829488754272 seconds
Then, training+dataloading take 12.872695207595825 seconds
The mode is:  split
2
Start 8000, end 10000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.4282512664794922
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3471519947052002
Time for backpropagation: 0.26163172721862793
One training iteration takes: 1.1506891250610352 seconds
Index: 3
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.596426248550415 seconds
Streaming imagenet data took 9.623525142669678 seconds
Then, training+dataloading take 9.627521276473999 seconds
The mode is:  split
2
Start 10000, end 12000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3971891403198242
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.41858410835266113
Time for backpropagation: 0.2516798973083496
One training iteration takes: 1.2055954933166504 seconds
Index: 4
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.44373106956482 seconds
Streaming imagenet data took 9.509358882904053 seconds
Then, training+dataloading take 9.516941785812378 seconds
The mode is:  split
2
Start 12000, end 14000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3930950164794922
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.37574028968811035
Time for backpropagation: 0.2633497714996338
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.163116693496704 seconds
Index: 5
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.537625551223755 seconds
Streaming imagenet data took 9.565625190734863 seconds
Then, training+dataloading take 9.570533275604248 seconds
The mode is:  split
2
Start 14000, end 16000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.34955596923828125
Time for copying to cuda: 6.67572021484375e-06
Time for forward pass: 0.3750627040863037
Time for backpropagation: 0.2993810176849365
One training iteration takes: 1.1493966579437256 seconds
Index: 6
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.071154832839966 seconds
Streaming imagenet data took 9.098238945007324 seconds
Then, training+dataloading take 9.101150751113892 seconds
The mode is:  split
2
Start 16000, end 18000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3544909954071045
Time for copying to cuda: 6.9141387939453125e-06
Memory occpied: (1250.0, 3.0)
Time for forward pass: 0.4372241497039795
Time for backpropagation: 0.2781679630279541
One training iteration takes: 1.2031896114349365 seconds
Index: 7
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.817204236984253 seconds
Streaming imagenet data took 9.844481229782104 seconds
Then, training+dataloading take 9.84856367111206 seconds
The mode is:  split
2
Start 18000, end 20000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.398632287979126
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.38773393630981445
Time for backpropagation: 0.259448766708374
One training iteration takes: 1.203826665878296 seconds
Index: 8
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.709036588668823 seconds
Streaming imagenet data took 9.736356019973755 seconds
Then, training+dataloading take 9.741208553314209 seconds
The mode is:  split
2
Start 20000, end 22000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3568694591522217
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.3407104015350342
Time for backpropagation: 0.3115723133087158
One training iteration takes: 1.1232411861419678 seconds
Index: 9
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.199723720550537 seconds
Streaming imagenet data took 9.226919412612915 seconds
Then, training+dataloading take 9.231153964996338 seconds
The mode is:  split
2
Start 22000, end 24000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41854262351989746
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.4304795265197754
Time for backpropagation: 0.21442270278930664
One training iteration takes: 1.2070376873016357 seconds
Index: 10
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.227535724639893 seconds
Streaming imagenet data took 9.255256652832031 seconds
Then, training+dataloading take 9.259476661682129 seconds
The mode is:  split
2
Start 24000, end 26000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4058554172515869
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3930668830871582
Time for backpropagation: 0.2504920959472656
One training iteration takes: 1.1870734691619873 seconds
Index: 11
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.474933862686157 seconds
Streaming imagenet data took 9.541293382644653 seconds
Then, training+dataloading take 9.548194169998169 seconds
The mode is:  split
2
Start 26000, end 28000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.41625261306762695
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.38643813133239746
Time for backpropagation: 0.2807457447052002
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.2117948532104492 seconds
Index: 12
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.371352672576904 seconds
Streaming imagenet data took 9.43768835067749 seconds
Then, training+dataloading take 9.445239782333374 seconds
The mode is:  split
2
Start 28000, end 30000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39673376083374023
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.3863382339477539
Time for backpropagation: 0.23241424560546875
Memory occpied: (1250.0, 3.0)
One training iteration takes: 1.1464436054229736 seconds
Index: 13
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.256263017654419 seconds
Streaming imagenet data took 9.283426523208618 seconds
Then, training+dataloading take 9.2880220413208 seconds
The mode is:  split
2
Start 30000, end 32000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.39546847343444824
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.38585591316223145
Time for backpropagation: 0.2579925060272217
One training iteration takes: 1.1712124347686768 seconds
Index: 14
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.235039710998535 seconds
Streaming imagenet data took 9.262464046478271 seconds
Then, training+dataloading take 9.265280485153198 seconds
The mode is:  split
2
Start 32000, end 34000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40352368354797363
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3995206356048584
Time for backpropagation: 0.22175002098083496
One training iteration takes: 1.159724473953247 seconds
Index: 15
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.723505020141602 seconds
Streaming imagenet data took 9.750873804092407 seconds
Then, training+dataloading take 9.755133152008057 seconds
The mode is:  split
2
Start 34000, end 36000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.3616321086883545
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.3819766044616699
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.44385385513305664
One training iteration takes: 1.3078134059906006 seconds
Index: 16
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.514424085617065 seconds
Streaming imagenet data took 9.542270183563232 seconds
Then, training+dataloading take 9.547069072723389 seconds
The mode is:  split
2
Start 36000, end 38000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.40903639793395996
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.4240415096282959
Time for backpropagation: 0.25136756896972656
One training iteration takes: 1.2102696895599365 seconds
Index: 17
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.59877324104309 seconds
Streaming imagenet data took 9.626500606536865 seconds
Then, training+dataloading take 9.631617307662964 seconds
The mode is:  split
2
Start 38000, end 40000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.40502429008483887
Time for copying to cuda: 7.3909759521484375e-06
Time for forward pass: 0.4084932804107666
Time for backpropagation: 0.2702028751373291
One training iteration takes: 1.2215814590454102 seconds
Index: 18
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.607905864715576 seconds
Streaming imagenet data took 9.674575090408325 seconds
Then, training+dataloading take 9.682666063308716 seconds
The mode is:  split
2
Start 40000, end 42000, post_step 1000


Epoch: 0
Memory occpied: (1250.0, 3.0)
Time of next(dataloader) is: 0.3688836097717285
Time for copying to cuda: 6.9141387939453125e-06
Time for forward pass: 0.3772439956665039
Time for backpropagation: 0.2866802215576172
One training iteration takes: 1.1644775867462158 seconds
Index: 19
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.530775308609009 seconds
Streaming imagenet data took 9.558438301086426 seconds
Then, training+dataloading take 9.563039064407349 seconds
The mode is:  split
2
Start 42000, end 44000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4105191230773926
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.40697383880615234
Time for backpropagation: 0.2622969150543213
One training iteration takes: 1.2159991264343262 seconds
Index: 20
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.470980167388916 seconds
Streaming imagenet data took 9.49827766418457 seconds
Then, training+dataloading take 9.502789974212646 seconds
The mode is:  split
2
Start 44000, end 46000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4112679958343506
Time for copying to cuda: 7.62939453125e-06
Time for forward pass: 0.39897584915161133
Time for backpropagation: 0.35083746910095215
One training iteration takes: 1.3095107078552246 seconds
Index: 21
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.356571435928345 seconds
Streaming imagenet data took 9.38345718383789 seconds
Then, training+dataloading take 9.38773226737976 seconds
The mode is:  split
2
Start 46000, end 48000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.4170970916748047
Time for copying to cuda: 8.106231689453125e-06
Time for forward pass: 0.3959624767303467
Time for backpropagation: 0.2603788375854492
One training iteration takes: 1.2093610763549805 seconds
Index: 22
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.265335083007812 seconds
Streaming imagenet data took 9.292639970779419 seconds
Then, training+dataloading take 9.29687213897705 seconds
The mode is:  split
2
Start 48000, end 50000, post_step 1000


Epoch: 0
Time of next(dataloader) is: 0.401735782623291
Time for copying to cuda: 7.867813110351562e-06
Time for forward pass: 0.4198915958404541
Time for backpropagation: 0.23856306076049805
One training iteration takes: 1.1959691047668457 seconds
Index: 23
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Memory occpied: (1250.0, 3.0)
Read 70.3937759399414 MBs for this batch
Executing all posts took 9.811494827270508 seconds
Streaming imagenet data took 9.838913679122925 seconds
Then, training+dataloading take 9.841991424560547 seconds

Epoch: 0
Time of next(dataloader) is: 0.36770176887512207
Time for copying to cuda: 7.152557373046875e-06
Time for forward pass: 0.3942582607269287
Memory occpied: (1250.0, 3.0)
Time for backpropagation: 0.4632682800292969
The whole process took 260.9716193675995 seconds
